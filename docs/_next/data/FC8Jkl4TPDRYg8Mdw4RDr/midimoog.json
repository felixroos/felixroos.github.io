{"pageProps":{"frontmatter":{"title":"Building a Minimoog MIDI Controller","date":"2020-06-11","tags":["diy","electronics","arduino"],"description":"Last week, a friend a I built a MIDI Controller for the Arturia Mini V3 VST.","image":"./img/miniv3frontpanel.png"},"code":"var Component=(()=>{var r=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=>c(a,\"__esModule\",{value:!0});var u=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),k=(a,n)=>{i(a);for(var s in n)c(a,s,{get:n[s],enumerable:!0})},N=(a,n,s)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let t of d(n))!m.call(a,t)&&t!==\"default\"&&c(a,t,{get:()=>n[t],enumerable:!(s=p(n,t))||s.enumerable});return a},g=a=>N(i(c(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((I,l)=>{l.exports=_jsx_runtime});var y={};k(y,{default:()=>f,frontmatter:()=>w});var e=g(o()),w={title:\"Building a Minimoog MIDI Controller\",date:\"2020-06-11\",tags:[\"diy\",\"electronics\",\"arduino\"],description:\"Last week, a friend a I built a MIDI Controller for the Arturia Mini V3 VST.\",image:\"./img/miniv3frontpanel.png\"};function b(a){let n=Object.assign({p:\"p\",img:\"img\",h2:\"h2\",a:\"a\",span:\"span\",ul:\"ul\",li:\"li\",h3:\"h3\",strong:\"strong\",pre:\"pre\",code:\"code\"},a.components),{wrapper:s}=n,t=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.p,{children:\"Last week, a friend a I built a MIDI Controller for the Arturia Mini V3 VST:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/miniv3.png\",alt:\"mini v3\"})}),`\n`,(0,e.jsxs)(n.h2,{id:\"front-panel-controls\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#front-panel-controls\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Front Panel Controls\"]}),`\n`,(0,e.jsx)(n.p,{children:\"At first, we identified the different 44 controls we needed:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://www.musikding.de/Alpha-Poti-16mm-gewinkelt-print-5k-lin\",children:\"21 potentiometers\"}),\" (with 2 \",(0,e.jsx)(n.a,{href:\"https://www.musikding.de/Bakelit-Knopf-21mm-schwarz\",children:\"21mm\"}),\" and 19 \",(0,e.jsx)(n.a,{href:\"https://www.musikding.de/Bakelit-Knopf-19mm-schwarz\",children:\"19mm\"}),\" bakelit knobs)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://www.musikding.de/Drehschalter-6-Pole-2-Stellungen-offen\",children:\"6 rotary switches\"}),\" (with \",(0,e.jsx)(n.a,{href:\"https://www.musikding.de/Chickenhead-23mm-schwarz\",children:\"chicken head knobs\"}),\")\"]}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://www.conrad.de/de/p/tru-components-tc-r13-2-05-kippschalter-250-v-ac-1-5-a-1-x-aus-ein-rastend-1-1587664.html\",children:\"17 flip switches\"})}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"We decided to omit the following rather useless controls:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"A440 rocker switch\"}),`\n`,(0,e.jsx)(n.li,{children:\"soft clipping switch + button\"}),`\n`,(0,e.jsx)(n.li,{children:\"all keyboard controls\"}),`\n`,(0,e.jsx)(n.li,{children:\"flip switch + overload leds\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"Also, we decided to use flip switches only + we added 2 extra flip switches below the 3 pots on the left.\"}),`\n`,(0,e.jsx)(n.p,{children:\"This is the front panel with all the pots and switches in place:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/midimoogpanel.png\",alt:\"front panel\"})}),`\n`,(0,e.jsx)(n.p,{children:\"for comparison:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/miniv3frontpanel.png\",alt:\"mini v3 front panel\"})}),`\n`,(0,e.jsxs)(n.h2,{id:\"midi-brain\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#midi-brain\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"MIDI Brain\"]}),`\n`,(0,e.jsx)(n.p,{children:\"To read the positions of all controls, we ended up using the Arduino Micro:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/arduinopins.png\",alt:\"arduino pins\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"it has a ATmega32U4 microcontroller, which makes it usable as a USB device\"}),`\n`,(0,e.jsx)(n.li,{children:\"it has up to 12 analog inputs and up to 20 digital inputs\"}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"analog-input-multiplexing\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#analog-input-multiplexing\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Analog Input Multiplexing\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"As we have 44 controls and only 12 analog inputs, we used seven \",(0,e.jsx)(n.a,{href:\"https://www.musikding.de/CD4051\",children:\"cd4051 ics\"}),\":\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/cd4051.png\",alt:\"cd4051 pins\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"pins 6 7 & 8 can be connected to ground\"}),`\n`,(0,e.jsx)(n.li,{children:\"pin 16 is connected to 5V\"}),`\n`,(0,e.jsx)(n.li,{children:'the \"channel in\" pins are connected to the controls'}),`\n`,(0,e.jsxs)(n.li,{children:['via the select pins a b and c, we can control which \"channel in\" is routed to the \"com out\". This is done by splitting the three digits of a binary number (000-111) to the three select pins.',`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"by constantly looping through all inputs, we can read all 8 controls in a short amount of time\"}),`\n`,(0,e.jsx)(n.li,{children:'this \"trick\" is also called time multiplexing, which makes the cd4051 a multiplexer'}),`\n`]}),`\n`]}),`\n`,(0,e.jsx)(n.li,{children:\"so with the 12 analog inputs of the arduino, we can connect up to 12x8 = 96 controls\"}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"the-board\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#the-board\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"The Board\"]}),`\n`,(0,e.jsx)(n.p,{children:\"To connect all 44 controls with the multiplexers to the arduino, I drew this board plan:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/boardplan1.png\",alt:\"board plan 1\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://www.conrad.de/de/p/rademacher-wr-typ-710-5-platine-hartpapier-l-x-b-160-mm-x-100-mm-35-m-rastermass-2-54-mm-inhalt-1-529506.html\",children:\"the copper strips\"}),\" go from left to right\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"black boxes: \",(0,e.jsx)(n.a,{href:\"(https://www.musikding.de/CD4051)\",children:\"cd4051 multiplexers\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"blue vertical lines: \",(0,e.jsx)(n.a,{href:\"https://www.musikding.de/Platinen-Steckverbinder-8-polig\",children:\"8 pole plug jacks\"})]}),`\n`,(0,e.jsx)(n.li,{children:\"red: 5V\"}),`\n`,(0,e.jsx)(n.li,{children:\"white: ground\"}),`\n`,(0,e.jsx)(n.li,{children:\"shades of blue: select bits a b and c\"}),`\n`,(0,e.jsx)(n.li,{children:\"red vertical marks: copper cuts\"}),`\n`,(0,e.jsx)(n.li,{children:\"green: output cables\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"By rotating the middle row of ics by 180 degrees, we can spare some cables for ground and the select pins.\"}),`\n`,(0,e.jsx)(n.p,{children:\"After soldering it together, the board looked like this:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/board1.png\",alt:\"soldered board\"})}),`\n`,(0,e.jsxs)(n.h2,{id:\"problems\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#problems\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Problems\"]}),`\n`,(0,e.jsx)(n.p,{children:\"As this was our first real electronics project, we ran into some unforseen problems.\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"problem-1-mirroring\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#problem-1-mirroring\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Problem 1: Mirroring\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"After the plan was made, we started using it on the copper side (top image) to solder the \",(0,e.jsx)(n.a,{href:\"https://www.musikding.de/16-Pin-Sockel\",children:\"16 pin jacks\"}),\" and the \",(0,e.jsx)(n.a,{href:\"https://www.musikding.de/Platinen-Steckverbinder-8-polig\",children:\"plug jacks\"}),\".\"]}),`\n`,(0,e.jsx)(n.li,{children:\"When we were done soldering, we realized that if we now attach the ics from the plastic side (down image), they will be mirrored, having wrong pin placements!\"}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Workaround\"}),': To fix the problem, we painstakingly bent all the ic legs to the other side to \"mirror\" them...']}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Future Learning\"}),\": Use two plans, where one is the mirrored version of the other, for both sides of the board\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"problem-2-empty-inputs\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#problem-2-empty-inputs\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Problem 2: Empty Inputs\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Another thing that we realized too late was all the multiplexers inputs must be connected to the circuit to make them work\"}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Workaround\"}),\": We connected all empty inputs via 10k pull up resistors to ground\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Future Learning\"}),\": It's better to use up as much inputs as possible\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"wiring-the-controls\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#wiring-the-controls\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Wiring the controls\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/panelwires.png\",alt:\"panel wires\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"the middle pins of each pot + one of the pins of each switch are connected to ic inputs\"}),`\n`,(0,e.jsx)(n.li,{children:\"all other pins of the switches + one of the outer pot pins are connected to 5V\"}),`\n`,(0,e.jsx)(n.li,{children:\"all remaining pins are connected to ground\"}),`\n`,(0,e.jsx)(n.li,{children:\"all the 5V pins of the switches are connected to ground with a 10k resistor\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"we transformed the rotary switches to potentiometers \",(0,e.jsx)(n.a,{href:\"https://www.instructables.com/id/Arduino-Rotary-Switch-One-Analogue-Input/\",children:\"by connecting the outer pins via resistors\"})]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"For the switches and the empty inputs (see Problem 2), we added the resistors directly on the board, before the plugs:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/boardwithresistors.png\",alt:\"board with resistors\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Future Learning\"}),\": Add the resistors directly to the 5V pin\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"programming-the-arduino\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#programming-the-arduino\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Programming the Arduino\"]}),`\n`,(0,e.jsx)(n.p,{children:\"The controls can be identified like this:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" NControls \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"44\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" connected\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"184\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// polyphonic switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"185\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// volume poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"186\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// unison switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"187\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// voice detune poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"191\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc3 volume poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"193\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// ext volume switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"195\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// keyboard ctrl 1 switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"196\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// amp attack poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"197\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// filter mod switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"198\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc1 switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"201\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc2 tune poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"203\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc1 range rotary switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"204\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// noise volume poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"205\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc2 switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"206\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc3 switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"207\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// noise switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"208\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc2 range rotary switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"211\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// vcf cutoff poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"213\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// vcf decay poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"214\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc2 vol poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"215\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc1 vol poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"216\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc2 waveform rotary switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"217\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc3 waveform rotary switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"218\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// vcf emphasis poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"221\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// external volume poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"223\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// keyboard ctrl 2 switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"224\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc1 frequency sync switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"225\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc3 tune poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"226\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc1 waveform rotary switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"227\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc3 range rotary switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"228\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// white/pink switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"231\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// effect 2 switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"232\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// effect 1 switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"233\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc2 ctrl switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"234\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// master tune poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"235\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc modulation switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"236\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// glide poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"237\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// mod mix poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"238\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// osc3 ctrl switch\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"274\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// vcf sustain poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"276\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// vcf contour poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"277\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// amp sustain poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"275\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// amp decay poti\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"194\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// vcf attack poti\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"The first two digits are the analog input of the ic (a0 - a5 = 18 - 23, a9 = 27)\"}),`\n`,(0,e.jsx)(n.li,{children:\"The third digit is where the control is connected to the ic (1-8)\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"For easier access, we can seperate the two numbers into two arrays:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" analogInput\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"NControls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// holds aX for every index\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" selectByte\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"NControls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// holds select byte for every index (controls ic)\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setup\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"byte i \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\" NControls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" i\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"++\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n    analogInput`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"floor\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"connected\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    selectByte`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" connected\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,e.jsx)(n.p,{children:\"In the loop function, we can now read all the voltages:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"loop\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"byte i \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\" NControls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" i\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"++\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// loop through all connected controls\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// select correct byte for current control\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bitRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"selectByte\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"11\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bitRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"selectByte\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"12\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bitRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"selectByte\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" voltage \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"analogRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"analogInput\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// 0-1023\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token function\",children:\"voltageToMidi\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"voltage\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,e.jsx)(n.p,{children:\"Now we can transform the raw voltage value to MIDI messages:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" midiCh \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"9\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" cc \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" voltageChangeThreshold \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" TIMEOUT \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"300\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"unsigned\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"long\"}),\" PTime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"NControls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// previous time the voltage changed (more than threshold)\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" midiPState\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"NControls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// previous sent midi value for control i\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" voltagePState\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"NControls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// voltage of control i at last midi send\"}),`\n\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"voltageToMidi\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" voltage\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"abs\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"voltage\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\"voltagePState\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" voltageChangeThreshold\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n    PTime`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"millis\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"millis\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" PTime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\" TIMEOUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token comment\",children:'// here the voltage changed significantly and \"stayed there\" for more than 300 ms'}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" midiValue\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"isInverted\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"connected\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n      midiValue `,(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"voltage\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1023\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"127\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// flipped last 2 numbers to invert\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"connected\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"227\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n      midiValue `,(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"rotaryMidi\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"voltage\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"6\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n      midiValue `,(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"voltage\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1023\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"127\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// only send midi if it changes (0-127)\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"midiPState\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" midiValue\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n      `,(0,e.jsx)(n.span,{className:\"token function\",children:\"controlChange\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"midiCh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" cc\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" midiValue\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// send midi\"}),`\n      MidiUSB`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"flush\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// force send midi immediately\"}),`\n      voltagePState`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" voltage\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// remember last voltage where midi was sent\"}),`\n      midiPState`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" midiValue\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// update last sent midi\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"to compensate for voltage jitter, we ignore voltage changes that are lower than a threshold of 8\"}),`\n`,(0,e.jsx)(n.li,{children:\"if the voltage change is above the the theshold, the time is remembered\"}),`\n`,(0,e.jsx)(n.li,{children:\"for 300ms after a significant voltage change, the voltage is mapped to a midi value (0-127)\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"if the calculated midi value is different from the last, the value is sent out, using \",(0,e.jsx)(n.a,{href:\"https://www.arduino.cc/en/Reference/MIDIUSB\",children:\"MIDIUSB lib\"})]}),`\n`,(0,e.jsx)(n.li,{children:\"isInverted inverts the mapping for controls with inverted voltages (depends on wiring of 5v and ground)\"}),`\n`,(0,e.jsx)(n.li,{children:\"rotaryMidi maps the 6 step rotary switch to the target 7 step midi value of osc3 range (ignoring the first step)\"}),`\n`]}),`\n`,(0,e.jsx)(\"a\",{href:\"https://gist.github.com/felixroos/929a8d9c303748179c6bca835e6a16ab\",target:\"_blank\",children:(0,e.jsx)(n.p,{children:\"show complete code\"})}),`\n`,(0,e.jsxs)(n.h2,{id:\"conclusion\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#conclusion\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,e.jsx)(n.p,{children:\"After 4 days of soldering, and learning a lot about electronics, the basic controller was finished. I also built a prototype case:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/caseprototype.jpg\",alt:\"case\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Huge thanks goes out\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://goetzmd.de/category/diy/diy-midi-controller\",children:\"!! Goetz M\\xFCller D\\xFCrholt for his DIY Midi Controller Series\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://www.musiconerd.com/single-post/arduino-pro-micro-as-a-usb-midi-device\",children:\"Gustavo Silveira for the mapping idea\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://www.instructables.com/id/Arduino-Rotary-Switch-One-Analogue-Input/\",children:\"Mr Fid for the rotary switch idea\"})}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"I already know that this was not the last MIDI controller to build for myself. Next time, I will try to build a controller for the Prophet V (maybe also including keys).\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"tbd\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#tbd\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"TBD\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"build proper case\"}),`\n`,(0,e.jsx)(n.li,{children:\"add labels\"}),`\n`,(0,e.jsx)(n.li,{children:\"minor midi mapping issues\"}),`\n`]})]});return s?(0,e.jsx)(s,Object.assign({},a,{children:t})):t}var f=b;return y;})();\n;return Component.default;"},"__N_SSG":true}