{"pageProps":{"frontmatter":{"title":"DIY MIDI Keyboard Scanner","date":"2021-02-11","tags":["diy","electronics"],"description":"How to make two MIDI keyboards out of one..","image":"./img/maudio49/example-connection.png"},"code":"var Component=(()=>{var r=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var i=a=>c(a,\"__esModule\",{value:!0});var m=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),k=(a,n)=>{i(a);for(var s in n)c(a,s,{get:n[s],enumerable:!0})},N=(a,n,s)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let t of d(n))!h.call(a,t)&&t!==\"default\"&&c(a,t,{get:()=>n[t],enumerable:!(s=p(n,t))||s.enumerable});return a},b=a=>N(i(c(a!=null?r(u(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var l=m((v,o)=>{o.exports=_jsx_runtime});var f={};k(f,{default:()=>y,frontmatter:()=>g});var e=b(l()),g={title:\"DIY MIDI Keyboard Scanner\",date:\"2021-02-11\",tags:[\"diy\",\"electronics\"],description:\"How to make two MIDI keyboards out of one..\",image:\"./img/maudio49/example-connection.png\"};function w(a){let n=Object.assign({p:\"p\",img:\"img\",a:\"a\",h2:\"h2\",span:\"span\",h3:\"h3\",ul:\"ul\",li:\"li\",pre:\"pre\",code:\"code\"},a.components),{wrapper:s}=n,t=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/arduino-keystation49.png\",alt:\"keystation 49\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"After the \",(0,e.jsx)(n.a,{href:\"../midimoog/\",children:\"Minimoog MIDI Controller\"}),`, here comes another electronics project I did a few days ago.\nAs I had a `,(0,e.jsx)(n.a,{href:\"https://m-audio.de/keystation-88-mkii\",children:\"M Audio Keystation 88 MkII\"}),` laying around that I had replaced with a better master keyboard,\nI decided to tear it open and look inside..`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"1-how-a-midi-keyboard-looks-inside\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#1-how-a-midi-keyboard-looks-inside\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"1. How a MIDI Keyboard looks inside\"]}),`\n`,(0,e.jsx)(n.p,{children:\"The first step was dissassembling all the parts and understanding how they work. I cannot speak for all MIDI Keyboards, but I suppose they all work in a similar way.\"}),`\n`,(0,e.jsx)(n.p,{children:\"After removing the case, this is how the keybed looks like:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/keybed.png\",alt:\"keybed\"})}),`\n`,(0,e.jsx)(n.p,{children:\"The little green pcb holds a microcontroller, which controls the keybed:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/control-pcb.png\",alt:\"control pcb\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Looking from the side, we can see plastic fins that push down buttons when keys are pressed:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/switch.jpeg\",alt:\"switch\"})}),`\n`,(0,e.jsx)(n.p,{children:\"To get a better view, I removed the pcb from the keybed and took a closer look at the buttons:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/switch-inside.jpeg\",alt:\"switch inside\"})}),`\n`,(0,e.jsx)(n.p,{children:`Inside each button, there are two circles with conductive ink above a conductive ink pad that is interrupted by a snake shaped gap.\nIf the buttons are pressed, the circles bridge the gap, connecting the left and right inputs. Long story short, these are switches.`}),`\n`,(0,e.jsxs)(n.h3,{id:\"why-are-there-two-switches-per-key\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#why-are-there-two-switches-per-key\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Why are there two switches per key?\"]}),`\n`,(0,e.jsx)(n.p,{children:`There are two switches per key to be able to measure the velocity of the keystroke.\nAs one circle is slightly more elevated, it will make a connection a little earlier, before the less elevated one.\nThe time between the connections can be used to tell the velocity (smaller time = higher velocity).`}),`\n`,(0,e.jsxs)(n.h2,{id:\"2-analyzing-the-pcb\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#2-analyzing-the-pcb\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"2. Analyzing the PCB\"]}),`\n`,(0,e.jsx)(n.p,{children:`To find out what is going on, I needed to look at the pcb. For all 88 keys, there are 2 pcbs, where one has 49 and the other 39 keys.\nFrom this point, I decided to work with only 49 keys, as it is more handy.`}),`\n`,(0,e.jsx)(n.p,{children:\"Taking a closer look, we can see many diodes on the plastic side:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/diodes.png\",alt:\"diodes\"})}),`\n`,(0,e.jsx)(n.p,{children:\"I took pictures of the other (more interesting) side of the pcb, stitched them together and then redrew the copper lines above the photo:\"}),`\n`,(0,e.jsxs)(\"div\",{style:{display:\"flex\",height:\"500px\",width:\"600px\",overflow:\"auto\"},children:[(0,e.jsx)(\"div\",{style:{width:\"300px\",height:\"1000px\"},children:(0,e.jsx)(\"img\",{alt:\"pcb photo\",src:\"./img/maudio49/pcb_photo.png\"})}),(0,e.jsx)(\"div\",{style:{width:\"300px\",height:\"1000px\"},children:(0,e.jsx)(\"img\",{alt:\"pcb drawn\",src:\"./img/maudio49/pcb_drawing.png\"})})]}),`\n`,(0,e.jsx)(n.p,{children:`From the right image, I then created a more overseeable schematic,\nwhich is not constrained by pcb dimensions:`}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/pcb_schematic_flipped.png\",alt:\"schematic\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"The schematic unveils a logical arrangement of connections that is known as a \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Keyboard_matrix_circuit\",children:\"Keyboard Matrix\"}),\".\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"keyboard-matrix\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#keyboard-matrix\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Keyboard Matrix\"]}),`\n`,(0,e.jsx)(n.p,{children:`The above arrangement of wiring makes it possible to have much less pins than keys.\nHere, we have only 21 pins for 96 switches (2 switches for each of the 49 keys).\nIf we did not use a keyboard matrix, we could just connect each switch directly the microcontroller,\nbut that would cost us 96 pins..`}),`\n`,(0,e.jsx)(n.p,{children:`The 21 pins are connected via 2 plugs with 9 and 12 pins.\nAs we can tell from the direction of the diodes, the current must flow from the 9 pin connector the the 12 pin connector,\nas a diode only allows current flowing in one direction (direction of arrow).`}),`\n`,(0,e.jsx)(n.p,{children:`Now, the idea of the keyboard matrix is this: If we activate only one input pin,\nthe output pins that will be active let us decipher exactly which keys are pressed.\nAs we have 9 input pins and 12 output pins, we have a total of 9*12 = 108 possible combinations,\nwhich is more than enough for our 96 switches.`}),`\n`,(0,e.jsx)(n.p,{children:`Example: If we activate input pin 3, output pin 2 will be active if switch 8A is pressed (A = first, B = second switch).\nWe can verify that by looking at the schematic:`}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/example-connection.png\",alt:\"example connection\"})}),`\n`,(0,e.jsx)(n.p,{children:\"To get a better overview, we can create a table to show which combination of pins corresponds to which key switch:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/matrix-table.png\",alt:\"matrix table\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Of course, the values of this table will depend on the keyboard model, but the structure should be the same.\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"verifying-the-matrix-table\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#verifying-the-matrix-table\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Verifying the Matrix Table\"]}),`\n`,(0,e.jsx)(n.p,{children:`To verify that I am on the track, I used a multimeter in diode testing mode and connected the plus side to an input pin and the minus side to an output pin.\nPressing the key that corresponds to the pin combination should then make a connection, while others do nothing.\nI was quite happy to find out everything behaved as expected.`}),`\n`,(0,e.jsxs)(n.h3,{id:\"what-a-keyboard-scanner-does\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#what-a-keyboard-scanner-does\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"What a Keyboard Scanner does\"]}),`\n`,(0,e.jsx)(n.p,{children:`Now that we know how the keyboard matrix works, we can start to think of how to handle it.\nIn the end, we want a midi signal each time a key is pressed (note on) and depressed (note off).\nThis task is handled by the keyboard scanner, which is a microcontroller that repeatedly tests all pin combinations very quickly.\nIf a test for a particular combination is positive, a midi signal is sent for the key corresponding to that combination.`}),`\n`,(0,e.jsxs)(n.h2,{id:\"3-arduino-keyboard-scanner\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#3-arduino-keyboard-scanner\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"3. Arduino Keyboard Scanner\"]}),`\n`,(0,e.jsx)(n.p,{children:`As the already existing microcontroller is a black box, let's wire up our own keyboard scanner with an Arduino Micro.\nThe Arduino Micro is perfect for that task, as it acts as a class compliant USB device.`}),`\n`,(0,e.jsxs)(n.p,{children:[`The only problem: The Arduino Micro only has 20 input pins, but we need 21 for our 49 keys.\nTo fix that, we can use multiplexers, like already used `,(0,e.jsx)(n.a,{href:\"../midimoog/#analog-input-multiplexing\",children:\"for the midimoog\"}),\".\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"schematic\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#schematic\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Schematic\"]}),`\n`,(0,e.jsx)(n.p,{children:'This time, I started soldering without a plan (not recommended), but drew the \"schematic\" afterwards:'}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/scanner-schematic.png\",alt:\"scanner schematic\"})}),`\n`,(0,e.jsx)(n.p,{children:\"I did not explicitly draw all connections, this is the meaning of the colors:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"red is 5V\"}),`\n`,(0,e.jsx)(n.li,{children:\"black is ground\"}),`\n`,(0,e.jsx)(n.li,{children:\"gray numbers are keybed pins (top ic goes to input pins, bottom ics go to output pins)\"}),`\n`,(0,e.jsx)(n.li,{children:\"blue are the select pins / cables\"}),`\n`,(0,e.jsx)(n.li,{children:\"yellow is the input\"}),`\n`,(0,e.jsx)(n.li,{children:\"green are the outputs\"}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"soldering\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#soldering\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Soldering\"]}),`\n`,(0,e.jsx)(n.p,{children:\"After soldering it all together, the connected board board looked like this:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"./img/maudio49/arduino-scanner-pcb.png\",alt:\"scanner pcb\"})}),`\n`,(0,e.jsxs)(n.h3,{id:\"code\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#code\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Code\"]}),`\n`,(0,e.jsx)(n.p,{children:\"The basic idea of how to check if a key is pressed goes like this:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// send voltage to input pin\"}),`\n`,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"inputPin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" HIGH\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"outputPin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" HIGH\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// key is pressed => send midi or whatever\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,e.jsx)(n.p,{children:`The Problem: If a key is NOT pressed, the output pin might still be HIGH if it is not connected to ground with a pulldown resistor,\nas it is \"hanging in mid air\". When I realized that, I already soldered everything together..`}),`\n`,(0,e.jsxs)(n.p,{children:[\"Luckily, Arduino comes with \",(0,e.jsx)(n.a,{href:\"https://www.arduino.cc/en/Tutorial/DigitalInputPullup\",children:\"internal pullup resistors\"}),`.\nThis makes soldering resistors to each input obsolete. But, unluckily, there are no internal pulldown resistors, which means we have to flip the logic:`]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setup\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"outputPin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"inputPin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" INPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"inputPin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" HIGH\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// pullup\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"loop\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// send output pin LOW\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"outputPin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" LOW\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"inputPin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" LOW\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// key is pressed => send midi or whatever\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,e.jsx)(n.p,{children:`It took me a while to find this trick, but it makes sense:\nInstead of setting an output HIGH, we set the input LOW, which results in the current keep flowing through the diodes in the right direction.`}),`\n`,(0,e.jsx)(n.p,{children:\"Now, here is the code with all the correct ins and outs, according to the schematic:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setup\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"begin\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"9600\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"//select pins\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// ABC of INPUT\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"11\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"12\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// ABC of OUTPUTs\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" INPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// gray\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" HIGH\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// pullup\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"6\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" INPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// yellow\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"6\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" HIGH\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// pullup\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// green\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"pinMode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// green\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"set4051\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" pinA\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" pinB\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" pinC\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" channel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// A = least significant bit\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// bitRead also starts from least significant bit\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"pinA\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bitRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"channel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"pinB\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bitRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"channel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"pinC\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bitRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"channel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"loop\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// loop through all switches (98 = 49 * 2)\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" k \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" k \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"98\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" k\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"++\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" i \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" k \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"12\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// values between 0 to 8 (input pins)\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" o \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" k \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"12\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// values between 0 and 11 (output pins)\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// use input pin 5 for i == 8\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" readPin \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bitRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"6\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token function\",children:\"set4051\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"11\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"12\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// select input channel\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token function\",children:\"set4051\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" o\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// select output channel\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// use output 7 for o < 8 and output 8 for o >= 8\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bitRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"o\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalWrite\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"bitRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"o\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"readPin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" LOW\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n      `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// connected\"}),`\n      Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"println\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"k\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,e.jsx)(n.p,{children:`With this code, the serial monitor will print number k everytime a key is pressed.\nThis prevents us from the total brainfuck of thinking through which combination of inputs and outputs lead to which key.`}),`\n`,(0,e.jsx)(n.p,{children:`All we have to do is press each key lightly first (switch A), then to the bottom (switch B) and write the logged numbers to a list.\nFor my wiring, the list looks like this:`}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" keys\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"98\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"31\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"29\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"56\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"59\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"83\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"104\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"107\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"92\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"95\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"68\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"71\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"44\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"47\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"11\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"20\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"23\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"58\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"57\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"82\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"81\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"106\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"105\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"94\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"93\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"70\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"69\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"46\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"45\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"9\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"22\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"21\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"48\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"51\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"72\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"75\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"96\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"99\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"84\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"87\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"60\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"63\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"36\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"39\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"12\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"15\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"50\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"49\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"74\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"73\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"98\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"97\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"86\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"85\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"62\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"61\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"38\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"37\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"14\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"13\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"55\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"53\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"79\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"77\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"103\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"101\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"91\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"89\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"67\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"65\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"43\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"41\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"19\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"17\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"54\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"52\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"78\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"76\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"102\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"100\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"90\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"88\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"66\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"64\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"42\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"40\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"6\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token number\",children:\"18\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),`\n`,(0,e.jsx)(n.p,{children:\"With this knowledge, we can now loop through the keys in the correct order:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"loop\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" n \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" n \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"98\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" n\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"++\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" k \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" keys\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// the rest is the same as above\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,e.jsx)(n.p,{children:\"For the rest of the logic, we need to keep track of which keys are currently pressed + when the first switch of a key is pressed:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"/* */\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" maxPressTime \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"250\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// if key is pressed slower, nothing happens\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" minVelocity \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// velocity of maxPressTime\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" maxVelocity \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"90\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// velocity of pressTime 0\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" midiChannel \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// channel 0 = midi channel #1 (zero index)\"}),`\nbool pressed`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"49\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// keys that are currently pressed\"}),`\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"unsigned\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"long\"}),\" pressStart\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"49\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// remembers keypress starting times\"}),`\n\n`,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"loop\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"/* */\"}),`\n  bool isConnected `,(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"digitalRead\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"readPin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" LOW\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// connection is found for\"}),`\n  bool isDown `,(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" n \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// odd number = switch B => key is pressed down\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" keyIndex \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" n \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// 0 - 48 (will round down as it is int)\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" midi \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" keyIndex \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"36\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// to start from C2\"}),`\n  bool isPressed `,(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pressed\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"keyIndex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// is already pressed\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"/* */\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,e.jsx)(n.p,{children:\"With that info, we can implement everything else:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-c\",children:(0,e.jsxs)(n.code,{className:\"language-c\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"loop\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"/* */\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// keypress starts\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"isConnected \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"isPressed \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"isDown \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"pressStart\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"keyIndex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n      pressStart`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"keyIndex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"millis\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// key is now fully pressed\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"isConnected \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"isPressed \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" isDown\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"unsigned\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"long\"}),\" pressTime \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"millis\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" pressStart\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"keyIndex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),\" f \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"pressTime \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"maxPressTime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" velocity \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" f \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"maxVelocity \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" minVelocity\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" minVelocity\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"debug\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n      Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"done pressing \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n      Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"println\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n    pressed`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"keyIndex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"pressTime \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<=\"}),\" maxPressTime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// min velocity?\"}),`\n      `,(0,e.jsx)(n.span,{className:\"token function\",children:\"noteOn\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"midiChannel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" midi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" velocity\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n      MidiUSB`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"flush\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n      `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"debug\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n        Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"on \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n        Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"midi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n        Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"println\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n      `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// key is now fully unpressed\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"isConnected \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" isPressed \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"isDown\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n    pressed`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"keyIndex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token function\",children:\"noteOff\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"midiChannel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" midi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    MidiUSB`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"flush\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"debug\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n      Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"off \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n      Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"midi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n      Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n      Serial`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"println\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n    `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token comment\",children:\"// key is unpressed => may include keypresses that have started but did not go down\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"isConnected \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"isDown\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n    pressStart`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"keyIndex\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// reset time when key is released completely\"}),`\n  `,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`,(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"That's it! You can find the complete code \",(0,e.jsx)(n.a,{href:\"https://gist.github.com/felixroos/cd7111d1b1a2ba7e381b82faf6abb9e2\",children:\"here\"}),\".\"]}),`\n`,(0,e.jsxs)(n.h2,{id:\"4-final-thoughts\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#4-final-thoughts\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"4. Final Thoughts\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Now that the keyboard works, I will redo this with the other 39 keys to make 2 keyboards out of one!\"}),`\n`,(0,e.jsx)(n.li,{children:\"In the end, it was not really necessary to reverse engineer the pcb, but it helped for a deeper understanding.\"}),`\n`,(0,e.jsx)(n.li,{children:\"In a future project, I want to use the keyboard to send pitch control voltages to an analog synthesizer instead of midi messages.\"}),`\n`,(0,e.jsx)(n.li,{children:\"I also want to add pitch wheel and mod wheel support + octave change buttons.\"}),`\n`]})]});return s?(0,e.jsx)(s,Object.assign({},a,{children:t})):t}var y=w;return f;})();\n;return Component.default;"},"__N_SSG":true}