<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Loophole Letters</title><meta content="This is where felixroos writes about music and coding and stuff that he finds interesting." name="description"/><meta property="og:url" content="https://felixroos.github.io/analog-synthesis"/><link rel="canonical" href="https://felixroos.github.io/analog-synthesis"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"/><meta property="og:type" content="website"/><meta property="og:site_name" content="Loophole Letters"/><meta property="og:description" content="This is where felixroos writes about music and coding and stuff that he finds interesting."/><meta property="og:title" content="Loophole Letters"/><meta property="og:image" content="https://felixroos.github.io/images/site-preview.png"/><meta name="next-head-count" content="12"/><link rel="preload" href="/_next/static/css/1bf41908dc2b02975933.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1bf41908dc2b02975933.css" data-n-g=""/><link rel="preload" href="/_next/static/css/3dd4d340904c9260f6d8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3dd4d340904c9260f6d8.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-ddd010a953737b6e3536.js" defer=""></script><script src="/_next/static/chunks/framework-895f067827ebe11ffe45.js" defer=""></script><script src="/_next/static/chunks/main-222191e14496d29481e0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-59e28196aa70d0b239d8.js" defer=""></script><script src="/_next/static/chunks/404-d5935ede064e9f79c1b7.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-e72df5e3122da1e00991.js" defer=""></script><script src="/_next/static/3g4JzCtv87FmuTIoVbGJn/_buildManifest.js" defer=""></script><script src="/_next/static/3g4JzCtv87FmuTIoVbGJn/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css-global 1ob364s">html{--theme-ui-colors-primary:#307AC6;--theme-ui-colors-secondary:#27a727;--theme-ui-colors-background:#fff;--theme-ui-colors-text:#1b1e21;--theme-ui-colors-blue:#4169e1;--theme-ui-colors-cyan:#41b9e1;--theme-ui-colors-gray:#667788;--theme-ui-colors-green:#27a727;--theme-ui-colors-purple:#6941e1;--theme-ui-colors-orange:#fba100;--theme-ui-colors-pink:#e141b9;--theme-ui-colors-red:#ee5555;--theme-ui-colors-white:#fff;--theme-ui-colors-yellow:#FFDD22;--theme-ui-colors-lite:#eee;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-__default{--theme-ui-colors-primary:#307AC6;--theme-ui-colors-secondary:#27a727;--theme-ui-colors-background:#fff;--theme-ui-colors-text:#1b1e21;--theme-ui-colors-blue:#4169e1;--theme-ui-colors-cyan:#41b9e1;--theme-ui-colors-gray:#667788;--theme-ui-colors-green:#27a727;--theme-ui-colors-purple:#6941e1;--theme-ui-colors-orange:#fba100;--theme-ui-colors-pink:#e141b9;--theme-ui-colors-red:#ee5555;--theme-ui-colors-white:#fff;--theme-ui-colors-yellow:#FFDD22;--theme-ui-colors-lite:#eee;}html.theme-ui-dark{--theme-ui-colors-text:#fff;--theme-ui-colors-background:#292C34;--theme-ui-colors-lite:#333;--theme-ui-colors-primary:#85DEFB;}</style><style data-emotion="css-global 0"></style><style data-emotion="css 1td7120">.css-1td7120{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin:auto;position:relative;max-width:800px;}</style><div class="css-1td7120"><style data-emotion="css eim2bq">.css-eim2bq{box-sizing:border-box;margin:0;min-width:0;padding:16px;position:absolute;top:0;right:0;opacity:0;-webkit-transition:opacity .25s ease-in-out;transition:opacity .25s ease-in-out;}</style><div class="css-eim2bq"><style data-emotion="css jakyet">.css-jakyet{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;display:inline-block;text-align:center;line-height:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:inherit;padding-left:16px;padding-right:16px;padding-top:8px;padding-bottom:8px;color:var(--theme-ui-colors-white);background-color:var(--theme-ui-colors-primary);border:0;border-radius:4px;color:var(--theme-ui-colors-background);background-color:var(--theme-ui-colors-primary);background-color:var(--theme-ui-colors-gray);padding-top:4px;padding-bottom:4px;padding-left:8px;padding-right:8px;font-size:16px;cursor:pointer;}.css-jakyet:hover{background-color:var(--theme-ui-colors-text);}</style><button class="css-jakyet">light<!-- --> mode</button></div><style data-emotion="css 1doo0ju">.css-1doo0ju{box-sizing:border-box;margin:0;min-width:0;padding-top:32px;}</style><header class="css-1doo0ju"><style data-emotion="css 1n35gdr">.css-1n35gdr{box-sizing:border-box;margin:0;min-width:0;font-family:Montserrat,sans-serif;font-weight:900;line-height:1.1;font-size:30px;padding-bottom:32px;padding-left:16px;padding-right:16px;font-weight:900;}@media screen and (min-width: 32em){.css-1n35gdr{padding-left:32px;padding-right:32px;}}</style><h1 class="css-1n35gdr"><style data-emotion="css 1ie6k50">.css-1ie6k50{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-text);}</style><a href="/" class="css-1ie6k50">‚ôæÔ∏è loophole letters</a></h1></header><style data-emotion="css td0gup">.css-td0gup{box-sizing:border-box;margin:0;min-width:0;padding-left:16px;padding-right:16px;padding-bottom:0;}@media screen and (min-width: 32em){.css-td0gup{padding-left:32px;padding-right:32px;}}</style><main class="css-td0gup"><style data-emotion="css vurnku">.css-vurnku{box-sizing:border-box;margin:0;min-width:0;}</style><article class="css-vurnku"><style data-emotion="css 1hep91p">.css-1hep91p{box-sizing:border-box;margin:0;min-width:0;float:right;}</style><div class="css-1hep91p"><style data-emotion="css 1f7qs6g">.css-1f7qs6g{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;display:inline-block;text-align:center;line-height:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:inherit;padding-left:16px;padding-right:16px;padding-top:8px;padding-bottom:8px;color:var(--theme-ui-colors-white);background-color:var(--theme-ui-colors-primary);border:0;border-radius:4px;color:var(--theme-ui-colors-primary);border:1px solid var(--theme-ui-colors-primary);background-color:var(--theme-ui-colors-background);display:inline;margin-right:4px;}</style><button class="css-1f7qs6g">diy</button><button class="css-1f7qs6g">electronics</button><button class="css-1f7qs6g">synthesis</button></div><style data-emotion="css 108j34h">.css-108j34h{box-sizing:border-box;margin:0;min-width:0;font-family:Montserrat,sans-serif;font-weight:900;line-height:1.1;font-size:40px;}</style><h2 class="css-108j34h">A Macro View on Analog Synthesis</h2><style data-emotion="css 188b938">.css-188b938{box-sizing:border-box;margin:0;min-width:0;font-family:'Merriweather','Georgia',serif;font-weight:400;line-height:1.75;margin-bottom:32px;color:var(--theme-ui-colors-gray);font-style:italic;}</style><p class="css-188b938">May 14, 2021</p><div class="css-vurnku"><style data-emotion="css 142cd63">.css-142cd63{font-size:18px;font-weight:400;line-height:1.75;}</style><p class="css-142cd63">Lately, I&#x27;ve been learning about analog synthesis.
In this post, I want to document what I&#x27;ve learned so far and how I approached the topic.
Disclaimer: I am not an expert.</p>
<style data-emotion="css 12ewxln">.css-12ewxln{box-sizing:border-box;margin:0;min-width:0;font-family:Montserrat,sans-serif;font-weight:900;line-height:1.1;margin-bottom:8px;margin-top:32px;}</style><h2 id="analog--digital-synthesis" class="css-12ewxln"><style data-emotion="css 1e6egy8">.css-1e6egy8{color:var(--theme-ui-colors-primary);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;}</style><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Analog &amp; Digital Synthesis</h2>
<p class="css-142cd63"><style data-emotion="css 9whsf3">.css-9whsf3{max-width:100%;}</style><img src="./img/analog-synthesis/analogcircuit.gif" alt="analog circuit" class="css-9whsf3"/></p>
<p class="css-142cd63">In a nutshell, analog synthesis produces sound by directly manipulating voltages in electrical circuits.
In digital synthesis, buffered sound data is calculated from code and then passed to an audio interface that transforms it into voltage.</p>
<p class="css-142cd63">Generally, analog synthesis is much simpler in its infrastructure.
The higher complexity of digital synthesis allows much more fine grained control,
whereas analog synthesis can sometimes behave in unexpected ways.</p>
<p class="css-142cd63">I am not going into the debate of which is &quot;better&quot; here, as both ways have their right to exist.</p>
<h2 id="from-voltage-to-sound--" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>From Voltage to Sound üîå üîä</h2>
<p class="css-142cd63">In both analog and digital synthesis, we have a voltage at the end, which is fed to the sound system (amplifier + speaker).</p>
<div style="display:flex"><div style="width:300px"><p class="css-142cd63">When the voltage does a sine wave,</p><svg width="300" height="100"><g><path d="M269.000001,58.55786742317792L268.000001,62.043310495653806L267.000001,65.38537207766848L266.000001,68.5160174331217L265.000001,71.37151565061231L264.000001,73.89373702100893L263.000001,76.03133639069615L262.000001,77.74079840083459L261.000001,78.98732333457932L260.000001,79.74553553896028L259.000001,79.99999999999974L258.000001,79.74553655508585L257.000001,78.98732534614506L256.000001,77.7408013668908L255.000001,76.03134025086248L254.000001,73.89374169670357L253.000001,71.37152104665164L252.000001,68.51602343965781L251.000001,65.38537857242565L250.000001,62.04331734641754L249.000001,58.5578744904864L248.000001,55.00000356999156L247.000001,51.442132576822175L246.000001,47.956689504346194L245.000001,44.61462792233152L244.000001,41.483982566878296L243.000001,38.628484349387634L242.000001,36.10626297899107L241.000001,33.96866360930386L240.000001,32.25920159916541L239.000001,31.012676665420656L238.000001,30.254464461039717L237.000001,30.000000000000256L236.000001,30.254463444914144L235.000001,31.01267465385496L234.000001,32.25919863310915L233.000001,33.9686597491375L232.000001,36.10625830329636L231.000001,38.62847895334842L230.000001,41.48397656034219L229.000001,44.614621427574335L228.000001,47.95668265358247L227.000001,51.442125509513595L226.000001,54.99999643000843L225.000001,58.557867423177825L224.000001,62.0433104956538L223.000001,65.3853720776684L222.000001,68.51601743312177L221.000001,71.3715156506123L220.000001,73.89373702100893L219.000001,76.03133639069608L218.000001,77.74079840083462L217.000001,78.98732333457934L216.000001,79.74553553896028L215.000001,79.99999999999974L214.000001,79.74553655508585L213.000001,78.98732534614504L212.000001,77.74080136689085L211.000001,76.0313402508625L210.000001,73.89374169670364L209.000001,71.37152104665158L208.000001,68.51602343965789L207.000001,65.38537857242567L206.000001,62.04331734641762L205.000001,58.55787449048631L204.000001,55.00000356999157L203.000001,51.44213257682219L202.000001,47.9566895043462L201.000001,44.61462792233152L200.000001,41.483982566878225L199.000001,38.62848434938771L198.000001,36.10626297899107L197.000001,33.96866360930387L196.000001,32.25920159916537L195.000001,31.012676665420685L194.000001,30.254464461039717L193.000001,30.000000000000256L192.000001,30.254463444914155L191.000001,31.01267465385493L190.000001,32.25919863310915L189.000001,33.968659749137494L188.000001,36.106258303296414L187.000001,38.62847895334842L186.000001,41.48397656034211L185.000001,44.614621427574335L184.000001,47.95668265358246L183.000001,51.44212550951368L182.000001,54.99999643000834L181.000001,58.55786742317781L180.000001,62.04331049565379L179.000001,65.38537207766848L178.000001,68.5160174331217L177.000001,71.3715156506123L176.000001,73.89373702100899L175.000001,76.03133639069613L174.000001,77.74079840083463L173.000001,78.98732333457932L172.000001,79.74553553896028L171.000001,79.99999999999974L170.000001,79.74553655508585L169.000001,78.98732534614507L168.000001,77.74080136689084L167.000001,76.0313402508625L166.000001,73.8937416967036L165.000001,71.37152104665165L164.000001,68.5160234396579L163.000001,65.38537857242567L162.000001,62.043317346417545L161.000001,58.55787449048637L160.000001,55.00000356999166L159.000001,51.44213257682219L158.000001,47.95668950434621L157.000001,44.614627922331564L156.000001,41.48398256687823L155.000001,38.628484349387676L154.000001,36.106262978991076L153.000001,33.96866360930387L152.000001,32.259201599165394L151.000001,31.012676665420674L150.000001,30.254464461039717L149.000001,30.000000000000256L148.000001,30.25446344491415L147.000001,31.01267465385494L146.000001,32.25919863310914L145.000001,33.968659749137494L144.000001,36.10625830329638L143.000001,38.628478953348385L142.000001,41.48397656034214L141.000001,44.61462142757437L140.000001,47.956682653582455L139.000001,51.44212550951367L138.000001,54.99999643000837L137.000001,58.55786742317781L136.000001,62.043310495653785L135.000001,65.38537207766842L134.000001,68.51601743312173L133.000001,71.37151565061228L132.000001,73.89373702100892L131.000001,76.0313363906961L130.000001,77.74079840083462L129.000001,78.98732333457932L128.000001,79.74553553896028L127.000001,79.99999999999974L126.000001,79.74553655508585L125.000001,78.98732534614507L124.000001,77.74080136689084L123.000001,76.0313402508625L122.000001,73.8937416967036L121.000001,71.37152104665162L120.000001,68.51602343965786L119.000001,65.38537857242568L118.000001,62.04331734641759L117.000001,58.55787449048637L116.000001,55.00000356999167L115.000001,51.44213257682219L114.000001,47.956689504346215L113.000001,44.614627922331536L112.000001,41.48398256687827L111.000001,38.62848434938768L110.000001,36.10626297899108L109.000001,33.968663609303874L108.000001,32.259201599165394L107.000001,31.012676665420674L106.000001,30.254464461039717L105.000001,30.000000000000256L104.000001,30.254463444914155L103.000001,31.01267465385494L102.000001,32.25919863310915L101.000001,33.96865974913749L100.000001,36.10625830329639L99.000001,38.62847895334838L98.000001,41.483976560342114L97.000001,44.61462142757435L96.000001,47.95668265358245L95.000001,51.44212550951365L94.000001,54.999996430008366L93.000001,58.557867423177825L92.000001,62.043310495653785L91.000001,65.38537207766842L90.000001,68.51601743312172L89.000001,71.37151565061231L88.000001,73.89373702100892L87.000001,76.03133639069611L86.000001,77.7407984008346L85.000001,78.98732333457932L84.000001,79.74553553896028L83.000001,79.99999999999974L82.000001,79.74553655508585L81.000001,78.98732534614507L80.000001,77.74080136689085L79.000001,76.03134025086251L78.000001,73.8937416967036L77.000001,71.37152104665162L76.000001,68.51602343965789L75.000001,65.38537857242568L74.000001,62.04331734641757L73.000001,58.55787449048637L72.000001,55.00000356999165L71.000001,51.442132576822175L70.000001,47.95668950434622L69.000001,44.614627922331564L68.000001,41.48398256687828L67.000001,38.628484349387705L66.000001,36.10626297899108L65.000001,33.96866360930388L64.000001,32.259201599165394L63.000001,31.012676665420685L62.000001,30.254464461039717L61.000001,30.000000000000256L60.000001,30.254463444914155L59.000001,31.01267465385494L58.000001,32.25919863310915L57.000001,33.96865974913749L56.000001,36.10625830329639L55.000001,38.62847895334838L54.000001,41.48397656034212L53.000001,44.61462142757433L52.000001,47.95668265358243L51.000001,51.44212550951363L50.000001,54.99999643000836" stroke="green" stroke-width="1" fill="none"></path></g></svg></div><div style="width:300px"><p class="css-142cd63"> the membrane will move like this:</p><svg width="300" height="100"><g><path d="M269.000001,55L268.000001,55L267.000001,55L266.000001,55L265.000001,55L264.000001,55L263.000001,55L262.000001,55L261.000001,55L260.000001,55L259.000001,55L258.000001,55L257.000001,55L256.000001,55L255.000001,55L254.000001,55L253.000001,55L252.000001,55L251.000001,55L250.000001,55L249.000001,55L248.000001,55L247.000001,55L246.000001,55L245.000001,55L244.000001,55L243.000001,55L242.000001,55L241.000001,55L240.000001,55L239.000001,55L238.000001,55L237.000001,55L236.000001,55L235.000001,55L234.000001,55L233.000001,55L232.000001,55L231.000001,55L230.000001,55L229.000001,55L228.000001,55L227.000001,55L226.000001,55L225.000001,55L224.000001,55L223.000001,55L222.000001,55L221.000001,55L220.000001,55L219.000001,55L218.000001,55L217.000001,55L216.000001,55L215.000001,55L214.000001,55L213.000001,55L212.000001,55L211.000001,55L210.000001,55L209.000001,55L208.000001,55L207.000001,55L206.000001,55L205.000001,55L204.000001,55L203.000001,55L202.000001,55L201.000001,55L200.000001,55L199.000001,55L198.000001,55L197.000001,55L196.000001,55L195.000001,55L194.000001,55L193.000001,55L192.000001,55L191.000001,55L190.000001,55L189.000001,55L188.000001,55L187.000001,55L186.000001,55L185.000001,55L184.000001,55L183.000001,55L182.000001,55L181.000001,55L180.000001,55L179.000001,55L178.000001,55L177.000001,55L176.000001,55L175.000001,55L174.000001,55L173.000001,55L172.000001,55L171.000001,55L170.000001,55L169.000001,55L168.000001,55L167.000001,55L166.000001,55L165.000001,55L164.000001,55L163.000001,55L162.000001,55L161.000001,55L160.000001,55L159.000001,55L158.000001,55L157.000001,55L156.000001,55L155.000001,55L154.000001,55L153.000001,55L152.000001,55L151.000001,55L150.000001,55L149.000001,55L148.000001,55L147.000001,55L146.000001,55L145.000001,55L144.000001,55L143.000001,55L142.000001,55L141.000001,55L140.000001,55L139.000001,55L138.000001,55L137.000001,55L136.000001,55L135.000001,55L134.000001,55L133.000001,55L132.000001,55L131.000001,55L130.000001,55L129.000001,55L128.000001,55L127.000001,55L126.000001,55L125.000001,55L124.000001,55L123.000001,55L122.000001,55L121.000001,55L120.000001,55L119.000001,55L118.000001,55L117.000001,55L116.000001,55L115.000001,55L114.000001,55L113.000001,55L112.000001,55L111.000001,55L110.000001,55L109.000001,55L108.000001,55L107.000001,55L106.000001,55L105.000001,55L104.000001,55L103.000001,55L102.000001,55L101.000001,55L100.000001,55L99.000001,55L98.000001,55L97.000001,55L96.000001,55L95.000001,55L94.000001,55L93.000001,55L92.000001,55L91.000001,55L90.000001,55L89.000001,55L88.000001,55L87.000001,55L86.000001,55L85.000001,55L84.000001,55L83.000001,55L82.000001,55L81.000001,55L80.000001,55L79.000001,55L78.000001,55L77.000001,55L76.000001,55L75.000001,55L74.000001,55L73.000001,55L72.000001,55L71.000001,55L70.000001,55L69.000001,55L68.000001,55L67.000001,55L66.000001,55L65.000001,55L64.000001,55L63.000001,55L62.000001,55L61.000001,55L60.000001,55L59.000001,55L58.000001,55L57.000001,55L56.000001,55L55.000001,55L54.000001,55L53.000001,55L52.000001,55L51.000001,55L50.000001,55" stroke="green" stroke-width="1" fill="none"></path></g></svg></div></div>
<p>... which will push and pull the air molecules around (now from left to right..):</p>
<img src="https://mk0waitbutwhy9c3hjku.kinstacdn.com/wp-content/uploads/2016/03/red-dot.gif"/>
<p class="css-142cd63">So, the displacement of the membrane in the speaker is directly affected by that incoming voltage level.
When the membrane moves, it pushes the air molecules back and forth, creating a sound wave that the human ear can detect.</p>
<p class="css-142cd63">If you want to read more on the basics of sound, I recommend <a target="_blank" href="https://waitbutwhy.com/2016/03/sound.html" class="css-1e6egy8">this post by waitbutwhy</a>.</p>
<h2 id="building-blocks-of-analog-synthesis" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Building Blocks of Analog Synthesis</h2>
<p class="css-142cd63">Now that we have the basic theory out of the way, let&#x27;s look at the most important building blocks of an analog synth.</p>
<h3 id="micromodules" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Micromodules</h3>
<p class="css-142cd63">As this post is a macro view on analog synthesis, I will not talk about how the electric circuits work in detail.
To start playing around with analog synthesis, I found the <a target="_blank" href="http://micromodular.pl/" class="css-1e6egy8">micromodules from Syntaxis</a> (not sponsored üôÇ).
They provide breadboard friendly components that can be linked together in multiple ways. With them, I could start to explore
how analog modules interact without needing to know the details about how to build the circuits.</p>
<h3 id="the-oscillator" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>The Oscillator</h3>
<p class="css-142cd63">As a sound source, we need at least one oscillator. At the heart of an analog oscillator, an electric circuit is creating some kind of
periodic voltage wave. Commonly, the frequency of that wave can be controlled with voltage (CV = Control Voltage).
An oscillator that can be controlled with voltage is called a VCO (= Voltage Controlled Oscillator).</p>
<p class="css-142cd63">Let&#x27;s start with a simple circuit:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-simple.png" alt="vco-simple" class="css-9whsf3"/></p>
<style data-emotion="css 1mt12s">.css-1mt12s{width:100%;border-spacing:0px;}</style><table class="css-1mt12s">
<thead>
<tr class="css-0">
<style data-emotion="css af81ef">.css-af81ef{padding:8px;font-size:18px;border-bottom:1px solid black;}</style><th class="css-af81ef">color</th>
<th class="css-af81ef">meaning</th>
</tr>
</thead>
<tbody>
<tr class="css-0">
<style data-emotion="css deana">.css-deana{padding:8px;border-bottom:1px solid black;}</style><td class="css-deana"><div style="background-color:#CB2A1D;width:25px;height:25px;border-radius:50%"></div></td>
<td class="css-deana">+12V</td>
</tr>
<tr class="css-0">
<td class="css-deana"><div style="background-color:#3E89D5;width:25px;height:25px;border-radius:50%"></div></td>
<td class="css-deana">-12V</td>
</tr>
<tr class="css-0">
<td class="css-deana"><div style="background-color:#3C3C3C;width:25px;height:25px;border-radius:50%"></div></td>
<td class="css-deana">Ground (0V)</td>
</tr>
<tr class="css-0">
<td class="css-deana"><div style="background-color:#EC612A;width:25px;height:25px;border-radius:50%"></div></td>
<td class="css-deana">5V</td>
</tr>
<tr class="css-0">
<td class="css-deana"><div style="background-color:#FFF853;width:25px;height:25px;border-radius:50%"></div></td>
<td class="css-deana">Control Voltage (CV)</td>
</tr>
<tr class="css-0">
<td class="css-deana"><div style="background-color:#5CC63D;width:25px;height:25px;border-radius:50%"></div></td>
<td class="css-deana">Analog Audio Voltage</td>
</tr>
</tbody>
</table>
<p class="css-142cd63">We will use this color coding throughout the post. This is the (much more messy) circuit in real life:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-simple-real.png" alt="vco-simple-real" class="css-9whsf3"/></p>
<h4 id="parts" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Parts</h4>
<style data-emotion="css zoser8">.css-zoser8{padding-top:8px;}</style><ul class="css-zoser8">
<style data-emotion="css 58pxoz">.css-58pxoz{font-family:'Merriweather','Georgia',serif;margin-bottom:14px;}</style><li class="css-58pxoz"><a target="_blank" href="https://syntaxis.com.pl/en/micromodules/77-uvco-3340-a.html" class="css-1e6egy8">uVCO-3340-A</a></li>
<li class="css-58pxoz"><a target="_blank" href="https://syntaxis.com.pl/en/micromodules/82-upsu-112-a.html" class="css-1e6egy8">uPSU-112-A</a> with laptop charger</li>
<li class="css-58pxoz">8ohm speaker</li>
<li class="css-58pxoz">3 potentiometers to provide CV</li>
<li class="css-58pxoz">breadboard + cables</li>
</ul>
<h4 id="power-connections" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Power Connections</h4>
<ul class="css-zoser8">
<li class="css-58pxoz">The PSU (power suplly unit) provides -12V, GND (0V), +12 and 5V.</li>
<li class="css-58pxoz">The VCO is connected to -12V, GND and 12V</li>
<li class="css-58pxoz">The potentiometers are connected to GND and 5V, outputting a voltage between 0 and 5V.</li>
</ul>
<p class="css-142cd63">Similar power connections will be used throughout the post.</p>
<h4 id="control-voltage" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Control Voltage</h4>
<p class="css-142cd63">The output of the pots is used as CV to change certain parameters of the VCO:</p>
<ul class="css-zoser8">
<li class="css-58pxoz">The coarse pot is connected to the 1/2 V/Oct input, which means it can add 5V/0.5V = 10 octaves</li>
<li class="css-58pxoz">The fine pot is connected to the 24V/Oct input, which means it can add 5V/24V = 0.2 octaves = 2.5 semitones</li>
<li class="css-58pxoz">Let&#x27;s ignore the pulse width pot for now</li>
</ul>
<h4 id="adding-a-keyboard" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Adding a Keyboard</h4>
<p class="css-142cd63">The circuit above is slightly boring, as controlling pitch with a potentiometer is not very useful when we want to play melodies.
To fix that, let&#x27;s remove all pots and add a keyboard that supports CV, like the Arturia Keystep:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-keystep-sketch.png" alt="vco-keystep real" class="css-9whsf3"/></p>
<p class="css-142cd63">In reality:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-keystep-real.png" alt="vco-keystep real" class="css-9whsf3"/></p>
<ul class="css-zoser8">
<li class="css-58pxoz">The keystep has a pitch cv output, that I connected to the 1V/Oct input of the VCO, using a 3,5mm jack (which is also grounded)</li>
<li class="css-58pxoz">I also replaced the cheap 8ohm speaker with a Bluetooth Speaker that has an AUX input.</li>
</ul>
<h4 id="ready-to-rave" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Ready to Rave?</h4>
<p class="css-142cd63">Now we are finally ready to rave (loud):</p>
<audio class="react-audio-player " controls="" id="" preload="metadata" src="./audio/vco-rave.mp3" title="./audio/vco-rave.mp3"><p>Your browser does not support the <code>audio</code> element.</p></audio>
<p class="css-142cd63">If we look at the waveform, we can see the crisp sawwave:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/sawrave.png" alt="sawrave" class="css-9whsf3"/></p>
<p class="css-142cd63">Here, we can clearly see the sawwave changing frequencies.
Also, we can make out slight wobbles in the amplitude, which is that dirty analog imperfection we want.</p>
<h3 id="the-filter" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>The Filter</h3>
<p class="css-142cd63">If you listen to the sound above, the sawwave is really harsh, which might be tamed with a <a target="_blank" href="https://syntaxis.com.pl/en/micromodules/109-uvcf-2044-lp4-a.html" class="css-1e6egy8">filter</a>:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filtered-sketch.png" alt="vco-filtered" class="css-9whsf3"/></p>
<p class="css-142cd63">In reality (with slightly exaggerated cutoff pot):</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filtered-real.png" alt="vco-filtered real" class="css-9whsf3"/></p>
<h4 id="explanation" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Explanation</h4>
<ul class="css-zoser8">
<li class="css-58pxoz">Instead of going from the VCO saw output directly to the speaker, we route it into the filter input</li>
<li class="css-58pxoz">The filter output is then plugged to the speaker</li>
<li class="css-58pxoz">The potentiometer controls the cutoff frequency of the filter</li>
<li class="css-58pxoz">A filter that can be controlled with voltage is called VCF (Voltage Controlled Filter)</li>
</ul>
<h4 id="now-the-rave-gets-better" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Now the rave gets better</h4>
<audio class="react-audio-player " controls="" id="" preload="metadata" src="./audio/vco-rave-filter.mp3" title="./audio/vco-rave-filter.mp3"><p>Your browser does not support the <code>audio</code> element.</p></audio>
<p class="css-142cd63">In the beginning of the waveform, we can see the sawwave emerging from a more sinelike shape as the filter opens:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/sawrave-filtered.png" alt="vco-sawrave filtered" class="css-9whsf3"/></p>
<h3 id="the-lfo" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>The LFO</h3>
<p class="css-142cd63">So far, I had to use my hand to manually turn the cutoff knob.
Using an LFO (= Low Frequency Oscillator), we can automate periodic CV changes:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filter-lfo-sketch.png" alt="vco filter + lfo sketch" class="css-9whsf3"/></p>
<p class="css-142cd63">In the messy real life:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filter-lfo.png" alt="vco filter + lfo" class="css-9whsf3"/></p>
<h4 id="explanation-1" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Explanation</h4>
<ul class="css-zoser8">
<li class="css-58pxoz">The LFOs triangle output is connected with the filter frequency input</li>
<li class="css-58pxoz">The right pot is connected to another filter frequency input<!-- -->
<ul class="css-zoser8">
<li class="css-58pxoz">Both frequency inputs will be summed by the filter</li>
</ul>
</li>
<li class="css-58pxoz">A left pot controls the speed of the lfo</li>
</ul>
<h4 id="hands-free-raving" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Hands free raving</h4>
<audio class="react-audio-player " controls="" id="" preload="metadata" src="./audio/vco-rave-filter-lfo.mp3" title="./audio/vco-rave-filter-lfo.mp3"><p>Your browser does not support the <code>audio</code> element.</p></audio>
<p class="css-142cd63">In the waveform, the periodic cutoff changes look like this:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/sawrave-filter-lfo.png" alt="vco-sawrave filter + lfo" class="css-9whsf3"/></p>
<h3 id="the-attenuator" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>The Attenuator</h3>
<p class="css-142cd63">So far, the LFO has a pretty big impact on our filter.
It would be nice if we could somehow control the amount of impact.. This is where the attenuator comes in.
Unlike the other modules, an attenuator is just a potentiometer with special wiring:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/attenuator.png" alt="attenuator sketch" class="css-9whsf3"/></p>
<p class="css-142cd63">Instead of wiring 5V to the right pin, we use any signal that should be attenuated.
In our case, we can use the LFO triangle output.
Using the pot, we can then scale it down to minimize its impact:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filter-lfo-attenuator-sketch.png" alt="vco-sawrave filter + lfo + attenuator sketch" class="css-9whsf3"/></p>
<p class="css-142cd63">The rats nest in real life:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filter-lfo-attenuator-real.png" alt="vco-sawrave filter + lfo + attenuator real" class="css-9whsf3"/></p>
<p class="css-142cd63">Note that I also added an attenuator for pitch. You can view the attenuator like a modulation depth control for any parameter.</p>
<h4 id="lets-rave-again" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Let&#x27;s rave again</h4>
<audio class="react-audio-player " controls="" id="" preload="metadata" src="./audio/vco-rave-filter-lfo-attenuator.mp3" title="./audio/vco-rave-filter-lfo-attenuator.mp3"><p>Your browser does not support the <code>audio</code> element.</p></audio>
<p class="css-142cd63">In the waveform, we can see the wobbles getting slightly more intense to the right:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/sawrave-filter-lfo-attenuator.png" alt="vco-sawrave filter + lfo + attenuator" class="css-9whsf3"/></p>
<h4 id="time-for-a-melody" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Time for a Melody</h4>
<p class="css-142cd63">Using the pitch modulation attenuator, we can create a spacey melody ontop (layered with a DAW):</p>
<audio class="react-audio-player " controls="" id="" preload="metadata" src="./audio/vco-rave-filter-lfo-attenuator-melody.mp3" title="./audio/vco-rave-filter-lfo-attenuator-melody.mp3"><p>Your browser does not support the <code>audio</code> element.</p></audio>
<p class="css-142cd63">(The steady beeping came from my potentiometer bouncing out of the breadboard...)</p>
<h3 id="gate-signals-and-the-amplifier" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Gate Signals and the Amplifier</h3>
<p class="css-142cd63">In our little synth, the tone keeps going on and on and on, even if we release the key on the keyboard.
This is not really practical to make music with.. To control the volume / amplitude of a signal, we can use a VCA (= Voltage Controlled Amplifier).</p>
<p class="css-142cd63">When using a keyboard, we want the sound to start when the key is pressed and stop when it is released.
Therefore, a keyboard that includes CV will commonly also have a Gate output.
By convention, the gate signal will be low (0V) when no key is pressed and high (5V) when a key is pressed.</p>
<p class="css-142cd63">Back to the circuit: To keep it simple, let&#x27;s remove the lfo and the attenuators, and add the VCA + Gate:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filter-vca.png" alt="vco, filter + vca sketch" class="css-9whsf3"/></p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filter-vca-real.png" alt="vco, filter + vca real" class="css-9whsf3"/></p>
<p class="css-142cd63">Now we can release the key and the sound will stop.</p>
<audio class="react-audio-player " controls="" id="" preload="metadata" src="./audio/vco-rave-filter-vca-melody.mp3" title="./audio/vco-rave-filter-vca-melody.mp3"><p>Your browser does not support the <code>audio</code> element.</p></audio>
<h3 id="the-adsr-envelope" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>The ADSR Envelope</h3>
<p class="css-142cd63">Using the gate to control our amplifier sounds really hard and sometimes clicky.
For softer sounds, we might want to fade the in when the key is pressed and out when it is released.
This is where the ADSR envelope comes in. ADSR stands for:</p>
<ul class="css-zoser8">
<li class="css-58pxoz">Attack: Time till the note reaches the max volume</li>
<li class="css-58pxoz">Decay: Time till the note reaches the sustain level</li>
<li class="css-58pxoz">Sustain: Final level for the sustained note</li>
<li class="css-58pxoz">Release: Time till the note is silent after the key is released</li>
</ul>
<p class="css-142cd63"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/ADSR_parameter.svg/2880px-ADSR_parameter.svg.png" alt="ADSR" class="css-9whsf3"/></p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filter-vca-envelope.png" alt="ADSR sketch" class="css-9whsf3"/></p>
<p class="css-142cd63"><img src="./img/analog-synthesis/vco-filter-vca-adsr-real.png" alt="ADSR real" class="css-9whsf3"/></p>
<p class="css-142cd63">Now we can control the ADSR curve with the 4 pots on the bottom!
As we will see soon, we can also use attenuators to modulate parameters with an envelope.</p>
<audio class="react-audio-player " controls="" id="" preload="metadata" src="./audio/vco-rave-filter-vca-adsr-melody.mp3" title="./audio/vco-rave-filter-vca-adsr-melody.mp3"><p>Your browser does not support the <code>audio</code> element.</p></audio>
<p class="css-142cd63">In the waveform, we can see the slow decay:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/sawrave-vco-filter-vca-adsr.png" alt="ADSR real" class="css-9whsf3"/></p>
<h3 id="putting-it-all-together" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Putting it all together</h3>
<p class="css-142cd63">After we examined the most important building blocks of a classic analog synthesizer, let&#x27;s combine all of them!</p>
<p class="css-142cd63">This sketch from the <a target="_blank" href="http://micromodular.pl/howto" class="css-1e6egy8">micromodular how to site</a> shows how we can arrange all the parts to a fully functional monosynth:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/bb_simplest_synthesizer.png" alt="full synth" class="css-9whsf3"/></p>
<p class="css-142cd63">Of course, I also built this thing:</p>
<p class="css-142cd63"><img src="./img/analog-synthesis/whole-synth.png" alt="full synth real" class="css-9whsf3"/></p>
<h4 id="controls" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Controls</h4>
<ul class="css-zoser8">
<li class="css-58pxoz">VCO<!-- -->
<ul class="css-zoser8">
<li class="css-58pxoz">pitch coarse</li>
<li class="css-58pxoz">pitch fine</li>
<li class="css-58pxoz">pulse width (for square wave)</li>
<li class="css-58pxoz">pitch mod ADSR attenuator</li>
<li class="css-58pxoz">pitch mod LFO attenuator</li>
</ul>
</li>
<li class="css-58pxoz">VCF<!-- -->
<ul class="css-zoser8">
<li class="css-58pxoz">cutoff</li>
<li class="css-58pxoz">resonance</li>
<li class="css-58pxoz">cutoff mod ADSR attenuator</li>
<li class="css-58pxoz">res mod LFO attenuator</li>
</ul>
</li>
<li class="css-58pxoz">VCA<!-- -->
<ul class="css-zoser8">
<li class="css-58pxoz">manual gain</li>
<li class="css-58pxoz">volume attenuator</li>
<li class="css-58pxoz">gain mod ADSR attenuator</li>
<li class="css-58pxoz">gain mod LFO attenuator</li>
</ul>
</li>
<li class="css-58pxoz">LFO<!-- -->
<ul class="css-zoser8">
<li class="css-58pxoz">rate coarse</li>
<li class="css-58pxoz">rate fine</li>
<li class="css-58pxoz">pulse width</li>
</ul>
</li>
</ul>
<h3 id="final-thoughts" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Final Thoughts</h3>
<p class="css-142cd63">Those were the most essential building blocks of an analog synthesizer.
In a future posts, I might</p>
<ul class="css-zoser8">
<li class="css-58pxoz">combine the synth with my DIY Keyboard Scanner</li>
<li class="css-58pxoz">use a multi channel DAC to output polyphonic CV</li>
<li class="css-58pxoz">build modules from scratch</li>
</ul></div></article></main><style data-emotion="css btp6j1">.css-btp6j1{box-sizing:border-box;margin:0;min-width:0;padding:32px;color:#666;text-align:center;font-size:18px;}</style><div class="css-btp6j1"><style data-emotion="css i57cvr">.css-i57cvr{box-sizing:border-box;margin:0;min-width:0;margin-left:16px;margin-right:16px;display:inline-block;}</style><span class="css-i57cvr">Created by <a href="https://github.com/felixroos" class="css-1e6egy8">Felix Roos</a></span></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"A Macro View on Analog Synthesis","date":"2021-05-14","tags":["diy","electronics","synthesis"],"description":"Lately, I've been learning about analog synthesis","image":"./img/vco.png"},"code":"var Component=(()=\u003e{var zi=Object.create;var We=Object.defineProperty;var Hi=Object.getOwnPropertyDescriptor;var Ki=Object.getOwnPropertyNames;var $i=Object.getPrototypeOf,Gi=Object.prototype.hasOwnProperty;var pn=e=\u003eWe(e,\"__esModule\",{value:!0});var Q=(e,t)=\u003e()=\u003e(t||e((t={exports:{}}).exports,t),t.exports),Xi=(e,t)=\u003e{pn(e);for(var r in t)We(e,r,{get:t[r],enumerable:!0})},Yi=(e,t,r)=\u003e{if(t\u0026\u0026typeof t==\"object\"||typeof t==\"function\")for(let n of Ki(t))!Gi.call(e,n)\u0026\u0026n!==\"default\"\u0026\u0026We(e,n,{get:()=\u003et[n],enumerable:!(r=Hi(t,n))||r.enumerable});return e},te=e=\u003eYi(pn(We(e!=null?zi($i(e)):{},\"default\",e\u0026\u0026e.__esModule\u0026\u0026\"default\"in e?{get:()=\u003ee.default,enumerable:!0}:{value:e,enumerable:!0})),e);var gn=Q((Za,mn)=\u003e{mn.exports=_jsx_runtime});var ge=Q((Ja,yn)=\u003e{yn.exports=React});var He=Q((ze,xn)=\u003e{(function(e,t){typeof ze==\"object\"\u0026\u0026typeof xn!=\"undefined\"?t(ze):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\"],t):(e=typeof globalThis!=\"undefined\"?globalThis:e||self,t(e.d3=e.d3||{}))})(ze,function(e){\"use strict\";function t(o,u){return o\u003cu?-1:o\u003eu?1:o\u003e=u?0:NaN}function r(o){let u=o,c=o;o.length===1\u0026\u0026(u=(x,w)=\u003eo(x)-w,c=n(o));function d(x,w,M,k){for(M==null\u0026\u0026(M=0),k==null\u0026\u0026(k=x.length);M\u003ck;){let j=M+k\u003e\u003e\u003e1;c(x[j],w)\u003c0?M=j+1:k=j}return M}function f(x,w,M,k){for(M==null\u0026\u0026(M=0),k==null\u0026\u0026(k=x.length);M\u003ck;){let j=M+k\u003e\u003e\u003e1;c(x[j],w)\u003e0?k=j:M=j+1}return M}function p(x,w,M,k){M==null\u0026\u0026(M=0),k==null\u0026\u0026(k=x.length);let j=d(x,w,M,k-1);return j\u003eM\u0026\u0026u(x[j-1],w)\u003e-u(x[j],w)?j-1:j}return{left:d,center:p,right:f}}function n(o){return(u,c)=\u003et(o(u),c)}function i(o){return o===null?NaN:+o}function*s(o,u){if(u===void 0)for(let c of o)c!=null\u0026\u0026(c=+c)\u003e=c\u0026\u0026(yield c);else{let c=-1;for(let d of o)(d=u(d,++c,o))!=null\u0026\u0026(d=+d)\u003e=d\u0026\u0026(yield d)}}let l=r(t),h=l.right,m=l.left,y=r(i).center;function _(o,u){let c=0;if(u===void 0)for(let d of o)d!=null\u0026\u0026(d=+d)\u003e=d\u0026\u0026++c;else{let d=-1;for(let f of o)(f=u(f,++d,o))!=null\u0026\u0026(f=+f)\u003e=f\u0026\u0026++c}return c}function g(o){return o.length|0}function v(o){return!(o\u003e0)}function b(o){return typeof o!=\"object\"||\"length\"in o?o:Array.from(o)}function P(o){return u=\u003eo(...u)}function C(...o){let u=typeof o[o.length-1]==\"function\"\u0026\u0026P(o.pop());o=o.map(b);let c=o.map(g),d=o.length-1,f=new Array(d+1).fill(0),p=[];if(d\u003c0||c.some(v))return p;for(;;){p.push(f.map((w,M)=\u003eo[M][w]));let x=d;for(;++f[x]===c[x];){if(x===0)return u?p.map(u):p;f[x--]=0}}}function T(o,u){var c=0,d=0;return Float64Array.from(o,u===void 0?f=\u003ec+=+f||0:f=\u003ec+=+u(f,d++,o)||0)}function N(o,u){return u\u003co?-1:u\u003eo?1:u\u003e=o?0:NaN}function I(o,u){let c=0,d,f=0,p=0;if(u===void 0)for(let x of o)x!=null\u0026\u0026(x=+x)\u003e=x\u0026\u0026(d=x-f,f+=d/++c,p+=d*(x-f));else{let x=-1;for(let w of o)(w=u(w,++x,o))!=null\u0026\u0026(w=+w)\u003e=w\u0026\u0026(d=w-f,f+=d/++c,p+=d*(w-f))}if(c\u003e1)return p/(c-1)}function L(o,u){let c=I(o,u);return c\u0026\u0026Math.sqrt(c)}function O(o,u){let c,d;if(u===void 0)for(let f of o)f!=null\u0026\u0026(c===void 0?f\u003e=f\u0026\u0026(c=d=f):(c\u003ef\u0026\u0026(c=f),d\u003cf\u0026\u0026(d=f)));else{let f=-1;for(let p of o)(p=u(p,++f,o))!=null\u0026\u0026(c===void 0?p\u003e=p\u0026\u0026(c=d=p):(c\u003ep\u0026\u0026(c=p),d\u003cp\u0026\u0026(d=p)))}return[c,d]}class E{constructor(){this._partials=new Float64Array(32),this._n=0}add(u){let c=this._partials,d=0;for(let f=0;f\u003cthis._n\u0026\u0026f\u003c32;f++){let p=c[f],x=u+p,w=Math.abs(u)\u003cMath.abs(p)?u-(x-p):p-(x-u);w\u0026\u0026(c[d++]=w),u=x}return c[d]=u,this._n=d+1,this}valueOf(){let u=this._partials,c=this._n,d,f,p,x=0;if(c\u003e0){for(x=u[--c];c\u003e0\u0026\u0026(d=x,f=u[--c],x=d+f,p=f-(x-d),!p););c\u003e0\u0026\u0026(p\u003c0\u0026\u0026u[c-1]\u003c0||p\u003e0\u0026\u0026u[c-1]\u003e0)\u0026\u0026(f=p*2,d=x+f,f==d-x\u0026\u0026(x=d))}return x}}function U(o,u){let c=new E;if(u===void 0)for(let d of o)(d=+d)\u0026\u0026c.add(d);else{let d=-1;for(let f of o)(f=+u(f,++d,o))\u0026\u0026c.add(f)}return+c}function q(o,u){let c=new E,d=-1;return Float64Array.from(o,u===void 0?f=\u003ec.add(+f||0):f=\u003ec.add(+u(f,++d,o)||0))}class K extends Map{constructor(u,c=F){super();if(Object.defineProperties(this,{_intern:{value:new Map},_key:{value:c}}),u!=null)for(let[d,f]of u)this.set(d,f)}get(u){return super.get(Y(this,u))}has(u){return super.has(Y(this,u))}set(u,c){return super.set(A(this,u),c)}delete(u){return super.delete(B(this,u))}}class ee extends Set{constructor(u,c=F){super();if(Object.defineProperties(this,{_intern:{value:new Map},_key:{value:c}}),u!=null)for(let d of u)this.add(d)}has(u){return super.has(Y(this,u))}add(u){return super.add(A(this,u))}delete(u){return super.delete(B(this,u))}}function Y({_intern:o,_key:u},c){let d=u(c);return o.has(d)?o.get(d):c}function A({_intern:o,_key:u},c){let d=u(c);return o.has(d)?o.get(d):(o.set(d,c),c)}function B({_intern:o,_key:u},c){let d=u(c);return o.has(d)\u0026\u0026(c=o.get(c),o.delete(d)),c}function F(o){return o!==null\u0026\u0026typeof o==\"object\"?o.valueOf():o}function G(o){return o}function Ce(o,...u){return we(o,G,G,u)}function ve(o,...u){return we(o,Array.from,G,u)}function pe(o,u,...c){return we(o,G,u,c)}function be(o,u,...c){return we(o,Array.from,u,c)}function J(o,...u){return we(o,G,tn,u)}function si(o,...u){return we(o,Array.from,tn,u)}function tn(o){if(o.length!==1)throw new Error(\"duplicate key\");return o[0]}function we(o,u,c,d){return function f(p,x){if(x\u003e=d.length)return c(p);let w=new K,M=d[x++],k=-1;for(let j of p){let S=M(j,++k,p),V=w.get(S);V?V.push(j):w.set(S,[j])}for(let[j,S]of w)w.set(j,f(S,x));return u(w)}(o,0)}function nn(o,u){return Array.from(u,c=\u003eo[c])}function ft(o,...u){if(typeof o[Symbol.iterator]!=\"function\")throw new TypeError(\"values is not iterable\");o=Array.from(o);let[c=t]=u;if(c.length===1||u.length\u003e1){let d=Uint32Array.from(o,(f,p)=\u003ep);return u.length\u003e1?(u=u.map(f=\u003eo.map(f)),d.sort((f,p)=\u003e{for(let x of u){let w=t(x[f],x[p]);if(w)return w}})):(c=o.map(c),d.sort((f,p)=\u003et(c[f],c[p]))),nn(o,d)}return o.sort(c)}function ui(o,u,c){return(u.length===1?ft(pe(o,u,c),([d,f],[p,x])=\u003et(f,x)||t(d,p)):ft(Ce(o,c),([d,f],[p,x])=\u003eu(f,x)||t(d,p))).map(([d])=\u003ed)}var ci=Array.prototype,fi=ci.slice;function Ve(o){return function(){return o}}var dt=Math.sqrt(50),ht=Math.sqrt(10),pt=Math.sqrt(2);function rn(o,u,c){var d,f=-1,p,x,w;if(u=+u,o=+o,c=+c,o===u\u0026\u0026c\u003e0)return[o];if((d=u\u003co)\u0026\u0026(p=o,o=u,u=p),(w=qe(o,u,c))===0||!isFinite(w))return[];if(w\u003e0){let M=Math.round(o/w),k=Math.round(u/w);for(M*w\u003co\u0026\u0026++M,k*w\u003eu\u0026\u0026--k,x=new Array(p=k-M+1);++f\u003cp;)x[f]=(M+f)*w}else{w=-w;let M=Math.round(o*w),k=Math.round(u*w);for(M/w\u003co\u0026\u0026++M,k/w\u003eu\u0026\u0026--k,x=new Array(p=k-M+1);++f\u003cp;)x[f]=(M+f)/w}return d\u0026\u0026x.reverse(),x}function qe(o,u,c){var d=(u-o)/Math.max(0,c),f=Math.floor(Math.log(d)/Math.LN10),p=d/Math.pow(10,f);return f\u003e=0?(p\u003e=dt?10:p\u003e=ht?5:p\u003e=pt?2:1)*Math.pow(10,f):-Math.pow(10,-f)/(p\u003e=dt?10:p\u003e=ht?5:p\u003e=pt?2:1)}function di(o,u,c){var d=Math.abs(u-o)/Math.max(0,c),f=Math.pow(10,Math.floor(Math.log(d)/Math.LN10)),p=d/f;return p\u003e=dt?f*=10:p\u003e=ht?f*=5:p\u003e=pt\u0026\u0026(f*=2),u\u003co?-f:f}function on(o,u,c){let d;for(;;){let f=qe(o,u,c);if(f===d||f===0||!isFinite(f))return[o,u];f\u003e0?(o=Math.floor(o/f)*f,u=Math.ceil(u/f)*f):f\u003c0\u0026\u0026(o=Math.ceil(o*f)/f,u=Math.floor(u*f)/f),d=f}}function an(o){return Math.ceil(Math.log(_(o))/Math.LN2)+1}function ln(){var o=G,u=O,c=an;function d(f){Array.isArray(f)||(f=Array.from(f));var p,x=f.length,w,M=new Array(x);for(p=0;p\u003cx;++p)M[p]=o(f[p],p,f);var k=u(M),j=k[0],S=k[1],V=c(M,j,S);if(!Array.isArray(V)){let Wi=S,_t=+V;if(u===O\u0026\u0026([j,S]=on(j,S,_t)),V=rn(j,S,_t),V[V.length-1]\u003e=S)if(Wi\u003e=S\u0026\u0026u===O){let me=qe(j,S,_t);isFinite(me)\u0026\u0026(me\u003e0?S=(Math.floor(S/me)+1)*me:me\u003c0\u0026\u0026(S=(Math.ceil(S*-me)+1)/-me))}else V.pop()}for(var ae=V.length;V[0]\u003c=j;)V.shift(),--ae;for(;V[ae-1]\u003eS;)V.pop(),--ae;var Oe=new Array(ae+1),yt;for(p=0;p\u003c=ae;++p)yt=Oe[p]=[],yt.x0=p\u003e0?V[p-1]:j,yt.x1=p\u003cae?V[p]:S;for(p=0;p\u003cx;++p)w=M[p],j\u003c=w\u0026\u0026w\u003c=S\u0026\u0026Oe[h(V,w,0,ae)].push(f[p]);return Oe}return d.value=function(f){return arguments.length?(o=typeof f==\"function\"?f:Ve(f),d):o},d.domain=function(f){return arguments.length?(u=typeof f==\"function\"?f:Ve([f[0],f[1]]),d):u},d.thresholds=function(f){return arguments.length?(c=typeof f==\"function\"?f:Array.isArray(f)?Ve(fi.call(f)):Ve(f),d):c},d}function mt(o,u){let c;if(u===void 0)for(let d of o)d!=null\u0026\u0026(c\u003cd||c===void 0\u0026\u0026d\u003e=d)\u0026\u0026(c=d);else{let d=-1;for(let f of o)(f=u(f,++d,o))!=null\u0026\u0026(c\u003cf||c===void 0\u0026\u0026f\u003e=f)\u0026\u0026(c=f)}return c}function Be(o,u){let c;if(u===void 0)for(let d of o)d!=null\u0026\u0026(c\u003ed||c===void 0\u0026\u0026d\u003e=d)\u0026\u0026(c=d);else{let d=-1;for(let f of o)(f=u(f,++d,o))!=null\u0026\u0026(c\u003ef||c===void 0\u0026\u0026f\u003e=f)\u0026\u0026(c=f)}return c}function gt(o,u,c=0,d=o.length-1,f=t){for(;d\u003ec;){if(d-c\u003e600){let M=d-c+1,k=u-c+1,j=Math.log(M),S=.5*Math.exp(2*j/3),V=.5*Math.sqrt(j*S*(M-S)/M)*(k-M/2\u003c0?-1:1),ae=Math.max(c,Math.floor(u-k*S/M+V)),Oe=Math.min(d,Math.floor(u+(M-k)*S/M+V));gt(o,u,ae,Oe,f)}let p=o[u],x=c,w=d;for(je(o,c,u),f(o[d],p)\u003e0\u0026\u0026je(o,c,d);x\u003cw;){for(je(o,x,w),++x,--w;f(o[x],p)\u003c0;)++x;for(;f(o[w],p)\u003e0;)--w}f(o[c],p)===0?je(o,c,w):(++w,je(o,w,d)),w\u003c=u\u0026\u0026(c=w+1),u\u003c=w\u0026\u0026(d=w-1)}return o}function je(o,u,c){let d=o[u];o[u]=o[c],o[c]=d}function Ue(o,u,c){if(o=Float64Array.from(s(o,c)),!!(d=o.length)){if((u=+u)\u003c=0||d\u003c2)return Be(o);if(u\u003e=1)return mt(o);var d,f=(d-1)*u,p=Math.floor(f),x=mt(gt(o,p).subarray(0,p+1)),w=Be(o.subarray(p+1));return x+(w-x)*(f-p)}}function hi(o,u,c=i){if(!!(d=o.length)){if((u=+u)\u003c=0||d\u003c2)return+c(o[0],0,o);if(u\u003e=1)return+c(o[d-1],d-1,o);var d,f=(d-1)*u,p=Math.floor(f),x=+c(o[p],p,o),w=+c(o[p+1],p+1,o);return x+(w-x)*(f-p)}}function pi(o,u,c){return Math.ceil((c-u)/(2*(Ue(o,.75)-Ue(o,.25))*Math.pow(_(o),-1/3)))}function mi(o,u,c){return Math.ceil((c-u)/(3.5*L(o)*Math.pow(_(o),-1/3)))}function sn(o,u){let c,d=-1,f=-1;if(u===void 0)for(let p of o)++f,p!=null\u0026\u0026(c\u003cp||c===void 0\u0026\u0026p\u003e=p)\u0026\u0026(c=p,d=f);else for(let p of o)(p=u(p,++f,o))!=null\u0026\u0026(c\u003cp||c===void 0\u0026\u0026p\u003e=p)\u0026\u0026(c=p,d=f);return d}function gi(o,u){let c=0,d=0;if(u===void 0)for(let f of o)f!=null\u0026\u0026(f=+f)\u003e=f\u0026\u0026(++c,d+=f);else{let f=-1;for(let p of o)(p=u(p,++f,o))!=null\u0026\u0026(p=+p)\u003e=p\u0026\u0026(++c,d+=p)}if(c)return d/c}function yi(o,u){return Ue(o,.5,u)}function*_i(o){for(let u of o)yield*u}function xi(o){return Array.from(_i(o))}function un(o,u){let c,d=-1,f=-1;if(u===void 0)for(let p of o)++f,p!=null\u0026\u0026(c\u003ep||c===void 0\u0026\u0026p\u003e=p)\u0026\u0026(c=p,d=f);else for(let p of o)(p=u(p,++f,o))!=null\u0026\u0026(c\u003ep||c===void 0\u0026\u0026p\u003e=p)\u0026\u0026(c=p,d=f);return d}function vi(o,u=bi){let c=[],d,f=!1;for(let p of o)f\u0026\u0026c.push(u(d,p)),d=p,f=!0;return c}function bi(o,u){return[o,u]}function wi(o,u,c){o=+o,u=+u,c=(f=arguments.length)\u003c2?(u=o,o=0,1):f\u003c3?1:+c;for(var d=-1,f=Math.max(0,Math.ceil((u-o)/c))|0,p=new Array(f);++d\u003cf;)p[d]=o+d*c;return p}function Mi(o,u=t){let c,d=!1;if(u.length===1){let f;for(let p of o){let x=u(p);(d?t(x,f)\u003c0:t(x,x)===0)\u0026\u0026(c=p,f=x,d=!0)}}else for(let f of o)(d?u(f,c)\u003c0:u(f,f)===0)\u0026\u0026(c=f,d=!0);return c}function cn(o,u=t){if(u.length===1)return un(o,u);let c,d=-1,f=-1;for(let p of o)++f,(d\u003c0?u(p,p)===0:u(p,c)\u003c0)\u0026\u0026(c=p,d=f);return d}function Ai(o,u=t){let c,d=!1;if(u.length===1){let f;for(let p of o){let x=u(p);(d?t(x,f)\u003e0:t(x,x)===0)\u0026\u0026(c=p,f=x,d=!0)}}else for(let f of o)(d?u(f,c)\u003e0:u(f,f)===0)\u0026\u0026(c=f,d=!0);return c}function Pi(o,u=t){if(u.length===1)return sn(o,u);let c,d=-1,f=-1;for(let p of o)++f,(d\u003c0?u(p,p)===0:u(p,c)\u003e0)\u0026\u0026(c=p,d=f);return d}function Ei(o,u){let c=cn(o,u);return c\u003c0?void 0:c}var ki=fn(Math.random);function fn(o){return function(c,d=0,f=c.length){let p=f-(d=+d);for(;p;){let x=o()*p--|0,w=c[p+d];c[p+d]=c[x+d],c[x+d]=w}return c}}function Ci(o,u){let c=0;if(u===void 0)for(let d of o)(d=+d)\u0026\u0026(c+=d);else{let d=-1;for(let f of o)(f=+u(f,++d,o))\u0026\u0026(c+=f)}return c}function dn(o){if(!(p=o.length))return[];for(var u=-1,c=Be(o,ji),d=new Array(c);++u\u003cc;)for(var f=-1,p,x=d[u]=new Array(p);++f\u003cp;)x[f]=o[f][u];return d}function ji(o){return o.length}function Oi(){return dn(arguments)}function Ii(o,u){if(typeof u!=\"function\")throw new TypeError(\"test is not a function\");let c=-1;for(let d of o)if(!u(d,++c,o))return!1;return!0}function Si(o,u){if(typeof u!=\"function\")throw new TypeError(\"test is not a function\");let c=-1;for(let d of o)if(u(d,++c,o))return!0;return!1}function Ti(o,u){if(typeof u!=\"function\")throw new TypeError(\"test is not a function\");let c=[],d=-1;for(let f of o)u(f,++d,o)\u0026\u0026c.push(f);return c}function Li(o,u){if(typeof o[Symbol.iterator]!=\"function\")throw new TypeError(\"values is not iterable\");if(typeof u!=\"function\")throw new TypeError(\"mapper is not a function\");return Array.from(o,(c,d)=\u003eu(c,d,o))}function Di(o,u,c){if(typeof u!=\"function\")throw new TypeError(\"reducer is not a function\");let d=o[Symbol.iterator](),f,p,x=-1;if(arguments.length\u003c3){if({done:f,value:c}=d.next(),f)return;++x}for(;{done:f,value:p}=d.next(),!f;)c=u(c,p,++x,o);return c}function Ni(o){if(typeof o[Symbol.iterator]!=\"function\")throw new TypeError(\"values is not iterable\");return Array.from(o).reverse()}function Ri(o,...u){o=new Set(o);for(let c of u)for(let d of c)o.delete(d);return o}function Fi(o,u){let c=u[Symbol.iterator](),d=new Set;for(let f of o){if(d.has(f))return!1;let p,x;for(;({value:p,done:x}=c.next())\u0026\u0026!x;){if(Object.is(f,p))return!1;d.add(p)}}return!0}function Vi(o){return o instanceof Set?o:new Set(o)}function qi(o,...u){o=new Set(o),u=u.map(Vi);e:for(let c of o)for(let d of u)if(!d.has(c)){o.delete(c);continue e}return o}function hn(o,u){let c=o[Symbol.iterator](),d=new Set;for(let f of u){if(d.has(f))continue;let p,x;for(;{value:p,done:x}=c.next();){if(x)return!1;if(d.add(p),Object.is(f,p))break}}return!0}function Bi(o,u){return hn(u,o)}function Ui(...o){let u=new Set;for(let c of o)for(let d of c)u.add(d);return u}e.Adder=E,e.InternMap=K,e.InternSet=ee,e.ascending=t,e.bin=ln,e.bisect=h,e.bisectCenter=y,e.bisectLeft=m,e.bisectRight=h,e.bisector=r,e.count=_,e.cross=C,e.cumsum=T,e.descending=N,e.deviation=L,e.difference=Ri,e.disjoint=Fi,e.every=Ii,e.extent=O,e.fcumsum=q,e.filter=Ti,e.fsum=U,e.greatest=Ai,e.greatestIndex=Pi,e.group=Ce,e.groupSort=ui,e.groups=ve,e.histogram=ln,e.index=J,e.indexes=si,e.intersection=qi,e.least=Mi,e.leastIndex=cn,e.map=Li,e.max=mt,e.maxIndex=sn,e.mean=gi,e.median=yi,e.merge=xi,e.min=Be,e.minIndex=un,e.nice=on,e.pairs=vi,e.permute=nn,e.quantile=Ue,e.quantileSorted=hi,e.quickselect=gt,e.range=wi,e.reduce=Di,e.reverse=Ni,e.rollup=pe,e.rollups=be,e.scan=Ei,e.shuffle=ki,e.shuffler=fn,e.some=Si,e.sort=ft,e.subset=Bi,e.sum=Ci,e.superset=hn,e.thresholdFreedmanDiaconis=pi,e.thresholdScott=mi,e.thresholdSturges=an,e.tickIncrement=qe,e.tickStep=di,e.ticks=rn,e.transpose=dn,e.union=Ui,e.variance=I,e.zip=Oi,Object.defineProperty(e,\"__esModule\",{value:!0})})});var zr=Q((sf,le)=\u003e{function Yt(e,t){return le.exports=Yt=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},le.exports.default=le.exports,le.exports.__esModule=!0,Yt(e,t)}le.exports=Yt;le.exports.default=le.exports,le.exports.__esModule=!0});var Hr=Q((uf,Re)=\u003e{var va=zr();function ba(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,va(e,t)}Re.exports=ba;Re.exports.default=Re.exports,Re.exports.__esModule=!0});var Kr=Q((cf,Fe)=\u003e{function wa(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s\u003cn.length;s++)i=n[s],!(t.indexOf(i)\u003e=0)\u0026\u0026(r[i]=e[i]);return r}Fe.exports=wa;Fe.exports.default=Fe.exports,Fe.exports.__esModule=!0});var $r=Q((ff,se)=\u003e{function Qt(){return se.exports=Qt=Object.assign||function(e){for(var t=1;t\u003carguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)\u0026\u0026(e[n]=r[n])}return e},se.exports.default=se.exports,se.exports.__esModule=!0,Qt.apply(this,arguments)}se.exports=Qt;se.exports.default=se.exports,se.exports.__esModule=!0});var Zr=Q(R=\u003e{\"use strict\";Object.defineProperty(R,\"__esModule\",{value:!0});function Zt(e){return e\u0026\u0026typeof e==\"object\"\u0026\u0026\"default\"in e?e.default:e}var Gr=Zt(Hr()),W=ge(),H=Zt(Kr()),de=Zt($r()),Ma=function(t){return typeof t==\"function\"},z=function(t){for(var r=t.children,n=t.render,i=Ma(r)?r:n,s=arguments.length,l=new Array(s\u003e1?s-1:0),h=1;h\u003cs;h++)l[h-1]=arguments[h];return i?i.apply(void 0,l):null},Jt=function(){},$=function(e){Gr(t,e);function t(){for(var n,i=arguments.length,s=new Array(i),l=0;l\u003ci;l++)s[l]=arguments[l];return n=e.call.apply(e,[this].concat(s))||this,n.state={value:n.props.initial},n._set=function(h,m){m===void 0\u0026\u0026(m=Jt);var y=n.props.onChange,_=y===void 0?Jt:y;n.setState(typeof h==\"function\"?function(g){return{value:h(g.value)}}:{value:h},function(){_(n.state.value),m()})},n._reset=function(h){h===void 0\u0026\u0026(h=Jt),n._set(n.props.initial,h)},n}var r=t.prototype;return r.render=function(){return z(this.props,{value:this.state.value,set:this._set,reset:this._reset})},t}(W.Component),Aa=function(t){var r=t.onChange,n=H(t,[\"onChange\"]);return W.createElement($,{initial:!1,onChange:r},function(i){var s=i.value,l=i.set;return z(n,{active:s,bind:{onMouseDown:function(){return l(!0)},onMouseUp:function(){return l(!1)}}})})},Pa=function(t){return typeof t.type==\"function\"},Xr=function(){for(var t=arguments.length,r=new Array(t),n=0;n\u003ct;n++)r[n]=arguments[n];var i=r.reverse();return function(s){function l(h,m,y){y===void 0\u0026\u0026(y=[]);var _=m[h],g=h===0,v=function(C){return g?z.apply(void 0,[s].concat(y.concat(C))):l(h-1,m,y.concat(C))},b=Pa(_)?W.cloneElement:W.createElement;return b(_,{},v)}return l(r.length-1,i)}},Ea=function(t){var r=t.components,n=H(t,[\"components\"]);return Xr.apply(void 0,r)(n)},ct=function(t){return function(r){return r+t}},ka=function(t){var r=t.initial,n=r===void 0?0:r,i=t.onChange,s=H(t,[\"initial\",\"onChange\"]);return W.createElement($,{initial:n,onChange:i},function(l){var h=l.value,m=l.set,y=l.reset;return z(s,{count:h,inc:function(){return m(ct(1))},dec:function(){return m(ct(-1))},incBy:function(g){return m(ct(g))},decBy:function(g){return m(ct(-g))},set:function(g){return m(g)},reset:y})})},Yr=function(t){return typeof t==\"object\"\u0026\u0026t},Ca=function(t){var r=t.initial,n=r===void 0?\"\":r,i=t.onChange,s=H(t,[\"initial\",\"onChange\"]);return W.createElement($,{initial:n,onChange:i},function(l){var h=l.value,m=l.set,y=l.reset;return z(s,{value:h,reset:y,set:m,bind:{value:h,onChange:function(g){Yr(g)\u0026\u0026Yr(g.target)?m(g.target.value):m(g)}}})})},ja=function(t){var r=t.onChange,n=H(t,[\"onChange\"]);return W.createElement($,{initial:!1,onChange:r},function(i){var s=i.value,l=i.set;return z(n,{focused:s,bind:{onFocus:function(){return l(!0)},onBlur:function(){return l(!1)}}})})},Oa=function(t){var r=t.onChange,n=H(t,[\"onChange\"]),i=!0;return W.createElement($,{initial:!1,onChange:r},function(s){var l=s.value,h=s.set;return z(n,{focused:l,blur:function(){l\u0026\u0026document.activeElement.blur()},bind:{tabIndex:-1,onBlur:function(){i\u0026\u0026h(!1)},onFocus:function(){h(!0)},onMouseDown:function(){i=!1},onMouseUp:function(){i=!0}}})})},Qr=function(t){return typeof t==\"object\"\u0026\u0026t},Ia=function(t){var r=t.initial,n=r===void 0?{}:r,i=t.onChange,s=H(t,[\"initial\",\"onChange\"]);return W.createElement($,{initial:de({},n),onChange:i},function(l){var h=l.value,m=l.set,y=l.reset;return z(s,{values:h,reset:y,setValues:function(g){return m(function(v){return de({},v,typeof g==\"function\"?g(v):g)})},field:function(g){var v=h[g],b=function(C){var T;return typeof C==\"function\"?m(function(N){var I;return de({},N,(I={},I[g]=C(N[g]),I))}):m(de({},h,(T={},T[g]=C,T)))};return{value:v,set:b,bind:{value:v,onChange:function(C){Qr(C)\u0026\u0026Qr(C.target)?b(C.target.value):b(C)}}}}})})},Sa=function(t){var r=t.onChange,n=H(t,[\"onChange\"]);return W.createElement($,{initial:!1,onChange:r},function(i){var s=i.value,l=i.set;return z(n,{hovered:s,bind:{onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)}}})})},Ta=function(e){Gr(t,e);function t(){for(var n,i=arguments.length,s=new Array(i),l=0;l\u003ci;l++)s[l]=arguments[l];return n=e.call.apply(e,[this].concat(s))||this,n.state={times:0},n.intervalId=void 0,n._clearIntervalIfNecessary=function(){n.intervalId\u0026\u0026(n.intervalId=clearInterval(n.intervalId))},n._setIntervalIfNecessary=function(h){Number.isFinite(h)\u0026\u0026(n._clearIntervalIfNecessary(),n.intervalId=setInterval(function(){return n.setState(function(m){return{times:m.times+1}})},h))},n.stop=function(){n._clearIntervalIfNecessary()},n.start=function(h){var m=typeof h==\"number\"?h:n.props.delay!=null?n.props.delay:1e3;n._setIntervalIfNecessary(m)},n.toggle=function(){n.intervalId?n.stop():n.start()},n}var r=t.prototype;return r.componentDidMount=function(){this.start()},r.componentDidUpdate=function(i){i.delay!==this.props.delay\u0026\u0026(this.stop(),this.start())},r.componentWillUnmount=function(){this.stop()},r.render=function(){return z(this.props,{start:this.start,stop:this.stop,toggle:this.toggle})},t}(W.Component),La=function(t){return function(){return!t.apply(void 0,arguments)}},Da=function(t){var r=t.initial,n=r===void 0?[]:r,i=t.onChange,s=H(t,[\"initial\",\"onChange\"]);return W.createElement($,{initial:n,onChange:i},function(l){var h=l.value,m=l.set,y=l.reset;return z(s,{list:h,first:function(){return h[0]},last:function(){return h[Math.max(0,h.length-1)]},set:function(g){return m(g)},push:function(){for(var g=arguments.length,v=new Array(g),b=0;b\u003cg;b++)v[b]=arguments[b];return m(function(P){return P.concat(v)})},pull:function(g){return m(function(v){return v.filter(La(g))})},sort:function(g){return m(function(v){return v.concat().sort(g)})},reset:y})})},Na=function(t){var r=t.initial,n=r===void 0?{}:r,i=t.onChange,s=H(t,[\"initial\",\"onChange\"]);return W.createElement($,{initial:de({},n),onChange:i},function(l){var h=l.value,m=l.set,y=l.reset;return z(s,{values:h,clear:function(){return m({})},reset:y,set:function(g,v){return m(function(b){var P;return de({},b,(P={},P[g]=typeof v==\"function\"?v(b[g]):v,P))})},get:function(g){return h[g]},has:function(g){return h[g]!=null},delete:function(g){return m(function(v){var b=v[g],P=H(v,[g]);return P})}})})},Ra=function(t){return t.filter(function(r,n){return t.indexOf(r)===n})},en=function(t,r){return t.indexOf(r)!==-1},Fa=function(t,r){return en(t,r)?t.filter(function(n){return n!==r}):t},Va=function(t,r){return en(t,r)?t:t.concat([r])},qa=function(t){var r=t.initial,n=r===void 0?[]:r,i=t.onChange,s=H(t,[\"initial\",\"onChange\"]);return W.createElement($,{initial:Ra(n),onChange:i},function(l){var h=l.value,m=l.set,y=l.reset;return z(s,{values:h,add:function(g){return m(function(v){return Va(v,g)})},clear:function(){return m([])},remove:function(g){return m(function(v){return Fa(v,g)})},has:function(g){return en(h,g)},reset:y})})},Ba=function(t){var r=t.initial,n=r===void 0?{}:r,i=t.onChange,s=H(t,[\"initial\",\"onChange\"]);return W.createElement($,{initial:n,onChange:i},function(l){var h=l.value,m=l.set,y=l.reset;return z(s,{state:h,setState:function(g,v){return m(function(b){return de({},b,typeof g==\"function\"?g(b):g)},v)},resetState:y})})},Ua=function(t){var r=t.initial,n=r===void 0?!1:r,i=t.onChange,s=H(t,[\"initial\",\"onChange\"]);return W.createElement($,{initial:n,onChange:i},function(l){var h=l.value,m=l.set,y=l.reset;return z(s,{on:h,set:function(g){return m(g)},reset:y,toggle:function(){return m(function(g){return!g})},setOn:function(){return m(!0)},setOff:function(){return m(!1)}})})},Wa=function(t){var r=t.onChange,n=H(t,[\"onChange\"]);return W.createElement($,{initial:!1,onChange:r},function(i){var s=i.value,l=i.set;return z(n,{touched:s,bind:{onTouchStart:function(){return l(!0)},onTouchEnd:function(){return l(!1)}}})})},za=function(){for(var t=arguments.length,r=new Array(t),n=0;n\u003ct;n++)r[n]=arguments[n];return r.reverse().reduce(function(i,s){var l={},h=function(_){l[_]=i[_]?function(){s[_].apply(s,arguments),i[_].apply(i,arguments)}:s[_]};for(var m in s)h(m);return de({},i,l)})};R.Active=Aa;R.Compose=Ea;R.Counter=ka;R.Field=Ca;R.Focus=ja;R.unstable_FocusManager=Oa;R.Form=Ia;R.Hover=Sa;R.Interval=Ta;R.List=Da;R.Map=Na;R.Set=qa;R.State=Ba;R.Toggle=Ua;R.Touch=Wa;R.Value=$;R.compose=Xr;R.composeEvents=za;R.renderProps=z});var ei=Q((hf,Jr)=\u003e{\"use strict\";var Ha=\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\";Jr.exports=Ha});var ii=Q((pf,ri)=\u003e{\"use strict\";var Ka=ei();function ti(){}function ni(){}ni.resetWarningCache=ti;ri.exports=function(){function e(n,i,s,l,h,m){if(m!==Ka){var y=new Error(\"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types\");throw y.name=\"Invariant Violation\",y}}e.isRequired=e;function t(){return e}var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:ni,resetWarningCache:ti};return r.PropTypes=r,r}});var ai=Q((yf,oi)=\u003e{oi.exports=ii()();var mf,gf});var li=Q((exports,module)=\u003e{module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(n,i,s){r.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:s})},r.r=function(n){typeof Symbol!=\"undefined\"\u0026\u0026Symbol.toStringTag\u0026\u0026Object.defineProperty(n,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(n,\"__esModule\",{value:!0})},r.t=function(n,i){if(1\u0026i\u0026\u0026(n=r(n)),8\u0026i||4\u0026i\u0026\u0026typeof n==\"object\"\u0026\u0026n\u0026\u0026n.__esModule)return n;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,\"default\",{enumerable:!0,value:n}),2\u0026i\u0026\u0026typeof n!=\"string\")for(var l in n)r.d(s,l,function(h){return n[h]}.bind(null,l));return s},r.n=function(n){var i=n\u0026\u0026n.__esModule?function(){return n.default}:function(){return n};return r.d(i,\"a\",i),i},r.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},r.p=\"\",r(r.s=2)}([function(e,t){e.exports=ai()},function(e,t){e.exports=ge()},function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),enterModule;function _typeof(e){return(_typeof=typeof Symbol==\"function\"\u0026\u0026typeof Symbol.iterator==\"symbol\"?function(t){return typeof t}:function(t){return t\u0026\u0026typeof Symbol==\"function\"\u0026\u0026t.constructor===Symbol\u0026\u0026t!==Symbol.prototype?\"symbol\":typeof t})(e)}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t\u003carguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)\u0026\u0026(e[n]=r[n])}return e}).apply(this,arguments)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function _defineProperties(e,t){for(var r=0;r\u003ct.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n\u0026\u0026(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t\u0026\u0026_defineProperties(e.prototype,t),r\u0026\u0026_defineProperties(e,r),e}function _inherits(e,t){if(typeof t!=\"function\"\u0026\u0026t!==null)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t\u0026\u0026t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t\u0026\u0026_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r})(e,t)}function _createSuper(e){return function(){var t,r=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var n=_getPrototypeOf(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||_typeof(t)!==\"object\"\u0026\u0026typeof t!=\"function\"?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(e===void 0)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function _isNativeReflectConstruct(){if(typeof Reflect==\"undefined\"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy==\"function\")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}enterModule=typeof reactHotLoaderGlobal!=\"undefined\"?reactHotLoaderGlobal.enterModule:void 0,enterModule\u0026\u0026enterModule(module);var __signature__=typeof reactHotLoaderGlobal!=\"undefined\"?reactHotLoaderGlobal.default.signature:function(e){return e},ReactAudioPlayer=function(_Component){_inherits(ReactAudioPlayer,_Component);var _super=_createSuper(ReactAudioPlayer);function ReactAudioPlayer(){var e;_classCallCheck(this,ReactAudioPlayer);for(var t=arguments.length,r=new Array(t),n=0;n\u003ct;n++)r[n]=arguments[n];return _defineProperty(_assertThisInitialized(e=_super.call.apply(_super,[this].concat(r))),\"audioEl\",react__WEBPACK_IMPORTED_MODULE_0___default.a.createRef()),_defineProperty(_assertThisInitialized(e),\"listenTracker\",void 0),_defineProperty(_assertThisInitialized(e),\"onError\",function(i){var s,l;return(s=(l=e.props).onError)===null||s===void 0?void 0:s.call(l,i)}),_defineProperty(_assertThisInitialized(e),\"onCanPlay\",function(i){var s,l;return(s=(l=e.props).onCanPlay)===null||s===void 0?void 0:s.call(l,i)}),_defineProperty(_assertThisInitialized(e),\"onCanPlayThrough\",function(i){var s,l;return(s=(l=e.props).onCanPlayThrough)===null||s===void 0?void 0:s.call(l,i)}),_defineProperty(_assertThisInitialized(e),\"onPlay\",function(i){var s,l;e.setListenTrack(),(s=(l=e.props).onPlay)===null||s===void 0||s.call(l,i)}),_defineProperty(_assertThisInitialized(e),\"onAbort\",function(i){var s,l;e.clearListenTrack(),(s=(l=e.props).onAbort)===null||s===void 0||s.call(l,i)}),_defineProperty(_assertThisInitialized(e),\"onEnded\",function(i){var s,l;e.clearListenTrack(),(s=(l=e.props).onEnded)===null||s===void 0||s.call(l,i)}),_defineProperty(_assertThisInitialized(e),\"onPause\",function(i){var s,l;e.clearListenTrack(),(s=(l=e.props).onPause)===null||s===void 0||s.call(l,i)}),_defineProperty(_assertThisInitialized(e),\"onSeeked\",function(i){var s,l;(s=(l=e.props).onSeeked)===null||s===void 0||s.call(l,i)}),_defineProperty(_assertThisInitialized(e),\"onLoadedMetadata\",function(i){var s,l;(s=(l=e.props).onLoadedMetadata)===null||s===void 0||s.call(l,i)}),_defineProperty(_assertThisInitialized(e),\"onVolumeChanged\",function(i){var s,l;(s=(l=e.props).onVolumeChanged)===null||s===void 0||s.call(l,i)}),e}return _createClass(ReactAudioPlayer,[{key:\"componentDidMount\",value:function(){var e=this.audioEl.current;e\u0026\u0026(this.updateVolume(this.props.volume),e.addEventListener(\"error\",this.onError),e.addEventListener(\"canplay\",this.onCanPlay),e.addEventListener(\"canplaythrough\",this.onCanPlayThrough),e.addEventListener(\"play\",this.onPlay),e.addEventListener(\"abort\",this.onAbort),e.addEventListener(\"ended\",this.onEnded),e.addEventListener(\"pause\",this.onPause),e.addEventListener(\"seeked\",this.onSeeked),e.addEventListener(\"loadedmetadata\",this.onLoadedMetadata),e.addEventListener(\"volumechange\",this.onVolumeChanged))}},{key:\"componentWillUnmount\",value:function(){var e=this.audioEl.current;e\u0026\u0026(e.removeEventListener(\"error\",this.onError),e.removeEventListener(\"canplay\",this.onCanPlay),e.removeEventListener(\"canplaythrough\",this.onCanPlayThrough),e.removeEventListener(\"play\",this.onPlay),e.removeEventListener(\"abort\",this.onAbort),e.removeEventListener(\"ended\",this.onEnded),e.removeEventListener(\"pause\",this.onPause),e.removeEventListener(\"seeked\",this.onSeeked),e.removeEventListener(\"loadedmetadata\",this.onLoadedMetadata),e.removeEventListener(\"volumechange\",this.onVolumeChanged))}},{key:\"componentDidUpdate\",value:function(e){this.updateVolume(this.props.volume)}},{key:\"setListenTrack\",value:function(){var e=this;if(!this.listenTracker){var t=this.props.listenInterval;this.listenTracker=window.setInterval(function(){var r,n;e.audioEl.current\u0026\u0026((r=(n=e.props).onListen)===null||r===void 0||r.call(n,e.audioEl.current.currentTime))},t)}}},{key:\"updateVolume\",value:function(e){var t=this.audioEl.current;t!==null\u0026\u0026typeof e==\"number\"\u0026\u0026e!==(t==null?void 0:t.volume)\u0026\u0026(t.volume=e)}},{key:\"clearListenTrack\",value:function(){this.listenTracker\u0026\u0026(clearInterval(this.listenTracker),delete this.listenTracker)}},{key:\"render\",value:function(){var e=this.props.children||react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"p\",null,\"Your browser does not support the \",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"code\",null,\"audio\"),\" element.\"),t=this.props.controls!==!1,r=this.props.title?this.props.title:this.props.src,n={};return this.props.controlsList\u0026\u0026(n.controlsList=this.props.controlsList),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"audio\",_extends({autoPlay:this.props.autoPlay,className:\"react-audio-player \".concat(this.props.className),controls:t,crossOrigin:this.props.crossOrigin,id:this.props.id,loop:this.props.loop,muted:this.props.muted,preload:this.props.preload,ref:this.audioEl,src:this.props.src,style:this.props.style,title:r},n),e)}},{key:\"__reactstandin__regenerateByEval\",value:function(key,code){this[key]=eval(code)}}]),ReactAudioPlayer}(react__WEBPACK_IMPORTED_MODULE_0__.Component);_defineProperty(ReactAudioPlayer,\"propTypes\",void 0),_defineProperty(ReactAudioPlayer,\"defaultProps\",void 0),ReactAudioPlayer.defaultProps={autoPlay:!1,children:null,className:\"\",controls:!1,controlsList:\"\",id:\"\",listenInterval:1e4,loop:!1,muted:!1,onAbort:function(){},onCanPlay:function(){},onCanPlayThrough:function(){},onEnded:function(){},onError:function(){},onListen:function(){},onPause:function(){},onPlay:function(){},onSeeked:function(){},onVolumeChanged:function(){},onLoadedMetadata:function(){},preload:\"metadata\",style:{},title:\"\",volume:1},ReactAudioPlayer.propTypes={autoPlay:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.bool,children:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.element,className:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,controls:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.bool,controlsList:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,crossOrigin:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,id:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,listenInterval:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.number,loop:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.bool,muted:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.bool,onAbort:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onCanPlay:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onCanPlayThrough:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onEnded:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onError:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onListen:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onLoadedMetadata:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onPause:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onPlay:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onSeeked:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,onVolumeChanged:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func,preload:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.oneOf([\"\",\"none\",\"metadata\",\"auto\"]),src:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,style:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.objectOf(prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string),title:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,volume:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.number};var _default=ReactAudioPlayer,reactHotLoader,leaveModule;__webpack_exports__.default=_default,reactHotLoader=typeof reactHotLoaderGlobal!=\"undefined\"?reactHotLoaderGlobal.default:void 0,reactHotLoader\u0026\u0026(reactHotLoader.register(ReactAudioPlayer,\"ReactAudioPlayer\",\"/home/justin/Projects/react-audio-player/src/index.tsx\"),reactHotLoader.register(_default,\"default\",\"/home/justin/Projects/react-audio-player/src/index.tsx\")),leaveModule=typeof reactHotLoaderGlobal!=\"undefined\"?reactHotLoaderGlobal.leaveModule:void 0,leaveModule\u0026\u0026leaveModule(module)}.call(this,__webpack_require__(3)(module))},function(e,t){e.exports=function(r){if(!r.webpackPolyfill){var n=Object.create(r);n.children||(n.children=[]),Object.defineProperty(n,\"loaded\",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,\"id\",{enumerable:!0,get:function(){return n.i}}),Object.defineProperty(n,\"exports\",{enumerable:!0}),n.webpackPolyfill=1}return n}}])});var Ya={};Xi(Ya,{default:()=\u003eXa,frontmatter:()=\u003e$a});var a=te(gn());var _n=te(ge());function ye({color:e,size:t}){return t=t||25,_n.default.createElement(\"div\",{style:{backgroundColor:e,width:t,height:t,borderRadius:\"50%\"}})}var Z=te(ge());function vn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}var et=te(He());var qn=te(He());function Ke(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function xt(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Ie(){}var Se=.7,$e=1/Se,Me=\"\\\\s*([+-]?\\\\d+)\\\\s*\",Te=\"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",ne=\"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",Qi=/^#([0-9a-f]{3,8})$/,Zi=new RegExp(\"^rgb\\\\(\"+[Me,Me,Me]+\"\\\\)$\"),Ji=new RegExp(\"^rgb\\\\(\"+[ne,ne,ne]+\"\\\\)$\"),eo=new RegExp(\"^rgba\\\\(\"+[Me,Me,Me,Te]+\"\\\\)$\"),to=new RegExp(\"^rgba\\\\(\"+[ne,ne,ne,Te]+\"\\\\)$\"),no=new RegExp(\"^hsl\\\\(\"+[Te,ne,ne]+\"\\\\)$\"),ro=new RegExp(\"^hsla\\\\(\"+[Te,ne,ne,Te]+\"\\\\)$\"),bn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ke(Ie,ue,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:wn,formatHex:wn,formatHsl:io,formatRgb:Mn,toString:Mn});function wn(){return this.rgb().formatHex()}function io(){return Cn(this).formatHsl()}function Mn(){return this.rgb().formatRgb()}function ue(e){var t,r;return e=(e+\"\").trim().toLowerCase(),(t=Qi.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?An(t):r===3?new X(t\u003e\u003e8\u002615|t\u003e\u003e4\u0026240,t\u003e\u003e4\u002615|t\u0026240,(t\u002615)\u003c\u003c4|t\u002615,1):r===8?Ge(t\u003e\u003e24\u0026255,t\u003e\u003e16\u0026255,t\u003e\u003e8\u0026255,(t\u0026255)/255):r===4?Ge(t\u003e\u003e12\u002615|t\u003e\u003e8\u0026240,t\u003e\u003e8\u002615|t\u003e\u003e4\u0026240,t\u003e\u003e4\u002615|t\u0026240,((t\u002615)\u003c\u003c4|t\u002615)/255):null):(t=Zi.exec(e))?new X(t[1],t[2],t[3],1):(t=Ji.exec(e))?new X(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=eo.exec(e))?Ge(t[1],t[2],t[3],t[4]):(t=to.exec(e))?Ge(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=no.exec(e))?kn(t[1],t[2]/100,t[3]/100,1):(t=ro.exec(e))?kn(t[1],t[2]/100,t[3]/100,t[4]):bn.hasOwnProperty(e)?An(bn[e]):e===\"transparent\"?new X(NaN,NaN,NaN,0):null}function An(e){return new X(e\u003e\u003e16\u0026255,e\u003e\u003e8\u0026255,e\u0026255,1)}function Ge(e,t,r,n){return n\u003c=0\u0026\u0026(e=t=r=NaN),new X(e,t,r,n)}function oo(e){return e instanceof Ie||(e=ue(e)),e?(e=e.rgb(),new X(e.r,e.g,e.b,e.opacity)):new X}function Ae(e,t,r,n){return arguments.length===1?oo(e):new X(e,t,r,n??1)}function X(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Ke(X,Ae,xt(Ie,{brighter:function(e){return e=e==null?$e:Math.pow($e,e),new X(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Se:Math.pow(Se,e),new X(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5\u003c=this.r\u0026\u0026this.r\u003c255.5\u0026\u0026-.5\u003c=this.g\u0026\u0026this.g\u003c255.5\u0026\u0026-.5\u003c=this.b\u0026\u0026this.b\u003c255.5\u0026\u00260\u003c=this.opacity\u0026\u0026this.opacity\u003c=1},hex:Pn,formatHex:Pn,formatRgb:En,toString:En}));function Pn(){return\"#\"+vt(this.r)+vt(this.g)+vt(this.b)}function En(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?\"rgb(\":\"rgba(\")+Math.max(0,Math.min(255,Math.round(this.r)||0))+\", \"+Math.max(0,Math.min(255,Math.round(this.g)||0))+\", \"+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?\")\":\", \"+e+\")\")}function vt(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e\u003c16?\"0\":\"\")+e.toString(16)}function kn(e,t,r,n){return n\u003c=0?e=t=r=NaN:r\u003c=0||r\u003e=1?e=t=NaN:t\u003c=0\u0026\u0026(e=NaN),new re(e,t,r,n)}function Cn(e){if(e instanceof re)return new re(e.h,e.s,e.l,e.opacity);if(e instanceof Ie||(e=ue(e)),!e)return new re;if(e instanceof re)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),l=NaN,h=s-i,m=(s+i)/2;return h?(t===s?l=(r-n)/h+(r\u003cn)*6:r===s?l=(n-t)/h+2:l=(t-r)/h+4,h/=m\u003c.5?s+i:2-s-i,l*=60):h=m\u003e0\u0026\u0026m\u003c1?0:l,new re(l,h,m,e.opacity)}function jn(e,t,r,n){return arguments.length===1?Cn(e):new re(e,t,r,n??1)}function re(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Ke(re,jn,xt(Ie,{brighter:function(e){return e=e==null?$e:Math.pow($e,e),new re(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Se:Math.pow(Se,e),new re(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h\u003c0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r\u003c.5?r:1-r)*t,i=2*r-n;return new X(bt(e\u003e=240?e-240:e+120,i,n),bt(e,i,n),bt(e\u003c120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0\u003c=this.s\u0026\u0026this.s\u003c=1||isNaN(this.s))\u0026\u00260\u003c=this.l\u0026\u0026this.l\u003c=1\u0026\u00260\u003c=this.opacity\u0026\u0026this.opacity\u003c=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?\"hsl(\":\"hsla(\")+(this.h||0)+\", \"+(this.s||0)*100+\"%, \"+(this.l||0)*100+\"%\"+(e===1?\")\":\", \"+e+\")\")}}));function bt(e,t,r){return(e\u003c60?t+(r-t)*e/60:e\u003c180?r:e\u003c240?t+(r-t)*(240-e)/60:t)*255}function wt(e,t,r,n,i){var s=e*e,l=s*e;return((1-3*e+3*s-l)*t+(4-6*s+3*l)*r+(1+3*e+3*s-3*l)*n+l*i)/6}function On(e){var t=e.length-1;return function(r){var n=r\u003c=0?r=0:r\u003e=1?(r=1,t-1):Math.floor(r*t),i=e[n],s=e[n+1],l=n\u003e0?e[n-1]:2*i-s,h=n\u003ct-1?e[n+2]:2*s-i;return wt((r-n/t)*t,l,i,s,h)}}function In(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)\u003c0?++r:r)*t),i=e[(n+t-1)%t],s=e[n%t],l=e[(n+1)%t],h=e[(n+2)%t];return wt((r-n/t)*t,i,s,l,h)}}var Le=e=\u003e()=\u003ee;function ao(e,t){return function(r){return e+r*t}}function lo(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Sn(e){return(e=+e)==1?Xe:function(t,r){return r-t?lo(t,r,e):Le(isNaN(t)?r:t)}}function Xe(e,t){var r=t-e;return r?ao(e,r):Le(isNaN(e)?t:e)}var Mt=function e(t){var r=Sn(t);function n(i,s){var l=r((i=Ae(i)).r,(s=Ae(s)).r),h=r(i.g,s.g),m=r(i.b,s.b),y=Xe(i.opacity,s.opacity);return function(_){return i.r=l(_),i.g=h(_),i.b=m(_),i.opacity=y(_),i+\"\"}}return n.gamma=e,n}(1);function Tn(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),s=new Array(r),l,h;for(l=0;l\u003cr;++l)h=Ae(t[l]),n[l]=h.r||0,i[l]=h.g||0,s[l]=h.b||0;return n=e(n),i=e(i),s=e(s),h.opacity=1,function(m){return h.r=n(m),h.g=i(m),h.b=s(m),h+\"\"}}}var yl=Tn(On),_l=Tn(In);function Ln(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(s){for(i=0;i\u003cr;++i)n[i]=e[i]*(1-s)+t[i]*s;return n}}function Dn(e){return ArrayBuffer.isView(e)\u0026\u0026!(e instanceof DataView)}function Nn(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),s=new Array(r),l;for(l=0;l\u003cn;++l)i[l]=_e(e[l],t[l]);for(;l\u003cr;++l)s[l]=t[l];return function(h){for(l=0;l\u003cn;++l)s[l]=i[l](h);return s}}function Rn(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function ce(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Fn(e,t){var r={},n={},i;(e===null||typeof e!=\"object\")\u0026\u0026(e={}),(t===null||typeof t!=\"object\")\u0026\u0026(t={});for(i in t)i in e?r[i]=_e(e[i],t[i]):n[i]=t[i];return function(s){for(i in r)n[i]=r[i](s);return n}}var At=/[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,Pt=new RegExp(At.source,\"g\");function so(e){return function(){return e}}function uo(e){return function(t){return e(t)+\"\"}}function Vn(e,t){var r=At.lastIndex=Pt.lastIndex=0,n,i,s,l=-1,h=[],m=[];for(e=e+\"\",t=t+\"\";(n=At.exec(e))\u0026\u0026(i=Pt.exec(t));)(s=i.index)\u003er\u0026\u0026(s=t.slice(r,s),h[l]?h[l]+=s:h[++l]=s),(n=n[0])===(i=i[0])?h[l]?h[l]+=i:h[++l]=i:(h[++l]=null,m.push({i:l,x:ce(n,i)})),r=Pt.lastIndex;return r\u003ct.length\u0026\u0026(s=t.slice(r),h[l]?h[l]+=s:h[++l]=s),h.length\u003c2?m[0]?uo(m[0].x):so(t):(t=m.length,function(y){for(var _=0,g;_\u003ct;++_)h[(g=m[_]).i]=g.x(y);return h.join(\"\")})}function _e(e,t){var r=typeof t,n;return t==null||r===\"boolean\"?Le(t):(r===\"number\"?ce:r===\"string\"?(n=ue(t))?(t=n,Mt):Vn:t instanceof ue?Mt:t instanceof Date?Rn:Dn(t)?Ln:Array.isArray(t)?Nn:typeof t.valueOf!=\"function\"\u0026\u0026typeof t.toString!=\"function\"||isNaN(t)?Fn:ce)(e,t)}function Et(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function kt(e){return function(){return e}}function Ct(e){return+e}var Bn=[0,1];function Pe(e){return e}function jt(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:kt(isNaN(t)?NaN:.5)}function co(e,t){var r;return e\u003et\u0026\u0026(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function fo(e,t,r){var n=e[0],i=e[1],s=t[0],l=t[1];return i\u003cn?(n=jt(i,n),s=r(l,s)):(n=jt(n,i),s=r(s,l)),function(h){return s(n(h))}}function ho(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),s=new Array(n),l=-1;for(e[n]\u003ce[0]\u0026\u0026(e=e.slice().reverse(),t=t.slice().reverse());++l\u003cn;)i[l]=jt(e[l],e[l+1]),s[l]=r(t[l],t[l+1]);return function(h){var m=(0,qn.bisect)(e,h,1,n)-1;return s[m](i[m](h))}}function Un(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function po(){var e=Bn,t=Bn,r=_e,n,i,s,l=Pe,h,m,y;function _(){var v=Math.min(e.length,t.length);return l!==Pe\u0026\u0026(l=co(e[0],e[v-1])),h=v\u003e2?ho:fo,m=y=null,g}function g(v){return v==null||isNaN(v=+v)?s:(m||(m=h(e.map(n),t,r)))(n(l(v)))}return g.invert=function(v){return l(i((y||(y=h(t,e.map(n),ce)))(v)))},g.domain=function(v){return arguments.length?(e=Array.from(v,Ct),_()):e.slice()},g.range=function(v){return arguments.length?(t=Array.from(v),_()):t.slice()},g.rangeRound=function(v){return t=Array.from(v),r=Et,_()},g.clamp=function(v){return arguments.length?(l=v?!0:Pe,_()):l!==Pe},g.interpolate=function(v){return arguments.length?(r=v,_()):r},g.unknown=function(v){return arguments.length?(s=v,g):s},function(v,b){return n=v,i=b,_()}}function Ot(){return po()(Pe,Pe)}var Qn=te(He());function Wn(e){return Math.abs(e=Math.round(e))\u003e=1e21?e.toLocaleString(\"en\").replace(/,/g,\"\"):e.toString(10)}function xe(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf(\"e\"))\u003c0)return null;var r,n=e.slice(0,r);return[n.length\u003e1?n[0]+n.slice(2):n,+e.slice(r+1)]}function ie(e){return e=xe(Math.abs(e)),e?e[1]:NaN}function zn(e,t){return function(r,n){for(var i=r.length,s=[],l=0,h=e[0],m=0;i\u003e0\u0026\u0026h\u003e0\u0026\u0026(m+h+1\u003en\u0026\u0026(h=Math.max(1,n-m)),s.push(r.substring(i-=h,i+h)),!((m+=h+1)\u003en));)h=e[l=(l+1)%e.length];return s.reverse().join(t)}}function Hn(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var mo=/^(?:(.)?([\u003c\u003e=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;function fe(e){if(!(t=mo.exec(e)))throw new Error(\"invalid format: \"+e);var t;return new Ye({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]\u0026\u0026t[8].slice(1),trim:t[9],type:t[10]})}fe.prototype=Ye.prototype;function Ye(e){this.fill=e.fill===void 0?\" \":e.fill+\"\",this.align=e.align===void 0?\"\u003e\":e.align+\"\",this.sign=e.sign===void 0?\"-\":e.sign+\"\",this.symbol=e.symbol===void 0?\"\":e.symbol+\"\",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?\"\":e.type+\"\"}Ye.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?\"0\":\"\")+(this.width===void 0?\"\":Math.max(1,this.width|0))+(this.comma?\",\":\"\")+(this.precision===void 0?\"\":\".\"+Math.max(0,this.precision|0))+(this.trim?\"~\":\"\")+this.type};function Kn(e){e:for(var t=e.length,r=1,n=-1,i;r\u003ct;++r)switch(e[r]){case\".\":n=i=r;break;case\"0\":n===0\u0026\u0026(n=r),i=r;break;default:if(!+e[r])break e;n\u003e0\u0026\u0026(n=0);break}return n\u003e0?e.slice(0,n)+e.slice(i+1):e}var It;function $n(e,t){var r=xe(e,t);if(!r)return e+\"\";var n=r[0],i=r[1],s=i-(It=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=n.length;return s===l?n:s\u003el?n+new Array(s-l+1).join(\"0\"):s\u003e0?n.slice(0,s)+\".\"+n.slice(s):\"0.\"+new Array(1-s).join(\"0\")+xe(e,Math.max(0,t+s-1))[0]}function St(e,t){var r=xe(e,t);if(!r)return e+\"\";var n=r[0],i=r[1];return i\u003c0?\"0.\"+new Array(-i).join(\"0\")+n:n.length\u003ei+1?n.slice(0,i+1)+\".\"+n.slice(i+1):n+new Array(i-n.length+2).join(\"0\")}var Tt={\"%\":(e,t)=\u003e(e*100).toFixed(t),b:e=\u003eMath.round(e).toString(2),c:e=\u003ee+\"\",d:Wn,e:(e,t)=\u003ee.toExponential(t),f:(e,t)=\u003ee.toFixed(t),g:(e,t)=\u003ee.toPrecision(t),o:e=\u003eMath.round(e).toString(8),p:(e,t)=\u003eSt(e*100,t),r:St,s:$n,X:e=\u003eMath.round(e).toString(16).toUpperCase(),x:e=\u003eMath.round(e).toString(16)};function Lt(e){return e}var Gn=Array.prototype.map,Xn=[\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"\\xB5\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];function Yn(e){var t=e.grouping===void 0||e.thousands===void 0?Lt:zn(Gn.call(e.grouping,Number),e.thousands+\"\"),r=e.currency===void 0?\"\":e.currency[0]+\"\",n=e.currency===void 0?\"\":e.currency[1]+\"\",i=e.decimal===void 0?\".\":e.decimal+\"\",s=e.numerals===void 0?Lt:Hn(Gn.call(e.numerals,String)),l=e.percent===void 0?\"%\":e.percent+\"\",h=e.minus===void 0?\"\\u2212\":e.minus+\"\",m=e.nan===void 0?\"NaN\":e.nan+\"\";function y(g){g=fe(g);var v=g.fill,b=g.align,P=g.sign,C=g.symbol,T=g.zero,N=g.width,I=g.comma,L=g.precision,O=g.trim,E=g.type;E===\"n\"?(I=!0,E=\"g\"):Tt[E]||(L===void 0\u0026\u0026(L=12),O=!0,E=\"g\"),(T||v===\"0\"\u0026\u0026b===\"=\")\u0026\u0026(T=!0,v=\"0\",b=\"=\");var U=C===\"$\"?r:C===\"#\"\u0026\u0026/[boxX]/.test(E)?\"0\"+E.toLowerCase():\"\",q=C===\"$\"?n:/[%p]/.test(E)?l:\"\",K=Tt[E],ee=/[defgprs%]/.test(E);L=L===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,L)):Math.max(0,Math.min(20,L));function Y(A){var B=U,F=q,G,Ce,ve;if(E===\"c\")F=K(A)+F,A=\"\";else{A=+A;var pe=A\u003c0||1/A\u003c0;if(A=isNaN(A)?m:K(Math.abs(A),L),O\u0026\u0026(A=Kn(A)),pe\u0026\u0026+A==0\u0026\u0026P!==\"+\"\u0026\u0026(pe=!1),B=(pe?P===\"(\"?P:h:P===\"-\"||P===\"(\"?\"\":P)+B,F=(E===\"s\"?Xn[8+It/3]:\"\")+F+(pe\u0026\u0026P===\"(\"?\")\":\"\"),ee){for(G=-1,Ce=A.length;++G\u003cCe;)if(ve=A.charCodeAt(G),48\u003eve||ve\u003e57){F=(ve===46?i+A.slice(G+1):A.slice(G))+F,A=A.slice(0,G);break}}}I\u0026\u0026!T\u0026\u0026(A=t(A,1/0));var be=B.length+A.length+F.length,J=be\u003cN?new Array(N-be+1).join(v):\"\";switch(I\u0026\u0026T\u0026\u0026(A=t(J+A,J.length?N-F.length:1/0),J=\"\"),b){case\"\u003c\":A=B+A+F+J;break;case\"=\":A=B+J+A+F;break;case\"^\":A=J.slice(0,be=J.length\u003e\u003e1)+B+A+F+J.slice(be);break;default:A=J+B+A+F;break}return s(A)}return Y.toString=function(){return g+\"\"},Y}function _(g,v){var b=y((g=fe(g),g.type=\"f\",g)),P=Math.max(-8,Math.min(8,Math.floor(ie(v)/3)))*3,C=Math.pow(10,-P),T=Xn[8+P/3];return function(N){return b(C*N)+T}}return{format:y,formatPrefix:_}}var Qe,Ze,Je;Dt({thousands:\",\",grouping:[3],currency:[\"$\",\"\"]});function Dt(e){return Qe=Yn(e),Ze=Qe.format,Je=Qe.formatPrefix,Qe}function Nt(e){return Math.max(0,-ie(Math.abs(e)))}function Rt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ie(t)/3)))*3-ie(Math.abs(e)))}function Ft(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ie(t)-ie(e))+1}function Vt(e,t,r,n){var i=(0,Qn.tickStep)(e,t,r),s;switch(n=fe(n??\",f\"),n.type){case\"s\":{var l=Math.max(Math.abs(e),Math.abs(t));return n.precision==null\u0026\u0026!isNaN(s=Rt(i,l))\u0026\u0026(n.precision=s),Je(n,l)}case\"\":case\"e\":case\"g\":case\"p\":case\"r\":{n.precision==null\u0026\u0026!isNaN(s=Ft(i,Math.max(Math.abs(e),Math.abs(t))))\u0026\u0026(n.precision=s-(n.type===\"e\"));break}case\"f\":case\"%\":{n.precision==null\u0026\u0026!isNaN(s=Nt(i))\u0026\u0026(n.precision=s-(n.type===\"%\")*2);break}}return Ze(n)}function go(e){var t=e.domain;return e.ticks=function(r){var n=t();return(0,et.ticks)(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return Vt(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null\u0026\u0026(r=10);var n=t(),i=0,s=n.length-1,l=n[i],h=n[s],m,y,_=10;for(h\u003cl\u0026\u0026(y=l,l=h,h=y,y=i,i=s,s=y);_-- \u003e0;){if(y=(0,et.tickIncrement)(l,h,r),y===m)return n[i]=l,n[s]=h,t(n);if(y\u003e0)l=Math.floor(l/y)*y,h=Math.ceil(h/y)*y;else if(y\u003c0)l=Math.ceil(l*y)/y,h=Math.floor(h*y)/y;else break;m=y}return e},e}function Ee(){var e=Ot();return e.copy=function(){return Un(e,Ee())},vn.apply(e,arguments),go(e)}function Zn(e){return e}var qt=1,Bt=2,Ut=3,De=4,Jn=1e-6;function yo(e){return\"translate(\"+e+\",0)\"}function _o(e){return\"translate(0,\"+e+\")\"}function xo(e){return t=\u003e+e(t)}function vo(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()\u0026\u0026(t=Math.round(t)),r=\u003e+e(r)+t}function bo(){return!this.__axis}function er(e,t){var r=[],n=null,i=null,s=6,l=6,h=3,m=typeof window!=\"undefined\"\u0026\u0026window.devicePixelRatio\u003e1?0:.5,y=e===qt||e===De?-1:1,_=e===De||e===Bt?\"x\":\"y\",g=e===qt||e===Ut?yo:_o;function v(b){var P=n??(t.ticks?t.ticks.apply(t,r):t.domain()),C=i??(t.tickFormat?t.tickFormat.apply(t,r):Zn),T=Math.max(s,0)+h,N=t.range(),I=+N[0]+m,L=+N[N.length-1]+m,O=(t.bandwidth?vo:xo)(t.copy(),m),E=b.selection?b.selection():b,U=E.selectAll(\".domain\").data([null]),q=E.selectAll(\".tick\").data(P,t).order(),K=q.exit(),ee=q.enter().append(\"g\").attr(\"class\",\"tick\"),Y=q.select(\"line\"),A=q.select(\"text\");U=U.merge(U.enter().insert(\"path\",\".tick\").attr(\"class\",\"domain\").attr(\"stroke\",\"currentColor\")),q=q.merge(ee),Y=Y.merge(ee.append(\"line\").attr(\"stroke\",\"currentColor\").attr(_+\"2\",y*s)),A=A.merge(ee.append(\"text\").attr(\"fill\",\"currentColor\").attr(_,y*T).attr(\"dy\",e===qt?\"0em\":e===Ut?\"0.71em\":\"0.32em\")),b!==E\u0026\u0026(U=U.transition(b),q=q.transition(b),Y=Y.transition(b),A=A.transition(b),K=K.transition(b).attr(\"opacity\",Jn).attr(\"transform\",function(B){return isFinite(B=O(B))?g(B+m):this.getAttribute(\"transform\")}),ee.attr(\"opacity\",Jn).attr(\"transform\",function(B){var F=this.parentNode.__axis;return g((F\u0026\u0026isFinite(F=F(B))?F:O(B))+m)})),K.remove(),U.attr(\"d\",e===De||e===Bt?l?\"M\"+y*l+\",\"+I+\"H\"+m+\"V\"+L+\"H\"+y*l:\"M\"+m+\",\"+I+\"V\"+L:l?\"M\"+I+\",\"+y*l+\"V\"+m+\"H\"+L+\"V\"+y*l:\"M\"+I+\",\"+m+\"H\"+L),q.attr(\"opacity\",1).attr(\"transform\",function(B){return g(O(B)+m)}),Y.attr(_+\"2\",y*s),A.attr(_,y*T).text(C),E.filter(bo).attr(\"fill\",\"none\").attr(\"font-size\",10).attr(\"font-family\",\"sans-serif\").attr(\"text-anchor\",e===Bt?\"start\":e===De?\"end\":\"middle\"),E.each(function(){this.__axis=O})}return v.scale=function(b){return arguments.length?(t=b,v):t},v.ticks=function(){return r=Array.from(arguments),v},v.tickArguments=function(b){return arguments.length?(r=b==null?[]:Array.from(b),v):r.slice()},v.tickValues=function(b){return arguments.length?(n=b==null?null:Array.from(b),v):n\u0026\u0026n.slice()},v.tickFormat=function(b){return arguments.length?(i=b,v):i},v.tickSize=function(b){return arguments.length?(s=l=+b,v):s},v.tickSizeInner=function(b){return arguments.length?(s=+b,v):s},v.tickSizeOuter=function(b){return arguments.length?(l=+b,v):l},v.tickPadding=function(b){return arguments.length?(h=+b,v):h},v.offset=function(b){return arguments.length?(m=+b,v):m},v}function tt(e){return er(Ut,e)}function nt(e){return er(De,e)}var rt=\"http://www.w3.org/1999/xhtml\",Wt={svg:\"http://www.w3.org/2000/svg\",xhtml:rt,xlink:\"http://www.w3.org/1999/xlink\",xml:\"http://www.w3.org/XML/1998/namespace\",xmlns:\"http://www.w3.org/2000/xmlns/\"};function it(e){var t=e+=\"\",r=t.indexOf(\":\");return r\u003e=0\u0026\u0026(t=e.slice(0,r))!==\"xmlns\"\u0026\u0026(e=e.slice(r+1)),Wt.hasOwnProperty(t)?{space:Wt[t],local:e}:e}function wo(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===rt\u0026\u0026t.documentElement.namespaceURI===rt?t.createElement(e):t.createElementNS(r,e)}}function Mo(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ot(e){var t=it(e);return(t.local?Mo:wo)(t)}function Ao(){}function at(e){return e==null?Ao:function(){return this.querySelector(e)}}function tr(e){typeof e!=\"function\"\u0026\u0026(e=at(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i\u003cr;++i)for(var s=t[i],l=s.length,h=n[i]=new Array(l),m,y,_=0;_\u003cl;++_)(m=s[_])\u0026\u0026(y=e.call(m,m.__data__,_,s))\u0026\u0026(\"__data__\"in m\u0026\u0026(y.__data__=m.__data__),h[_]=y);return new D(n,this._parents)}function zt(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Po(){return[]}function nr(e){return e==null?Po:function(){return this.querySelectorAll(e)}}function Eo(e){return function(){return zt(e.apply(this,arguments))}}function rr(e){typeof e==\"function\"?e=Eo(e):e=nr(e);for(var t=this._groups,r=t.length,n=[],i=[],s=0;s\u003cr;++s)for(var l=t[s],h=l.length,m,y=0;y\u003ch;++y)(m=l[y])\u0026\u0026(n.push(e.call(m,m.__data__,y,l)),i.push(m));return new D(n,i)}function ir(e){return function(){return this.matches(e)}}function lt(e){return function(t){return t.matches(e)}}var ko=Array.prototype.find;function Co(e){return function(){return ko.call(this.children,e)}}function jo(){return this.firstElementChild}function or(e){return this.select(e==null?jo:Co(typeof e==\"function\"?e:lt(e)))}var Oo=Array.prototype.filter;function Io(){return Array.from(this.children)}function So(e){return function(){return Oo.call(this.children,e)}}function ar(e){return this.selectAll(e==null?Io:So(typeof e==\"function\"?e:lt(e)))}function lr(e){typeof e!=\"function\"\u0026\u0026(e=ir(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i\u003cr;++i)for(var s=t[i],l=s.length,h=n[i]=[],m,y=0;y\u003cl;++y)(m=s[y])\u0026\u0026e.call(m,m.__data__,y,s)\u0026\u0026h.push(m);return new D(n,this._parents)}function st(e){return new Array(e.length)}function sr(){return new D(this._enter||this._groups.map(st),this._parents)}function Ne(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ne.prototype={constructor:Ne,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ur(e){return function(){return e}}function To(e,t,r,n,i,s){for(var l=0,h,m=t.length,y=s.length;l\u003cy;++l)(h=t[l])?(h.__data__=s[l],n[l]=h):r[l]=new Ne(e,s[l]);for(;l\u003cm;++l)(h=t[l])\u0026\u0026(i[l]=h)}function Lo(e,t,r,n,i,s,l){var h,m,y=new Map,_=t.length,g=s.length,v=new Array(_),b;for(h=0;h\u003c_;++h)(m=t[h])\u0026\u0026(v[h]=b=l.call(m,m.__data__,h,t)+\"\",y.has(b)?i[h]=m:y.set(b,m));for(h=0;h\u003cg;++h)b=l.call(e,s[h],h,s)+\"\",(m=y.get(b))?(n[h]=m,m.__data__=s[h],y.delete(b)):r[h]=new Ne(e,s[h]);for(h=0;h\u003c_;++h)(m=t[h])\u0026\u0026y.get(v[h])===m\u0026\u0026(i[h]=m)}function Do(e){return e.__data__}function cr(e,t){if(!arguments.length)return Array.from(this,Do);var r=t?Lo:To,n=this._parents,i=this._groups;typeof e!=\"function\"\u0026\u0026(e=ur(e));for(var s=i.length,l=new Array(s),h=new Array(s),m=new Array(s),y=0;y\u003cs;++y){var _=n[y],g=i[y],v=g.length,b=No(e.call(_,_\u0026\u0026_.__data__,y,n)),P=b.length,C=h[y]=new Array(P),T=l[y]=new Array(P),N=m[y]=new Array(v);r(_,g,C,T,N,b,t);for(var I=0,L=0,O,E;I\u003cP;++I)if(O=C[I]){for(I\u003e=L\u0026\u0026(L=I+1);!(E=T[L])\u0026\u0026++L\u003cP;);O._next=E||null}}return l=new D(l,n),l._enter=h,l._exit=m,l}function No(e){return typeof e==\"object\"\u0026\u0026\"length\"in e?e:Array.from(e)}function fr(){return new D(this._exit||this._groups.map(st),this._parents)}function dr(e,t,r){var n=this.enter(),i=this,s=this.exit();return typeof e==\"function\"?(n=e(n),n\u0026\u0026(n=n.selection())):n=n.append(e+\"\"),t!=null\u0026\u0026(i=t(i),i\u0026\u0026(i=i.selection())),r==null?s.remove():r(s),n\u0026\u0026i?n.merge(i).order():i}function hr(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,s=n.length,l=Math.min(i,s),h=new Array(i),m=0;m\u003cl;++m)for(var y=r[m],_=n[m],g=y.length,v=h[m]=new Array(g),b,P=0;P\u003cg;++P)(b=y[P]||_[P])\u0026\u0026(v[P]=b);for(;m\u003ci;++m)h[m]=r[m];return new D(h,this._parents)}function pr(){for(var e=this._groups,t=-1,r=e.length;++t\u003cr;)for(var n=e[t],i=n.length-1,s=n[i],l;--i\u003e=0;)(l=n[i])\u0026\u0026(s\u0026\u0026l.compareDocumentPosition(s)^4\u0026\u0026s.parentNode.insertBefore(l,s),s=l);return this}function mr(e){e||(e=Ro);function t(g,v){return g\u0026\u0026v?e(g.__data__,v.__data__):!g-!v}for(var r=this._groups,n=r.length,i=new Array(n),s=0;s\u003cn;++s){for(var l=r[s],h=l.length,m=i[s]=new Array(h),y,_=0;_\u003ch;++_)(y=l[_])\u0026\u0026(m[_]=y);m.sort(t)}return new D(i,this._parents).order()}function Ro(e,t){return e\u003ct?-1:e\u003et?1:e\u003e=t?0:NaN}function gr(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function yr(){return Array.from(this)}function _r(){for(var e=this._groups,t=0,r=e.length;t\u003cr;++t)for(var n=e[t],i=0,s=n.length;i\u003cs;++i){var l=n[i];if(l)return l}return null}function xr(){let e=0;for(let t of this)++e;return e}function vr(){return!this.node()}function br(e){for(var t=this._groups,r=0,n=t.length;r\u003cn;++r)for(var i=t[r],s=0,l=i.length,h;s\u003cl;++s)(h=i[s])\u0026\u0026e.call(h,h.__data__,s,i);return this}function Fo(e){return function(){this.removeAttribute(e)}}function Vo(e){return function(){this.removeAttributeNS(e.space,e.local)}}function qo(e,t){return function(){this.setAttribute(e,t)}}function Bo(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Uo(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Wo(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function wr(e,t){var r=it(e);if(arguments.length\u003c2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?Vo:Fo:typeof t==\"function\"?r.local?Wo:Uo:r.local?Bo:qo)(r,t))}function ut(e){return e.ownerDocument\u0026\u0026e.ownerDocument.defaultView||e.document\u0026\u0026e||e.defaultView}function zo(e){return function(){this.style.removeProperty(e)}}function Ho(e,t,r){return function(){this.style.setProperty(e,t,r)}}function Ko(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function Mr(e,t,r){return arguments.length\u003e1?this.each((t==null?zo:typeof t==\"function\"?Ko:Ho)(e,t,r??\"\")):$o(this.node(),e)}function $o(e,t){return e.style.getPropertyValue(t)||ut(e).getComputedStyle(e,null).getPropertyValue(t)}function Go(e){return function(){delete this[e]}}function Xo(e,t){return function(){this[e]=t}}function Yo(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function Ar(e,t){return arguments.length\u003e1?this.each((t==null?Go:typeof t==\"function\"?Yo:Xo)(e,t)):this.node()[e]}function Pr(e){return e.trim().split(/^|\\s+/)}function Ht(e){return e.classList||new Er(e)}function Er(e){this._node=e,this._names=Pr(e.getAttribute(\"class\")||\"\")}Er.prototype={add:function(e){var t=this._names.indexOf(e);t\u003c0\u0026\u0026(this._names.push(e),this._node.setAttribute(\"class\",this._names.join(\" \")))},remove:function(e){var t=this._names.indexOf(e);t\u003e=0\u0026\u0026(this._names.splice(t,1),this._node.setAttribute(\"class\",this._names.join(\" \")))},contains:function(e){return this._names.indexOf(e)\u003e=0}};function kr(e,t){for(var r=Ht(e),n=-1,i=t.length;++n\u003ci;)r.add(t[n])}function Cr(e,t){for(var r=Ht(e),n=-1,i=t.length;++n\u003ci;)r.remove(t[n])}function Qo(e){return function(){kr(this,e)}}function Zo(e){return function(){Cr(this,e)}}function Jo(e,t){return function(){(t.apply(this,arguments)?kr:Cr)(this,e)}}function jr(e,t){var r=Pr(e+\"\");if(arguments.length\u003c2){for(var n=Ht(this.node()),i=-1,s=r.length;++i\u003cs;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t==\"function\"?Jo:t?Qo:Zo)(r,t))}function ea(){this.textContent=\"\"}function ta(e){return function(){this.textContent=e}}function na(e){return function(){var t=e.apply(this,arguments);this.textContent=t??\"\"}}function Or(e){return arguments.length?this.each(e==null?ea:(typeof e==\"function\"?na:ta)(e)):this.node().textContent}function ra(){this.innerHTML=\"\"}function ia(e){return function(){this.innerHTML=e}}function oa(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??\"\"}}function Ir(e){return arguments.length?this.each(e==null?ra:(typeof e==\"function\"?oa:ia)(e)):this.node().innerHTML}function aa(){this.nextSibling\u0026\u0026this.parentNode.appendChild(this)}function Sr(){return this.each(aa)}function la(){this.previousSibling\u0026\u0026this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Tr(){return this.each(la)}function Lr(e){var t=typeof e==\"function\"?e:ot(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function sa(){return null}function Dr(e,t){var r=typeof e==\"function\"?e:ot(e),n=t==null?sa:typeof t==\"function\"?t:at(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function ua(){var e=this.parentNode;e\u0026\u0026e.removeChild(this)}function Nr(){return this.each(ua)}function ca(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fa(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Rr(e){return this.select(e?fa:ca)}function Fr(e){return arguments.length?this.property(\"__data__\",e):this.node().__data__}function da(e){return function(t){e.call(this,t,this.__data__)}}function ha(e){return e.trim().split(/^|\\s+/).map(function(t){var r=\"\",n=t.indexOf(\".\");return n\u003e=0\u0026\u0026(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function pa(e){return function(){var t=this.__on;if(!!t){for(var r=0,n=-1,i=t.length,s;r\u003ci;++r)s=t[r],(!e.type||s.type===e.type)\u0026\u0026s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++n]=s;++n?t.length=n:delete this.__on}}}function ma(e,t,r){return function(){var n=this.__on,i,s=da(t);if(n){for(var l=0,h=n.length;l\u003ch;++l)if((i=n[l]).type===e.type\u0026\u0026i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=r),i.value=t;return}}this.addEventListener(e.type,s,r),i={type:e.type,name:e.name,value:t,listener:s,options:r},n?n.push(i):this.__on=[i]}}function Vr(e,t,r){var n=ha(e+\"\"),i,s=n.length,l;if(arguments.length\u003c2){var h=this.node().__on;if(h){for(var m=0,y=h.length,_;m\u003cy;++m)for(i=0,_=h[m];i\u003cs;++i)if((l=n[i]).type===_.type\u0026\u0026l.name===_.name)return _.value}return}for(h=t?ma:pa,i=0;i\u003cs;++i)this.each(h(n[i],t,r));return this}function qr(e,t,r){var n=ut(e),i=n.CustomEvent;typeof i==\"function\"?i=new i(t,r):(i=n.document.createEvent(\"Event\"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function ga(e,t){return function(){return qr(this,e,t)}}function ya(e,t){return function(){return qr(this,e,t.apply(this,arguments))}}function Br(e,t){return this.each((typeof t==\"function\"?ya:ga)(e,t))}function*Ur(){for(var e=this._groups,t=0,r=e.length;t\u003cr;++t)for(var n=e[t],i=0,s=n.length,l;i\u003cs;++i)(l=n[i])\u0026\u0026(yield l)}var Kt=[null];function D(e,t){this._groups=e,this._parents=t}function _a(){return new D([[document.documentElement]],Kt)}function xa(){return this}D.prototype=_a.prototype={constructor:D,select:tr,selectAll:rr,selectChild:or,selectChildren:ar,filter:lr,data:cr,enter:sr,exit:fr,join:dr,merge:hr,selection:xa,order:pr,sort:mr,call:gr,nodes:yr,node:_r,size:xr,empty:vr,each:br,attr:wr,style:Mr,property:Ar,classed:jr,text:Or,html:Ir,raise:Sr,lower:Tr,append:Lr,insert:Dr,remove:Nr,clone:Rr,datum:Fr,on:Vr,dispatch:Br,[Symbol.iterator]:Ur};function ke(e){return typeof e==\"string\"?new D([[document.querySelector(e)]],[document.documentElement]):new D([[e]],Kt)}function $t({strokeWidth:e,functions:t,width:r,height:n,range:i,colors:s,grid:l,onHover:h,onMouseEnter:m,onMouseLeave:y,onClick:_,margin:g,hideAxes:v,hideXAxis:b,hideYAxis:P}){g=g||{top:20,right:30,bottom:30,left:50},r=r||500,n=n||300;let C=n-g.top-g.bottom,T=r-g.left-g.right;e=e||1,s=s||[\"lightsalmon\",\"lightseagreen\",\"indianred\",\"darkmagenta\",\"cornflowerblue\",\"aqua\"],t=t||[],i=i||{x:[-4,4],y:[-4,4]};let N=Ee().domain(i.x).range([g.left,r-g.right]),I=Ee().domain(i.y).range([n-g.top,g.bottom]),L=t.map(O=\u003e{let E=[[]];for(let U=g.left+1e-6;U\u003cr-g.right;U+=1){let q=N.invert(U),K=O(q);if(typeof K==\"number\"){let ee=I(K);q\u003e=i.x[0]\u0026\u0026q\u003c=i.x[1]\u0026\u0026K\u003e=i.y[0]\u0026\u0026K\u003c=i.y[1]\u0026\u0026E[0].unshift([U,ee])}}return E});return Z.default.createElement(\"svg\",{width:r,height:n,onClick:O=\u003e_\u0026\u0026_(O)},!v\u0026\u0026Z.default.createElement(Z.default.Fragment,null,!b\u0026\u0026Z.default.createElement(\"g\",{className:\"x-axis plot-axis\",ref:O=\u003eke(O).attr(\"transform\",`translate(0,${n-g.top})`).call(tt(N).ticks(r/50))}),!P\u0026\u0026Z.default.createElement(\"g\",{className:\"y-axis plot-axis\",ref:O=\u003eke(O).attr(\"transform\",`translate(${g.left},0)`).call(nt(I).ticks(n/50))})),l\u0026\u0026Z.default.createElement(Z.default.Fragment,null,l.x\u0026\u0026Z.default.createElement(\"g\",{className:\"grid\",ref:O=\u003eke(O).attr(\"transform\",`translate(0, ${I(i.y[1])})`).call(tt(N).ticks(l.x).tickSize(C).tickFormat(()=\u003e\"\"))}),l.y\u0026\u0026Z.default.createElement(\"g\",{className:\"grid\",ref:O=\u003eke(O).attr(\"transform\",`translate(${N(i.x[0])}, 0)`).call(nt(I).ticks(l.y).tickSize(-T).tickFormat(()=\u003e\"\"))})),Z.default.createElement(\"g\",null,L.map((O,E)=\u003eO.map((U,q)=\u003eZ.default.createElement(\"path\",{onMouseEnter:()=\u003em\u0026\u0026m(E),onMouseLeave:()=\u003ey\u0026\u0026y(E),key:E+\"-\"+q,d:\"M\"+U.join(\"L\"),stroke:s[E%s.length]||\"black\",strokeWidth:e,fill:\"none\"})))))}var Wr=te(ge());var oe=te(ge());function Gt(e,t=!1){let r=(0,oe.useRef)(),n=(0,oe.useRef)(),i=(0,oe.useRef)(),s=(0,oe.useRef)(0),l=(0,oe.useRef)(),[h,m]=(0,oe.useState)(t),y=b=\u003e{if(i.current||(i.current=b),n.current!=null){let P=b-n.current,C=b-i.current,T=l.current\u0026\u0026C\u003e=l.current;if(e({time:b,delta:P,fromStart:C,last:T,fromFirstStart:C+s.current,stopTime:s.current,progress:l.current?C/l.current:0}),T){g(),l.current=null;return}}n.current=b,r.current=requestAnimationFrame(y)};function _(b){h\u0026\u0026g(),b\u0026\u0026(l.current=b),r.current=requestAnimationFrame(y),m(!0)}function g(){n.current\u0026\u0026i.current\u0026\u0026(s.current=n.current-i.current+s.current),cancelAnimationFrame(r.current),i.current=0,r.current=null,m(!1)}function v(){r.current?g():_()}return oe.default.useEffect(()=\u003e(t\u0026\u0026_(),()=\u003eg()),[]),{start:_,stop:g,toggle:v,isRunning:h}}function Xt(e){let[t,r]=(0,Wr.useState)({fromStart:0,fromFirstStart:0,progress:0,delta:null}),n=Gt(r,e.autostart);return e.children({...n,time:t})}var bf=te(Zr()),he=te(li()),$a={title:\"A Macro View on Analog Synthesis\",date:\"2021-05-14\",tags:[\"diy\",\"electronics\",\"synthesis\"],description:\"Lately, I've been learning about analog synthesis\",image:\"./img/vco.png\"};function Ga(e){let t=Object.assign({p:\"p\",h2:\"h2\",a:\"a\",span:\"span\",img:\"img\",div:\"div\",h3:\"h3\",table:\"table\",thead:\"thead\",tr:\"tr\",th:\"th\",tbody:\"tbody\",td:\"td\",h4:\"h4\",ul:\"ul\",li:\"li\"},e.components),{wrapper:r}=t,n=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:`Lately, I've been learning about analog synthesis.\nIn this post, I want to document what I've learned so far and how I approached the topic.\nDisclaimer: I am not an expert.`}),`\n`,(0,a.jsxs)(t.h2,{id:\"analog--digital-synthesis\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#analog--digital-synthesis\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Analog \u0026 Digital Synthesis\"]}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/analogcircuit.gif\",alt:\"analog circuit\"})}),`\n`,(0,a.jsx)(t.p,{children:`In a nutshell, analog synthesis produces sound by directly manipulating voltages in electrical circuits.\nIn digital synthesis, buffered sound data is calculated from code and then passed to an audio interface that transforms it into voltage.`}),`\n`,(0,a.jsx)(t.p,{children:`Generally, analog synthesis is much simpler in its infrastructure.\nThe higher complexity of digital synthesis allows much more fine grained control,\nwhereas analog synthesis can sometimes behave in unexpected ways.`}),`\n`,(0,a.jsx)(t.p,{children:'I am not going into the debate of which is \"better\" here, as both ways have their right to exist.'}),`\n`,(0,a.jsxs)(t.h2,{id:\"from-voltage-to-sound--\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#from-voltage-to-sound--\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"From Voltage to Sound \\u{1F50C} \\u{1F50A}\"]}),`\n`,(0,a.jsx)(t.p,{children:\"In both analog and digital synthesis, we have a voltage at the end, which is fed to the sound system (amplifier + speaker).\"}),`\n`,(0,a.jsx)(Xt,{autostart:!0,children:({toggle:i,time:s,isRunning:l,start:h})=\u003e(0,a.jsx)(a.Fragment,{children:s\u0026\u0026(0,a.jsxs)(t.div,{style:{display:\"flex\"},children:[(0,a.jsxs)(t.div,{style:{width:300},children:[(0,a.jsx)(t.p,{children:\"When the voltage does a sine wave,\"}),(0,a.jsx)($t,{range:{x:[0,10*Math.PI],y:[-1,1]},height:100,width:300,hideAxes:!0,functions:[m=\u003eMath.sin(m+s.fromStart/100)],colors:[\"green\",\"yellow\"]})]}),(0,a.jsxs)(t.div,{style:{width:300},children:[(0,a.jsx)(t.p,{children:\" the membrane will move like this:\"}),(0,a.jsx)($t,{range:{x:[0,Math.PI],y:[-1,1]},height:100,width:300,hideAxes:!0,functions:[m=\u003eMath.sin(s.fromStart/100)*Math.sin(m)],colors:[\"green\",\"yellow\"]})]})]})})}),`\n`,(0,a.jsx)(\"p\",{children:\"... which will push and pull the air molecules around (now from left to right..):\"}),`\n`,(0,a.jsx)(\"img\",{src:\"https://mk0waitbutwhy9c3hjku.kinstacdn.com/wp-content/uploads/2016/03/red-dot.gif\"}),`\n`,(0,a.jsx)(t.p,{children:`So, the displacement of the membrane in the speaker is directly affected by that incoming voltage level.\nWhen the membrane moves, it pushes the air molecules back and forth, creating a sound wave that the human ear can detect.`}),`\n`,(0,a.jsxs)(t.p,{children:[\"If you want to read more on the basics of sound, I recommend \",(0,a.jsx)(t.a,{href:\"https://waitbutwhy.com/2016/03/sound.html\",children:\"this post by waitbutwhy\"}),\".\"]}),`\n`,(0,a.jsxs)(t.h2,{id:\"building-blocks-of-analog-synthesis\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#building-blocks-of-analog-synthesis\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Building Blocks of Analog Synthesis\"]}),`\n`,(0,a.jsx)(t.p,{children:\"Now that we have the basic theory out of the way, let's look at the most important building blocks of an analog synth.\"}),`\n`,(0,a.jsxs)(t.h3,{id:\"micromodules\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#micromodules\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Micromodules\"]}),`\n`,(0,a.jsxs)(t.p,{children:[`As this post is a macro view on analog synthesis, I will not talk about how the electric circuits work in detail.\nTo start playing around with analog synthesis, I found the `,(0,a.jsx)(t.a,{href:\"http://micromodular.pl/\",children:\"micromodules from Syntaxis\"}),` (not sponsored \\u{1F642}).\nThey provide breadboard friendly components that can be linked together in multiple ways. With them, I could start to explore\nhow analog modules interact without needing to know the details about how to build the circuits.`]}),`\n`,(0,a.jsxs)(t.h3,{id:\"the-oscillator\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#the-oscillator\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"The Oscillator\"]}),`\n`,(0,a.jsx)(t.p,{children:`As a sound source, we need at least one oscillator. At the heart of an analog oscillator, an electric circuit is creating some kind of\nperiodic voltage wave. Commonly, the frequency of that wave can be controlled with voltage (CV = Control Voltage).\nAn oscillator that can be controlled with voltage is called a VCO (= Voltage Controlled Oscillator).`}),`\n`,(0,a.jsx)(t.p,{children:\"Let's start with a simple circuit:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-simple.png\",alt:\"vco-simple\"})}),`\n`,(0,a.jsxs)(t.table,{children:[`\n`,(0,a.jsxs)(t.thead,{children:[`\n`,(0,a.jsxs)(t.tr,{children:[`\n`,(0,a.jsx)(t.th,{children:\"color\"}),`\n`,(0,a.jsx)(t.th,{children:\"meaning\"}),`\n`]}),`\n`]}),`\n`,(0,a.jsxs)(t.tbody,{children:[`\n`,(0,a.jsxs)(t.tr,{children:[`\n`,(0,a.jsx)(t.td,{children:(0,a.jsx)(ye,{color:\"#CB2A1D\"})}),`\n`,(0,a.jsx)(t.td,{children:\"+12V\"}),`\n`]}),`\n`,(0,a.jsxs)(t.tr,{children:[`\n`,(0,a.jsx)(t.td,{children:(0,a.jsx)(ye,{color:\"#3E89D5\"})}),`\n`,(0,a.jsx)(t.td,{children:\"-12V\"}),`\n`]}),`\n`,(0,a.jsxs)(t.tr,{children:[`\n`,(0,a.jsx)(t.td,{children:(0,a.jsx)(ye,{color:\"#3C3C3C\"})}),`\n`,(0,a.jsx)(t.td,{children:\"Ground (0V)\"}),`\n`]}),`\n`,(0,a.jsxs)(t.tr,{children:[`\n`,(0,a.jsx)(t.td,{children:(0,a.jsx)(ye,{color:\"#EC612A\"})}),`\n`,(0,a.jsx)(t.td,{children:\"5V\"}),`\n`]}),`\n`,(0,a.jsxs)(t.tr,{children:[`\n`,(0,a.jsx)(t.td,{children:(0,a.jsx)(ye,{color:\"#FFF853\"})}),`\n`,(0,a.jsx)(t.td,{children:\"Control Voltage (CV)\"}),`\n`]}),`\n`,(0,a.jsxs)(t.tr,{children:[`\n`,(0,a.jsx)(t.td,{children:(0,a.jsx)(ye,{color:\"#5CC63D\"})}),`\n`,(0,a.jsx)(t.td,{children:\"Analog Audio Voltage\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,a.jsx)(t.p,{children:\"We will use this color coding throughout the post. This is the (much more messy) circuit in real life:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-simple-real.png\",alt:\"vco-simple-real\"})}),`\n`,(0,a.jsxs)(t.h4,{id:\"parts\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#parts\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Parts\"]}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:\"https://syntaxis.com.pl/en/micromodules/77-uvco-3340-a.html\",children:\"uVCO-3340-A\"})}),`\n`,(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:\"https://syntaxis.com.pl/en/micromodules/82-upsu-112-a.html\",children:\"uPSU-112-A\"}),\" with laptop charger\"]}),`\n`,(0,a.jsx)(t.li,{children:\"8ohm speaker\"}),`\n`,(0,a.jsx)(t.li,{children:\"3 potentiometers to provide CV\"}),`\n`,(0,a.jsx)(t.li,{children:\"breadboard + cables\"}),`\n`]}),`\n`,(0,a.jsxs)(t.h4,{id:\"power-connections\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#power-connections\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Power Connections\"]}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"The PSU (power suplly unit) provides -12V, GND (0V), +12 and 5V.\"}),`\n`,(0,a.jsx)(t.li,{children:\"The VCO is connected to -12V, GND and 12V\"}),`\n`,(0,a.jsx)(t.li,{children:\"The potentiometers are connected to GND and 5V, outputting a voltage between 0 and 5V.\"}),`\n`]}),`\n`,(0,a.jsx)(t.p,{children:\"Similar power connections will be used throughout the post.\"}),`\n`,(0,a.jsxs)(t.h4,{id:\"control-voltage\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#control-voltage\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Control Voltage\"]}),`\n`,(0,a.jsx)(t.p,{children:\"The output of the pots is used as CV to change certain parameters of the VCO:\"}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"The coarse pot is connected to the 1/2 V/Oct input, which means it can add 5V/0.5V = 10 octaves\"}),`\n`,(0,a.jsx)(t.li,{children:\"The fine pot is connected to the 24V/Oct input, which means it can add 5V/24V = 0.2 octaves = 2.5 semitones\"}),`\n`,(0,a.jsx)(t.li,{children:\"Let's ignore the pulse width pot for now\"}),`\n`]}),`\n`,(0,a.jsxs)(t.h4,{id:\"adding-a-keyboard\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#adding-a-keyboard\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Adding a Keyboard\"]}),`\n`,(0,a.jsx)(t.p,{children:`The circuit above is slightly boring, as controlling pitch with a potentiometer is not very useful when we want to play melodies.\nTo fix that, let's remove all pots and add a keyboard that supports CV, like the Arturia Keystep:`}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-keystep-sketch.png\",alt:\"vco-keystep real\"})}),`\n`,(0,a.jsx)(t.p,{children:\"In reality:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-keystep-real.png\",alt:\"vco-keystep real\"})}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"The keystep has a pitch cv output, that I connected to the 1V/Oct input of the VCO, using a 3,5mm jack (which is also grounded)\"}),`\n`,(0,a.jsx)(t.li,{children:\"I also replaced the cheap 8ohm speaker with a Bluetooth Speaker that has an AUX input.\"}),`\n`]}),`\n`,(0,a.jsxs)(t.h4,{id:\"ready-to-rave\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#ready-to-rave\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Ready to Rave?\"]}),`\n`,(0,a.jsx)(t.p,{children:\"Now we are finally ready to rave (loud):\"}),`\n`,(0,a.jsx)(he.default,{type:\"audio/x-m4a\",src:\"./audio/vco-rave.mp3\",controls:!0}),`\n`,(0,a.jsx)(t.p,{children:\"If we look at the waveform, we can see the crisp sawwave:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/sawrave.png\",alt:\"sawrave\"})}),`\n`,(0,a.jsx)(t.p,{children:`Here, we can clearly see the sawwave changing frequencies.\nAlso, we can make out slight wobbles in the amplitude, which is that dirty analog imperfection we want.`}),`\n`,(0,a.jsxs)(t.h3,{id:\"the-filter\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#the-filter\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"The Filter\"]}),`\n`,(0,a.jsxs)(t.p,{children:[\"If you listen to the sound above, the sawwave is really harsh, which might be tamed with a \",(0,a.jsx)(t.a,{href:\"https://syntaxis.com.pl/en/micromodules/109-uvcf-2044-lp4-a.html\",children:\"filter\"}),\":\"]}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filtered-sketch.png\",alt:\"vco-filtered\"})}),`\n`,(0,a.jsx)(t.p,{children:\"In reality (with slightly exaggerated cutoff pot):\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filtered-real.png\",alt:\"vco-filtered real\"})}),`\n`,(0,a.jsxs)(t.h4,{id:\"explanation\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#explanation\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Explanation\"]}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"Instead of going from the VCO saw output directly to the speaker, we route it into the filter input\"}),`\n`,(0,a.jsx)(t.li,{children:\"The filter output is then plugged to the speaker\"}),`\n`,(0,a.jsx)(t.li,{children:\"The potentiometer controls the cutoff frequency of the filter\"}),`\n`,(0,a.jsx)(t.li,{children:\"A filter that can be controlled with voltage is called VCF (Voltage Controlled Filter)\"}),`\n`]}),`\n`,(0,a.jsxs)(t.h4,{id:\"now-the-rave-gets-better\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#now-the-rave-gets-better\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Now the rave gets better\"]}),`\n`,(0,a.jsx)(he.default,{type:\"audio/x-m4a\",src:\"./audio/vco-rave-filter.mp3\",controls:!0}),`\n`,(0,a.jsx)(t.p,{children:\"In the beginning of the waveform, we can see the sawwave emerging from a more sinelike shape as the filter opens:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/sawrave-filtered.png\",alt:\"vco-sawrave filtered\"})}),`\n`,(0,a.jsxs)(t.h3,{id:\"the-lfo\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#the-lfo\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"The LFO\"]}),`\n`,(0,a.jsx)(t.p,{children:`So far, I had to use my hand to manually turn the cutoff knob.\nUsing an LFO (= Low Frequency Oscillator), we can automate periodic CV changes:`}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filter-lfo-sketch.png\",alt:\"vco filter + lfo sketch\"})}),`\n`,(0,a.jsx)(t.p,{children:\"In the messy real life:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filter-lfo.png\",alt:\"vco filter + lfo\"})}),`\n`,(0,a.jsxs)(t.h4,{id:\"explanation-1\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#explanation-1\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Explanation\"]}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"The LFOs triangle output is connected with the filter frequency input\"}),`\n`,(0,a.jsxs)(t.li,{children:[\"The right pot is connected to another filter frequency input\",`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"Both frequency inputs will be summed by the filter\"}),`\n`]}),`\n`]}),`\n`,(0,a.jsx)(t.li,{children:\"A left pot controls the speed of the lfo\"}),`\n`]}),`\n`,(0,a.jsxs)(t.h4,{id:\"hands-free-raving\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#hands-free-raving\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Hands free raving\"]}),`\n`,(0,a.jsx)(he.default,{type:\"audio/x-m4a\",src:\"./audio/vco-rave-filter-lfo.mp3\",controls:!0}),`\n`,(0,a.jsx)(t.p,{children:\"In the waveform, the periodic cutoff changes look like this:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/sawrave-filter-lfo.png\",alt:\"vco-sawrave filter + lfo\"})}),`\n`,(0,a.jsxs)(t.h3,{id:\"the-attenuator\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#the-attenuator\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"The Attenuator\"]}),`\n`,(0,a.jsx)(t.p,{children:`So far, the LFO has a pretty big impact on our filter.\nIt would be nice if we could somehow control the amount of impact.. This is where the attenuator comes in.\nUnlike the other modules, an attenuator is just a potentiometer with special wiring:`}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/attenuator.png\",alt:\"attenuator sketch\"})}),`\n`,(0,a.jsx)(t.p,{children:`Instead of wiring 5V to the right pin, we use any signal that should be attenuated.\nIn our case, we can use the LFO triangle output.\nUsing the pot, we can then scale it down to minimize its impact:`}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filter-lfo-attenuator-sketch.png\",alt:\"vco-sawrave filter + lfo + attenuator sketch\"})}),`\n`,(0,a.jsx)(t.p,{children:\"The rats nest in real life:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filter-lfo-attenuator-real.png\",alt:\"vco-sawrave filter + lfo + attenuator real\"})}),`\n`,(0,a.jsx)(t.p,{children:\"Note that I also added an attenuator for pitch. You can view the attenuator like a modulation depth control for any parameter.\"}),`\n`,(0,a.jsxs)(t.h4,{id:\"lets-rave-again\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#lets-rave-again\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Let's rave again\"]}),`\n`,(0,a.jsx)(he.default,{type:\"audio/x-m4a\",src:\"./audio/vco-rave-filter-lfo-attenuator.mp3\",controls:!0}),`\n`,(0,a.jsx)(t.p,{children:\"In the waveform, we can see the wobbles getting slightly more intense to the right:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/sawrave-filter-lfo-attenuator.png\",alt:\"vco-sawrave filter + lfo + attenuator\"})}),`\n`,(0,a.jsxs)(t.h4,{id:\"time-for-a-melody\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#time-for-a-melody\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Time for a Melody\"]}),`\n`,(0,a.jsx)(t.p,{children:\"Using the pitch modulation attenuator, we can create a spacey melody ontop (layered with a DAW):\"}),`\n`,(0,a.jsx)(he.default,{type:\"audio/x-m4a\",src:\"./audio/vco-rave-filter-lfo-attenuator-melody.mp3\",controls:!0}),`\n`,(0,a.jsx)(t.p,{children:\"(The steady beeping came from my potentiometer bouncing out of the breadboard...)\"}),`\n`,(0,a.jsxs)(t.h3,{id:\"gate-signals-and-the-amplifier\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#gate-signals-and-the-amplifier\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Gate Signals and the Amplifier\"]}),`\n`,(0,a.jsx)(t.p,{children:`In our little synth, the tone keeps going on and on and on, even if we release the key on the keyboard.\nThis is not really practical to make music with.. To control the volume / amplitude of a signal, we can use a VCA (= Voltage Controlled Amplifier).`}),`\n`,(0,a.jsx)(t.p,{children:`When using a keyboard, we want the sound to start when the key is pressed and stop when it is released.\nTherefore, a keyboard that includes CV will commonly also have a Gate output.\nBy convention, the gate signal will be low (0V) when no key is pressed and high (5V) when a key is pressed.`}),`\n`,(0,a.jsx)(t.p,{children:\"Back to the circuit: To keep it simple, let's remove the lfo and the attenuators, and add the VCA + Gate:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filter-vca.png\",alt:\"vco, filter + vca sketch\"})}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filter-vca-real.png\",alt:\"vco, filter + vca real\"})}),`\n`,(0,a.jsx)(t.p,{children:\"Now we can release the key and the sound will stop.\"}),`\n`,(0,a.jsx)(he.default,{type:\"audio/x-m4a\",src:\"./audio/vco-rave-filter-vca-melody.mp3\",controls:!0}),`\n`,(0,a.jsxs)(t.h3,{id:\"the-adsr-envelope\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#the-adsr-envelope\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"The ADSR Envelope\"]}),`\n`,(0,a.jsx)(t.p,{children:`Using the gate to control our amplifier sounds really hard and sometimes clicky.\nFor softer sounds, we might want to fade the in when the key is pressed and out when it is released.\nThis is where the ADSR envelope comes in. ADSR stands for:`}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"Attack: Time till the note reaches the max volume\"}),`\n`,(0,a.jsx)(t.li,{children:\"Decay: Time till the note reaches the sustain level\"}),`\n`,(0,a.jsx)(t.li,{children:\"Sustain: Final level for the sustained note\"}),`\n`,(0,a.jsx)(t.li,{children:\"Release: Time till the note is silent after the key is released\"}),`\n`]}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/ADSR_parameter.svg/2880px-ADSR_parameter.svg.png\",alt:\"ADSR\"})}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filter-vca-envelope.png\",alt:\"ADSR sketch\"})}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/vco-filter-vca-adsr-real.png\",alt:\"ADSR real\"})}),`\n`,(0,a.jsx)(t.p,{children:`Now we can control the ADSR curve with the 4 pots on the bottom!\nAs we will see soon, we can also use attenuators to modulate parameters with an envelope.`}),`\n`,(0,a.jsx)(he.default,{type:\"audio/x-m4a\",src:\"./audio/vco-rave-filter-vca-adsr-melody.mp3\",controls:!0}),`\n`,(0,a.jsx)(t.p,{children:\"In the waveform, we can see the slow decay:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/sawrave-vco-filter-vca-adsr.png\",alt:\"ADSR real\"})}),`\n`,(0,a.jsxs)(t.h3,{id:\"putting-it-all-together\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#putting-it-all-together\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Putting it all together\"]}),`\n`,(0,a.jsx)(t.p,{children:\"After we examined the most important building blocks of a classic analog synthesizer, let's combine all of them!\"}),`\n`,(0,a.jsxs)(t.p,{children:[\"This sketch from the \",(0,a.jsx)(t.a,{href:\"http://micromodular.pl/howto\",children:\"micromodular how to site\"}),\" shows how we can arrange all the parts to a fully functional monosynth:\"]}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/bb_simplest_synthesizer.png\",alt:\"full synth\"})}),`\n`,(0,a.jsx)(t.p,{children:\"Of course, I also built this thing:\"}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"./img/analog-synthesis/whole-synth.png\",alt:\"full synth real\"})}),`\n`,(0,a.jsxs)(t.h4,{id:\"controls\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#controls\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Controls\"]}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsxs)(t.li,{children:[\"VCO\",`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"pitch coarse\"}),`\n`,(0,a.jsx)(t.li,{children:\"pitch fine\"}),`\n`,(0,a.jsx)(t.li,{children:\"pulse width (for square wave)\"}),`\n`,(0,a.jsx)(t.li,{children:\"pitch mod ADSR attenuator\"}),`\n`,(0,a.jsx)(t.li,{children:\"pitch mod LFO attenuator\"}),`\n`]}),`\n`]}),`\n`,(0,a.jsxs)(t.li,{children:[\"VCF\",`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"cutoff\"}),`\n`,(0,a.jsx)(t.li,{children:\"resonance\"}),`\n`,(0,a.jsx)(t.li,{children:\"cutoff mod ADSR attenuator\"}),`\n`,(0,a.jsx)(t.li,{children:\"res mod LFO attenuator\"}),`\n`]}),`\n`]}),`\n`,(0,a.jsxs)(t.li,{children:[\"VCA\",`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"manual gain\"}),`\n`,(0,a.jsx)(t.li,{children:\"volume attenuator\"}),`\n`,(0,a.jsx)(t.li,{children:\"gain mod ADSR attenuator\"}),`\n`,(0,a.jsx)(t.li,{children:\"gain mod LFO attenuator\"}),`\n`]}),`\n`]}),`\n`,(0,a.jsxs)(t.li,{children:[\"LFO\",`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"rate coarse\"}),`\n`,(0,a.jsx)(t.li,{children:\"rate fine\"}),`\n`,(0,a.jsx)(t.li,{children:\"pulse width\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,a.jsxs)(t.h3,{id:\"final-thoughts\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#final-thoughts\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Final Thoughts\"]}),`\n`,(0,a.jsx)(t.p,{children:`Those were the most essential building blocks of an analog synthesizer.\nIn a future posts, I might`}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"combine the synth with my DIY Keyboard Scanner\"}),`\n`,(0,a.jsx)(t.li,{children:\"use a multi channel DAC to output polyphonic CV\"}),`\n`,(0,a.jsx)(t.li,{children:\"build modules from scratch\"}),`\n`]})]});return r?(0,a.jsx)(r,Object.assign({},e,{children:n})):n}var Xa=Ga;return Ya;})();\n;return Component.default;"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"analog-synthesis"},"buildId":"3g4JzCtv87FmuTIoVbGJn","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>