<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Loophole Letters</title><meta content="This is where felixroos writes about music and coding and stuff that he finds interesting." name="description"/><meta property="og:url" content="https://felixroos.github.io/chords"/><link rel="canonical" href="https://felixroos.github.io/chords"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"/><meta property="og:type" content="website"/><meta property="og:site_name" content="Loophole Letters"/><meta property="og:description" content="This is where felixroos writes about music and coding and stuff that he finds interesting."/><meta property="og:title" content="Loophole Letters"/><meta property="og:image" content="https://felixroos.github.io/images/site-preview.png"/><meta name="next-head-count" content="12"/><link rel="preload" href="/_next/static/css/824406bfec680877c871.css" as="style"/><link rel="stylesheet" href="/_next/static/css/824406bfec680877c871.css" data-n-g=""/><link rel="preload" href="/_next/static/css/3dd4d340904c9260f6d8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3dd4d340904c9260f6d8.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-ddd010a953737b6e3536.js" defer=""></script><script src="/_next/static/chunks/framework-895f067827ebe11ffe45.js" defer=""></script><script src="/_next/static/chunks/main-222191e14496d29481e0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-99b66f93221fbb7f4a73.js" defer=""></script><script src="/_next/static/chunks/404-d5935ede064e9f79c1b7.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-451cfbeca75d2f1e006e.js" defer=""></script><script src="/_next/static/G5eXQ8z6A3k3-xRBvlX_5/_buildManifest.js" defer=""></script><script src="/_next/static/G5eXQ8z6A3k3-xRBvlX_5/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css-global 1ob364s">html{--theme-ui-colors-primary:#307AC6;--theme-ui-colors-secondary:#27a727;--theme-ui-colors-background:#fff;--theme-ui-colors-text:#1b1e21;--theme-ui-colors-blue:#4169e1;--theme-ui-colors-cyan:#41b9e1;--theme-ui-colors-gray:#667788;--theme-ui-colors-green:#27a727;--theme-ui-colors-purple:#6941e1;--theme-ui-colors-orange:#fba100;--theme-ui-colors-pink:#e141b9;--theme-ui-colors-red:#ee5555;--theme-ui-colors-white:#fff;--theme-ui-colors-yellow:#FFDD22;--theme-ui-colors-lite:#eee;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-__default{--theme-ui-colors-primary:#307AC6;--theme-ui-colors-secondary:#27a727;--theme-ui-colors-background:#fff;--theme-ui-colors-text:#1b1e21;--theme-ui-colors-blue:#4169e1;--theme-ui-colors-cyan:#41b9e1;--theme-ui-colors-gray:#667788;--theme-ui-colors-green:#27a727;--theme-ui-colors-purple:#6941e1;--theme-ui-colors-orange:#fba100;--theme-ui-colors-pink:#e141b9;--theme-ui-colors-red:#ee5555;--theme-ui-colors-white:#fff;--theme-ui-colors-yellow:#FFDD22;--theme-ui-colors-lite:#eee;}html.theme-ui-dark{--theme-ui-colors-text:#fff;--theme-ui-colors-background:#292C34;--theme-ui-colors-lite:#333;--theme-ui-colors-primary:#85DEFB;}</style><style data-emotion="css-global 0"></style><style data-emotion="css 1td7120">.css-1td7120{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin:auto;position:relative;max-width:800px;}</style><div class="css-1td7120"><style data-emotion="css eim2bq">.css-eim2bq{box-sizing:border-box;margin:0;min-width:0;padding:16px;position:absolute;top:0;right:0;opacity:0;-webkit-transition:opacity .25s ease-in-out;transition:opacity .25s ease-in-out;}</style><div class="css-eim2bq"><style data-emotion="css jakyet">.css-jakyet{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;display:inline-block;text-align:center;line-height:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:inherit;padding-left:16px;padding-right:16px;padding-top:8px;padding-bottom:8px;color:var(--theme-ui-colors-white);background-color:var(--theme-ui-colors-primary);border:0;border-radius:4px;color:var(--theme-ui-colors-background);background-color:var(--theme-ui-colors-primary);background-color:var(--theme-ui-colors-gray);padding-top:4px;padding-bottom:4px;padding-left:8px;padding-right:8px;font-size:16px;cursor:pointer;}.css-jakyet:hover{background-color:var(--theme-ui-colors-text);}</style><button class="css-jakyet">light<!-- --> mode</button></div><style data-emotion="css 1doo0ju">.css-1doo0ju{box-sizing:border-box;margin:0;min-width:0;padding-top:32px;}</style><header class="css-1doo0ju"><style data-emotion="css 1n35gdr">.css-1n35gdr{box-sizing:border-box;margin:0;min-width:0;font-family:Montserrat,sans-serif;font-weight:900;line-height:1.1;font-size:30px;padding-bottom:32px;padding-left:16px;padding-right:16px;font-weight:900;}@media screen and (min-width: 32em){.css-1n35gdr{padding-left:32px;padding-right:32px;}}</style><h1 class="css-1n35gdr"><style data-emotion="css 1ie6k50">.css-1ie6k50{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-text);}</style><a href="/" class="css-1ie6k50">♾️ loophole letters</a></h1></header><style data-emotion="css td0gup">.css-td0gup{box-sizing:border-box;margin:0;min-width:0;padding-left:16px;padding-right:16px;padding-bottom:0;}@media screen and (min-width: 32em){.css-td0gup{padding-left:32px;padding-right:32px;}}</style><main class="css-td0gup"><style data-emotion="css vurnku">.css-vurnku{box-sizing:border-box;margin:0;min-width:0;}</style><article class="css-vurnku"><style data-emotion="css 1hep91p">.css-1hep91p{box-sizing:border-box;margin:0;min-width:0;float:right;}</style><div class="css-1hep91p"><style data-emotion="css 1f7qs6g">.css-1f7qs6g{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;display:inline-block;text-align:center;line-height:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:inherit;padding-left:16px;padding-right:16px;padding-top:8px;padding-bottom:8px;color:var(--theme-ui-colors-white);background-color:var(--theme-ui-colors-primary);border:0;border-radius:4px;color:var(--theme-ui-colors-primary);border:1px solid var(--theme-ui-colors-primary);background-color:var(--theme-ui-colors-background);display:inline;margin-right:4px;}</style><button class="css-1f7qs6g">music theory</button></div><style data-emotion="css 108j34h">.css-108j34h{box-sizing:border-box;margin:0;min-width:0;font-family:Montserrat,sans-serif;font-weight:900;line-height:1.1;font-size:40px;}</style><h2 class="css-108j34h">Chords and Scales</h2><style data-emotion="css 188b938">.css-188b938{box-sizing:border-box;margin:0;min-width:0;font-family:'Merriweather','Georgia',serif;font-weight:400;line-height:1.75;margin-bottom:32px;color:var(--theme-ui-colors-gray);font-style:italic;}</style><p class="css-188b938">March 27, 2020</p><div class="css-vurnku"><style data-emotion="css 1i3mtem">.css-1i3mtem{font-size:16px;font-weight:400;line-height:1.75;font-family:'Merriweather','Georgia',serif;}</style><p class="css-1i3mtem">Let&#x27;s use the SVG Piano to display chords. My favourite lib for music theory in javascript is <style data-emotion="css 1e6egy8">.css-1e6egy8{color:var(--theme-ui-colors-primary);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;}</style><a target="_blank" href="https://github.com/tonaljs/tonal" class="css-1e6egy8">tonal</a>.
It comes with a dictionary that contains all more or less common chords. We will use that to build a simple chord selection.
To get the notes of a chord on a certain root, we can do it like this:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// we can get all chord symbols with ChordType.names()</span>
<span class="token keyword">function</span> <span class="token function">getChordNotes</span><span class="token punctuation">(</span><span class="token parameter">tonic<span class="token punctuation">,</span> symbol</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token maybe-class-name">ChordType</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">intervals</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">interval</span> <span class="token arrow operator">=&gt;</span>
    <span class="token maybe-class-name">Note</span><span class="token punctuation">.</span><span class="token method function property-access">transpose</span><span class="token punctuation">(</span>tonic<span class="token punctuation">,</span> interval<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p class="css-1i3mtem">If we combine this with our svg piano, and some mouse events + colorization + labels, we can build this:</p>
<select><option selected="">C</option><option>D</option><option>E</option><option>F</option><option>G</option><option>A</option><option>B</option><option>Cb</option><option>Db</option><option>Eb</option><option>Fb</option><option>Gb</option><option>Ab</option><option>Bb</option><option>C#</option><option>D#</option><option>E#</option><option>F#</option><option>G#</option><option>A#</option><option>B#</option></select><select><option>fifth</option><option>suspended fourth</option><option>suspended fourth seventh</option><option>augmented</option><option>major seventh flat sixth</option><option>augmented seventh</option><option selected="">major</option><option>major seventh</option><option>dominant seventh</option><option>sixth</option><option>major seventh sharp eleventh</option><option>lydian dominant seventh</option><option>minor augmented</option><option>minor</option><option>minor/major seventh</option><option>minor seventh</option><option>minor sixth</option><option>diminished</option><option>half-diminished</option><option>diminished seventh</option><option>dominant sharp ninth</option><option>suspended second</option><option>eleventh</option><option>major ninth</option><option>dominant ninth</option><option>sixth/ninth</option><option>major thirteenth</option><option>dominant thirteenth</option><option>major sharp eleventh (lydian)</option><option>minor/major ninth</option><option>minor ninth</option><option>minor thirteenth</option><option>minor eleventh</option><option>suspended fourth flat ninth</option><option>altered</option><option>dominant flat ninth</option></select><button>play</button><br/><svg width="757" height="292"><polygon points="1,2 1,202 1,202 1,292 48.2,292 48.2,202 48.2,202 48.2,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="48.19999999999999,2 48.19999999999999,202 48.19999999999999,202 48.19999999999999,292 95.39999999999999,292 95.39999999999999,202 78.29999999999998,202 78.29999999999998,2" style="fill:yellow;stroke:#39383D;stroke-width:1"></polygon><circle cx="71.79999999999998" cy="275.73333333333335" r="10.7" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="71.79999999999998" y="279.3" text-anchor="middle" font-size="10.7" font-family="helvetica" value="C3" style="pointer-events:none;user-select:none">C3</text><polygon points="78.3,2 78.3,202 78.3,202 78.3,202 103.69999999999999,202 103.69999999999999,202 103.69999999999999,202 103.69999999999999,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="103.69999999999997,2 103.69999999999997,202 95.39999999999998,202 95.39999999999998,292 142.59999999999997,292 142.59999999999997,202 134.29999999999998,202 134.29999999999998,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="134.3,2 134.3,202 134.3,202 134.3,202 159.70000000000002,202 159.70000000000002,202 159.70000000000002,202 159.70000000000002,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="159.69999999999996,2 159.69999999999996,202 142.59999999999997,202 142.59999999999997,292 189.79999999999995,292 189.79999999999995,202 189.79999999999995,202 189.79999999999995,2" style="fill:yellow;stroke:#39383D;stroke-width:1"></polygon><circle cx="166.19999999999996" cy="275.73333333333335" r="10.7" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="166.19999999999996" y="279.3" text-anchor="middle" font-size="10.7" font-family="helvetica" value="E3" style="pointer-events:none;user-select:none">E3</text><polygon points="189.79999999999995,2 189.79999999999995,202 189.79999999999995,202 189.79999999999995,292 236.99999999999994,292 236.99999999999994,202 217.69999999999996,202 217.69999999999996,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="217.70000000000002,2 217.70000000000002,202 217.70000000000002,202 217.70000000000002,202 243.10000000000002,202 243.10000000000002,202 243.10000000000002,202 243.10000000000002,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="243.1,2 243.1,202 237,202 237,292 284.2,292 284.2,202 271.5,202 271.5,2" style="fill:yellow;stroke:#39383D;stroke-width:1"></polygon><circle cx="260.6" cy="275.73333333333335" r="10.7" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="260.6" y="279.3" text-anchor="middle" font-size="10.7" font-family="helvetica" value="G3" style="pointer-events:none;user-select:none">G3</text><polygon points="271.5,2 271.5,202 271.5,202 271.5,202 296.9,202 296.9,202 296.9,202 296.9,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="296.90000000000003,2 296.90000000000003,202 284.20000000000005,202 284.20000000000005,292 331.40000000000003,292 331.40000000000003,202 325.30000000000007,202 325.30000000000007,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="325.3,2 325.3,202 325.3,202 325.3,202 350.7,202 350.7,202 350.7,202 350.7,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="350.7,2 350.7,202 331.4,202 331.4,292 378.59999999999997,292 378.59999999999997,202 378.59999999999997,202 378.59999999999997,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="378.6,2 378.6,202 378.6,202 378.6,292 425.8,292 425.8,202 408.70000000000005,202 408.70000000000005,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="408.7,2 408.7,202 408.7,202 408.7,202 434.09999999999997,202 434.09999999999997,202 434.09999999999997,202 434.09999999999997,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="434.09999999999997,2 434.09999999999997,202 425.79999999999995,202 425.79999999999995,292 472.99999999999994,292 472.99999999999994,202 464.69999999999993,202 464.69999999999993,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="464.7,2 464.7,202 464.7,202 464.7,202 490.09999999999997,202 490.09999999999997,202 490.09999999999997,202 490.09999999999997,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="490.1,2 490.1,202 473,202 473,292 520.2,292 520.2,202 520.2,202 520.2,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="520.2,2 520.2,202 520.2,202 520.2,292 567.4000000000001,292 567.4000000000001,202 548.1,202 548.1,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="548.0999999999999,2 548.0999999999999,202 548.0999999999999,202 548.0999999999999,202 573.4999999999999,202 573.4999999999999,202 573.4999999999999,202 573.4999999999999,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="573.5,2 573.5,202 567.4,202 567.4,292 614.6,292 614.6,202 601.9,202 601.9,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="601.8999999999999,2 601.8999999999999,202 601.8999999999999,202 601.8999999999999,202 627.2999999999998,202 627.2999999999998,202 627.2999999999998,202 627.2999999999998,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="627.3000000000001,2 627.3000000000001,202 614.6,202 614.6,292 661.8000000000001,292 661.8000000000001,202 655.7,202 655.7,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="655.6999999999998,2 655.6999999999998,202 655.6999999999998,202 655.6999999999998,202 681.0999999999998,202 681.0999999999998,202 681.0999999999998,202 681.0999999999998,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="681.0999999999999,2 681.0999999999999,202 661.8,202 661.8,292 709,292 709,202 709,202 709,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon><polygon points="709,2 709,202 709,202 709,292 756.2,292 756.2,202 756.2,202 756.2,2" style="fill:#F2F2EF;stroke:#39383D;stroke-width:1"></polygon></svg>
<style data-emotion="css 12ewxln">.css-12ewxln{box-sizing:border-box;margin:0;min-width:0;font-family:Montserrat,sans-serif;font-weight:900;line-height:1.1;margin-bottom:8px;margin-top:32px;}</style><h2 id="scales--step-chords" class="css-12ewxln"><a aria-hidden="true" tabindex="-1" class="css-1e6egy8"><span class="icon icon-link"></span></a>Scales + Step Chords</h2>
<p class="css-1i3mtem">Tonal also knows scales:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getScaleWithNumerals</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> scale <span class="token operator">=</span> <span class="token maybe-class-name">Scale</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>root<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> numerals <span class="token operator">=</span> scale<span class="token punctuation">.</span><span class="token property-access">intervals</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span>
    <span class="token parameter">interval</span> <span class="token arrow operator">=&gt;</span> <span class="token maybe-class-name">RomanNumeral</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token maybe-class-name">Interval</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">name</span>
  <span class="token punctuation">)</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span>scale<span class="token punctuation">,</span> numerals <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p class="css-1i3mtem">It would be cool to trigger step chords with the mouse.
A step chord is nothing but a every other note in the scale starting from any note in the scale:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// variables obtained from getScaleWithNumerals:</span>
<span class="token comment">// notes = pitches in scale</span>
<span class="token comment">// intervals = intervals of scale</span>
<span class="token keyword">function</span> <span class="token function">getStepChord</span><span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> count <span class="token operator">=</span> <span class="token number">3</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> chordNotes <span class="token operator">=</span> <span class="token punctuation">[</span>root<span class="token punctuation">]</span>
  <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> lastNote <span class="token operator">=</span> chordNotes<span class="token punctuation">[</span>chordNotes<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">const</span> index <span class="token operator">=</span> notes<span class="token punctuation">.</span><span class="token method function property-access">indexOf</span><span class="token punctuation">(</span><span class="token maybe-class-name">Note</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>lastNote<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">pc</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> nextIndex <span class="token operator">=</span> index <span class="token operator">+</span> <span class="token number">2</span>
    <span class="token keyword">let</span> nextInterval <span class="token operator">=</span> intervals<span class="token punctuation">[</span>nextIndex <span class="token operator">%</span> intervals<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">]</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>nextIndex <span class="token operator">&gt;</span> intervals<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      nextInterval <span class="token operator">=</span> <span class="token maybe-class-name">Interval</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>nextInterval<span class="token punctuation">,</span> <span class="token string">&quot;8P&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// make next interval relative to current root</span>
    nextInterval <span class="token operator">=</span> <span class="token maybe-class-name">Interval</span><span class="token punctuation">.</span><span class="token method function property-access">substract</span><span class="token punctuation">(</span>nextInterval<span class="token punctuation">,</span> intervals<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> nextNote <span class="token operator">=</span> <span class="token maybe-class-name">Note</span><span class="token punctuation">.</span><span class="token method function property-access">transpose</span><span class="token punctuation">(</span>lastNote<span class="token punctuation">,</span> nextInterval<span class="token punctuation">)</span>
    chordNotes<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>nextNote<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> chordNotes
<span class="token punctuation">}</span>
</code></pre>
<p class="css-1i3mtem">Disabling all keys that are not in scale + applying coloring (blue = scale note, yellow = played note).
Make sure you try more than one note to let the magic happen!</p>
<select><option selected="">C</option><option>D</option><option>E</option><option>F</option><option>G</option><option>A</option><option>B</option><option>Cb</option><option>Db</option><option>Eb</option><option>Fb</option><option>Gb</option><option>Ab</option><option>Bb</option><option>C#</option><option>D#</option><option>E#</option><option>F#</option><option>G#</option><option>A#</option><option>B#</option></select><select><option>major pentatonic</option><option>ionian pentatonic</option><option>mixolydian pentatonic</option><option>ritusen</option><option>egyptian</option><option>neopolitan major pentatonic</option><option>vietnamese 1</option><option>pelog</option><option>kumoijoshi</option><option>hirajoshi</option><option>iwato</option><option>in-sen</option><option>lydian pentatonic</option><option>malkos raga</option><option>locrian pentatonic</option><option>minor pentatonic</option><option>minor six pentatonic</option><option>flat three pentatonic</option><option>flat six pentatonic</option><option>scriabin</option><option>whole tone pentatonic</option><option>lydian #5P pentatonic</option><option>lydian dominant pentatonic</option><option>minor #7M pentatonic</option><option>super locrian pentatonic</option><option>minor hexatonic</option><option>augmented</option><option>major blues</option><option>piongio</option><option>prometheus neopolitan</option><option>prometheus</option><option>mystery #1</option><option>six tone symmetric</option><option>whole tone</option><option>messiaen&#x27;s mode #5</option><option>minor blues</option><option>locrian major</option><option>double harmonic lydian</option><option>harmonic minor</option><option>altered</option><option>locrian #2</option><option>mixolydian b6</option><option>lydian dominant</option><option>lydian</option><option>lydian augmented</option><option>dorian b2</option><option>melodic minor</option><option>locrian</option><option>ultralocrian</option><option>locrian 6</option><option>augmented heptatonic</option><option>romanian minor</option><option>dorian #4</option><option>lydian diminished</option><option>phrygian</option><option>leading whole tone</option><option>lydian minor</option><option>phrygian dominant</option><option>balinese</option><option>neopolitan major</option><option>aeolian</option><option>harmonic major</option><option>double harmonic major</option><option>dorian</option><option>hungarian minor</option><option>hungarian major</option><option>oriental</option><option>flamenco</option><option>todi raga</option><option>mixolydian</option><option>persian</option><option selected="">major</option><option>enigmatic</option><option>major augmented</option><option>lydian #9</option><option>messiaen&#x27;s mode #4</option><option>purvi raga</option><option>spanish heptatonic</option><option>bebop</option><option>bebop minor</option><option>bebop major</option><option>bebop locrian</option><option>minor bebop</option><option>diminished</option><option>ichikosucho</option><option>minor six diminished</option><option>half-whole diminished</option><option>kafi raga</option><option>messiaen&#x27;s mode #6</option><option>composite blues</option><option>messiaen&#x27;s mode #3</option><option>messiaen&#x27;s mode #7</option><option>chromatic</option></select><select><option selected="" value="1">1 note</option><option value="2">2 notes</option><option value="3">3 notes</option><option value="4">4 notes</option><option value="5">5 notes</option><option value="6">6 notes</option><option value="7">7 notes</option></select><br/><svg width="708" height="191"><polygon points="1,2 1,132 1,132 1,190.5 31.680000000000003,190.5 31.680000000000003,132 31.680000000000003,132 31.680000000000003,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="31.679999999999993,2 31.679999999999993,132 31.679999999999993,132 31.679999999999993,190.5 62.36,190.5 62.36,132 51.24499999999999,132 51.24499999999999,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><circle cx="47.019999999999996" cy="179.22666666666666" r="6.955" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="47.019999999999996" y="181.545" text-anchor="middle" font-size="6.955" font-family="helvetica" value="I" style="pointer-events:none;user-select:none">I</text><polygon points="51.245,2 51.245,132 51.245,132 51.245,132 67.755,132 67.755,132 67.755,132 67.755,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="67.75499999999998,2 67.75499999999998,132 62.359999999999985,132 62.359999999999985,190.5 93.03999999999999,190.5 93.03999999999999,132 87.64499999999998,132 87.64499999999998,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><circle cx="77.69999999999999" cy="179.22666666666666" r="6.955" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="77.69999999999999" y="181.545" text-anchor="middle" font-size="6.955" font-family="helvetica" value="II" style="pointer-events:none;user-select:none">II</text><polygon points="87.64500000000001,2 87.64500000000001,132 87.64500000000001,132 87.64500000000001,132 104.155,132 104.155,132 104.155,132 104.155,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="104.15499999999997,2 104.15499999999997,132 93.03999999999998,132 93.03999999999998,190.5 123.71999999999998,190.5 123.71999999999998,132 123.71999999999998,132 123.71999999999998,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><circle cx="108.37999999999998" cy="179.22666666666666" r="6.955" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="108.37999999999998" y="181.545" text-anchor="middle" font-size="6.955" font-family="helvetica" value="III" style="pointer-events:none;user-select:none">III</text><polygon points="123.71999999999997,2 123.71999999999997,132 123.71999999999997,132 123.71999999999997,190.5 154.39999999999998,190.5 154.39999999999998,132 141.85499999999996,132 141.85499999999996,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><circle cx="139.05999999999997" cy="179.22666666666666" r="6.955" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="139.05999999999997" y="181.545" text-anchor="middle" font-size="6.955" font-family="helvetica" value="IV" style="pointer-events:none;user-select:none">IV</text><polygon points="141.85500000000002,2 141.85500000000002,132 141.85500000000002,132 141.85500000000002,132 158.365,132 158.365,132 158.365,132 158.365,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="158.365,2 158.365,132 154.4,132 154.4,190.5 185.08,190.5 185.08,132 176.82500000000002,132 176.82500000000002,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><circle cx="169.74" cy="179.22666666666666" r="6.955" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="169.74" y="181.545" text-anchor="middle" font-size="6.955" font-family="helvetica" value="V" style="pointer-events:none;user-select:none">V</text><polygon points="176.82500000000002,2 176.82500000000002,132 176.82500000000002,132 176.82500000000002,132 193.335,132 193.335,132 193.335,132 193.335,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="193.33500000000004,2 193.33500000000004,132 185.08000000000004,132 185.08000000000004,190.5 215.76000000000005,190.5 215.76000000000005,132 211.79500000000004,132 211.79500000000004,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><circle cx="200.42000000000004" cy="179.22666666666666" r="6.955" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="200.42000000000004" y="181.545" text-anchor="middle" font-size="6.955" font-family="helvetica" value="VI" style="pointer-events:none;user-select:none">VI</text><polygon points="211.79500000000002,2 211.79500000000002,132 211.79500000000002,132 211.79500000000002,132 228.305,132 228.305,132 228.305,132 228.305,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="228.305,2 228.305,132 215.76,132 215.76,190.5 246.44,190.5 246.44,132 246.44,132 246.44,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><circle cx="231.1" cy="179.22666666666666" r="6.955" fill="white" stroke="#39383D" stroke-width="1" style="pointer-events:none"></circle><text x="231.1" y="181.545" text-anchor="middle" font-size="6.955" font-family="helvetica" value="VII" style="pointer-events:none;user-select:none">VII</text><polygon points="246.44000000000003,2 246.44000000000003,132 246.44000000000003,132 246.44000000000003,190.5 277.12,190.5 277.12,132 266.00500000000005,132 266.00500000000005,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="266.005,2 266.005,132 266.005,132 266.005,132 282.515,132 282.515,132 282.515,132 282.515,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="282.515,2 282.515,132 277.12,132 277.12,190.5 307.8,190.5 307.8,132 302.40500000000003,132 302.40500000000003,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="302.40500000000003,2 302.40500000000003,132 302.40500000000003,132 302.40500000000003,132 318.915,132 318.915,132 318.915,132 318.915,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="318.915,2 318.915,132 307.8,132 307.8,190.5 338.48,190.5 338.48,132 338.48,132 338.48,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="338.48,2 338.48,132 338.48,132 338.48,190.5 369.16,190.5 369.16,132 356.615,132 356.615,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="356.61499999999995,2 356.61499999999995,132 356.61499999999995,132 356.61499999999995,132 373.12499999999994,132 373.12499999999994,132 373.12499999999994,132 373.12499999999994,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="373.125,2 373.125,132 369.16,132 369.16,190.5 399.84000000000003,190.5 399.84000000000003,132 391.58500000000004,132 391.58500000000004,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="391.5849999999999,2 391.5849999999999,132 391.5849999999999,132 391.5849999999999,132 408.0949999999999,132 408.0949999999999,132 408.0949999999999,132 408.0949999999999,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="408.095,2 408.095,132 399.84000000000003,132 399.84000000000003,190.5 430.52000000000004,190.5 430.52000000000004,132 426.555,132 426.555,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="426.5549999999999,2 426.5549999999999,132 426.5549999999999,132 426.5549999999999,132 443.0649999999999,132 443.0649999999999,132 443.0649999999999,132 443.0649999999999,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="443.065,2 443.065,132 430.52,132 430.52,190.5 461.2,190.5 461.2,132 461.2,132 461.2,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="461.2,2 461.2,132 461.2,132 461.2,190.5 491.88,190.5 491.88,132 480.765,132 480.765,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="480.7649999999999,2 480.7649999999999,132 480.7649999999999,132 480.7649999999999,132 497.27499999999986,132 497.27499999999986,132 497.27499999999986,132 497.27499999999986,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="497.27500000000003,2 497.27500000000003,132 491.88000000000005,132 491.88000000000005,190.5 522.5600000000001,190.5 522.5600000000001,132 517.1650000000001,132 517.1650000000001,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="517.1649999999998,2 517.1649999999998,132 517.1649999999998,132 517.1649999999998,132 533.6749999999998,132 533.6749999999998,132 533.6749999999998,132 533.6749999999998,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="533.6750000000001,2 533.6750000000001,132 522.5600000000001,132 522.5600000000001,190.5 553.24,190.5 553.24,132 553.24,132 553.24,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="553.2400000000001,2 553.2400000000001,132 553.2400000000001,132 553.2400000000001,190.5 583.9200000000001,190.5 583.9200000000001,132 571.3750000000001,132 571.3750000000001,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="571.3749999999999,2 571.3749999999999,132 571.3749999999999,132 571.3749999999999,132 587.8849999999999,132 587.8849999999999,132 587.8849999999999,132 587.8849999999999,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="587.885,2 587.885,132 583.92,132 583.92,190.5 614.5999999999999,190.5 614.5999999999999,132 606.3449999999999,132 606.3449999999999,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="606.3449999999998,2 606.3449999999998,132 606.3449999999998,132 606.3449999999998,132 622.8549999999998,132 622.8549999999998,132 622.8549999999998,132 622.8549999999998,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="622.855,2 622.855,132 614.6,132 614.6,190.5 645.28,190.5 645.28,132 641.315,132 641.315,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="641.3149999999998,2 641.3149999999998,132 641.3149999999998,132 641.3149999999998,132 657.8249999999998,132 657.8249999999998,132 657.8249999999998,132 657.8249999999998,2" style="fill:#39383D;stroke:#39383D;stroke-width:1"></polygon><polygon points="657.825,2 657.825,132 645.2800000000001,132 645.2800000000001,190.5 675.96,190.5 675.96,132 675.96,132 675.96,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon><polygon points="675.96,2 675.96,132 675.96,132 675.96,190.5 706.64,190.5 706.64,132 706.64,132 706.64,2" style="fill:lightblue;stroke:#39383D;stroke-width:1"></polygon></svg></div></article></main><style data-emotion="css btp6j1">.css-btp6j1{box-sizing:border-box;margin:0;min-width:0;padding:32px;color:#666;text-align:center;font-size:18px;}</style><div class="css-btp6j1"><style data-emotion="css i57cvr">.css-i57cvr{box-sizing:border-box;margin:0;min-width:0;margin-left:16px;margin-right:16px;display:inline-block;}</style><span class="css-i57cvr">Created by <a href="https://github.com/felixroos" class="css-1e6egy8">Felix Roos</a></span></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"Chords and Scales","date":"2020-03-27","tags":["music theory"],"description":"Let's use the SVG Piano to display chords.","image":"./img/chords-scales.png"},"code":"var Component=(()=\u003e{var Jd=Object.create;var so=Object.defineProperty;var tp=Object.getOwnPropertyDescriptor;var ep=Object.getOwnPropertyNames;var np=Object.getPrototypeOf,sp=Object.prototype.hasOwnProperty;var yu=o=\u003eso(o,\"__esModule\",{value:!0});var Kt=(o,r)=\u003e()=\u003e(r||o((r={exports:{}}).exports,r),r.exports),ip=(o,r)=\u003e{yu(o);for(var a in r)so(o,a,{get:r[a],enumerable:!0})},rp=(o,r,a)=\u003e{if(r\u0026\u0026typeof r==\"object\"||typeof r==\"function\")for(let u of ep(r))!sp.call(o,u)\u0026\u0026u!==\"default\"\u0026\u0026so(o,u,{get:()=\u003er[u],enumerable:!(a=tp(r,u))||a.enumerable});return o},Be=o=\u003erp(yu(so(o!=null?Jd(np(o)):{},\"default\",o\u0026\u0026o.__esModule\u0026\u0026\"default\"in o?{get:()=\u003eo.default,enumerable:!0}:{value:o,enumerable:!0})),o);var wu=Kt((tf,bu)=\u003e{bu.exports=_jsx_runtime});var Ee=Kt((io,xu)=\u003e{(function(o,r){typeof io==\"object\"\u0026\u0026typeof xu!=\"undefined\"?r(io):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Core={}))})(io,function(o){\"use strict\";var r=function(Z,lt){return Array(Math.abs(lt)+1).join(Z)};function a(Z,lt,xt){return function(){for(var Mt=[],Tt=0;Tt\u003carguments.length;Tt++)Mt[Tt]=arguments[Tt];return console.warn(Z+\" is deprecated. Use \"+lt+\".\"),xt.apply(this,Mt)}}function u(Z){return Z!==null\u0026\u0026typeof Z==\"object\"\u0026\u0026typeof Z.name==\"string\"}function d(Z){return Z!==null\u0026\u0026typeof Z==\"object\"\u0026\u0026typeof Z.step==\"number\"\u0026\u0026typeof Z.alt==\"number\"}var m=[0,2,4,-1,1,3,5],_=m.map(function(Z){return Math.floor(Z*7/12)});function T(Z){var lt=Z.step,xt=Z.alt,Mt=Z.oct,Tt=Z.dir,gt=Tt===void 0?1:Tt,Bt=m[lt]+7*xt;if(Mt===void 0)return[gt*Bt];var Qt=Mt-_[lt]-4*xt;return[gt*Bt,gt*Qt]}var k=[3,0,4,1,5,2,6];function D(Z){var lt=Z[0],xt=Z[1],Mt=Z[2],Tt=k[O(lt)],gt=Math.floor((lt+1)/7);if(xt===void 0)return{step:Tt,alt:gt,dir:Mt};var Bt=xt+4*gt+_[Tt];return{step:Tt,alt:gt,oct:Bt,dir:Mt}}function O(Z){var lt=(Z+1)%7;return lt\u003c0?7+lt:lt}var A={empty:!0,name:\"\",pc:\"\",acc:\"\"},N=new Map,U=function(Z){return\"CDEFGAB\".charAt(Z)},z=function(Z){return Z\u003c0?r(\"b\",-Z):r(\"#\",Z)},X=function(Z){return Z[0]===\"b\"?-Z.length:Z.length};function K(Z){var lt=N.get(Z);if(lt)return lt;var xt=typeof Z==\"string\"?B(Z):d(Z)?K(F(Z)):u(Z)?K(Z.name):A;return N.set(Z,xt),xt}var $=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\\d*)\\s*(.*)$/;function Y(Z){var lt=$.exec(Z);return[lt[1].toUpperCase(),lt[2].replace(/x/g,\"##\"),lt[3],lt[4]]}function st(Z){return K(D(Z))}var R=function(Z,lt){return(Z%lt+lt)%lt},P=[0,2,4,5,7,9,11];function B(Z){var lt=Y(Z);if(lt[0]===\"\"||lt[3]!==\"\")return A;var xt=lt[0],Mt=lt[1],Tt=lt[2],gt=(xt.charCodeAt(0)+3)%7,Bt=X(Mt),Qt=Tt.length?+Tt:void 0,Ie=T({step:gt,alt:Bt,oct:Qt}),jn=xt+Mt+Tt,Ue=xt+Mt,mn=(P[gt]+Bt+120)%12,gn=Qt===void 0?R(P[gt]+Bt,12)-12*99:P[gt]+Bt+12*(Qt+1),vs=gn\u003e=0\u0026\u0026gn\u003c=127?gn:null,_s=Qt===void 0?null:Math.pow(2,(gn-69)/12)*440;return{empty:!1,acc:Mt,alt:Bt,chroma:mn,coord:Ie,freq:_s,height:gn,letter:xt,midi:vs,name:jn,oct:Qt,pc:Ue,step:gt}}function F(Z){var lt=Z.step,xt=Z.alt,Mt=Z.oct,Tt=U(lt);if(!Tt)return\"\";var gt=Tt+z(xt);return Mt||Mt===0?gt+Mt:gt}var tt={empty:!0,name:\"\",acc:\"\"},at=\"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\",pt=\"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\",Dt=new RegExp(\"^\"+at+\"|\"+pt+\"$\");function jt(Z){var lt=Dt.exec(\"\"+Z);return lt===null?[\"\",\"\"]:lt[1]?[lt[1],lt[2]]:[lt[4],lt[3]]}var Ht={};function re(Z){return typeof Z==\"string\"?Ht[Z]||(Ht[Z]=it(Z)):d(Z)?re(rt(Z)):u(Z)?re(Z.name):tt}var L=[0,2,4,5,7,9,11],J=\"PMMPPMM\";function it(Z){var lt=jt(Z);if(lt[0]===\"\")return tt;var xt=+lt[0],Mt=lt[1],Tt=(Math.abs(xt)-1)%7,gt=J[Tt];if(gt===\"M\"\u0026\u0026Mt===\"P\")return tt;var Bt=gt===\"M\"?\"majorable\":\"perfectable\",Qt=\"\"+xt+Mt,Ie=xt\u003c0?-1:1,jn=xt===8||xt===-8?xt:Ie*(Tt+1),Ue=ht(Bt,Mt),mn=Math.floor((Math.abs(xt)-1)/7),gn=Ie*(L[Tt]+Ue+12*mn),vs=(Ie*(L[Tt]+Ue)%12+12)%12,_s=T({step:Tt,alt:Ue,oct:mn,dir:Ie});return{empty:!1,name:Qt,num:xt,q:Mt,step:Tt,alt:Ue,dir:Ie,type:Bt,simple:jn,semitones:gn,chroma:vs,coord:_s,oct:mn}}function et(Z){var lt=Z[0],xt=Z[1],Mt=xt===void 0?0:xt,Tt=lt*7+Mt*12\u003c0,gt=Tt?[-lt,-Mt,-1]:[lt,Mt,1];return re(D(gt))}function ht(Z,lt){return lt===\"M\"\u0026\u0026Z===\"majorable\"||lt===\"P\"\u0026\u0026Z===\"perfectable\"?0:lt===\"m\"\u0026\u0026Z===\"majorable\"?-1:/^A+$/.test(lt)?lt.length:/^d+$/.test(lt)?-1*(Z===\"perfectable\"?lt.length:lt.length+1):0}function rt(Z){var lt=Z.step,xt=Z.alt,Mt=Z.oct,Tt=Mt===void 0?0:Mt,gt=Z.dir;if(!gt)return\"\";var Bt=lt+1+7*Tt,Qt=gt\u003c0?\"-\":\"\",Ie=J[lt]===\"M\"?\"majorable\":\"perfectable\",jn=Qt+Bt+At(Ie,xt);return jn}function At(Z,lt){return lt===0?Z===\"majorable\"?\"M\":\"P\":lt===-1\u0026\u0026Z===\"majorable\"?\"m\":lt\u003e0?r(\"A\",lt):r(\"d\",Z===\"perfectable\"?lt:lt+1)}function Gt(Z,lt){var xt=K(Z),Mt=re(lt);if(xt.empty||Mt.empty)return\"\";var Tt=xt.coord,gt=Mt.coord,Bt=Tt.length===1?[Tt[0]+gt[0]]:[Tt[0]+gt[0],Tt[1]+gt[1]];return st(Bt).name}function le(Z,lt){var xt=K(Z),Mt=K(lt);if(xt.empty||Mt.empty)return\"\";var Tt=xt.coord,gt=Mt.coord,Bt=gt[0]-Tt[0],Qt=Tt.length===2\u0026\u0026gt.length===2?gt[1]-Tt[1]:-Math.floor(Bt*7/12);return et([Bt,Qt]).name}o.accToAlt=X,o.altToAcc=z,o.coordToInterval=et,o.coordToNote=st,o.decode=D,o.deprecate=a,o.distance=le,o.encode=T,o.fillStr=r,o.interval=re,o.isNamed=u,o.isPitch=d,o.note=K,o.stepToLetter=U,o.tokenizeInterval=jt,o.tokenizeNote=Y,o.transpose=Gt,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Su=Kt((ro,Tu)=\u003e{(function(o,r){typeof ro==\"object\"\u0026\u0026typeof Tu!=\"undefined\"?r(ro,Ee()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/core\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.AbcNotation={},o.core))})(ro,function(o,r){\"use strict\";var a=function(O,A){return Array(A+1).join(O)},u=/^(_{1,}|=|\\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function d(O){var A=u.exec(O);return A?[A[1],A[2],A[3]]:[\"\",\"\",\"\"]}function m(O){var A=d(O),N=A[0],U=A[1],z=A[2];if(U===\"\")return\"\";for(var X=4,K=0;K\u003cz.length;K++)X+=z.charAt(K)===\",\"?-1:1;var $=N[0]===\"_\"?N.replace(/_/g,\"b\"):N[0]===\"^\"?N.replace(/\\^/g,\"#\"):\"\";return U.charCodeAt(0)\u003e96?U.toUpperCase()+$+(X+1):U+$+X}function _(O){var A=r.note(O);if(A.empty||!A.oct\u0026\u0026A.oct!==0)return\"\";var N=A.letter,U=A.acc,z=A.oct,X=U[0]===\"b\"?U.replace(/b/g,\"_\"):U.replace(/#/g,\"^\"),K=z\u003e4?N.toLowerCase():N,$=z===5?\"\":z\u003e4?a(\"'\",z-5):a(\",\",4-z);return X+K+$}function T(O,A){return _(r.transpose(m(O),A))}function k(O,A){return r.distance(m(O),m(A))}var D={abcToScientificNotation:m,scientificToAbcNotation:_,tokenize:d,transpose:T,distance:k};o.abcToScientificNotation=m,o.default=D,o.distance=k,o.scientificToAbcNotation=_,o.tokenize=d,o.transpose=T,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Mu=Kt((oo,ku)=\u003e{(function(o,r){typeof oo==\"object\"\u0026\u0026typeof ku!=\"undefined\"?r(oo,Ee()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/core\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Array={},o.core))})(oo,function(o,r){\"use strict\";function a(A,N){for(var U=[];N--;U[N]=N+A);return U}function u(A,N){for(var U=[];N--;U[N]=A-N);return U}function d(A,N){return A\u003cN?a(A,N-A+1):u(A,A-N+1)}function m(A,N){var U=N.length,z=(A%U+U)%U;return N.slice(z,U).concat(N.slice(0,z))}function _(A){return A.filter(function(N){return N===0||N})}function T(A){var N=A.map(function(U){return r.note(U)}).filter(function(U){return!U.empty});return N.sort(function(U,z){return U.height-z.height}).map(function(U){return U.name})}function k(A){return T(A).filter(function(N,U,z){return U===0||N!==z[U-1]})}function D(A,N){N===void 0\u0026\u0026(N=Math.random);for(var U,z,X=A.length;X;)U=Math.floor(N()*X--),z=A[X],A[X]=A[U],A[U]=z;return A}function O(A){return A.length===0?[[]]:O(A.slice(1)).reduce(function(N,U){return N.concat(A.map(function(z,X){var K=U.slice();return K.splice(X,0,A[0]),K}))},[])}o.compact=_,o.permutations=O,o.range=d,o.rotate=m,o.shuffle=D,o.sortedNoteNames=T,o.sortedUniqNoteNames=k,Object.defineProperty(o,\"__esModule\",{value:!0})})});var ei=Kt((ao,Au)=\u003e{(function(o,r){typeof ao==\"object\"\u0026\u0026typeof Au!=\"undefined\"?r(ao):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Collection={}))})(ao,function(o){\"use strict\";function r(D,O){for(var A=[];O--;A[O]=O+D);return A}function a(D,O){for(var A=[];O--;A[O]=D-O);return A}function u(D,O){return D\u003cO?r(D,O-D+1):a(D,D-O+1)}function d(D,O){var A=O.length,N=(D%A+A)%A;return O.slice(N,A).concat(O.slice(0,N))}function m(D){return D.filter(function(O){return O===0||O})}function _(D,O){O===void 0\u0026\u0026(O=Math.random);for(var A,N,U=D.length;U;)A=Math.floor(O()*U--),N=D[U],D[U]=D[A],D[A]=N;return D}function T(D){return D.length===0?[[]]:T(D.slice(1)).reduce(function(O,A){return O.concat(D.map(function(N,U){var z=A.slice();return z.splice(U,0,D[0]),z}))},[])}var k={compact:m,permutations:T,range:u,rotate:d,shuffle:_};o.compact=m,o.default=k,o.permutations=T,o.range=u,o.rotate=d,o.shuffle=_,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Zn=Kt((co,Cu)=\u003e{(function(o,r){typeof co==\"object\"\u0026\u0026typeof Cu!=\"undefined\"?r(co,ei(),Ee()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/collection\",\"@tonaljs/core\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Pcset={},o.collection,o.core))})(co,function(o,r,a){\"use strict\";var u,d={empty:!0,name:\"\",setNum:0,chroma:\"000000000000\",normalized:\"000000000000\",intervals:[]},m=function(L){return Number(L).toString(2)},_=function(L){return parseInt(L,2)},T=/^[01]{12}$/;function k(L){return T.test(L)}var D=function(L){return typeof L==\"number\"\u0026\u0026L\u003e=0\u0026\u0026L\u003c=4095},O=function(L){return L\u0026\u0026k(L.chroma)},A=(u={},u[d.chroma]=d,u);function N(L){var J=k(L)?L:D(L)?m(L):Array.isArray(L)?re(L):O(L)?L.chroma:d.chroma;return A[J]=A[J]||Ht(J)}var U=a.deprecate(\"Pcset.pcset\",\"Pcset.get\",N),z=function(L){return N(L).chroma},X=function(L){return N(L).intervals},K=function(L){return N(L).setNum},$=[\"1P\",\"2m\",\"2M\",\"3m\",\"3M\",\"4P\",\"5d\",\"5P\",\"6m\",\"6M\",\"7m\",\"7M\"];function Y(L){for(var J=[],it=0;it\u003c12;it++)L.charAt(it)===\"1\"\u0026\u0026J.push($[it]);return J}function st(){return r.range(2048,4095).map(m)}function R(L,J){J===void 0\u0026\u0026(J=!0);var it=N(L),et=it.chroma.split(\"\");return r.compact(et.map(function(ht,rt){var At=r.rotate(rt,et);return J\u0026\u0026At[0]===\"0\"?null:At.join(\"\")}))}function P(L,J){return N(L).setNum===N(J).setNum}function B(L){var J=N(L).setNum;return function(it){var et=N(it).setNum;return J\u0026\u0026J!==et\u0026\u0026(et\u0026J)===et}}function F(L){var J=N(L).setNum;return function(it){var et=N(it).setNum;return J\u0026\u0026J!==et\u0026\u0026(et|J)===et}}function tt(L){var J=N(L);return function(it){var et=a.note(it);return J\u0026\u0026!et.empty\u0026\u0026J.chroma.charAt(et.chroma)===\"1\"}}var at=tt;function pt(L){var J=tt(L);return function(it){return it.filter(J)}}var Dt={get:N,chroma:z,num:K,intervals:X,chromas:st,isSupersetOf:F,isSubsetOf:B,isNoteIncludedIn:tt,isEqual:P,filter:pt,modes:R,pcset:U};function jt(L){var J=L.split(\"\");return J.map(function(it,et){return r.rotate(et,J).join(\"\")})}function Ht(L){var J=_(L),it=jt(L).map(_).filter(function(rt){return rt\u003e=2048}).sort()[0],et=m(it),ht=Y(L);return{empty:!1,name:\"\",setNum:J,chroma:L,normalized:et,intervals:ht}}function re(L){if(L.length===0)return d.chroma;for(var J,it=[0,0,0,0,0,0,0,0,0,0,0,0],et=0;et\u003cL.length;et++)J=a.note(L[et]),J.empty\u0026\u0026(J=a.interval(L[et])),J.empty||(it[J.chroma]=1);return it.join(\"\")}o.EmptyPcset=d,o.chromaToIntervals=Y,o.chromas=st,o.default=Dt,o.filter=pt,o.get=N,o.includes=at,o.isEqual=P,o.isNoteIncludedIn=tt,o.isSubsetOf=B,o.isSupersetOf=F,o.modes=R,o.pcset=U,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Di=Kt((uo,Ou)=\u003e{(function(o,r){typeof uo==\"object\"\u0026\u0026typeof Ou!=\"undefined\"?r(uo,Ee(),Zn()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/core\",\"@tonaljs/pcset\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.ChordType={},o.core,o.pcset))})(uo,function(o,r,a){\"use strict\";var u=function(){return u=Object.assign||function(P){for(var B,F=1,tt=arguments.length;F\u003ctt;F++){B=arguments[F];for(var at in B)Object.prototype.hasOwnProperty.call(B,at)\u0026\u0026(P[at]=B[at])}return P},u.apply(this,arguments)},d=[[\"1P 3M 5P\",\"major\",\"M ^ \"],[\"1P 3M 5P 7M\",\"major seventh\",\"maj7 \\u0394 ma7 M7 Maj7 ^7\"],[\"1P 3M 5P 7M 9M\",\"major ninth\",\"maj9 \\u03949 ^9\"],[\"1P 3M 5P 7M 9M 13M\",\"major thirteenth\",\"maj13 Maj13 ^13\"],[\"1P 3M 5P 6M\",\"sixth\",\"6 add6 add13 M6\"],[\"1P 3M 5P 6M 9M\",\"sixth/ninth\",\"6/9 69 M69\"],[\"1P 3M 6m 7M\",\"major seventh flat sixth\",\"M7b6 ^7b6\"],[\"1P 3M 5P 7M 11A\",\"major seventh sharp eleventh\",\"maj#4 \\u0394#4 \\u0394#11 M7#11 ^7#11 maj7#11\"],[\"1P 3m 5P\",\"minor\",\"m min -\"],[\"1P 3m 5P 7m\",\"minor seventh\",\"m7 min7 mi7 -7\"],[\"1P 3m 5P 7M\",\"minor/major seventh\",\"m/ma7 m/maj7 mM7 mMaj7 m/M7 -\\u03947 m\\u0394 -^7\"],[\"1P 3m 5P 6M\",\"minor sixth\",\"m6 -6\"],[\"1P 3m 5P 7m 9M\",\"minor ninth\",\"m9 -9\"],[\"1P 3m 5P 7M 9M\",\"minor/major ninth\",\"mM9 mMaj9 -^9\"],[\"1P 3m 5P 7m 9M 11P\",\"minor eleventh\",\"m11 -11\"],[\"1P 3m 5P 7m 9M 13M\",\"minor thirteenth\",\"m13 -13\"],[\"1P 3m 5d\",\"diminished\",\"dim \\xB0 o\"],[\"1P 3m 5d 7d\",\"diminished seventh\",\"dim7 \\xB07 o7\"],[\"1P 3m 5d 7m\",\"half-diminished\",\"m7b5 \\xF8 -7b5 h7 h\"],[\"1P 3M 5P 7m\",\"dominant seventh\",\"7 dom\"],[\"1P 3M 5P 7m 9M\",\"dominant ninth\",\"9\"],[\"1P 3M 5P 7m 9M 13M\",\"dominant thirteenth\",\"13\"],[\"1P 3M 5P 7m 11A\",\"lydian dominant seventh\",\"7#11 7#4\"],[\"1P 3M 5P 7m 9m\",\"dominant flat ninth\",\"7b9\"],[\"1P 3M 5P 7m 9A\",\"dominant sharp ninth\",\"7#9\"],[\"1P 3M 7m 9m\",\"altered\",\"alt7\"],[\"1P 4P 5P\",\"suspended fourth\",\"sus4 sus\"],[\"1P 2M 5P\",\"suspended second\",\"sus2\"],[\"1P 4P 5P 7m\",\"suspended fourth seventh\",\"7sus4 7sus\"],[\"1P 5P 7m 9M 11P\",\"eleventh\",\"11\"],[\"1P 4P 5P 7m 9m\",\"suspended fourth flat ninth\",\"b9sus phryg 7b9sus 7b9sus4\"],[\"1P 5P\",\"fifth\",\"5\"],[\"1P 3M 5A\",\"augmented\",\"aug + +5 ^#5\"],[\"1P 3m 5A\",\"minor augmented\",\"m#5 -#5 m+\"],[\"1P 3M 5A 7M\",\"augmented seventh\",\"maj7#5 maj7+5 +maj7 ^7#5\"],[\"1P 3M 5P 7M 9M 11A\",\"major sharp eleventh (lydian)\",\"maj9#11 \\u03949#11 ^9#11\"],[\"1P 2M 4P 5P\",\"\",\"sus24 sus4add9\"],[\"1P 3M 5A 7M 9M\",\"\",\"maj9#5 Maj9#5\"],[\"1P 3M 5A 7m\",\"\",\"7#5 +7 7+ 7aug aug7\"],[\"1P 3M 5A 7m 9A\",\"\",\"7#5#9 7#9#5 7alt\"],[\"1P 3M 5A 7m 9M\",\"\",\"9#5 9+\"],[\"1P 3M 5A 7m 9M 11A\",\"\",\"9#5#11\"],[\"1P 3M 5A 7m 9m\",\"\",\"7#5b9 7b9#5\"],[\"1P 3M 5A 7m 9m 11A\",\"\",\"7#5b9#11\"],[\"1P 3M 5A 9A\",\"\",\"+add#9\"],[\"1P 3M 5A 9M\",\"\",\"M#5add9 +add9\"],[\"1P 3M 5P 6M 11A\",\"\",\"M6#11 M6b5 6#11 6b5\"],[\"1P 3M 5P 6M 7M 9M\",\"\",\"M7add13\"],[\"1P 3M 5P 6M 9M 11A\",\"\",\"69#11\"],[\"1P 3m 5P 6M 9M\",\"\",\"m69 -69\"],[\"1P 3M 5P 6m 7m\",\"\",\"7b6\"],[\"1P 3M 5P 7M 9A 11A\",\"\",\"maj7#9#11\"],[\"1P 3M 5P 7M 9M 11A 13M\",\"\",\"M13#11 maj13#11 M13+4 M13#4\"],[\"1P 3M 5P 7M 9m\",\"\",\"M7b9\"],[\"1P 3M 5P 7m 11A 13m\",\"\",\"7#11b13 7b5b13\"],[\"1P 3M 5P 7m 13M\",\"\",\"7add6 67 7add13\"],[\"1P 3M 5P 7m 9A 11A\",\"\",\"7#9#11 7b5#9 7#9b5\"],[\"1P 3M 5P 7m 9A 11A 13M\",\"\",\"13#9#11\"],[\"1P 3M 5P 7m 9A 11A 13m\",\"\",\"7#9#11b13\"],[\"1P 3M 5P 7m 9A 13M\",\"\",\"13#9\"],[\"1P 3M 5P 7m 9A 13m\",\"\",\"7#9b13\"],[\"1P 3M 5P 7m 9M 11A\",\"\",\"9#11 9+4 9#4\"],[\"1P 3M 5P 7m 9M 11A 13M\",\"\",\"13#11 13+4 13#4\"],[\"1P 3M 5P 7m 9M 11A 13m\",\"\",\"9#11b13 9b5b13\"],[\"1P 3M 5P 7m 9m 11A\",\"\",\"7b9#11 7b5b9 7b9b5\"],[\"1P 3M 5P 7m 9m 11A 13M\",\"\",\"13b9#11\"],[\"1P 3M 5P 7m 9m 11A 13m\",\"\",\"7b9b13#11 7b9#11b13 7b5b9b13\"],[\"1P 3M 5P 7m 9m 13M\",\"\",\"13b9\"],[\"1P 3M 5P 7m 9m 13m\",\"\",\"7b9b13\"],[\"1P 3M 5P 7m 9m 9A\",\"\",\"7b9#9\"],[\"1P 3M 5P 9M\",\"\",\"Madd9 2 add9 add2\"],[\"1P 3M 5P 9m\",\"\",\"Maddb9\"],[\"1P 3M 5d\",\"\",\"Mb5\"],[\"1P 3M 5d 6M 7m 9M\",\"\",\"13b5\"],[\"1P 3M 5d 7M\",\"\",\"M7b5\"],[\"1P 3M 5d 7M 9M\",\"\",\"M9b5\"],[\"1P 3M 5d 7m\",\"\",\"7b5\"],[\"1P 3M 5d 7m 9M\",\"\",\"9b5\"],[\"1P 3M 7m\",\"\",\"7no5\"],[\"1P 3M 7m 13m\",\"\",\"7b13\"],[\"1P 3M 7m 9M\",\"\",\"9no5\"],[\"1P 3M 7m 9M 13M\",\"\",\"13no5\"],[\"1P 3M 7m 9M 13m\",\"\",\"9b13\"],[\"1P 3m 4P 5P\",\"\",\"madd4\"],[\"1P 3m 5P 6m 7M\",\"\",\"mMaj7b6\"],[\"1P 3m 5P 6m 7M 9M\",\"\",\"mMaj9b6\"],[\"1P 3m 5P 7m 11P\",\"\",\"m7add11 m7add4\"],[\"1P 3m 5P 9M\",\"\",\"madd9\"],[\"1P 3m 5d 6M 7M\",\"\",\"o7M7\"],[\"1P 3m 5d 7M\",\"\",\"oM7\"],[\"1P 3m 6m 7M\",\"\",\"mb6M7\"],[\"1P 3m 6m 7m\",\"\",\"m7#5\"],[\"1P 3m 6m 7m 9M\",\"\",\"m9#5\"],[\"1P 3m 5A 7m 9M 11P\",\"\",\"m11A\"],[\"1P 3m 6m 9m\",\"\",\"mb6b9\"],[\"1P 2M 3m 5d 7m\",\"\",\"m9b5\"],[\"1P 4P 5A 7M\",\"\",\"M7#5sus4\"],[\"1P 4P 5A 7M 9M\",\"\",\"M9#5sus4\"],[\"1P 4P 5A 7m\",\"\",\"7#5sus4\"],[\"1P 4P 5P 7M\",\"\",\"M7sus4\"],[\"1P 4P 5P 7M 9M\",\"\",\"M9sus4\"],[\"1P 4P 5P 7m 9M\",\"\",\"9sus4 9sus\"],[\"1P 4P 5P 7m 9M 13M\",\"\",\"13sus4 13sus\"],[\"1P 4P 5P 7m 9m 13m\",\"\",\"7sus4b9b13 7b9b13sus4\"],[\"1P 4P 7m 10m\",\"\",\"4 quartal\"],[\"1P 5P 7m 9m 11P\",\"\",\"11b9\"]],m=u(u({},a.EmptyPcset),{name:\"\",quality:\"Unknown\",intervals:[],aliases:[]}),_=[],T={};function k(R){return T[R]||m}var D=r.deprecate(\"ChordType.chordType\",\"ChordType.get\",k);function O(){return _.map(function(R){return R.name}).filter(function(R){return R})}function A(){return _.map(function(R){return R.aliases[0]}).filter(function(R){return R})}function N(){return Object.keys(T)}function U(){return _.slice()}var z=r.deprecate(\"ChordType.entries\",\"ChordType.all\",U);function X(){_=[],T={}}function K(R,P,B){var F=Y(R),tt=u(u({},a.get(R)),{name:B||\"\",quality:F,intervals:R,aliases:P});_.push(tt),tt.name\u0026\u0026(T[tt.name]=tt),T[tt.setNum]=tt,T[tt.chroma]=tt,tt.aliases.forEach(function(at){return $(tt,at)})}function $(R,P){T[P]=R}function Y(R){var P=function(B){return R.indexOf(B)!==-1};return P(\"5A\")?\"Augmented\":P(\"3M\")?\"Major\":P(\"5d\")?\"Diminished\":P(\"3m\")?\"Minor\":\"Unknown\"}d.forEach(function(R){var P=R[0],B=R[1],F=R[2];return K(P.split(\" \"),F.split(\" \"),B)}),_.sort(function(R,P){return R.setNum-P.setNum});var st={names:O,symbols:A,get:k,all:U,add:K,removeAll:X,keys:N,entries:z,chordType:D};o.add=K,o.addAlias=$,o.all=U,o.chordType=D,o.default=st,o.entries=z,o.get=k,o.keys=N,o.names=O,o.removeAll=X,o.symbols=A,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Pu=Kt((lo,Du)=\u003e{(function(o,r){typeof lo==\"object\"\u0026\u0026typeof Du!=\"undefined\"?r(lo,Di(),Ee(),Zn()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/chord-type\",\"@tonaljs/core\",\"@tonaljs/pcset\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.ChordDetect={},o.chordType,o.core,o.pcset))})(lo,function(o,r,a,u){\"use strict\";var d=function(k){var D=k.reduce(function(O,A){var N=a.note(A).chroma;return N!==void 0\u0026\u0026(O[N]=O[N]||a.note(A).name),O},{});return function(O){return D[O]}};function m(k){var D=k.map(function(A){return a.note(A).pc}).filter(function(A){return A});if(a.note.length===0)return[];var O=_(D,1);return O.filter(function(A){return A.weight}).sort(function(A,N){return N.weight-A.weight}).map(function(A){return A.name})}function _(k,D){var O=k[0],A=a.note(O).chroma,N=d(k),U=u.modes(k,!1),z=[];return U.forEach(function(X,K){var $=r.all().filter(function(Y){return Y.chroma===X});$.forEach(function(Y){var st=Y.aliases[0],R=N(K),P=K!==A;P?z.push({weight:.5*D,name:\"\"+R+st+\"/\"+O}):z.push({weight:1*D,name:\"\"+R+st})})}),z}var T={detect:m};o.default=T,o.detect=m,Object.defineProperty(o,\"__esModule\",{value:!0})})});var po=Kt((ho,Eu)=\u003e{(function(o,r){typeof ho==\"object\"\u0026\u0026typeof Eu!=\"undefined\"?r(ho,Ee(),Zn()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/core\",\"@tonaljs/pcset\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.ScaleType={},o.core,o.pcset))})(ho,function(o,r,a){\"use strict\";var u=function(){return u=Object.assign||function(st){for(var R,P=1,B=arguments.length;P\u003cB;P++){R=arguments[P];for(var F in R)Object.prototype.hasOwnProperty.call(R,F)\u0026\u0026(st[F]=R[F])}return st},u.apply(this,arguments)},d=[[\"1P 2M 3M 5P 6M\",\"major pentatonic\",\"pentatonic\"],[\"1P 3M 4P 5P 7M\",\"ionian pentatonic\"],[\"1P 3M 4P 5P 7m\",\"mixolydian pentatonic\",\"indian\"],[\"1P 2M 4P 5P 6M\",\"ritusen\"],[\"1P 2M 4P 5P 7m\",\"egyptian\"],[\"1P 3M 4P 5d 7m\",\"neopolitan major pentatonic\"],[\"1P 3m 4P 5P 6m\",\"vietnamese 1\"],[\"1P 2m 3m 5P 6m\",\"pelog\"],[\"1P 2m 4P 5P 6m\",\"kumoijoshi\"],[\"1P 2M 3m 5P 6m\",\"hirajoshi\"],[\"1P 2m 4P 5d 7m\",\"iwato\"],[\"1P 2m 4P 5P 7m\",\"in-sen\"],[\"1P 3M 4A 5P 7M\",\"lydian pentatonic\",\"chinese\"],[\"1P 3m 4P 6m 7m\",\"malkos raga\"],[\"1P 3m 4P 5d 7m\",\"locrian pentatonic\",\"minor seven flat five pentatonic\"],[\"1P 3m 4P 5P 7m\",\"minor pentatonic\",\"vietnamese 2\"],[\"1P 3m 4P 5P 6M\",\"minor six pentatonic\"],[\"1P 2M 3m 5P 6M\",\"flat three pentatonic\",\"kumoi\"],[\"1P 2M 3M 5P 6m\",\"flat six pentatonic\"],[\"1P 2m 3M 5P 6M\",\"scriabin\"],[\"1P 3M 5d 6m 7m\",\"whole tone pentatonic\"],[\"1P 3M 4A 5A 7M\",\"lydian #5P pentatonic\"],[\"1P 3M 4A 5P 7m\",\"lydian dominant pentatonic\"],[\"1P 3m 4P 5P 7M\",\"minor #7M pentatonic\"],[\"1P 3m 4d 5d 7m\",\"super locrian pentatonic\"],[\"1P 2M 3m 4P 5P 7M\",\"minor hexatonic\"],[\"1P 2A 3M 5P 5A 7M\",\"augmented\"],[\"1P 2M 3m 3M 5P 6M\",\"major blues\"],[\"1P 2M 4P 5P 6M 7m\",\"piongio\"],[\"1P 2m 3M 4A 6M 7m\",\"prometheus neopolitan\"],[\"1P 2M 3M 4A 6M 7m\",\"prometheus\"],[\"1P 2m 3M 5d 6m 7m\",\"mystery #1\"],[\"1P 2m 3M 4P 5A 6M\",\"six tone symmetric\"],[\"1P 2M 3M 4A 5A 7m\",\"whole tone\",\"messiaen's mode #1\"],[\"1P 2m 4P 4A 5P 7M\",\"messiaen's mode #5\"],[\"1P 3m 4P 5d 5P 7m\",\"minor blues\",\"blues\"],[\"1P 2M 3M 4P 5d 6m 7m\",\"locrian major\",\"arabian\"],[\"1P 2m 3M 4A 5P 6m 7M\",\"double harmonic lydian\"],[\"1P 2M 3m 4P 5P 6m 7M\",\"harmonic minor\"],[\"1P 2m 2A 3M 4A 6m 7m\",\"altered\",\"super locrian\",\"diminished whole tone\",\"pomeroy\"],[\"1P 2M 3m 4P 5d 6m 7m\",\"locrian #2\",\"half-diminished\",\"aeolian b5\"],[\"1P 2M 3M 4P 5P 6m 7m\",\"mixolydian b6\",\"melodic minor fifth mode\",\"hindu\"],[\"1P 2M 3M 4A 5P 6M 7m\",\"lydian dominant\",\"lydian b7\",\"overtone\"],[\"1P 2M 3M 4A 5P 6M 7M\",\"lydian\"],[\"1P 2M 3M 4A 5A 6M 7M\",\"lydian augmented\"],[\"1P 2m 3m 4P 5P 6M 7m\",\"dorian b2\",\"phrygian #6\",\"melodic minor second mode\"],[\"1P 2M 3m 4P 5P 6M 7M\",\"melodic minor\"],[\"1P 2m 3m 4P 5d 6m 7m\",\"locrian\"],[\"1P 2m 3m 4d 5d 6m 7d\",\"ultralocrian\",\"superlocrian bb7\",\"\\xB7superlocrian diminished\"],[\"1P 2m 3m 4P 5d 6M 7m\",\"locrian 6\",\"locrian natural 6\",\"locrian sharp 6\"],[\"1P 2A 3M 4P 5P 5A 7M\",\"augmented heptatonic\"],[\"1P 2M 3m 5d 5P 6M 7m\",\"romanian minor\"],[\"1P 2M 3m 4A 5P 6M 7m\",\"dorian #4\"],[\"1P 2M 3m 4A 5P 6M 7M\",\"lydian diminished\"],[\"1P 2m 3m 4P 5P 6m 7m\",\"phrygian\"],[\"1P 2M 3M 4A 5A 7m 7M\",\"leading whole tone\"],[\"1P 2M 3M 4A 5P 6m 7m\",\"lydian minor\"],[\"1P 2m 3M 4P 5P 6m 7m\",\"phrygian dominant\",\"spanish\",\"phrygian major\"],[\"1P 2m 3m 4P 5P 6m 7M\",\"balinese\"],[\"1P 2m 3m 4P 5P 6M 7M\",\"neopolitan major\"],[\"1P 2M 3m 4P 5P 6m 7m\",\"aeolian\",\"minor\"],[\"1P 2M 3M 4P 5P 6m 7M\",\"harmonic major\"],[\"1P 2m 3M 4P 5P 6m 7M\",\"double harmonic major\",\"gypsy\"],[\"1P 2M 3m 4P 5P 6M 7m\",\"dorian\"],[\"1P 2M 3m 4A 5P 6m 7M\",\"hungarian minor\"],[\"1P 2A 3M 4A 5P 6M 7m\",\"hungarian major\"],[\"1P 2m 3M 4P 5d 6M 7m\",\"oriental\"],[\"1P 2m 3m 3M 4A 5P 7m\",\"flamenco\"],[\"1P 2m 3m 4A 5P 6m 7M\",\"todi raga\"],[\"1P 2M 3M 4P 5P 6M 7m\",\"mixolydian\",\"dominant\"],[\"1P 2m 3M 4P 5d 6m 7M\",\"persian\"],[\"1P 2M 3M 4P 5P 6M 7M\",\"major\",\"ionian\"],[\"1P 2m 3M 5d 6m 7m 7M\",\"enigmatic\"],[\"1P 2M 3M 4P 5A 6M 7M\",\"major augmented\",\"major #5\",\"ionian augmented\",\"ionian #5\"],[\"1P 2A 3M 4A 5P 6M 7M\",\"lydian #9\"],[\"1P 2m 2M 4P 4A 5P 6m 7M\",\"messiaen's mode #4\"],[\"1P 2m 3M 4P 4A 5P 6m 7M\",\"purvi raga\"],[\"1P 2m 3m 3M 4P 5P 6m 7m\",\"spanish heptatonic\"],[\"1P 2M 3M 4P 5P 6M 7m 7M\",\"bebop\"],[\"1P 2M 3m 3M 4P 5P 6M 7m\",\"bebop minor\"],[\"1P 2M 3M 4P 5P 5A 6M 7M\",\"bebop major\"],[\"1P 2m 3m 4P 5d 5P 6m 7m\",\"bebop locrian\"],[\"1P 2M 3m 4P 5P 6m 7m 7M\",\"minor bebop\"],[\"1P 2M 3m 4P 5d 6m 6M 7M\",\"diminished\",\"whole-half diminished\"],[\"1P 2M 3M 4P 5d 5P 6M 7M\",\"ichikosucho\"],[\"1P 2M 3m 4P 5P 6m 6M 7M\",\"minor six diminished\"],[\"1P 2m 3m 3M 4A 5P 6M 7m\",\"half-whole diminished\",\"dominant diminished\",\"messiaen's mode #2\"],[\"1P 3m 3M 4P 5P 6M 7m 7M\",\"kafi raga\"],[\"1P 2M 3M 4P 4A 5A 6A 7M\",\"messiaen's mode #6\"],[\"1P 2M 3m 3M 4P 5d 5P 6M 7m\",\"composite blues\"],[\"1P 2M 3m 3M 4A 5P 6m 7m 7M\",\"messiaen's mode #3\"],[\"1P 2m 2M 3m 4P 4A 5P 6m 6M 7M\",\"messiaen's mode #7\"],[\"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M\",\"chromatic\"]],m=u(u({},a.EmptyPcset),{intervals:[],aliases:[]}),_=[],T={};function k(){return _.map(function(Y){return Y.name})}function D(Y){return T[Y]||m}var O=r.deprecate(\"ScaleDictionary.scaleType\",\"ScaleType.get\",D);function A(){return _.slice()}var N=r.deprecate(\"ScaleDictionary.entries\",\"ScaleType.all\",A);function U(){return Object.keys(T)}function z(){_=[],T={}}function X(Y,st,R){R===void 0\u0026\u0026(R=[]);var P=u(u({},a.get(Y)),{name:st,intervals:Y,aliases:R});return _.push(P),T[P.name]=P,T[P.setNum]=P,T[P.chroma]=P,P.aliases.forEach(function(B){return K(P,B)}),P}function K(Y,st){T[st]=Y}d.forEach(function(Y){var st=Y[0],R=Y[1],P=Y.slice(2);return X(st.split(\" \"),R,P)});var $={names:k,get:D,all:A,add:X,removeAll:z,keys:U,entries:N,scaleType:O};o.NoScaleType=m,o.add=X,o.addAlias=K,o.all=A,o.default=$,o.entries=N,o.get=D,o.keys=U,o.names=k,o.removeAll=z,o.scaleType=O,Object.defineProperty(o,\"__esModule\",{value:!0})})});var xa=Kt((fo,Nu)=\u003e{(function(o,r){typeof fo==\"object\"\u0026\u0026typeof Nu!=\"undefined\"?r(fo,Pu(),Di(),Ee(),Zn(),po()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/chord-detect\",\"@tonaljs/chord-type\",\"@tonaljs/core\",\"@tonaljs/pcset\",\"@tonaljs/scale-type\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Chord={},o.chordDetect,o.chordType,o.core,o.pcset,o.scaleType))})(fo,function(o,r,a,u,d,m){\"use strict\";var _=function(){return _=Object.assign||function(st){for(var R,P=1,B=arguments.length;P\u003cB;P++){R=arguments[P];for(var F in R)Object.prototype.hasOwnProperty.call(R,F)\u0026\u0026(st[F]=R[F])}return st},_.apply(this,arguments)},T={empty:!0,name:\"\",symbol:\"\",root:\"\",rootDegree:0,type:\"\",tonic:null,setNum:NaN,quality:\"Unknown\",chroma:\"\",normalized:\"\",aliases:[],notes:[],intervals:[]},k=/^(6|64|7|9|11|13)$/;function D(Y){var st=u.tokenizeNote(Y),R=st[0],P=st[1],B=st[2],F=st[3];return R===\"\"?[\"\",Y]:R===\"A\"\u0026\u0026F===\"ug\"?[\"\",\"aug\"]:!F\u0026\u0026(B===\"4\"||B===\"5\")?[R+P,B]:k.test(B)?[R+P,B+F]:[R+P+B,F]}function O(Y){if(Y===\"\")return T;if(Array.isArray(Y)\u0026\u0026Y.length===2)return A(Y[1],Y[0]);var st=D(Y),R=st[0],P=st[1],B=A(P,R);return B.empty?A(Y):B}function A(Y,st,R){var P=a.get(Y),B=u.note(st||\"\"),F=u.note(R||\"\");if(P.empty||st\u0026\u0026B.empty||R\u0026\u0026F.empty)return T;var tt=u.distance(B.pc,F.pc),at=P.intervals.indexOf(tt)+1;if(!F.empty\u0026\u0026!at)return T;for(var pt=Array.from(P.intervals),Dt=1;Dt\u003cat;Dt++){var jt=pt[0][0],Ht=pt[0][1],re=parseInt(jt,10)+7;pt.push(\"\"+re+Ht),pt.shift()}var L=B.empty?[]:pt.map(function(et){return u.transpose(B,et)});Y=P.aliases.indexOf(Y)!==-1?Y:P.aliases[0];var J=\"\"+(B.empty?\"\":B.pc)+Y+(F.empty||at\u003c=1?\"\":\"/\"+F.pc),it=\"\"+(st?B.pc+\" \":\"\")+P.name+(at\u003e1\u0026\u0026R?\" over \"+F.pc:\"\");return _(_({},P),{name:it,symbol:J,type:P.name,root:F.name,intervals:pt,rootDegree:at,tonic:B.name,notes:L})}var N=u.deprecate(\"Chord.chord\",\"Chord.get\",O);function U(Y,st){var R=D(Y),P=R[0],B=R[1];return P?u.transpose(P,st)+B:Y}function z(Y){var st=O(Y),R=d.isSupersetOf(st.chroma);return m.all().filter(function(P){return R(P.chroma)}).map(function(P){return P.name})}function X(Y){var st=O(Y),R=d.isSupersetOf(st.chroma);return a.all().filter(function(P){return R(P.chroma)}).map(function(P){return st.tonic+P.aliases[0]})}function K(Y){var st=O(Y),R=d.isSubsetOf(st.chroma);return a.all().filter(function(P){return R(P.chroma)}).map(function(P){return st.tonic+P.aliases[0]})}var $={getChord:A,get:O,detect:r.detect,chordScales:z,extended:X,reduced:K,tokenize:D,transpose:U,chord:N};Object.defineProperty(o,\"detect\",{enumerable:!0,get:function(){return r.detect}}),o.chord=N,o.chordScales=z,o.default=$,o.extended=X,o.get=O,o.getChord=A,o.reduced=K,o.tokenize=D,o.transpose=U,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Iu=Kt((mo,qu)=\u003e{(function(o,r){typeof mo==\"object\"\u0026\u0026typeof qu!=\"undefined\"?r(mo):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.DurationValue={}))})(mo,function(o){\"use strict\";var r=function(){return r=Object.assign||function(X){for(var K,$=1,Y=arguments.length;$\u003cY;$++){K=arguments[$];for(var st in K)Object.prototype.hasOwnProperty.call(K,st)\u0026\u0026(X[st]=K[st])}return X},r.apply(this,arguments)},a=[[.125,\"dl\",[\"large\",\"duplex longa\",\"maxima\",\"octuple\",\"octuple whole\"]],[.25,\"l\",[\"long\",\"longa\"]],[.5,\"d\",[\"double whole\",\"double\",\"breve\"]],[1,\"w\",[\"whole\",\"semibreve\"]],[2,\"h\",[\"half\",\"minim\"]],[4,\"q\",[\"quarter\",\"crotchet\"]],[8,\"e\",[\"eighth\",\"quaver\"]],[16,\"s\",[\"sixteenth\",\"semiquaver\"]],[32,\"t\",[\"thirty-second\",\"demisemiquaver\"]],[64,\"sf\",[\"sixty-fourth\",\"hemidemisemiquaver\"]],[128,\"h\",[\"hundred twenty-eighth\"]],[256,\"th\",[\"two hundred fifty-sixth\"]]],u=[];a.forEach(function(z){var X=z[0],K=z[1],$=z[2];return N(X,K,$)});var d={empty:!0,name:\"\",value:0,fraction:[0,0],shorthand:\"\",dots:\"\",names:[]};function m(){return u.reduce(function(z,X){return X.names.forEach(function(K){return z.push(K)}),z},[])}function _(){return u.map(function(z){return z.shorthand})}var T=/^([^.]+)(\\.*)$/;function k(z){var X=T.exec(z)||[];X[0];var K=X[1],$=X[2],Y=u.find(function(P){return P.shorthand===K||P.names.includes(K)});if(!Y)return d;var st=U(Y.fraction,$.length),R=st[0]/st[1];return r(r({},Y),{name:z,dots:$,value:R,fraction:st})}var D=function(z){return k(z).value},O=function(z){return k(z).fraction},A={names:m,shorthands:_,get:k,value:D,fraction:O};function N(z,X,K){u.push({empty:!1,dots:\"\",name:\"\",value:1/z,fraction:z\u003c1?[1/z,1]:[1,z],shorthand:X,names:K})}function U(z,X){for(var K=Math.pow(2,X),$=z[0]*K,Y=z[1]*K,st=$,R=0;R\u003cX;R++)$+=st/Math.pow(2,R+1);for(;$%2==0\u0026\u0026Y%2==0;)$/=2,Y/=2;return[$,Y]}o.default=A,o.fraction=O,o.get=k,o.names=m,o.shorthands=_,o.value=D,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Ta=Kt((go,ju)=\u003e{(function(o,r){typeof go==\"object\"\u0026\u0026typeof ju!=\"undefined\"?r(go,Ee()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/core\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Interval={},o.core))})(go,function(o,r){\"use strict\";function a(){return\"1P 2M 3M 4P 5P 6m 7m\".split(\" \")}var u=r.interval,d=function(R){return r.interval(R).name},m=function(R){return r.interval(R).semitones},_=function(R){return r.interval(R).q},T=function(R){return r.interval(R).num};function k(R){var P=r.interval(R);return P.empty?\"\":P.simple+P.q}function D(R){var P=r.interval(R);if(P.empty)return\"\";var B=(7-P.step)%7,F=P.type===\"perfectable\"?-P.alt:-(P.alt+1);return r.interval({step:B,alt:F,oct:P.oct,dir:P.dir}).name}var O=[1,2,2,3,3,4,5,5,6,6,7,7],A=\"P m M m M P d P m M m M\".split(\" \");function N(R){var P=R\u003c0?-1:1,B=Math.abs(R),F=B%12,tt=Math.floor(B/12);return P*(O[F]+7*tt)+A[F]}var U=r.distance,z=st(function(R,P){return[R[0]+P[0],R[1]+P[1]]}),X=function(R){return function(P){return z(R,P)}},K=st(function(R,P){return[R[0]-P[0],R[1]-P[1]]});function $(R,P){var B=u(R);if(B.empty)return\"\";var F=B.coord,tt=F[0],at=F[1],pt=F[2];return r.coordToInterval([tt+P,at,pt]).name}var Y={names:a,get:u,name:d,num:T,semitones:m,quality:_,fromSemitones:N,distance:U,invert:D,simplify:k,add:z,addTo:X,substract:K,transposeFifths:$};function st(R){return function(P,B){var F=r.interval(P).coord,tt=r.interval(B).coord;if(F\u0026\u0026tt){var at=R(F,tt);return r.coordToInterval(at).name}}}o.add=z,o.addTo=X,o.default=Y,o.distance=U,o.fromSemitones=N,o.get=u,o.invert=D,o.name=d,o.names=a,o.num=T,o.quality=_,o.semitones=m,o.simplify=k,o.substract=K,o.transposeFifths=$,Object.defineProperty(o,\"__esModule\",{value:!0})})});var _o=Kt((vo,Ru)=\u003e{(function(o,r){typeof vo==\"object\"\u0026\u0026typeof Ru!=\"undefined\"?r(vo,Ee()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/core\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Midi={},o.core))})(vo,function(o,r){\"use strict\";function a(N){return+N\u003e=0\u0026\u0026+N\u003c=127}function u(N){if(a(N))return+N;var U=r.note(N);return U.empty?null:U.midi}function d(N,U){return U===void 0\u0026\u0026(U=440),Math.pow(2,(N-69)/12)*U}var m=Math.log(2),_=Math.log(440);function T(N){var U=12*(Math.log(N)-_)/m+69;return Math.round(U*100)/100}var k=\"C C# D D# E F F# G G# A A# B\".split(\" \"),D=\"C Db D Eb E F Gb G Ab A Bb B\".split(\" \");function O(N,U){if(U===void 0\u0026\u0026(U={}),isNaN(N)||N===-1/0||N===1/0)return\"\";N=Math.round(N);var z=U.sharps===!0?k:D,X=z[N%12];if(U.pitchClass)return X;var K=Math.floor(N/12)-1;return X+K}var A={isMidi:a,toMidi:u,midiToFreq:d,midiToNoteName:O,freqToMidi:T};o.default=A,o.freqToMidi=T,o.isMidi=a,o.midiToFreq=d,o.midiToNoteName=O,o.toMidi=u,Object.defineProperty(o,\"__esModule\",{value:!0})})});var bo=Kt((yo,Fu)=\u003e{(function(o,r){typeof yo==\"object\"\u0026\u0026typeof Fu!=\"undefined\"?r(yo,Ee(),_o()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/core\",\"@tonaljs/midi\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Note={},o.core,o.midi$1))})(yo,function(o,r,a){\"use strict\";var u=[\"C\",\"D\",\"E\",\"F\",\"G\",\"A\",\"B\"],d=function(et){return et.name},m=function(et){return et.map(r.note).filter(function(ht){return!ht.empty})};function _(et){return et===void 0?u.slice():Array.isArray(et)?m(et).map(d):[]}var T=r.note,k=function(et){return T(et).name},D=function(et){return T(et).pc},O=function(et){return T(et).acc},A=function(et){return T(et).oct},N=function(et){return T(et).midi},U=function(et){return T(et).freq},z=function(et){return T(et).chroma};function X(et){return a.midiToNoteName(et)}function K(et){return a.midiToNoteName(a.freqToMidi(et))}function $(et){return a.midiToNoteName(a.freqToMidi(et),{sharps:!0})}function Y(et){return a.midiToNoteName(et,{sharps:!0})}var st=r.transpose,R=r.transpose,P=function(et){return function(ht){return st(ht,et)}},B=P,F=function(et){return function(ht){return st(et,ht)}},tt=F;function at(et,ht){var rt=T(et);if(rt.empty)return\"\";var At=rt.coord,Gt=At[0],le=At[1],Z=le===void 0?r.coordToNote([Gt+ht]):r.coordToNote([Gt+ht,le]);return Z.name}var pt=at,Dt=function(et,ht){return et.height-ht.height},jt=function(et,ht){return ht.height-et.height};function Ht(et,ht){return ht=ht||Dt,m(et).sort(ht).map(d)}function re(et){return Ht(et,Dt).filter(function(ht,rt,At){return rt===0||ht!==At[rt-1]})}var L=function(et){var ht=T(et);return ht.empty?\"\":a.midiToNoteName(ht.midi||ht.chroma,{sharps:ht.alt\u003e0,pitchClass:ht.midi===null})};function J(et,ht){var rt=T(et);if(rt.empty)return\"\";var At=T(ht||a.midiToNoteName(rt.midi||rt.chroma,{sharps:rt.alt\u003c0,pitchClass:!0}));if(At.empty||At.chroma!==rt.chroma)return\"\";if(rt.oct===void 0)return At.pc;var Gt=rt.chroma-rt.alt,le=At.chroma-At.alt,Z=Gt\u003e11||le\u003c0?-1:Gt\u003c0||le\u003e11?1:0,lt=rt.oct+Z;return At.pc+lt}var it={names:_,get:T,name:k,pitchClass:D,accidentals:O,octave:A,midi:N,ascending:Dt,descending:jt,sortedNames:Ht,sortedUniqNames:re,fromMidi:X,fromMidiSharps:Y,freq:U,fromFreq:K,fromFreqSharps:$,chroma:z,transpose:st,tr:R,transposeBy:P,trBy:B,transposeFrom:F,trFrom:tt,transposeFifths:at,trFifths:pt,simplify:L,enharmonic:J};o.accidentals=O,o.ascending=Dt,o.chroma=z,o.default=it,o.descending=jt,o.enharmonic=J,o.freq=U,o.fromFreq=K,o.fromFreqSharps=$,o.fromMidi=X,o.fromMidiSharps=Y,o.get=T,o.midi=N,o.name=k,o.names=_,o.octave=A,o.pitchClass=D,o.simplify=L,o.sortedNames=Ht,o.sortedUniqNames=re,o.tr=R,o.trBy=B,o.trFifths=pt,o.trFrom=tt,o.transpose=st,o.transposeBy=P,o.transposeFifths=at,o.transposeFrom=F,Object.defineProperty(o,\"__esModule\",{value:!0})})});var xo=Kt((wo,Vu)=\u003e{(function(o,r){typeof wo==\"object\"\u0026\u0026typeof Vu!=\"undefined\"?r(wo,Ee()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/core\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.RomanNumeral={},o.core))})(wo,function(o,r){\"use strict\";var a={empty:!0,name:\"\",chordType:\"\"},u={};function d(X){return typeof X==\"string\"?u[X]||(u[X]=U(X)):typeof X==\"number\"?d(A[X]||\"\"):r.isPitch(X)?T(X):r.isNamed(X)?d(X.name):a}var m=r.deprecate(\"RomanNumeral.romanNumeral\",\"RomanNumeral.get\",d);function _(X){return X===void 0\u0026\u0026(X=!0),(X?A:N).slice()}function T(X){return d(r.altToAcc(X.alt)+A[X.step])}var k=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function D(X){return k.exec(X)||[\"\",\"\",\"\",\"\"]}var O=\"I II III IV V VI VII\",A=O.split(\" \"),N=O.toLowerCase().split(\" \");function U(X){var K=D(X),$=K[0],Y=K[1],st=K[2],R=K[3];if(!st)return a;var P=st.toUpperCase(),B=A.indexOf(P),F=r.accToAlt(Y),tt=1;return{empty:!1,name:$,roman:st,interval:r.interval({step:B,alt:F,dir:tt}).name,acc:Y,chordType:R,alt:F,step:B,major:st===P,oct:0,dir:tt}}var z={names:_,get:d,romanNumeral:m};o.default=z,o.get=d,o.names=_,o.tokenize=D,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Wu=Kt((To,Lu)=\u003e{(function(o,r){typeof To==\"object\"\u0026\u0026typeof Lu!=\"undefined\"?r(To,Ee(),bo(),xo()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/core\",\"@tonaljs/note\",\"@tonaljs/roman-numeral\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Key={},o.core,o.note,o.romanNumeral))})(To,function(o,r,a,u){\"use strict\";var d=function(){return d=Object.assign||function(B){for(var F,tt=1,at=arguments.length;tt\u003cat;tt++){F=arguments[tt];for(var pt in F)Object.prototype.hasOwnProperty.call(F,pt)\u0026\u0026(B[pt]=F[pt])}return B},d.apply(this,arguments)},m=Object.freeze([]),_={type:\"major\",tonic:\"\",alteration:0,keySignature:\"\"},T={tonic:\"\",grades:m,intervals:m,scale:m,chords:m,chordsHarmonicFunction:m,chordScales:m},k=d(d(d({},_),T),{type:\"major\",minorRelative:\"\",scale:m,secondaryDominants:m,secondaryDominantsMinorRelative:m,substituteDominants:m,substituteDominantsMinorRelative:m}),D=d(d({},_),{type:\"minor\",relativeMajor:\"\",natural:T,harmonic:T,melodic:T}),O=function(P,B,F){return F===void 0\u0026\u0026(F=\"\"),B.map(function(tt,at){return\"\"+P[at]+F+tt})};function A(P,B,F,tt){return function(at){var pt=P.map(function(jt){return u.get(jt).interval||\"\"}),Dt=pt.map(function(jt){return r.transpose(at,jt)});return{tonic:at,grades:P,intervals:pt,scale:Dt,chords:O(Dt,B),chordsHarmonicFunction:F.slice(),chordScales:O(Dt,tt,\" \")}}}var N=function(P,B){var F=r.note(P),tt=r.note(B);return F.empty||tt.empty?0:tt.coord[0]-F.coord[0]},U=A(\"I II III IV V VI VII\".split(\" \"),\"maj7 m7 m7 maj7 7 m7 m7b5\".split(\" \"),\"T SD T SD D T D\".split(\" \"),\"major,dorian,phrygian,lydian,mixolydian,minor,locrian\".split(\",\")),z=A(\"I II bIII IV V bVI bVII\".split(\" \"),\"m7 m7b5 maj7 m7 m7 maj7 7\".split(\" \"),\"T SD T SD D SD SD\".split(\" \"),\"minor,locrian,major,dorian,phrygian,lydian,mixolydian\".split(\",\")),X=A(\"I II bIII IV V bVI VII\".split(\" \"),\"mMaj7 m7b5 +maj7 m7 7 maj7 o7\".split(\" \"),\"T SD T SD D SD D\".split(\" \"),\"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian\".split(\",\")),K=A(\"I II bIII IV V VI VII\".split(\" \"),\"m6 m7 +maj7 7 7 m7b5 m7b5\".split(\" \"),\"T SD T SD D  \".split(\" \"),\"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered\".split(\",\"));function $(P){var B=r.note(P).pc;if(!B)return k;var F=U(B),tt=N(\"C\",B),at=function(pt){var Dt=u.get(pt);return Dt.empty?\"\":r.transpose(P,Dt.interval)+Dt.chordType};return d(d({},F),{type:\"major\",minorRelative:r.transpose(B,\"-3m\"),alteration:tt,keySignature:r.altToAcc(tt),secondaryDominants:\"- VI7 VII7 I7 II7 III7 -\".split(\" \").map(at),secondaryDominantsMinorRelative:\"- IIIm7b5 IV#m7 Vm7 VIm7 VIIm7b5 -\".split(\" \").map(at),substituteDominants:\"- bIII7 IV7 bV7 bVI7 bVII7 -\".split(\" \").map(at),substituteDominantsMinorRelative:\"- IIIm7 Im7 IIbm7 VIm7 IVm7 -\".split(\" \").map(at)})}function Y(P){var B=r.note(P).pc;if(!B)return D;var F=N(\"C\",B)-3;return{type:\"minor\",tonic:B,relativeMajor:r.transpose(B,\"3m\"),alteration:F,keySignature:r.altToAcc(F),natural:z(B),harmonic:X(B),melodic:K(B)}}function st(P){return typeof P==\"number\"?a.transposeFifths(\"C\",P):typeof P==\"string\"\u0026\u0026/^b+|#+$/.test(P)?a.transposeFifths(\"C\",r.accToAlt(P)):null}var R={majorKey:$,majorTonicFromKeySignature:st,minorKey:Y};o.default=R,o.majorKey=$,o.majorTonicFromKeySignature=st,o.minorKey=Y,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Gu=Kt((So,zu)=\u003e{(function(o,r){typeof So==\"object\"\u0026\u0026typeof zu!=\"undefined\"?r(So,ei(),Ee(),Ta(),Zn()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/collection\",\"@tonaljs/core\",\"@tonaljs/interval\",\"@tonaljs/pcset\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Mode={},o.collection,o.core,o.interval,o.pcset))})(So,function(o,r,a,u,d){\"use strict\";var m=function(){return m=Object.assign||function(tt){for(var at,pt=1,Dt=arguments.length;pt\u003cDt;pt++){at=arguments[pt];for(var jt in at)Object.prototype.hasOwnProperty.call(at,jt)\u0026\u0026(tt[jt]=at[jt])}return tt},m.apply(this,arguments)},_=[[0,2773,0,\"ionian\",\"\",\"Maj7\",\"major\"],[1,2902,2,\"dorian\",\"m\",\"m7\"],[2,3418,4,\"phrygian\",\"m\",\"m7\"],[3,2741,-1,\"lydian\",\"\",\"Maj7\"],[4,2774,1,\"mixolydian\",\"\",\"7\"],[5,2906,3,\"aeolian\",\"m\",\"m7\",\"minor\"],[6,3434,5,\"locrian\",\"dim\",\"m7b5\"]],T=m(m({},d.EmptyPcset),{name:\"\",alt:0,modeNum:NaN,triad:\"\",seventh:\"\",aliases:[]}),k=_.map(X),D={};k.forEach(function(F){D[F.name]=F,F.aliases.forEach(function(tt){D[tt]=F})});function O(F){return typeof F==\"string\"?D[F.toLowerCase()]||T:F\u0026\u0026F.name?O(F.name):T}var A=a.deprecate(\"Mode.mode\",\"Mode.get\",O);function N(){return k.slice()}var U=a.deprecate(\"Mode.mode\",\"Mode.all\",N);function z(){return k.map(function(F){return F.name})}function X(F){var tt=F[0],at=F[1],pt=F[2],Dt=F[3],jt=F[4],Ht=F[5],re=F[6],L=re?[re]:[],J=Number(at).toString(2),it=d.chromaToIntervals(J);return{empty:!1,intervals:it,modeNum:tt,chroma:J,normalized:J,name:Dt,setNum:at,alt:pt,triad:jt,seventh:Ht,aliases:L}}function K(F,tt){return O(F).intervals.map(function(at){return a.transpose(tt,at)})}function $(F){return function(tt,at){var pt=O(tt);if(pt.empty)return[];var Dt=r.rotate(pt.modeNum,F),jt=pt.intervals.map(function(Ht){return a.transpose(at,Ht)});return Dt.map(function(Ht,re){return jt[re]+Ht})}}var Y=$(_.map(function(F){return F[4]})),st=$(_.map(function(F){return F[5]}));function R(F,tt){var at=O(tt),pt=O(F);return at.empty||pt.empty?\"\":u.simplify(u.transposeFifths(\"1P\",pt.alt-at.alt))}function P(F,tt,at){return a.transpose(at,R(F,tt))}var B={get:O,names:z,all:N,distance:R,relativeTonic:P,notes:K,triads:Y,seventhChords:st,entries:U,mode:A};o.all=N,o.default=B,o.distance=R,o.entries=U,o.get=O,o.mode=A,o.names=z,o.notes=K,o.relativeTonic=P,o.seventhChords=st,o.triads=Y,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Uu=Kt((ko,Bu)=\u003e{(function(o,r){typeof ko==\"object\"\u0026\u0026typeof Bu!=\"undefined\"?r(ko,xa(),Ee(),xo()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/chord\",\"@tonaljs/core\",\"@tonaljs/roman-numeral\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Progression={},o.chord,o.core,o.romanNumeral))})(ko,function(o,r,a,u){\"use strict\";function d(T,k){var D=k.map(u.get);return D.map(function(O){return a.transpose(T,a.interval(O))+O.chordType})}function m(T,k){return k.map(function(D){var O=r.tokenize(D),A=O[0],N=O[1],U=a.distance(T,A),z=u.get(a.interval(U));return z.name+N})}var _={fromRomanNumerals:d,toRomanNumerals:m};o.default=_,o.fromRomanNumerals=d,o.toRomanNumerals=m,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Yu=Kt((Mo,Hu)=\u003e{(function(o,r){typeof Mo==\"object\"\u0026\u0026typeof Hu!=\"undefined\"?r(Mo,ei(),_o()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/collection\",\"@tonaljs/midi\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Range={},o.collection,o.midi))})(Mo,function(o,r,a){\"use strict\";function u(_){var T=r.compact(_.map(a.toMidi));return!_.length||T.length!==_.length?[]:T.reduce(function(k,D){var O=k[k.length-1];return k.concat(r.range(O,D).slice(1))},[T[0]])}function d(_,T){return u(_).map(function(k){return a.midiToNoteName(k,T)})}var m={numeric:u,chromatic:d};o.chromatic=d,o.default=m,o.numeric=u,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Qu=Kt((Ao,Xu)=\u003e{(function(o,r){typeof Ao==\"object\"\u0026\u0026typeof Xu!=\"undefined\"?r(Ao,Di(),ei(),Ee(),bo(),Zn(),po()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/chord-type\",\"@tonaljs/collection\",\"@tonaljs/core\",\"@tonaljs/note\",\"@tonaljs/pcset\",\"@tonaljs/scale-type\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Scale={},o.chordType,o.collection,o.core,o.note,o.pcset,o.scaleType))})(Ao,function(o,r,a,u,d,m,_){\"use strict\";var T=function(){return T=Object.assign||function(B){for(var F,tt=1,at=arguments.length;tt\u003cat;tt++){F=arguments[tt];for(var pt in F)Object.prototype.hasOwnProperty.call(F,pt)\u0026\u0026(B[pt]=F[pt])}return B},T.apply(this,arguments)},k={empty:!0,name:\"\",type:\"\",tonic:null,setNum:NaN,chroma:\"\",normalized:\"\",aliases:[],notes:[],intervals:[]};function D(P){if(typeof P!=\"string\")return[\"\",\"\"];var B=P.indexOf(\" \"),F=u.note(P.substring(0,B));if(F.empty){var tt=u.note(P);return tt.empty?[\"\",P]:[tt.name,\"\"]}var at=P.substring(F.name.length+1);return[F.name,at.length?at:\"\"]}var O=_.names;function A(P){var B=Array.isArray(P)?P:D(P),F=u.note(B[0]).name,tt=_.get(B[1]);if(tt.empty)return k;var at=tt.name,pt=F?tt.intervals.map(function(jt){return u.transpose(F,jt)}):[],Dt=F?F+\" \"+at:at;return T(T({},tt),{name:Dt,type:at,tonic:F,notes:pt})}var N=u.deprecate(\"Scale.scale\",\"Scale.get\",A);function U(P){var B=A(P),F=m.isSubsetOf(B.chroma);return r.all().filter(function(tt){return F(tt.chroma)}).map(function(tt){return tt.aliases[0]})}function z(P){var B=A(P),F=m.isSupersetOf(B.chroma);return _.all().filter(function(tt){return F(tt.chroma)}).map(function(tt){return tt.name})}function X(P){var B=m.isSubsetOf(A(P).chroma);return _.all().filter(function(F){return B(F.chroma)}).map(function(F){return F.name})}function K(P){var B=P.map(function(at){return u.note(at).pc}).filter(function(at){return at}),F=B[0],tt=d.sortedUniqNames(B);return a.rotate(tt.indexOf(F),tt)}function $(P){var B=A(P);if(B.empty)return[];var F=B.tonic?B.notes:B.intervals;return m.modes(B.chroma).map(function(tt,at){var pt=A(tt).name;return pt?[F[at],pt]:[\"\",\"\"]}).filter(function(tt){return tt[0]})}function Y(P){var B=Array.isArray(P)?K(P):A(P).notes,F=B.map(function(tt){return u.note(tt).chroma});return function(tt){var at=typeof tt==\"number\"?u.note(d.fromMidi(tt)):u.note(tt),pt=at.height;if(pt!==void 0){var Dt=pt%12,jt=F.indexOf(Dt);if(jt!==-1)return d.enharmonic(at.name,B[jt])}}}function st(P){var B=Y(P);return function(F,tt){var at=u.note(F).height,pt=u.note(tt).height;return at===void 0||pt===void 0?[]:a.range(at,pt).map(B).filter(function(Dt){return Dt})}}var R={get:A,names:O,extended:z,modeNames:$,reduced:X,scaleChords:U,scaleNotes:K,tokenize:D,rangeOf:st,scale:N};o.default=R,o.extended=z,o.get=A,o.modeNames=$,o.names=O,o.rangeOf=st,o.reduced=X,o.scale=N,o.scaleChords=U,o.scaleNotes=K,o.tokenize=D,Object.defineProperty(o,\"__esModule\",{value:!0})})});var Ku=Kt((Co,Zu)=\u003e{(function(o,r){typeof Co==\"object\"\u0026\u0026typeof Zu!=\"undefined\"?r(Co):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.TimeSignature={}))})(Co,function(o){\"use strict\";var r={empty:!0,name:\"\",upper:void 0,lower:void 0,type:void 0,additive:[]},a=[\"4/4\",\"3/4\",\"2/4\",\"2/2\",\"12/8\",\"9/8\",\"6/8\",\"3/8\"];function u(){return a.slice()}var d=/^(\\d?\\d(?:\\+\\d)*)\\/(\\d)$/,m=new Map;function _(O){var A=m.get(O);if(A)return A;var N=D(T(O));return m.set(O,N),N}function T(O){if(typeof O==\"string\"){var A=d.exec(O)||[];A[0];var N=A[1],U=A[2];return T([N,U])}var z=O[0],X=O[1],K=+X;if(typeof z==\"number\")return[z,K];var $=z.split(\"+\").map(function(Y){return+Y});return $.length===1?[$[0],K]:[$,K]}var k={names:u,parse:T,get:_};function D(O){var A=O[0],N=O[1],U=Array.isArray(A)?A.reduce(function(Y,st){return Y+st},0):A,z=N;if(U===0||z===0)return r;var X=Array.isArray(A)?A.join(\"+\")+\"/\"+N:A+\"/\"+N,K=Array.isArray(A)?A:[],$=z===4||z===2?\"simple\":z===8\u0026\u0026U%3==0?\"compound\":\"irregular\";return{empty:!1,name:X,type:$,upper:U,lower:z,additive:K}}o.default=k,o.get=_,o.names=u,o.parse=T,Object.defineProperty(o,\"__esModule\",{value:!0})})});var ni=Kt((Oo,$u)=\u003e{(function(o,r){typeof Oo==\"object\"\u0026\u0026typeof $u!=\"undefined\"?r(Oo,Su(),Mu(),xa(),Di(),ei(),Ee(),Iu(),Ta(),Wu(),_o(),Gu(),bo(),Zn(),Uu(),Yu(),xo(),Qu(),po(),Ku()):typeof define==\"function\"\u0026\u0026define.amd?define([\"exports\",\"@tonaljs/abc-notation\",\"@tonaljs/array\",\"@tonaljs/chord\",\"@tonaljs/chord-type\",\"@tonaljs/collection\",\"@tonaljs/core\",\"@tonaljs/duration-value\",\"@tonaljs/interval\",\"@tonaljs/key\",\"@tonaljs/midi\",\"@tonaljs/mode\",\"@tonaljs/note\",\"@tonaljs/pcset\",\"@tonaljs/progression\",\"@tonaljs/range\",\"@tonaljs/roman-numeral\",\"@tonaljs/scale\",\"@tonaljs/scale-type\",\"@tonaljs/time-signature\"],r):(o=typeof globalThis!=\"undefined\"?globalThis:o||self,r(o.Tonal={},o.abcNotation,o.array,o.chord,o.ChordType,o.collection,o.Core,o.durationValue,o.interval,o.key,o.midi,o.mode,o.note,o.Pcset,o.progression,o.range,o.romanNumeral,o.scale,o.ScaleType,o.timeSignature))})(Oo,function(o,r,a,u,d,m,_,T,k,D,O,A,N,U,z,X,K,$,Y,st){\"use strict\";function R(gt){return gt\u0026\u0026typeof gt==\"object\"\u0026\u0026\"default\"in gt?gt:{default:gt}}function P(gt){if(gt\u0026\u0026gt.__esModule)return gt;var Bt=Object.create(null);return gt\u0026\u0026Object.keys(gt).forEach(function(Qt){if(Qt!==\"default\"){var Ie=Object.getOwnPropertyDescriptor(gt,Qt);Object.defineProperty(Bt,Qt,Ie.get?Ie:{enumerable:!0,get:function(){return gt[Qt]}})}}),Bt.default=gt,Object.freeze(Bt)}var B=R(r),F=P(a),tt=R(u),at=R(d),pt=R(m),Dt=P(_),jt=R(T),Ht=R(k),re=R(D),L=R(O),J=R(A),it=R(N),et=R(U),ht=R(z),rt=R(X),At=R(K),Gt=R($),le=R(Y),Z=R(st),lt=Dt,xt=et.default,Mt=at.default,Tt=le.default;Object.defineProperty(o,\"AbcNotation\",{enumerable:!0,get:function(){return B.default}}),o.Array=F,Object.defineProperty(o,\"Chord\",{enumerable:!0,get:function(){return tt.default}}),Object.defineProperty(o,\"ChordType\",{enumerable:!0,get:function(){return at.default}}),Object.defineProperty(o,\"Collection\",{enumerable:!0,get:function(){return pt.default}}),o.Core=Dt,Object.defineProperty(o,\"DurationValue\",{enumerable:!0,get:function(){return jt.default}}),Object.defineProperty(o,\"Interval\",{enumerable:!0,get:function(){return Ht.default}}),Object.defineProperty(o,\"Key\",{enumerable:!0,get:function(){return re.default}}),Object.defineProperty(o,\"Midi\",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(o,\"Mode\",{enumerable:!0,get:function(){return J.default}}),Object.defineProperty(o,\"Note\",{enumerable:!0,get:function(){return it.default}}),Object.defineProperty(o,\"Pcset\",{enumerable:!0,get:function(){return et.default}}),Object.defineProperty(o,\"Progression\",{enumerable:!0,get:function(){return ht.default}}),Object.defineProperty(o,\"Range\",{enumerable:!0,get:function(){return rt.default}}),Object.defineProperty(o,\"RomanNumeral\",{enumerable:!0,get:function(){return At.default}}),Object.defineProperty(o,\"Scale\",{enumerable:!0,get:function(){return Gt.default}}),Object.defineProperty(o,\"ScaleType\",{enumerable:!0,get:function(){return le.default}}),Object.defineProperty(o,\"TimeSignature\",{enumerable:!0,get:function(){return Z.default}}),o.ChordDictionary=Mt,o.PcSet=xt,o.ScaleDictionary=Tt,o.Tonal=lt,Object.keys(_).forEach(function(gt){gt!==\"default\"\u0026\u0026!o.hasOwnProperty(gt)\u0026\u0026Object.defineProperty(o,gt,{enumerable:!0,get:function(){return _[gt]}})}),Object.defineProperty(o,\"__esModule\",{value:!0})})});var si=Kt((ef,Ju)=\u003e{Ju.exports=React});var Nl=Kt(on=\u003e{\"use strict\";Object.defineProperty(on,\"__esModule\",{value:!0});var Pi,ls=si(),sl=(Pi=ls)\u0026\u0026typeof Pi==\"object\"\u0026\u0026\"default\"in Pi?Pi.default:Pi;function Ei(o,r){return o.map(function(a,u){return a+r[u]})}function Ni(o,r){return o.map(function(a,u){return a-r[u]})}function qi(o){return Math.hypot.apply(Math,o)}function il(o,r){r===void 0\u0026\u0026(r=o);var a=qi(r),u=a===0?0:1/a,d=r.map(function(m){return u*m});return{distance:qi(o),direction:d}}function rl(o,r,a){var u=qi(r),d=u===0?0:1/u,m=a===0?0:1/a,_=m*u,T=r.map(function(D){return m*D}),k=r.map(function(D){return d*D});return{velocities:T,velocity:_,distance:qi(o),direction:k}}function Do(o){return Math.sign?Math.sign(o):Number(o\u003e0)-Number(o\u003c0)||+o}function ol(o,r,a){return r===0||Math.abs(r)===1/0?function(u,d){return Math.pow(u,5*d)}(o,a):o*r*a/(r+a*o)}function ka(o,r,a,u){return u===void 0\u0026\u0026(u=.15),u===0?function(d,m,_){return Math.max(m,Math.min(d,_))}(o,r,a):o\u003cr?-ol(r-o,a-r,u)+r:o\u003ea?+ol(o-a,a-r,u)+a:o}function It(){return(It=Object.assign||function(o){for(var r=1;r\u003carguments.length;r++){var a=arguments[r];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)\u0026\u0026(o[u]=a[u])}return o}).apply(this,arguments)}function hs(o,r){o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.__proto__=r}function ds(o,r){if(o==null)return{};var a,u,d={},m=Object.keys(o);for(u=0;u\u003cm.length;u++)r.indexOf(a=m[u])\u003e=0||(d[a]=o[a]);return d}function zt(o){if(o===void 0)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return o}function al(o,r){(r==null||r\u003eo.length)\u0026\u0026(r=o.length);for(var a=0,u=new Array(r);a\u003cr;a++)u[a]=o[a];return u}function Po(o,r){var a;if(typeof Symbol==\"undefined\"||o[Symbol.iterator]==null){if(Array.isArray(o)||(a=function(d,m){if(d){if(typeof d==\"string\")return al(d,void 0);var _=Object.prototype.toString.call(d).slice(8,-1);return _===\"Object\"\u0026\u0026d.constructor\u0026\u0026(_=d.constructor.name),_===\"Map\"||_===\"Set\"?Array.from(d):_===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?al(d,void 0):void 0}}(o))||r\u0026\u0026o\u0026\u0026typeof o.length==\"number\"){a\u0026\u0026(o=a);var u=0;return function(){return u\u003e=o.length?{done:!0}:{done:!1,value:o[u++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return(a=o[Symbol.iterator]()).next.bind(a)}function cl(){}function ul(){for(var o=arguments.length,r=new Array(o),a=0;a\u003co;a++)r[a]=arguments[a];return r.length===0?cl:r.length===1?r[0]:function(){for(var u,d,m=Po(r);!(d=m()).done;){var _=d.value;u=_.apply(this,arguments)||u}return u}}function Kn(o,r){if(o===void 0){if(r===void 0)throw new Error(\"Must define fallback value if undefined is expected\");o=r}return Array.isArray(o)?o:[o,o]}function ll(o,r){return Object.assign({},r,o||{})}function Eo(o){if(typeof o==\"function\"){for(var r=arguments.length,a=new Array(r\u003e1?r-1:0),u=1;u\u003cr;u++)a[u-1]=arguments[u];return o.apply(void 0,a)}return o}function Ii(o,r){o===void 0\u0026\u0026(o={});for(var a={},u=0,d=Object.entries(r);u\u003cd.length;u++){var m=d[u],_=m[0],T=m[1];switch(typeof T){case\"function\":a[_]=T.call(a,o[_],_,o);break;case\"object\":a[_]=Ii(o[_],T);break;case\"boolean\":T\u0026\u0026(a[_]=o[_])}}return a}function hl(){return typeof window!=\"undefined\"\u0026\u0026\"ontouchstart\"in window}function dl(o){return\"pointerId\"in o?null:o.type===\"touchend\"?o.changedTouches:o.targetTouches}function Ma(o){return Array.from(dl(o)).map(function(r){return r.identifier})}function rn(o){return{buttons:\"buttons\"in o?o.buttons:0,shiftKey:o.shiftKey,altKey:o.altKey,metaKey:o.metaKey,ctrlKey:o.ctrlKey}}var ji=function(o){return o};function oi(o,r){r===void 0\u0026\u0026(r=ji);var a=dl(o),u=a?a[0]:o;return r([u.clientX,u.clientY])}function pl(o,r,a){a===void 0\u0026\u0026(a=ji);var u=Array.from(o.touches).filter(function(O){return r.includes(O.identifier)}),d=u[0],m=u[1];if(!d||!m)throw Error(\"The event doesn't have two pointers matching the pointerIds\");var _=m.clientX-d.clientX,T=m.clientY-d.clientY,k=(m.clientX+d.clientX)/2,D=(m.clientY+d.clientY)/2;return{values:a([Math.hypot(_,T),-180*Math.atan2(_,T)/Math.PI]),origin:a([k,D])}}function _p(o,r){r===void 0\u0026\u0026(r=ji);var a=o.currentTarget;return r([a.scrollX||a.scrollLeft||0,a.scrollY||a.scrollTop||0])}function fl(o,r){r===void 0\u0026\u0026(r=ji);var a=o.deltaX,u=o.deltaY,d=o.deltaMode;return d===1?(a*=40,u*=40):d===2\u0026\u0026(a*=800,u*=800),r([a,u])}function ml(o,r){return r===void 0\u0026\u0026(r=ji),r([o.scale,o.rotation])}var gl={threshold:function(o){return o===void 0\u0026\u0026(o=0),Kn(o)},rubberband:function(o){switch(o===void 0\u0026\u0026(o=0),o){case!0:return Kn(.15);case!1:return Kn(0);default:return Kn(o)}},enabled:function(o){return o===void 0\u0026\u0026(o=!0),o},triggerAllEvents:function(o){return o===void 0\u0026\u0026(o=!1),o},initial:function(o){return o===void 0\u0026\u0026(o=0),typeof o==\"function\"?o:Kn(o)},transform:!0},Aa=It({},gl,{axis:!0,lockDirection:function(o){return o===void 0\u0026\u0026(o=!1),o},bounds:function(o){if(o===void 0\u0026\u0026(o={}),typeof o==\"function\")return function(m){return Aa.bounds(o(m))};var r=o.left,a=o.right,u=o.top,d=o.bottom;return[[r===void 0?-1/0:r,a===void 0?1/0:a],[u===void 0?-1/0:u,d===void 0?1/0:d]]}}),yp=typeof window!=\"undefined\"\u0026\u0026window.document\u0026\u0026window.document.createElement,bp={enabled:function(o){return o===void 0\u0026\u0026(o=!0),o},domTarget:!0,window:function(o){function r(a){return o.apply(this,arguments)}return r.toString=function(){return o.toString()},r}(function(o){return o===void 0\u0026\u0026(o=yp?window:void 0),o}),eventOptions:function(o){var r=o===void 0?{}:o,a=r.passive,u=r.capture;return{passive:a===void 0||a,capture:u!==void 0\u0026\u0026u}},transform:!0},wp=It({},gl,{bounds:function(o,r,a){var u=a.distanceBounds,d=u===void 0?{}:u,m=a.angleBounds,_=m===void 0?{}:m,T=function(D){var O=ll(Eo(d,D),{min:-1/0,max:1/0});return[O.min,O.max]},k=function(D){var O=ll(Eo(_,D),{min:-1/0,max:1/0});return[O.min,O.max]};return typeof d!=\"function\"\u0026\u0026typeof _!=\"function\"?[T(),k()]:function(D){return[T(D),k(D)]}}}),xp=It({},Aa,{useTouch:function(o){o===void 0\u0026\u0026(o=!1);var r=hl(),a=typeof window!=\"undefined\"\u0026\u0026\"onpointerdown\"in window;return!(!o||!r)||!(!r||a)},experimental_preventWindowScrollY:function(o){return o===void 0\u0026\u0026(o=!1),o},threshold:function(o,r,a){var u=a.filterTaps,d=u!==void 0\u0026\u0026u,m=a.lockDirection,_=a.axis,T=Kn(o,d?3:m!==void 0\u0026\u0026m||(_===void 0?void 0:_)?1:0);return this.filterTaps=d,T},swipeVelocity:function(o){return o===void 0\u0026\u0026(o=.5),Kn(o)},swipeDistance:function(o){return o===void 0\u0026\u0026(o=50),Kn(o)},swipeDuration:function(o){return o===void 0\u0026\u0026(o=250),o},delay:function(o){switch(o===void 0\u0026\u0026(o=0),o){case!0:return 180;case!1:return 0;default:return o}}});function ps(o){return o===void 0\u0026\u0026(o={}),Ii(o,bp)}function ai(o){return o===void 0\u0026\u0026(o={}),Ii(o,Aa)}function vl(o){return o===void 0\u0026\u0026(o={}),Ii(o,wp)}function _l(o){return o===void 0\u0026\u0026(o={}),Ii(o,xp)}function Tp(o){var r=o.domTarget,a=o.eventOptions,u=o.window,d=o.enabled,m=ds(o,[\"domTarget\",\"eventOptions\",\"window\",\"enabled\"]),_=ps({domTarget:r,eventOptions:a,window:u,enabled:d});return _.move=ai(m),_}function Sp(o){var r=o.domTarget,a=o.eventOptions,u=o.window,d=o.enabled,m=ds(o,[\"domTarget\",\"eventOptions\",\"window\",\"enabled\"]),_=ps({domTarget:r,eventOptions:a,window:u,enabled:d});return _.hover=It({enabled:!0},m),_}function kp(o){var r=o.domTarget,a=o.eventOptions,u=o.window,d=o.enabled,m=ds(o,[\"domTarget\",\"eventOptions\",\"window\",\"enabled\"]),_=ps({domTarget:r,eventOptions:a,window:u,enabled:d});return _.drag=_l(m),_}function Mp(o){var r=o.domTarget,a=o.eventOptions,u=o.window,d=o.enabled,m=ds(o,[\"domTarget\",\"eventOptions\",\"window\",\"enabled\"]),_=ps({domTarget:r,eventOptions:a,window:u,enabled:d});return _.pinch=vl(m),_}function Ap(o){var r=o.domTarget,a=o.eventOptions,u=o.window,d=o.enabled,m=ds(o,[\"domTarget\",\"eventOptions\",\"window\",\"enabled\"]),_=ps({domTarget:r,eventOptions:a,window:u,enabled:d});return _.scroll=ai(m),_}function Cp(o){var r=o.domTarget,a=o.eventOptions,u=o.window,d=o.enabled,m=ds(o,[\"domTarget\",\"eventOptions\",\"window\",\"enabled\"]),_=ps({domTarget:r,eventOptions:a,window:u,enabled:d});return _.wheel=ai(m),_}function Ri(o){return It({_active:!1,_blocked:!1,_intentional:[!1,!1],_movement:[0,0],_initial:[0,0],_bounds:[[-1/0,1/0],[-1/0,1/0]],_threshold:[0,0],_lastEventType:void 0,_dragStarted:!1,_dragPreventScroll:!1,_dragIsTap:!0,_dragDelayed:!1,event:void 0,intentional:!1,values:[0,0],velocities:[0,0],delta:[0,0],movement:[0,0],offset:[0,0],lastOffset:[0,0],direction:[0,0],initial:[0,0],previous:[0,0],first:!1,last:!1,active:!1,timeStamp:0,startTime:0,elapsedTime:0,cancel:cl,canceled:!1,memo:void 0,args:void 0},o)}function yl(){return{shared:{hovering:!1,scrolling:!1,wheeling:!1,dragging:!1,moving:!1,pinching:!1,touches:0,buttons:0,down:!1,shiftKey:!1,altKey:!1,metaKey:!1,ctrlKey:!1,locked:!1},drag:Ri({_pointerId:void 0,axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0,tap:!1,swipe:[0,0]}),pinch:Ri({_pointerIds:[],da:[0,0],vdva:[0,0],origin:void 0,turns:0}),wheel:Ri({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0}),move:Ri({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0}),scroll:Ri({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0})}}var Se=new Map,Op=function(o){return o},bl=function(){function o(u,d){var m=this;d===void 0\u0026\u0026(d=[]),this.controller=u,this.args=d,this.debounced=!0,this.setTimeout=function(_,T){var k;T===void 0\u0026\u0026(T=140),clearTimeout(m.controller.timeouts[m.stateKey]);for(var D=arguments.length,O=new Array(D\u003e2?D-2:0),A=2;A\u003cD;A++)O[A-2]=arguments[A];m.controller.timeouts[m.stateKey]=(k=window).setTimeout.apply(k,[_,T].concat(O))},this.clearTimeout=function(){clearTimeout(m.controller.timeouts[m.stateKey])},this.fireGestureHandler=function(_){if(_===void 0\u0026\u0026(_=!1),m.state._blocked)return m.debounced||(m.state._active=!1,m.clean()),null;if(!_\u0026\u0026!m.state.intentional\u0026\u0026!m.config.triggerAllEvents)return null;if(m.state.intentional){var T=m.state.active,k=m.state._active;m.state.active=k,m.state.first=k\u0026\u0026!T,m.state.last=T\u0026\u0026!k,m.controller.state.shared[m.ingKey]=k}var D=m.controller.pointerIds.size||m.controller.touchIds.size,O=m.controller.state.shared.buttons\u003e0||D\u003e0,A=It({},m.controller.state.shared,m.state,m.mapStateValues(m.state),{locked:!!document.pointerLockElement,touches:D,down:O}),N=m.handler(A);return m.state.memo=N!==void 0?N:m.state.memo,A},this.controller=u,this.args=d}var r,a=o.prototype;return a.updateSharedState=function(u){Object.assign(this.controller.state.shared,u)},a.updateGestureState=function(u){Object.assign(this.state,u)},a.checkIntentionality=function(u,d){return{_intentional:u,_blocked:!1}},a.getMovement=function(u){var d=this.config.rubberband,m=this.state,_=m._bounds,T=m._initial,k=m._active,D=m._intentional,O=m.lastOffset,A=m.movement,N=m._threshold,U=this.getInternalMovement(u,this.state),z=D[0]===!1?wl(U[0],N[0]):D[0],X=D[1]===!1?wl(U[1],N[1]):D[1],K=this.checkIntentionality([z,X],U);if(K._blocked)return It({},K,{_movement:U,delta:[0,0]});var $=K._intentional,Y=U,st=[$[0]!==!1?U[0]-$[0]:0,$[1]!==!1?U[1]-$[1]:0],R=Ei(st,O),P=k?d:[0,0];return st=xl(_,Ei(st,T),P),It({},K,{intentional:$[0]!==!1||$[1]!==!1,_initial:T,_movement:Y,movement:st,values:u,offset:xl(_,R,P),delta:Ni(st,A)})},a.clean=function(){this.clearTimeout()},(r=[{key:\"config\",get:function(){return this.controller.config[this.stateKey]}},{key:\"enabled\",get:function(){return this.controller.config.enabled\u0026\u0026this.config.enabled}},{key:\"state\",get:function(){return this.controller.state[this.stateKey]}},{key:\"handler\",get:function(){return this.controller.handlers[this.stateKey]}},{key:\"transform\",get:function(){return this.config.transform||this.controller.config.transform||Op}}])\u0026\u0026function(u,d){for(var m=0;m\u003cd.length;m++){var _=d[m];_.enumerable=_.enumerable||!1,_.configurable=!0,\"value\"in _\u0026\u0026(_.writable=!0),Object.defineProperty(u,_.key,_)}}(o.prototype,r),o}();function wl(o,r){return Math.abs(o)\u003e=r\u0026\u0026Do(o)*r}function xl(o,r,a){var u=r[1],d=a[1],m=o[0],_=o[1],T=_[0],k=_[1];return[ka(r[0],m[0],m[1],a[0]),ka(u,T,k,d)]}function be(o,r,a){var u=o.state,d=r.timeStamp;return{_lastEventType:r.type,event:r,timeStamp:d,elapsedTime:a?0:d-u.startTime,previous:u.values}}function fs(o,r,a,u){var d=o.config,m=o.stateKey,_=o.args,T=o.transform,k=o.state.offset,D=a.timeStamp,O=d.initial,A=d.bounds,N=Ni(T(d.threshold),T([0,0])).map(Math.abs),U=It({},yl()[m],{_active:!0,args:_,values:r,initial:u??r,_threshold:N,offset:k,lastOffset:k,startTime:D});return It({},U,{_initial:Eo(O,U),_bounds:Eo(A,U)})}var Dp=function(o){var r=this;this.classes=o,this.pointerIds=new Set,this.touchIds=new Set,this.supportsTouchEvents=hl(),this.supportsGestureEvents=function(){try{return\"constructor\"in GestureEvent}catch(a){return!1}}(),this.bind=function(){for(var a=arguments.length,u=new Array(a),d=0;d\u003ca;d++)u[d]=arguments[d];for(var m,_={},T=Po(r.classes);!(m=T()).done;){var k=m.value;new k(r,u).addBindings(_)}var D=function(A){oe(_,A,function(N){return r.nativeRefs[A](It({},r.state.shared,{event:N,args:u}))})};for(var O in r.nativeRefs)D(O);return r.config.domTarget?Np(r,_):qp(r,_)},this.effect=function(){return r.config.domTarget\u0026\u0026r.bind(),r.clean},this.clean=function(){var a=Ml(r.config),u=r.config.eventOptions;a\u0026\u0026Fi(a,kl(r.domListeners),u),Object.values(r.timeouts).forEach(clearTimeout),function(d){var m=d.config,_=m.window,T=m.eventOptions,k=d.windowListeners;if(_){for(var D in k)Fi(_,k[D],T);d.windowListeners={}}}(r)},this.classes=o,this.state=yl(),this.timeouts={},this.domListeners=[],this.windowListeners={}};function Tl(o,r){\"pointerId\"in r?o.pointerIds.add(r.pointerId):o.touchIds=new Set(Ma(r))}function Sl(o,r){\"pointerId\"in r?o.pointerIds.delete(r.pointerId):Ma(r).forEach(function(a){return o.touchIds.delete(a)})}function Pp(o,r,a){var u=o.config,d=o.windowListeners;a===void 0\u0026\u0026(a=u.eventOptions),u.window\u0026\u0026(Fi(u.window,d[r],a),delete d[r])}function Ep(o,r,a,u){var d=o.config,m=o.windowListeners;a===void 0\u0026\u0026(a=[]),u===void 0\u0026\u0026(u=d.eventOptions),d.window\u0026\u0026(Fi(d.window,m[r],u),Al(d.window,m[r]=a,u))}function Np(o,r){var a=o.config,u=o.domListeners,d=Ml(a);if(!d)throw new Error(\"domTarget must be defined\");var m=a.eventOptions;Fi(d,kl(u),m);for(var _=0,T=Object.entries(r);_\u003cT.length;_++){var k=T[_],D=k[1],O=k[0].slice(2).toLowerCase();u.push([O,ul.apply(void 0,D)])}Al(d,u,m)}function qp(o,r){for(var a={},u=o.config.eventOptions.capture?\"Capture\":\"\",d=0,m=Object.entries(r);d\u003cm.length;d++){var _=m[d],T=_[0],k=_[1],D=Array.isArray(k)?k:[k];a[T+u]=ul.apply(void 0,D)}return a}function kl(o){return o===void 0\u0026\u0026(o=[]),o.splice(0,o.length)}function Ml(o){var r=o.domTarget;return r\u0026\u0026\"current\"in r?r.current:r}function oe(o,r,a){o[r]||(o[r]=[]),o[r].push(a)}function Al(o,r,a){r===void 0\u0026\u0026(r=[]),a===void 0\u0026\u0026(a={});for(var u,d=Po(r);!(u=d()).done;){var m=u.value;o.addEventListener(m[0],m[1],a)}}function Fi(o,r,a){r===void 0\u0026\u0026(r=[]),a===void 0\u0026\u0026(a={});for(var u,d=Po(r);!(u=d()).done;){var m=u.value;o.removeEventListener(m[0],m[1],a)}}function ms(o,r,a){a===void 0\u0026\u0026(a={});var u=function(m){var _=new Set;return m.drag\u0026\u0026_.add(Se.get(\"drag\")),m.wheel\u0026\u0026_.add(Se.get(\"wheel\")),m.scroll\u0026\u0026_.add(Se.get(\"scroll\")),m.move\u0026\u0026_.add(Se.get(\"move\")),m.pinch\u0026\u0026_.add(Se.get(\"pinch\")),m.hover\u0026\u0026_.add(Se.get(\"hover\")),_}(o),d=sl.useMemo(function(){return new Dp(u)},[]);return d.config=r,d.handlers=o,d.nativeRefs=a,sl.useEffect(d.effect,[]),d.config.domTarget?Ip:d.bind}function Ip(){}var No=function(o){function r(){return o.apply(this,arguments)||this}hs(r,o);var a=r.prototype;return a.getInternalMovement=function(u,d){return Ni(u,d.initial)},a.checkIntentionality=function(u,d){if(u[0]===!1\u0026\u0026u[1]===!1)return{_intentional:u,axis:this.state.axis};var m=d.map(Math.abs),_=m[0],T=m[1],k=this.state.axis||(_\u003eT?\"x\":_\u003cT?\"y\":void 0);return this.config.axis||this.config.lockDirection?k?this.config.axis\u0026\u0026k!==this.config.axis?{_intentional:u,_blocked:!0,axis:k}:(u[k===\"x\"?1:0]=!1,{_intentional:u,_blocked:!1,axis:k}):{_intentional:[!1,!1],_blocked:!1,axis:k}:{_intentional:u,_blocked:!1,axis:k}},a.getKinematics=function(u,d){var m=this.getMovement(u);return m._blocked||Object.assign(m,rl(m.movement,m.delta,d.timeStamp-this.state.timeStamp)),m},a.mapStateValues=function(u){return{xy:u.values,vxvy:u.velocities}},r}(bl);function Cl(o){\"persist\"in o\u0026\u0026typeof o.persist==\"function\"\u0026\u0026o.persist()}var Ol=function(o){function r(){var u;return(u=o.apply(this,arguments)||this).ingKey=\"dragging\",u.stateKey=\"drag\",u.setPointerCapture=function(d){if(!u.config.useTouch\u0026\u0026!document.pointerLockElement){var m=d.target,_=d.pointerId;m\u0026\u0026\"setPointerCapture\"in m\u0026\u0026m.setPointerCapture(_),u.updateGestureState({_dragTarget:m,_dragPointerId:_})}},u.releasePointerCapture=function(){if(!u.config.useTouch\u0026\u0026!document.pointerLockElement){var d=u.state,m=d._dragTarget,_=d._dragPointerId;if(_\u0026\u0026m\u0026\u0026\"releasePointerCapture\"in m\u0026\u0026(!(\"hasPointerCapture\"in m)||m.hasPointerCapture(_)))try{m.releasePointerCapture(_)}catch(T){}}},u.preventScroll=function(d){u.state._dragPreventScroll\u0026\u0026d.cancelable\u0026\u0026d.preventDefault()},u.getEventId=function(d){return u.config.useTouch?d.changedTouches[0].identifier:d.pointerId},u.isValidEvent=function(d){return u.state._pointerId===u.getEventId(d)},u.shouldPreventWindowScrollY=u.config.experimental_preventWindowScrollY\u0026\u0026u.controller.supportsTouchEvents,u.setUpWindowScrollDetection=function(d){Cl(d),Ep(u.controller,u.stateKey,[[\"touchmove\",u.preventScroll],[\"touchend\",u.clean.bind(zt(u))],[\"touchcancel\",u.clean.bind(zt(u))]],{passive:!1}),u.setTimeout(u.startDrag.bind(zt(u)),250,d)},u.setUpDelayedDragTrigger=function(d){u.state._dragDelayed=!0,Cl(d),u.setTimeout(u.startDrag.bind(zt(u)),u.config.delay,d)},u.setStartState=function(d){var m=oi(d,u.transform);u.updateSharedState(rn(d)),u.updateGestureState(It({},fs(zt(u),m,d),be(zt(u),d,!0),{_pointerId:u.getEventId(d)})),u.updateGestureState(u.getMovement(m))},u.onDragStart=function(d){Tl(u.controller,d),u.enabled\u0026\u0026!u.state._active\u0026\u0026(u.setStartState(d),u.setPointerCapture(d),u.shouldPreventWindowScrollY?u.setUpWindowScrollDetection(d):u.config.delay\u003e0?u.setUpDelayedDragTrigger(d):u.startDrag(d,!0))},u.onDragChange=function(d){if(!u.state.canceled\u0026\u0026u.state._active\u0026\u0026u.isValidEvent(d)\u0026\u0026(u.state._lastEventType!==d.type||d.timeStamp!==u.state.timeStamp)){var m;m=document.pointerLockElement?Ei(u.transform([d.movementX,d.movementY]),u.state.values):oi(d,u.transform);var _=u.getKinematics(m,d);if(!u.state._dragStarted){if(u.state._dragDelayed)return void u.startDrag(d);if(!u.shouldPreventWindowScrollY||u.state._dragPreventScroll||!_.axis)return;if(_.axis!==\"x\")return void(u.state._active=!1);u.startDrag(d)}var T=rn(d);u.updateSharedState(T);var k=be(zt(u),d),D=qi(_._movement),O=u.state._dragIsTap;O\u0026\u0026D\u003e=3\u0026\u0026(O=!1),u.updateGestureState(It({},k,_,{_dragIsTap:O})),u.fireGestureHandler()}},u.onDragEnd=function(d){if(Sl(u.controller,d),u.isValidEvent(d)\u0026\u0026(u.clean(),u.state._active)){u.state._active=!1;var m=u.state._dragIsTap,_=u.state.velocities,T=_[0],k=_[1],D=u.state.movement,O=D[0],A=D[1],N=u.state._intentional,U=N[0],z=N[1],X=u.config.swipeVelocity,K=X[0],$=X[1],Y=u.config.swipeDistance,st=Y[0],R=Y[1],P=u.config.swipeDuration,B=It({},be(zt(u),d),u.getMovement(u.state.values)),F=[0,0];B.elapsedTime\u003cP\u0026\u0026(U!==!1\u0026\u0026Math.abs(T)\u003eK\u0026\u0026Math.abs(O)\u003est\u0026\u0026(F[0]=Do(T)),z!==!1\u0026\u0026Math.abs(k)\u003e$\u0026\u0026Math.abs(A)\u003eR\u0026\u0026(F[1]=Do(k))),u.updateSharedState({buttons:0}),u.updateGestureState(It({},B,{tap:m,swipe:F})),u.fireGestureHandler(u.config.filterTaps\u0026\u0026m===!0)}},u.clean=function(){o.prototype.clean.call(zt(u)),u.state._dragStarted=!1,u.releasePointerCapture(),Pp(u.controller,u.stateKey)},u.onCancel=function(){u.state.canceled||(u.updateGestureState({canceled:!0,_active:!1}),u.updateSharedState({buttons:0}),setTimeout(function(){return u.fireGestureHandler()},0))},u.onClick=function(d){u.state._dragIsTap||d.stopPropagation()},u}hs(r,o);var a=r.prototype;return a.startDrag=function(u,d){d===void 0\u0026\u0026(d=!1),this.state._active\u0026\u0026!this.state._dragStarted\u0026\u0026(d||this.setStartState(u),this.updateGestureState({_dragStarted:!0,_dragPreventScroll:!0,cancel:this.onCancel}),this.clearTimeout(),this.fireGestureHandler())},a.addBindings=function(u){this.config.useTouch?(oe(u,\"onTouchStart\",this.onDragStart),oe(u,\"onTouchMove\",this.onDragChange),oe(u,\"onTouchEnd\",this.onDragEnd),oe(u,\"onTouchCancel\",this.onDragEnd)):(oe(u,\"onPointerDown\",this.onDragStart),oe(u,\"onPointerMove\",this.onDragChange),oe(u,\"onPointerUp\",this.onDragEnd),oe(u,\"onPointerCancel\",this.onDragEnd)),this.config.filterTaps\u0026\u0026oe(u,this.controller.config.eventOptions.capture?\"onClick\":\"onClickCapture\",this.onClick)},r}(No);function ci(o,r){var a,u,d=[],m=!1;return function(){for(var _=arguments.length,T=new Array(_),k=0;k\u003c_;k++)T[k]=arguments[k];return m\u0026\u0026a===this\u0026\u0026r(T,d)||(u=o.apply(this,T),m=!0,a=this,d=T),u}}function ui(o,r){try{return function a(u,d){if(u===d)return!0;if(u\u0026\u0026d\u0026\u0026typeof u==\"object\"\u0026\u0026typeof d==\"object\"){if(u.constructor!==d.constructor)return!1;var m,_,T,k;if(Array.isArray(u)){if((m=u.length)!==d.length)return!1;for(_=m;_--!=0;)if(!a(u[_],d[_]))return!1;return!0}if(typeof Map==\"function\"\u0026\u0026u instanceof Map\u0026\u0026d instanceof Map){if(u.size!==d.size)return!1;for(k=u.entries();!(_=k.next()).done;)if(!d.has(_.value[0]))return!1;for(k=u.entries();!(_=k.next()).done;)if(!a(_.value[1],d.get(_.value[0])))return!1;return!0}if(typeof Set==\"function\"\u0026\u0026u instanceof Set\u0026\u0026d instanceof Set){if(u.size!==d.size)return!1;for(k=u.entries();!(_=k.next()).done;)if(!d.has(_.value[0]))return!1;return!0}if(u.constructor===RegExp)return u.source===d.source\u0026\u0026u.flags===d.flags;if(u.valueOf!==Object.prototype.valueOf)return u.valueOf()===d.valueOf();if(u.toString!==Object.prototype.toString)return u.toString()===d.toString();if((m=(T=Object.keys(u)).length)!==Object.keys(d).length)return!1;for(_=m;_--!=0;)if(!Object.prototype.hasOwnProperty.call(d,T[_]))return!1;if(typeof Element!=\"undefined\"\u0026\u0026u instanceof Element)return!1;for(_=m;_--!=0;)if(!(T[_]===\"_owner\"\u0026\u0026u.$$typeof||a(u[T[_]],d[T[_]])))return!1;return!0}return u!=u\u0026\u0026d!=d}(o,r)}catch(a){if((a.message||\"\").match(/stack|recursion/i))return console.warn(\"react-fast-compare cannot handle circular refs\"),!1;throw a}}var Dl=function(o){function r(){var a;return(a=o.apply(this,arguments)||this).ingKey=\"pinching\",a.stateKey=\"pinch\",a.onPinchStart=function(u){Tl(a.controller,u);var d=a.controller.touchIds;if(a.enabled\u0026\u0026!(a.state._active\u0026\u0026a.state._pointerIds.every(function(D){return d.has(D)})||d.size\u003c2)){var m=Array.from(d).slice(0,2),_=pl(u,m,a.transform),T=_.values,k=_.origin;a.updateSharedState(rn(u)),a.updateGestureState(It({},fs(zt(a),T,u),be(zt(a),u,!0),{_pointerIds:m,cancel:a.onCancel,origin:k})),a.updateGestureState(a.getMovement(T)),a.fireGestureHandler()}},a.onPinchChange=function(u){var d=a.state;if(!d.canceled\u0026\u0026d._active\u0026\u0026u.timeStamp!==a.state.timeStamp){var m=rn(u);a.updateSharedState(m);try{var _=pl(u,a.state._pointerIds,a.transform),T=_.origin,k=a.getKinematics(_.values,u);a.updateGestureState(It({},be(zt(a),u),k,{origin:T})),a.fireGestureHandler()}catch(D){a.onPinchEnd(u)}}},a.onPinchEnd=function(u){Sl(a.controller,u);var d=Ma(u);a.state._pointerIds.every(function(m){return!d.includes(m)})||(a.clean(),a.state._active\u0026\u0026(a.updateGestureState(It({},be(zt(a),u),a.getMovement(a.state.values),{_active:!1})),a.fireGestureHandler()))},a.onCancel=function(){a.state.canceled||(a.updateGestureState({_active:!1,canceled:!0}),setTimeout(function(){return a.fireGestureHandler()},0))},a.onGestureStart=function(u){if(a.enabled){u.preventDefault();var d=ml(u,a.transform);a.updateSharedState(rn(u)),a.updateGestureState(It({},fs(zt(a),d,u),be(zt(a),u,!0),{origin:[u.clientX,u.clientY],cancel:a.onCancel})),a.updateGestureState(a.getMovement(d)),a.fireGestureHandler()}},a.onGestureChange=function(u){var d=a.state;if(!d.canceled\u0026\u0026d._active){u.preventDefault();var m=rn(u);a.updateSharedState(m);var _=ml(u,a.transform);_[0]=260*(_[0]-a.state.event.scale)+a.state.values[0];var T=a.getKinematics(_,u);a.updateGestureState(It({},be(zt(a),u),T,{origin:[u.clientX,u.clientY]})),a.fireGestureHandler()}},a.onGestureEnd=function(u){a.clean(),a.state._active\u0026\u0026(a.updateGestureState(It({},be(zt(a),u),a.getMovement(a.state.values),{_active:!1,origin:[u.clientX,u.clientY]})),a.fireGestureHandler())},a.wheelShouldRun=function(u){return a.enabled\u0026\u0026u.ctrlKey},a.getWheelValuesFromEvent=function(u){var d=fl(u,a.transform),m=a.state.values,_=m[1],T=7*-d[1],k=_!==void 0?_:0;return{values:[m[0]+T,k],origin:[u.clientX,u.clientY],delta:[T,k]}},a.onWheel=function(u){a.wheelShouldRun(u)\u0026\u0026(a.setTimeout(a.onWheelEnd),a.state._active?a.onWheelChange(u):a.onWheelStart(u))},a.onWheelStart=function(u){var d=a.getWheelValuesFromEvent(u),m=d.values,_=d.delta,T=d.origin;u.cancelable\u0026\u0026u.preventDefault(),a.updateSharedState(rn(u)),a.updateGestureState(It({},fs(zt(a),m,u,a.state.values),be(zt(a),u,!0),{offset:m,delta:_,origin:T})),a.updateGestureState(a.getMovement(m)),a.fireGestureHandler()},a.onWheelChange=function(u){u.cancelable\u0026\u0026u.preventDefault(),a.updateSharedState(rn(u));var d=a.getWheelValuesFromEvent(u),m=d.values,_=d.origin,T=d.delta;a.updateGestureState(It({},be(zt(a),u),a.getKinematics(m,u),{origin:_,delta:T})),a.fireGestureHandler()},a.onWheelEnd=function(){a.clean(),a.state._active\u0026\u0026(a.state._active=!1,a.updateGestureState(a.getMovement(a.state.values)),a.fireGestureHandler())},a}return hs(r,o),r.prototype.addBindings=function(a){this.controller.config.domTarget\u0026\u0026!this.controller.supportsTouchEvents\u0026\u0026this.controller.supportsGestureEvents?(oe(a,\"onGestureStart\",this.onGestureStart),oe(a,\"onGestureChange\",this.onGestureChange),oe(a,\"onGestureEnd\",this.onGestureEnd)):(oe(a,\"onTouchStart\",this.onPinchStart),oe(a,\"onTouchMove\",this.onPinchChange),oe(a,\"onTouchEnd\",this.onPinchEnd),oe(a,\"onTouchCancel\",this.onPinchEnd),oe(a,\"onWheel\",this.onWheel))},r}(function(o){function r(){return o.apply(this,arguments)||this}hs(r,o);var a=r.prototype;return a.getInternalMovement=function(u,d){var m=d.values[1],_=u[0],T=u[1],k=T===void 0?m:T,D=k-m,O=d.turns;return Math.abs(D)\u003e270\u0026\u0026(O+=Do(D)),Ni([_,k-360*O],d.initial)},a.getKinematics=function(u,d){var m=this.getMovement(u);return It({turns:(u[1]-m._movement[1]-this.state.initial[1])/360},m,ds(rl(m.movement,m.delta,d.timeStamp-this.state.timeStamp),[\"distance\",\"velocity\"]))},a.mapStateValues=function(u){return{da:u.values,vdva:u.velocities}},r}(bl)),Pl=function(o){function r(){var a;return(a=o.apply(this,arguments)||this).ingKey=\"wheeling\",a.stateKey=\"wheel\",a.debounced=!0,a.handleEvent=function(u){if((!u.ctrlKey||!(\"pinch\"in a.controller.handlers))\u0026\u0026a.enabled){a.setTimeout(a.onEnd),a.updateSharedState(rn(u));var d=Ei(fl(u,a.transform),a.state.values);if(a.state._active)a.updateGestureState(It({},be(zt(a),u),a.getKinematics(d,u)));else{a.updateGestureState(It({},fs(zt(a),d,u,a.state.values),be(zt(a),u,!0)));var m=a.getMovement(d),_=il(m.delta);a.updateGestureState(m),a.updateGestureState(_)}a.fireGestureHandler()}},a.onEnd=function(){if(a.clean(),a.state._active){var u=a.getMovement(a.state.values);a.updateGestureState(u),a.updateGestureState({_active:!1,velocities:[0,0],velocity:0}),a.fireGestureHandler()}},a}return hs(r,o),r.prototype.addBindings=function(a){oe(a,\"onWheel\",this.handleEvent)},r}(No),qo=function(o){function r(){var a;return(a=o.apply(this,arguments)||this).ingKey=\"moving\",a.stateKey=\"move\",a.debounced=!0,a.onMove=function(u){a.enabled\u0026\u0026(a.setTimeout(a.onMoveEnd),a.state._active?a.onMoveChange(u):a.onMoveStart(u))},a.onMoveStart=function(u){a.updateSharedState(rn(u));var d=oi(u,a.transform);a.updateGestureState(It({},fs(zt(a),d,u),be(zt(a),u,!0))),a.updateGestureState(a.getMovement(d)),a.fireGestureHandler()},a.onMoveChange=function(u){a.updateSharedState(rn(u));var d=oi(u,a.transform);a.updateGestureState(It({},be(zt(a),u),a.getKinematics(d,u))),a.fireGestureHandler()},a.onMoveEnd=function(){a.clean(),a.state._active\u0026\u0026(a.updateGestureState(a.getMovement(a.state.values)),a.updateGestureState({velocities:[0,0],velocity:0,_active:!1}),a.fireGestureHandler())},a.hoverTransform=function(){return a.controller.config.hover.transform||a.controller.config.transform},a.onPointerEnter=function(u){if(a.controller.state.shared.hovering=!0,a.controller.config.enabled){if(a.controller.config.hover.enabled){var d=oi(u,a.hoverTransform()),m=It({},a.controller.state.shared,a.state,be(zt(a),u,!0),{args:a.args,values:d,active:!0,hovering:!0});a.controller.handlers.hover(It({},m,a.mapStateValues(m)))}\"move\"in a.controller.handlers\u0026\u0026a.onMoveStart(u)}},a.onPointerLeave=function(u){if(a.controller.state.shared.hovering=!1,\"move\"in a.controller.handlers\u0026\u0026a.onMoveEnd(),a.controller.config.hover.enabled){var d=oi(u,a.hoverTransform()),m=It({},a.controller.state.shared,a.state,be(zt(a),u),{args:a.args,values:d,active:!1});a.controller.handlers.hover(It({},m,a.mapStateValues(m)))}},a}return hs(r,o),r.prototype.addBindings=function(a){\"move\"in this.controller.handlers\u0026\u0026oe(a,\"onPointerMove\",this.onMove),\"hover\"in this.controller.handlers\u0026\u0026(oe(a,\"onPointerEnter\",this.onPointerEnter),oe(a,\"onPointerLeave\",this.onPointerLeave))},r}(No),El=function(o){function r(){var a;return(a=o.apply(this,arguments)||this).ingKey=\"scrolling\",a.stateKey=\"scroll\",a.debounced=!0,a.handleEvent=function(u){if(a.enabled){a.clearTimeout(),a.setTimeout(a.onEnd);var d=_p(u,a.transform);if(a.updateSharedState(rn(u)),a.state._active)a.updateGestureState(It({},be(zt(a),u),a.getKinematics(d,u)));else{a.updateGestureState(It({},fs(zt(a),d,u,a.state.values),be(zt(a),u,!0)));var m=a.getMovement(d),_=il(m.delta);a.updateGestureState(m),a.updateGestureState(_)}a.fireGestureHandler()}},a.onEnd=function(){a.clean(),a.state._active\u0026\u0026(a.updateGestureState(It({},a.getMovement(a.state.values),{_active:!1,velocities:[0,0],velocity:0})),a.fireGestureHandler())},a}return hs(r,o),r.prototype.addBindings=function(a){oe(a,\"onScroll\",this.handleEvent)},r}(No),jp=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function Vi(o,r){var a=r+\"Start\",u=r+\"End\";return function(d){var m=void 0;return d.first\u0026\u0026a in o\u0026\u0026o[a](d),r in o\u0026\u0026(m=o[r](d)),d.last\u0026\u0026u in o\u0026\u0026o[u](d),m}}on.addV=Ei,on.rubberbandIfOutOfBounds=ka,on.subV=Ni,on.useDrag=function(o,r){r===void 0\u0026\u0026(r={}),Se.set(\"drag\",Ol);var a=ls.useRef();return a.current||(a.current=ci(kp,ui)),ms({drag:o},a.current(r))},on.useGesture=function(o,r){r===void 0\u0026\u0026(r={});var a=function(k){var D={},O={},A=new Set;for(var N in k)jp.test(N)?(A.add(RegExp.lastMatch),O[N]=k[N]):D[N]=k[N];return[O,D,A]}(o),u=a[0],d=a[1],m=a[2];Se.set(\"drag\",Ol),Se.set(\"hover\",qo),Se.set(\"move\",qo),Se.set(\"pinch\",Dl),Se.set(\"scroll\",El),Se.set(\"wheel\",Pl);var _=function(k,D){k===void 0\u0026\u0026(k={}),D===void 0\u0026\u0026(D=new Set);var O=k.drag,A=k.wheel,N=k.move,U=k.scroll,z=k.pinch,X=k.hover,K=ps({domTarget:k.domTarget,eventOptions:k.eventOptions,transform:k.transform,window:k.window,enabled:k.enabled});return D.has(\"onDrag\")\u0026\u0026(K.drag=_l(O)),D.has(\"onWheel\")\u0026\u0026(K.wheel=ai(A)),D.has(\"onScroll\")\u0026\u0026(K.scroll=ai(U)),D.has(\"onMove\")\u0026\u0026(K.move=ai(N)),D.has(\"onPinch\")\u0026\u0026(K.pinch=vl(z)),D.has(\"onHover\")\u0026\u0026(K.hover=It({enabled:!0},X)),K}(r,m),T={};return m.has(\"onDrag\")\u0026\u0026(T.drag=Vi(u,\"onDrag\")),m.has(\"onWheel\")\u0026\u0026(T.wheel=Vi(u,\"onWheel\")),m.has(\"onScroll\")\u0026\u0026(T.scroll=Vi(u,\"onScroll\")),m.has(\"onMove\")\u0026\u0026(T.move=Vi(u,\"onMove\")),m.has(\"onPinch\")\u0026\u0026(T.pinch=Vi(u,\"onPinch\")),m.has(\"onHover\")\u0026\u0026(T.hover=u.onHover),ms(T,_,d)},on.useHover=function(o,r){r===void 0\u0026\u0026(r={}),Se.set(\"hover\",qo);var a=ls.useRef();return a.current||(a.current=ci(Sp,ui)),ms({hover:o},a.current(r))},on.useMove=function(o,r){r===void 0\u0026\u0026(r={}),Se.set(\"move\",qo);var a=ls.useRef();return a.current||(a.current=ci(Tp,ui)),ms({move:o},a.current(r))},on.usePinch=function(o,r){r===void 0\u0026\u0026(r={}),Se.set(\"pinch\",Dl);var a=ls.useRef();return a.current||(a.current=ci(Mp,ui)),ms({pinch:o},a.current(r))},on.useScroll=function(o,r){r===void 0\u0026\u0026(r={}),Se.set(\"scroll\",El);var a=ls.useRef();return a.current||(a.current=ci(Ap,ui)),ms({scroll:o},a.current(r))},on.useWheel=function(o,r){r===void 0\u0026\u0026(r={}),Se.set(\"wheel\",Pl);var a=ls.useRef();return a.current||(a.current=ci(Cp,ui)),ms({wheel:o},a.current(r))}});var Ca=Kt((af,ql)=\u003e{\"use strict\";ql.exports=Nl()});var Da=Kt((Wi,Oa)=\u003e{(function(o,r){typeof Wi==\"object\"\u0026\u0026typeof Oa==\"object\"?Oa.exports=r():typeof define==\"function\"\u0026\u0026define.amd?define([],r):typeof Wi==\"object\"?Wi.Tone=r():o.Tone=r()})(typeof self!=\"undefined\"?self:Wi,function(){return function(o){var r={};function a(u){if(r[u])return r[u].exports;var d=r[u]={i:u,l:!1,exports:{}};return o[u].call(d.exports,d,d.exports,a),d.l=!0,d.exports}return a.m=o,a.c=r,a.d=function(u,d,m){a.o(u,d)||Object.defineProperty(u,d,{enumerable:!0,get:m})},a.r=function(u){typeof Symbol!=\"undefined\"\u0026\u0026Symbol.toStringTag\u0026\u0026Object.defineProperty(u,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(u,\"__esModule\",{value:!0})},a.t=function(u,d){if(1\u0026d\u0026\u0026(u=a(u)),8\u0026d||4\u0026d\u0026\u0026typeof u==\"object\"\u0026\u0026u\u0026\u0026u.__esModule)return u;var m=Object.create(null);if(a.r(m),Object.defineProperty(m,\"default\",{enumerable:!0,value:u}),2\u0026d\u0026\u0026typeof u!=\"string\")for(var _ in u)a.d(m,_,function(T){return u[T]}.bind(null,_));return m},a.n=function(u){var d=u\u0026\u0026u.__esModule?function(){return u.default}:function(){return u};return a.d(d,\"a\",d),d},a.o=function(u,d){return Object.prototype.hasOwnProperty.call(u,d)},a.p=\"\",a(a.s=9)}([function(o,r,a){(function(u,d,m,_){\"use strict\";function T(L){return L\u0026\u0026typeof L==\"object\"\u0026\u0026\"default\"in L?L:{default:L}}var k=T(d),D=T(m),O=T(_),A=function(L,J,it){return{endTime:J,insertTime:it,type:\"exponentialRampToValue\",value:L}},N=function(L,J,it){return{endTime:J,insertTime:it,type:\"linearRampToValue\",value:L}},U=function(L,J){return{startTime:J,type:\"setValue\",value:L}},z=function(L,J,it){return{duration:it,startTime:J,type:\"setValueCurve\",values:L}},X=function(L,J,it){var et=it.startTime,ht=it.target,rt=it.timeConstant;return ht+(J-ht)*Math.exp((et-L)/rt)},K=function(L){return L.type===\"exponentialRampToValue\"},$=function(L){return L.type===\"linearRampToValue\"},Y=function(L){return K(L)||$(L)},st=function(L){return L.type===\"setValue\"},R=function(L){return L.type===\"setValueCurve\"},P=function L(J,it,et,ht){var rt=J[it];return rt===void 0?ht:Y(rt)||st(rt)?rt.value:R(rt)?rt.values[rt.values.length-1]:X(et,L(J,it-1,rt.startTime,ht),rt)},B=function(L,J,it,et,ht){return it===void 0?[et.insertTime,ht]:Y(it)?[it.endTime,it.value]:st(it)?[it.startTime,it.value]:R(it)?[it.startTime+it.duration,it.values[it.values.length-1]]:[it.startTime,P(L,J-1,it.startTime,ht)]},F=function(L){return L.type===\"cancelAndHold\"},tt=function(L){return L.type===\"cancelScheduledValues\"},at=function(L){return F(L)||tt(L)?L.cancelTime:K(L)||$(L)?L.endTime:L.startTime},pt=function(L,J,it,et){var ht=et.endTime,rt=et.value;return it===rt?rt:0\u003cit\u0026\u00260\u003crt||it\u003c0\u0026\u0026rt\u003c0?it*Math.pow(rt/it,(L-J)/(ht-J)):0},Dt=function(L,J,it,et){return it+(L-J)/(et.endTime-J)*(et.value-it)},jt=function(L,J){var it=J.duration,et=J.startTime,ht=J.values;return function(rt,At){var Gt=Math.floor(At),le=Math.ceil(At);return Gt===le?rt[Gt]:(1-(At-Gt))*rt[Gt]+(1-(le-At))*rt[le]}(ht,(L-et)/it*(ht.length-1))},Ht=function(L){return L.type===\"setTarget\"},re=function(){function L(J){D.default(this,L),this._automationEvents=[],this._currenTime=0,this._defaultValue=J}return O.default(L,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:\"add\",value:function(J){var it=at(J);if(F(J)||tt(J)){var et=this._automationEvents.findIndex(function(Tt){return tt(J)\u0026\u0026R(Tt)?Tt.startTime+Tt.duration\u003e=it:at(Tt)\u003e=it}),ht=this._automationEvents[et];if(et!==-1\u0026\u0026(this._automationEvents=this._automationEvents.slice(0,et)),F(J)){var rt=this._automationEvents[this._automationEvents.length-1];if(ht!==void 0\u0026\u0026Y(ht)){if(Ht(rt))throw new Error(\"The internal list is malformed.\");var At=R(rt)?rt.startTime+rt.duration:at(rt),Gt=R(rt)?rt.values[rt.values.length-1]:rt.value,le=K(ht)?pt(it,At,Gt,ht):Dt(it,At,Gt,ht),Z=K(ht)?A(le,it,this._currenTime):N(le,it,this._currenTime);this._automationEvents.push(Z)}rt!==void 0\u0026\u0026Ht(rt)\u0026\u0026this._automationEvents.push(U(this.getValue(it),it)),rt!==void 0\u0026\u0026R(rt)\u0026\u0026rt.startTime+rt.duration\u003eit\u0026\u0026(this._automationEvents[this._automationEvents.length-1]=z(new Float32Array([6,7]),rt.startTime,it-rt.startTime))}}else{var lt=this._automationEvents.findIndex(function(Tt){return at(Tt)\u003eit}),xt=lt===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[lt-1];if(xt!==void 0\u0026\u0026R(xt)\u0026\u0026at(xt)+xt.duration\u003eit)return!1;var Mt=K(J)?A(J.value,J.endTime,this._currenTime):$(J)?N(J.value,it,this._currenTime):J;if(lt===-1)this._automationEvents.push(Mt);else{if(R(J)\u0026\u0026it+J.duration\u003eat(this._automationEvents[lt]))return!1;this._automationEvents.splice(lt,0,Mt)}}return!0}},{key:\"flush\",value:function(J){var it=this._automationEvents.findIndex(function(rt){return at(rt)\u003eJ});if(it\u003e1){var et=this._automationEvents.slice(it-1),ht=et[0];Ht(ht)\u0026\u0026et.unshift(U(P(this._automationEvents,it-2,ht.startTime,this._defaultValue),ht.startTime)),this._automationEvents=et}}},{key:\"getValue\",value:function(J){if(this._automationEvents.length===0)return this._defaultValue;var it=this._automationEvents[this._automationEvents.length-1],et=this._automationEvents.findIndex(function(gt){return at(gt)\u003eJ}),ht=this._automationEvents[et],rt=at(it)\u003c=J?it:this._automationEvents[et-1];if(rt!==void 0\u0026\u0026Ht(rt)\u0026\u0026(ht===void 0||!Y(ht)||ht.insertTime\u003eJ))return X(J,P(this._automationEvents,et-2,rt.startTime,this._defaultValue),rt);if(rt!==void 0\u0026\u0026st(rt)\u0026\u0026(ht===void 0||!Y(ht)))return rt.value;if(rt!==void 0\u0026\u0026R(rt)\u0026\u0026(ht===void 0||!Y(ht)||rt.startTime+rt.duration\u003eJ))return J\u003crt.startTime+rt.duration?jt(J,rt):rt.values[rt.values.length-1];if(rt!==void 0\u0026\u0026Y(rt)\u0026\u0026(ht===void 0||!Y(ht)))return rt.value;if(ht!==void 0\u0026\u0026K(ht)){var At=B(this._automationEvents,et-1,rt,ht,this._defaultValue),Gt=k.default(At,2),le=Gt[0],Z=Gt[1];return pt(J,le,Z,ht)}if(ht!==void 0\u0026\u0026$(ht)){var lt=B(this._automationEvents,et-1,rt,ht,this._defaultValue),xt=k.default(lt,2),Mt=xt[0],Tt=xt[1];return Dt(J,Mt,Tt,ht)}return this._defaultValue}}]),L}();u.AutomationEventList=re,u.createCancelAndHoldAutomationEvent=function(L){return{cancelTime:L,type:\"cancelAndHold\"}},u.createCancelScheduledValuesAutomationEvent=function(L){return{cancelTime:L,type:\"cancelScheduledValues\"}},u.createExponentialRampToValueAutomationEvent=function(L,J){return{endTime:J,type:\"exponentialRampToValue\",value:L}},u.createLinearRampToValueAutomationEvent=function(L,J){return{endTime:J,type:\"linearRampToValue\",value:L}},u.createSetTargetAutomationEvent=function(L,J,it){return{startTime:J,target:L,timeConstant:it,type:\"setTarget\"}},u.createSetValueAutomationEvent=U,u.createSetValueCurveAutomationEvent=z,Object.defineProperty(u,\"__esModule\",{value:!0})})(r,a(1),a(7),a(8))},function(o,r,a){var u=a(2),d=a(3),m=a(4),_=a(6);o.exports=function(T,k){return u(T)||d(T,k)||m(T,k)||_()}},function(o,r){o.exports=function(a){if(Array.isArray(a))return a}},function(o,r){o.exports=function(a,u){if(typeof Symbol!=\"undefined\"\u0026\u0026Symbol.iterator in Object(a)){var d=[],m=!0,_=!1,T=void 0;try{for(var k,D=a[Symbol.iterator]();!(m=(k=D.next()).done)\u0026\u0026(d.push(k.value),!u||d.length!==u);m=!0);}catch(O){_=!0,T=O}finally{try{m||D.return==null||D.return()}finally{if(_)throw T}}return d}}},function(o,r,a){var u=a(5);o.exports=function(d,m){if(d){if(typeof d==\"string\")return u(d,m);var _=Object.prototype.toString.call(d).slice(8,-1);return _===\"Object\"\u0026\u0026d.constructor\u0026\u0026(_=d.constructor.name),_===\"Map\"||_===\"Set\"?Array.from(d):_===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?u(d,m):void 0}}},function(o,r){o.exports=function(a,u){(u==null||u\u003ea.length)\u0026\u0026(u=a.length);for(var d=0,m=new Array(u);d\u003cu;d++)m[d]=a[d];return m}},function(o,r){o.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}},function(o,r){o.exports=function(a,u){if(!(a instanceof u))throw new TypeError(\"Cannot call a class as a function\")}},function(o,r){function a(u,d){for(var m=0;m\u003cd.length;m++){var _=d[m];_.enumerable=_.enumerable||!1,_.configurable=!0,\"value\"in _\u0026\u0026(_.writable=!0),Object.defineProperty(u,_.key,_)}}o.exports=function(u,d,m){return d\u0026\u0026a(u.prototype,d),m\u0026\u0026a(u,m),u}},function(o,r,a){\"use strict\";a.r(r),a.d(r,\"getContext\",function(){return Jt}),a.d(r,\"setContext\",function(){return or}),a.d(r,\"Clock\",function(){return es}),a.d(r,\"Context\",function(){return ks}),a.d(r,\"BaseContext\",function(){return ua}),a.d(r,\"Delay\",function(){return We}),a.d(r,\"Gain\",function(){return ft}),a.d(r,\"Offline\",function(){return yd}),a.d(r,\"OfflineContext\",function(){return Ms}),a.d(r,\"Param\",function(){return St}),a.d(r,\"ToneAudioBuffer\",function(){return Rt}),a.d(r,\"ToneAudioBuffers\",function(){return Ps}),a.d(r,\"ToneAudioNode\",function(){return ot}),a.d(r,\"connectSeries\",function(){return Qe}),a.d(r,\"connect\",function(){return Le}),a.d(r,\"disconnect\",function(){return da}),a.d(r,\"FrequencyClass\",function(){return Re}),a.d(r,\"Frequency\",function(){return vd}),a.d(r,\"MidiClass\",function(){return Es}),a.d(r,\"Midi\",function(){return bd}),a.d(r,\"TimeClass\",function(){return Xe}),a.d(r,\"Time\",function(){return fd}),a.d(r,\"TicksClass\",function(){return Xt}),a.d(r,\"Ticks\",function(){return wd}),a.d(r,\"TransportTimeClass\",function(){return me}),a.d(r,\"TransportTime\",function(){return _d}),a.d(r,\"Emitter\",function(){return Ss}),a.d(r,\"IntervalTimeline\",function(){return nu}),a.d(r,\"StateTimeline\",function(){return Os}),a.d(r,\"Timeline\",function(){return hn}),a.d(r,\"isUndef\",function(){return Ve}),a.d(r,\"isDefined\",function(){return Ot}),a.d(r,\"isFunction\",function(){return Xc}),a.d(r,\"isNumber\",function(){return Ye}),a.d(r,\"isObject\",function(){return Mn}),a.d(r,\"isBoolean\",function(){return aa}),a.d(r,\"isArray\",function(){return Ae}),a.d(r,\"isString\",function(){return Je}),a.d(r,\"isNote\",function(){return vi}),a.d(r,\"dbToGain\",function(){return As}),a.d(r,\"gainToDb\",function(){return yi}),a.d(r,\"intervalToFrequencyRatio\",function(){return Cs}),a.d(r,\"ftom\",function(){return Ln}),a.d(r,\"mtof\",function(){return la}),a.d(r,\"optionsFromArguments\",function(){return S}),a.d(r,\"defaultArg\",function(){return en}),a.d(r,\"Unit\",function(){return d}),a.d(r,\"debug\",function(){return u}),a.d(r,\"Noise\",function(){return Dn}),a.d(r,\"UserMedia\",function(){return Ns}),a.d(r,\"Oscillator\",function(){return te}),a.d(r,\"AMOscillator\",function(){return Is}),a.d(r,\"FMOscillator\",function(){return ss}),a.d(r,\"PulseOscillator\",function(){return is}),a.d(r,\"FatOscillator\",function(){return js}),a.d(r,\"PWMOscillator\",function(){return Rs}),a.d(r,\"OmniOscillator\",function(){return bn}),a.d(r,\"ToneOscillatorNode\",function(){return qs}),a.d(r,\"LFO\",function(){return Ne}),a.d(r,\"ToneBufferSource\",function(){return On}),a.d(r,\"Player\",function(){return os}),a.d(r,\"Players\",function(){return fr}),a.d(r,\"GrainPlayer\",function(){return mr}),a.d(r,\"Add\",function(){return rs}),a.d(r,\"Abs\",function(){return ou}),a.d(r,\"AudioToGain\",function(){return dr}),a.d(r,\"GainToAudio\",function(){return au}),a.d(r,\"GreaterThan\",function(){return Ti}),a.d(r,\"GreaterThanZero\",function(){return gr}),a.d(r,\"Multiply\",function(){return ee}),a.d(r,\"Negate\",function(){return fa}),a.d(r,\"Pow\",function(){return Fs}),a.d(r,\"Signal\",function(){return wt}),a.d(r,\"connectSignal\",function(){return wi}),a.d(r,\"Scale\",function(){return wn}),a.d(r,\"ScaleExp\",function(){return Si}),a.d(r,\"Subtract\",function(){return as}),a.d(r,\"SyncedSignal\",function(){return kd}),a.d(r,\"WaveShaper\",function(){return nn}),a.d(r,\"Zero\",function(){return pr}),a.d(r,\"AMSynth\",function(){return ma}),a.d(r,\"DuoSynth\",function(){return _r}),a.d(r,\"FMSynth\",function(){return yr}),a.d(r,\"MetalSynth\",function(){return br}),a.d(r,\"MembraneSynth\",function(){return Gs}),a.d(r,\"MonoSynth\",function(){return zn}),a.d(r,\"NoiseSynth\",function(){return wr}),a.d(r,\"PluckSynth\",function(){return xr}),a.d(r,\"PolySynth\",function(){return Tr}),a.d(r,\"Sampler\",function(){return Ys}),a.d(r,\"Synth\",function(){return Nn}),a.d(r,\"Loop\",function(){return Xs}),a.d(r,\"Part\",function(){return Qs}),a.d(r,\"Pattern\",function(){return Sr}),a.d(r,\"Sequence\",function(){return kr}),a.d(r,\"ToneEvent\",function(){return dn}),a.d(r,\"AutoFilter\",function(){return Ar}),a.d(r,\"AutoPanner\",function(){return Cr}),a.d(r,\"AutoWah\",function(){return Or}),a.d(r,\"BitCrusher\",function(){return Dr}),a.d(r,\"Chebyshev\",function(){return Er}),a.d(r,\"Chorus\",function(){return Nr}),a.d(r,\"Distortion\",function(){return qr}),a.d(r,\"FeedbackDelay\",function(){return jr}),a.d(r,\"FrequencyShifter\",function(){return Rr}),a.d(r,\"Freeverb\",function(){return Fr}),a.d(r,\"JCReverb\",function(){return Vr}),a.d(r,\"PingPongDelay\",function(){return Lr}),a.d(r,\"PitchShift\",function(){return Wr}),a.d(r,\"Phaser\",function(){return zr}),a.d(r,\"Reverb\",function(){return Gr}),a.d(r,\"StereoWidener\",function(){return Br}),a.d(r,\"Tremolo\",function(){return Ur}),a.d(r,\"Vibrato\",function(){return Hr}),a.d(r,\"Analyser\",function(){return Js}),a.d(r,\"Meter\",function(){return Yr}),a.d(r,\"FFT\",function(){return Xr}),a.d(r,\"DCMeter\",function(){return ba}),a.d(r,\"Waveform\",function(){return Qr}),a.d(r,\"Follower\",function(){return $s}),a.d(r,\"Channel\",function(){return Un}),a.d(r,\"CrossFade\",function(){return cs}),a.d(r,\"Merge\",function(){return qn}),a.d(r,\"MidSideMerge\",function(){return Ai}),a.d(r,\"MidSideSplit\",function(){return Mi}),a.d(r,\"Mono\",function(){return wa}),a.d(r,\"MultibandSplit\",function(){return ti}),a.d(r,\"Panner\",function(){return Ks}),a.d(r,\"Panner3D\",function(){return Zr}),a.d(r,\"PanVol\",function(){return Ci}),a.d(r,\"Recorder\",function(){return Oi}),a.d(r,\"Solo\",function(){return ue}),a.d(r,\"Split\",function(){return Gn}),a.d(r,\"Volume\",function(){return yn}),a.d(r,\"Compressor\",function(){return Tn}),a.d(r,\"Gate\",function(){return Kr}),a.d(r,\"Limiter\",function(){return $r}),a.d(r,\"MidSideCompressor\",function(){return Jr}),a.d(r,\"MultibandCompressor\",function(){return to}),a.d(r,\"AmplitudeEnvelope\",function(){return Vs}),a.d(r,\"Envelope\",function(){return Te}),a.d(r,\"FrequencyEnvelope\",function(){return zs}),a.d(r,\"EQ3\",function(){return eo}),a.d(r,\"Filter\",function(){return ze}),a.d(r,\"OnePoleFilter\",function(){return Us}),a.d(r,\"FeedbackCombFilter\",function(){return Bs}),a.d(r,\"LowpassCombFilter\",function(){return Hs}),a.d(r,\"Convolver\",function(){return no}),a.d(r,\"BiquadFilter\",function(){return Ws}),a.d(r,\"version\",function(){return m}),a.d(r,\"start\",function(){return pd}),a.d(r,\"supported\",function(){return cd}),a.d(r,\"now\",function(){return Id}),a.d(r,\"immediate\",function(){return jd}),a.d(r,\"Transport\",function(){return Rd}),a.d(r,\"getTransport\",function(){return Fd}),a.d(r,\"Destination\",function(){return Vd}),a.d(r,\"Master\",function(){return Ld}),a.d(r,\"getDestination\",function(){return Wd}),a.d(r,\"Listener\",function(){return zd}),a.d(r,\"getListener\",function(){return Gd}),a.d(r,\"Draw\",function(){return Bd}),a.d(r,\"getDraw\",function(){return Ud}),a.d(r,\"context\",function(){return Hd}),a.d(r,\"loaded\",function(){return Yd}),a.d(r,\"Buffer\",function(){return Xd}),a.d(r,\"Buffers\",function(){return Qd}),a.d(r,\"BufferSource\",function(){return Zd});var u={};a.r(u),a.d(u,\"assert\",function(){return mt}),a.d(u,\"assertRange\",function(){return Me}),a.d(u,\"assertContextRunning\",function(){return ra}),a.d(u,\"setLogger\",function(){return ud}),a.d(u,\"log\",function(){return Yc}),a.d(u,\"warn\",function(){return gi});var d={};a.r(d);let m=\"14.7.77\";var _=a(0);let T=new WeakSet,k=new WeakMap,D=new WeakMap,O=new WeakMap,A=new WeakMap,N=new WeakMap,U=new WeakMap,z=new WeakMap,X=new WeakMap,K=new WeakMap,$={construct:()=\u003e$},Y=/^import(?:(?:[\\s]+[\\w]+|(?:[\\s]+[\\w]+[\\s]*,)?[\\s]*\\{[\\s]*[\\w]+(?:[\\s]+as[\\s]+[\\w]+)?(?:[\\s]*,[\\s]*[\\w]+(?:[\\s]+as[\\s]+[\\w]+)?)*[\\s]*}|(?:[\\s]+[\\w]+[\\s]*,)?[\\s]*\\*[\\s]+as[\\s]+[\\w]+)[\\s]+from)?(?:[\\s]*)(\"([^\"\\\\]|\\\\.)+\"|'([^'\\\\]|\\\\.)+')(?:[\\s]*);?/,st=(s,t)=\u003e{let e=[],n=s.replace(/^[\\s]+/,\"\"),i=n.match(Y);for(;i!==null;){let c=i[1].slice(1,-1),l=i[0].replace(/([\\s]+)?;?$/,\"\").replace(c,new URL(c,t).toString());e.push(l),n=n.slice(i[0].length).replace(/^[\\s]+/,\"\"),i=n.match(Y)}return[e.join(\";\"),n]},R=s=\u003e{if(s!==void 0\u0026\u0026!Array.isArray(s))throw new TypeError(\"The parameterDescriptors property of given value for processorCtor is not an array.\")},P=s=\u003e{if(!(t=\u003e{try{new new Proxy(t,$)}catch{return!1}return!0})(s))throw new TypeError(\"The given value for processorCtor should be a constructor.\");if(s.prototype===null||typeof s.prototype!=\"object\")throw new TypeError(\"The given value for processorCtor should have a prototype.\")},B=(s,t)=\u003e{let e=s.get(t);if(e===void 0)throw new Error(\"A value with the given key could not be found.\");return e},F=(s,t)=\u003e{let e=Array.from(s).filter(t);if(e.length\u003e1)throw Error(\"More than one element was found.\");if(e.length===0)throw Error(\"No element was found.\");let[n]=e;return s.delete(n),n},tt=(s,t,e,n)=\u003e{let i=B(s,t),c=F(i,l=\u003el[0]===e\u0026\u0026l[1]===n);return i.size===0\u0026\u0026s.delete(t),c},at=s=\u003eB(U,s),pt=s=\u003e{if(T.has(s))throw new Error(\"The AudioNode is already stored.\");T.add(s),at(s).forEach(t=\u003et(!0))},Dt=s=\u003e\"port\"in s,jt=s=\u003e{if(!T.has(s))throw new Error(\"The AudioNode is not stored.\");T.delete(s),at(s).forEach(t=\u003et(!1))},Ht=(s,t)=\u003e{!Dt(s)\u0026\u0026t.every(e=\u003ee.size===0)\u0026\u0026jt(s)},re={channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},L=(s,t)=\u003es.context===t,J=s=\u003e{try{s.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},it=()=\u003enew DOMException(\"\",\"IndexSizeError\"),et=s=\u003e{var t;s.getChannelData=(t=s.getChannelData,e=\u003e{try{return t.call(s,e)}catch(n){throw n.code===12?it():n}})},ht={numberOfChannels:1},rt=-34028234663852886e22,At=-rt,Gt=s=\u003eT.has(s),le={buffer:null,channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Z=s=\u003eB(k,s),lt=s=\u003eB(O,s),xt=(s,t)=\u003e{let{activeInputs:e}=Z(s);e.forEach(i=\u003ei.forEach(([c])=\u003e{t.includes(s)||xt(c,[...t,s])}));let n=(i=\u003e\"playbackRate\"in i)(s)?[s.playbackRate]:Dt(s)?Array.from(s.parameters.values()):(i=\u003e\"frequency\"in i\u0026\u0026\"gain\"in i)(s)?[s.Q,s.detune,s.frequency,s.gain]:(i=\u003e\"offset\"in i)(s)?[s.offset]:(i=\u003e!(\"frequency\"in i)\u0026\u0026\"gain\"in i)(s)?[s.gain]:(i=\u003e\"detune\"in i\u0026\u0026\"frequency\"in i)(s)?[s.detune,s.frequency]:(i=\u003e\"pan\"in i)(s)?[s.pan]:[];for(let i of n){let c=lt(i);c!==void 0\u0026\u0026c.activeInputs.forEach(([l])=\u003ext(l,t))}Gt(s)\u0026\u0026jt(s)},Mt=s=\u003e{xt(s.destination,[])},Tt=s=\u003es===void 0||typeof s==\"number\"||typeof s==\"string\"\u0026\u0026(s===\"balanced\"||s===\"interactive\"||s===\"playback\"),gt=s=\u003e\"context\"in s,Bt=s=\u003egt(s[0]),Qt=(s,t,e,n)=\u003e{for(let i of s)if(e(i)){if(n)return!1;throw Error(\"The set contains at least one similar element.\")}return s.add(t),!0},Ie=(s,t,[e,n],i)=\u003e{Qt(s,[t,e,n],c=\u003ec[0]===t\u0026\u0026c[1]===e,i)},jn=(s,[t,e,n],i)=\u003e{let c=s.get(t);c===void 0?s.set(t,new Set([[e,n]])):Qt(c,[e,n],l=\u003el[0]===e,i)},Ue=s=\u003e\"inputs\"in s,mn=(s,t,e,n)=\u003e{if(Ue(t)){let i=t.inputs[n];return s.connect(i,e,0),[i,e,0]}return s.connect(t,e,n),[t,e,n]},gn=(s,t,e)=\u003e{for(let n of s)if(n[0]===t\u0026\u0026n[1]===e)return s.delete(n),n;return null},vs=(s,t)=\u003e{if(!at(s).delete(t))throw new Error(\"Missing the expected event listener.\")},_s=(s,t,e)=\u003e{let n=B(s,t),i=F(n,c=\u003ec[0]===e);return n.size===0\u0026\u0026s.delete(t),i},zi=(s,t,e,n)=\u003e{Ue(t)?s.disconnect(t.inputs[n],e,0):s.disconnect(t,e,n)},$t=s=\u003eB(D,s),li=s=\u003eB(A,s),$n=s=\u003ez.has(s),Gi=s=\u003e!T.has(s),qa=s=\u003enew Promise(t=\u003e{let e=s.createScriptProcessor(256,1,1),n=s.createGain(),i=s.createBuffer(1,2,44100),c=i.getChannelData(0);c[0]=1,c[1]=1;let l=s.createBufferSource();l.buffer=i,l.loop=!0,l.connect(e).connect(s.destination),l.connect(n),l.disconnect(n),e.onaudioprocess=h=\u003e{let p=h.inputBuffer.getChannelData(0);Array.prototype.some.call(p,f=\u003ef===1)?t(!0):t(!1),l.stop(),e.onaudioprocess=null,l.disconnect(e),e.disconnect(s.destination)},l.start()}),jo=(s,t)=\u003e{let e=new Map;for(let n of s)for(let i of n){let c=e.get(i);e.set(i,c===void 0?1:c+1)}e.forEach((n,i)=\u003et(i,n))},Bi=s=\u003e\"context\"in s,Vl=(s,t,e,n)=\u003e{let{activeInputs:i,passiveInputs:c}=lt(t),{outputs:l}=Z(s),h=at(s),p=f=\u003e{let y=$t(s),g=li(t);if(f){let b=_s(c,s,e);Ie(i,s,b,!1),n||$n(s)||y.connect(g,e)}else{let b=((v,E,x)=\u003eF(v,w=\u003ew[0]===E\u0026\u0026w[1]===x))(i,s,e);jn(c,b,!1),n||$n(s)||y.disconnect(g,e)}};return!!Qt(l,[t,e],f=\u003ef[0]===t\u0026\u0026f[1]===e,!0)\u0026\u0026(h.add(p),Gt(s)?Ie(i,s,[e,p],!0):jn(c,[s,e,p],!0),!0)},Ro=(s,t,e,n,i)=\u003e{let[c,l]=((h,p,f,y)=\u003e{let{activeInputs:g,passiveInputs:b}=Z(p),v=gn(g[y],h,f);return v===null?[tt(b,h,f,y)[2],!1]:[v[2],!0]})(s,e,n,i);if(c!==null\u0026\u0026(vs(s,c),!l||t||$n(s)||zi($t(s),$t(e),n,i)),Gt(e)){let{activeInputs:h}=Z(e);Ht(e,h)}},Fo=(s,t,e,n)=\u003e{let[i,c]=((l,h,p)=\u003e{let{activeInputs:f,passiveInputs:y}=lt(h),g=gn(f,l,p);return g===null?[_s(y,l,p)[1],!1]:[g[2],!0]})(s,e,n);i!==null\u0026\u0026(vs(s,i),!c||t||$n(s)||$t(s).disconnect(li(e),n))};class Ia{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((n,i)=\u003et.call(e,n,i,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}let Ll={channelCount:2,channelCountMode:\"explicit\",channelInterpretation:\"speakers\",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function Ui(s,t,e,n,i){if(typeof s.copyFromChannel==\"function\")t[e].byteLength===0\u0026\u0026(t[e]=new Float32Array(128)),s.copyFromChannel(t[e],n,i);else{let c=s.getChannelData(n);if(t[e].byteLength===0)t[e]=c.slice(i,i+128);else{let l=new Float32Array(c.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);t[e].set(l)}}}let ja=(s,t,e,n,i)=\u003e{typeof s.copyToChannel==\"function\"?t[e].byteLength!==0\u0026\u0026s.copyToChannel(t[e],n,i):t[e].byteLength!==0\u0026\u0026s.getChannelData(n).set(t[e],i)},Hi=(s,t)=\u003e{let e=[];for(let n=0;n\u003cs;n+=1){let i=[],c=typeof t==\"number\"?t:t[n];for(let l=0;l\u003cc;l+=1)i.push(new Float32Array(128));e.push(i)}return e},Wl=async(s,t,e,n,i,c,l)=\u003e{let h=t===null?128*Math.ceil(s.context.length/128):t.length,p=n.channelCount*n.numberOfInputs,f=i.reduce((w,C)=\u003ew+C,0),y=f===0?null:e.createBuffer(f,h,e.sampleRate);if(c===void 0)throw new Error(\"Missing the processor constructor.\");let g=Z(s),b=await((w,C)=\u003e{let I=B(K,w),q=$t(C);return B(I,q)})(e,s),v=Hi(n.numberOfInputs,n.channelCount),E=Hi(n.numberOfOutputs,i),x=Array.from(s.parameters.keys()).reduce((w,C)=\u003e({...w,[C]:new Float32Array(128)}),{});for(let w=0;w\u003ch;w+=128){if(n.numberOfInputs\u003e0\u0026\u0026t!==null)for(let C=0;C\u003cn.numberOfInputs;C+=1)for(let I=0;I\u003cn.channelCount;I+=1)Ui(t,v[C],I,I,w);c.parameterDescriptors!==void 0\u0026\u0026t!==null\u0026\u0026c.parameterDescriptors.forEach(({name:C},I)=\u003e{Ui(t,x,C,p+I,w)});for(let C=0;C\u003cn.numberOfInputs;C+=1)for(let I=0;I\u003ci[C];I+=1)E[C][I].byteLength===0\u0026\u0026(E[C][I]=new Float32Array(128));try{let C=v.map((q,j)=\u003eg.activeInputs[j].size===0?[]:q),I=l(w/e.sampleRate,e.sampleRate,()=\u003eb.process(C,E,x));if(y!==null)for(let q=0,j=0;q\u003cn.numberOfOutputs;q+=1){for(let W=0;W\u003ci[q];W+=1)ja(y,E[q],W,j+W,w);j+=i[q]}if(!I)break}catch(C){s.dispatchEvent(new ErrorEvent(\"processorerror\",{colno:C.colno,filename:C.filename,lineno:C.lineno,message:C.message}));break}}return y},zl={Q:1,channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",detune:0,frequency:350,gain:0,type:\"lowpass\"},Gl={channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"speakers\",numberOfInputs:6},Bl={channelCount:6,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",numberOfOutputs:6},Ul={channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",offset:1},Hl={buffer:null,channelCount:2,channelCountMode:\"clamped-max\",channelInterpretation:\"speakers\",disableNormalization:!1},Yl={channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",delayTime:0,maxDelayTime:1},Yi=(s,t,e)=\u003e{let n=t[e];if(n===void 0)throw s();return n},Xl={attack:.003,channelCount:2,channelCountMode:\"clamped-max\",channelInterpretation:\"speakers\",knee:30,ratio:12,release:.25,threshold:-24},Ql={channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",gain:1},fe=()=\u003enew DOMException(\"\",\"InvalidStateError\"),Xi=()=\u003enew DOMException(\"\",\"InvalidAccessError\"),Zl={channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\"},Ra=(s,t,e,n,i,c,l,h,p,f,y)=\u003e{let g=f.length,b=h;for(let v=0;v\u003cg;v+=1){let E=e[0]*f[v];for(let x=1;x\u003ci;x+=1){let w=b-x\u0026p-1;E+=e[x]*c[w],E-=s[x]*l[w]}for(let x=i;x\u003cn;x+=1)E+=e[x]*c[b-x\u0026p-1];for(let x=i;x\u003ct;x+=1)E-=s[x]*l[b-x\u0026p-1];c[b]=f[v],l[b]=E,b=b+1\u0026p-1,y[v]=E}return b},Kl={channelCount:2,channelCountMode:\"explicit\",channelInterpretation:\"speakers\"},hi=s=\u003e{let t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let e=s.decodeAudioData(t.buffer,()=\u003e{});return e!==void 0\u0026\u0026(e.catch(()=\u003e{}),!0)}catch{}return!1},$p={numberOfChannels:1},se=(s,t,e)=\u003e{let n=t[e];n!==void 0\u0026\u0026n!==s[e]\u0026\u0026(s[e]=n)},ve=(s,t)=\u003e{se(s,t,\"channelCount\"),se(s,t,\"channelCountMode\"),se(s,t,\"channelInterpretation\")},Fa=s=\u003etypeof s.getFloatTimeDomainData==\"function\",ae=(s,t,e)=\u003e{let n=t[e];n!==void 0\u0026\u0026n!==s[e].value\u0026\u0026(s[e].value=n)},Vo=s=\u003e{var t;s.start=(t=s.start,(e=0,n=0,i)=\u003e{if(typeof i==\"number\"\u0026\u0026i\u003c0||n\u003c0||e\u003c0)throw new RangeError(\"The parameters can't be negative.\");t.call(s,e,n,i)})},Lo=s=\u003e{var t;s.stop=(t=s.stop,(e=0)=\u003e{if(e\u003c0)throw new RangeError(\"The parameter can't be negative.\");t.call(s,e)})},Va=(s,t)=\u003es===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(s*t))))),$l=async(s,t)=\u003enew s(await(e=\u003enew Promise((n,i)=\u003e{let{port1:c,port2:l}=new MessageChannel;c.onmessage=({data:h})=\u003e{c.close(),l.close(),n(h)},c.onmessageerror=({data:h})=\u003e{c.close(),l.close(),i(h)},l.postMessage(e)}))(t)),La=(s,t)=\u003e{let e=s.createBiquadFilter();return ve(e,t),ae(e,t,\"Q\"),ae(e,t,\"detune\"),ae(e,t,\"frequency\"),ae(e,t,\"gain\"),se(e,t,\"type\"),e},di=(s,t)=\u003e{let e=s.createChannelSplitter(t.numberOfOutputs);return ve(e,t),(n=\u003e{let i=n.numberOfOutputs;Object.defineProperty(n,\"channelCount\",{get:()=\u003ei,set:c=\u003e{if(c!==i)throw fe()}}),Object.defineProperty(n,\"channelCountMode\",{get:()=\u003e\"explicit\",set:c=\u003e{if(c!==\"explicit\")throw fe()}}),Object.defineProperty(n,\"channelInterpretation\",{get:()=\u003e\"discrete\",set:c=\u003e{if(c!==\"discrete\")throw fe()}})})(e),e},ys=(s,t)=\u003e(s.connect=t.connect.bind(t),s.disconnect=t.disconnect.bind(t),s),Wa=(s,t)=\u003e{let e=s.createDelay(t.maxDelayTime);return ve(e,t),ae(e,t,\"delayTime\"),e},Fe=(s,t)=\u003e{let e=s.createGain();return ve(e,t),ae(e,t,\"gain\"),e};function Jl(s,t){let e=t[0]*t[0]+t[1]*t[1];return[(s[0]*t[0]+s[1]*t[1])/e,(s[1]*t[0]-s[0]*t[1])/e]}function za(s,t){let e=[0,0];for(let c=s.length-1;c\u003e=0;c-=1)i=t,e=[(n=e)[0]*i[0]-n[1]*i[1],n[0]*i[1]+n[1]*i[0]],e[0]+=s[c];var n,i;return e}let pi=(s,t,e,n)=\u003es.createScriptProcessor(t,e,n),je=()=\u003enew DOMException(\"\",\"NotSupportedError\"),th={numberOfChannels:1},eh={channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",detune:0,frequency:440,periodicWave:void 0,type:\"sine\"},nh={channelCount:2,channelCountMode:\"clamped-max\",channelInterpretation:\"speakers\",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:\"inverse\",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:\"equalpower\",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},sh={disableNormalization:!1},ih={channelCount:2,channelCountMode:\"explicit\",channelInterpretation:\"speakers\",pan:0},Ga=()=\u003enew DOMException(\"\",\"UnknownError\"),rh={channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",curve:null,oversample:\"none\"},Ba=s=\u003e{if(s===null)return!1;let t=s.length;return t%2!=0?s[Math.floor(t/2)]!==0:s[t/2-1]+s[t/2]!==0},Qi=(s,t,e,n)=\u003e{let i=Object.getPrototypeOf(s);for(;!i.hasOwnProperty(t);)i=Object.getPrototypeOf(i);let{get:c,set:l}=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(s,t,{get:e(c),set:n(l)})},Ua=(s,t,e)=\u003e{try{s.setValueAtTime(t,e)}catch(n){if(n.code!==9)throw n;Ua(s,t,e+1e-7)}},Wo=s=\u003e{let t=s.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},Ha=s=\u003e{let t=s.createBuffer(1,1,44100),e=s.createBufferSource();e.buffer=t,e.start(),e.stop();try{return e.stop(),!0}catch{return!1}},zo=s=\u003e{let t=s.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},oh=()=\u003e{try{new DOMException}catch{return!1}return!0},ah=()=\u003enew Promise(s=\u003e{let t=new ArrayBuffer(0),{port1:e,port2:n}=new MessageChannel;e.onmessage=({data:i})=\u003es(i!==null),n.postMessage(t,[t])}),Ya=(s,t)=\u003e{let e=t.createGain();s.connect(e);let n=(i=s.disconnect,()=\u003e{i.call(s,e),s.removeEventListener(\"ended\",n)});var i;s.addEventListener(\"ended\",n),ys(s,e),s.stop=(c=\u003e{let l=!1;return(h=0)=\u003e{if(l)try{c.call(s,h)}catch{e.gain.setValueAtTime(0,h)}else c.call(s,h),l=!0}})(s.stop)},bs=(s,t)=\u003ee=\u003e{let n={value:s};return Object.defineProperties(e,{currentTarget:n,target:n}),typeof t==\"function\"?t.call(s,e):t.handleEvent.call(s,e)},ch=(Xa=Qt,(s,t,[e,n,i],c)=\u003e{Xa(s[n],[t,e,i],l=\u003el[0]===t\u0026\u0026l[1]===e,c)});var Xa;let uh=(s=\u003e(t,e,[n,i,c],l)=\u003e{let h=t.get(n);h===void 0?t.set(n,new Set([[i,e,c]])):s(h,[i,e,c],p=\u003ep[0]===i\u0026\u0026p[1]===e,l)})(Qt),lh=(s=\u003e(t,e,n,i)=\u003es(t[i],c=\u003ec[0]===e\u0026\u0026c[1]===n))(F),Qa=new WeakMap,hh=(s=\u003et=\u003e{var e;return(e=s.get(t))!==null\u0026\u0026e!==void 0?e:0})(Qa),He=(Zi=new Map,fi=new WeakMap,(s,t)=\u003e{let e=fi.get(s);if(e!==void 0)return e;let n=Zi.get(s);if(n!==void 0)return n;try{let i=t();return i instanceof Promise?(Zi.set(s,i),i.catch(()=\u003e!1).then(c=\u003e(Zi.delete(s),fi.set(s,c),c))):(fi.set(s,i),i)}catch{return fi.set(s,!1),!1}});var Zi,fi;let an=typeof window==\"undefined\"?null:window,Za=(Ka=He,$a=it,(s,t)=\u003e{let e=s.createAnalyser();if(ve(e,t),!(t.maxDecibels\u003et.minDecibels))throw $a();return se(e,t,\"fftSize\"),se(e,t,\"maxDecibels\"),se(e,t,\"minDecibels\"),se(e,t,\"smoothingTimeConstant\"),Ka(Fa,()=\u003eFa(e))||(n=\u003e{n.getFloatTimeDomainData=i=\u003e{let c=new Uint8Array(i.length);n.getByteTimeDomainData(c);let l=Math.max(c.length,n.fftSize);for(let h=0;h\u003cl;h+=1)i[h]=.0078125*(c[h]-128);return i}})(e),e});var Ka,$a;let Go=(Ja=Z,s=\u003e{let t=Ja(s);if(t.renderer===null)throw new Error(\"Missing the renderer of the given AudioNode in the audio graph.\");return t.renderer});var Ja;let ke=((s,t,e)=\u003easync(n,i,c,l)=\u003e{let h=s(n),p=[...l,n];await Promise.all(h.activeInputs.map((f,y)=\u003eArray.from(f).filter(([g])=\u003e!p.includes(g)).map(async([g,b])=\u003e{let v=t(g),E=await v.render(g,i,p),x=n.context.destination;e(g)||n===x\u0026\u0026e(n)||E.connect(c,b,y)})).reduce((f,y)=\u003e[...f,...y],[]))})(Z,Go,$n),dh=(tc=Za,ec=$t,nc=ke,()=\u003e{let s=new WeakMap;return{render(t,e,n){let i=s.get(e);return i!==void 0?Promise.resolve(i):(async(c,l,h)=\u003e{let p=ec(c);if(!L(p,l)){let f={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,fftSize:p.fftSize,maxDecibels:p.maxDecibels,minDecibels:p.minDecibels,smoothingTimeConstant:p.smoothingTimeConstant};p=tc(l,f)}return s.set(l,p),await nc(c,l,p,h),p})(t,e,n)}}});var tc,ec,nc;let Zt=(sc=N,s=\u003e{let t=sc.get(s);if(t===void 0)throw fe();return t});var sc;let we=(s=\u003es===null?null:s.hasOwnProperty(\"OfflineAudioContext\")?s.OfflineAudioContext:s.hasOwnProperty(\"webkitOfflineAudioContext\")?s.webkitOfflineAudioContext:null)(an),Ut=(Bo=we,s=\u003eBo!==null\u0026\u0026s instanceof Bo);var Bo;let ic=new WeakMap,rc=(oc=bs,class{constructor(s){this._nativeEventTarget=s,this._listeners=new WeakMap}addEventListener(s,t,e){if(t!==null){let n=this._listeners.get(t);n===void 0\u0026\u0026(n=oc(this,t),typeof t==\"function\"\u0026\u0026this._listeners.set(t,n)),this._nativeEventTarget.addEventListener(s,n,e)}}dispatchEvent(s){return this._nativeEventTarget.dispatchEvent(s)}removeEventListener(s,t,e){let n=t===null?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(s,n===void 0?null:n,e)}});var oc;let kn=(s=\u003es===null?null:s.hasOwnProperty(\"AudioContext\")?s.AudioContext:s.hasOwnProperty(\"webkitAudioContext\")?s.webkitAudioContext:null)(an),Uo=(Ho=kn,s=\u003eHo!==null\u0026\u0026s instanceof Ho);var Ho;let Yo=(s=\u003et=\u003es!==null\u0026\u0026typeof s.AudioNode==\"function\"\u0026\u0026t instanceof s.AudioNode)(an),ac=(s=\u003et=\u003es!==null\u0026\u0026typeof s.AudioParam==\"function\"\u0026\u0026t instanceof s.AudioParam)(an),he=((s,t,e,n,i,c,l,h,p,f,y,g,b,v,E)=\u003eclass extends f{constructor(x,w,C,I){super(C),this._context=x,this._nativeAudioNode=C;let q=y(x);g(q)\u0026\u0026e(qa,()=\u003eqa(q))!==!0\u0026\u0026(j=\u003e{let W=new Map;var V,G;j.connect=(V=j.connect.bind(j),(ct,H=0,Q=0)=\u003e{let nt=Bi(ct)?V(ct,H,Q):V(ct,H),dt=W.get(ct);return dt===void 0?W.set(ct,[{input:Q,output:H}]):dt.every(bt=\u003ebt.input!==Q||bt.output!==H)\u0026\u0026dt.push({input:Q,output:H}),nt}),j.disconnect=(G=j.disconnect,(ct,H,Q)=\u003e{if(G.apply(j),ct===void 0)W.clear();else if(typeof ct==\"number\")for(let[nt,dt]of W){let bt=dt.filter(Ft=\u003eFt.output!==ct);bt.length===0?W.delete(nt):W.set(nt,bt)}else if(W.has(ct))if(H===void 0)W.delete(ct);else{let nt=W.get(ct);if(nt!==void 0){let dt=nt.filter(bt=\u003ebt.output!==H\u0026\u0026(bt.input!==Q||Q===void 0));dt.length===0?W.delete(ct):W.set(ct,dt)}}for(let[nt,dt]of W)dt.forEach(bt=\u003e{Bi(nt)?j.connect(nt,bt.output,bt.input):j.connect(nt,bt.output)})})})(C),D.set(this,C),U.set(this,new Set),x.state!==\"closed\"\u0026\u0026w\u0026\u0026pt(this),s(this,I,C)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(x){this._nativeAudioNode.channelCount=x}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(x){this._nativeAudioNode.channelCountMode=x}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(x){this._nativeAudioNode.channelInterpretation=x}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(x,w=0,C=0){if(w\u003c0||w\u003e=this._nativeAudioNode.numberOfOutputs)throw i();let I=y(this._context),q=E(I);if(b(x)||v(x))throw c();if(gt(x)){let W=$t(x);try{let V=mn(this._nativeAudioNode,W,w,C),G=Gi(this);(q||G)\u0026\u0026this._nativeAudioNode.disconnect(...V),this.context.state!==\"closed\"\u0026\u0026!G\u0026\u0026Gi(x)\u0026\u0026pt(x)}catch(V){throw V.code===12?c():V}if(t(this,x,w,C,q)){let V=p([this],x);jo(V,n(q))}return x}let j=li(x);if(j.name===\"playbackRate\")throw l();try{this._nativeAudioNode.connect(j,w),(q||Gi(this))\u0026\u0026this._nativeAudioNode.disconnect(j,w)}catch(W){throw W.code===12?c():W}if(Vl(this,x,w,q)){let W=p([this],x);jo(W,n(q))}}disconnect(x,w,C){let I,q=y(this._context),j=E(q);if(x===void 0)I=((W,V)=\u003e{let G=Z(W),ct=[];for(let H of G.outputs)Bt(H)?Ro(W,V,...H):Fo(W,V,...H),ct.push(H[0]);return G.outputs.clear(),ct})(this,j);else if(typeof x==\"number\"){if(x\u003c0||x\u003e=this.numberOfOutputs)throw i();I=((W,V,G)=\u003e{let ct=Z(W),H=[];for(let Q of ct.outputs)Q[1]===G\u0026\u0026(Bt(Q)?Ro(W,V,...Q):Fo(W,V,...Q),H.push(Q[0]),ct.outputs.delete(Q));return H})(this,j,x)}else{if(w!==void 0\u0026\u0026(w\u003c0||w\u003e=this.numberOfOutputs)||gt(x)\u0026\u0026C!==void 0\u0026\u0026(C\u003c0||C\u003e=x.numberOfInputs))throw i();if(I=((W,V,G,ct,H)=\u003e{let Q=Z(W);return Array.from(Q.outputs).filter(nt=\u003e!(nt[0]!==G||ct!==void 0\u0026\u0026nt[1]!==ct||H!==void 0\u0026\u0026nt[2]!==H)).map(nt=\u003e(Bt(nt)?Ro(W,V,...nt):Fo(W,V,...nt),Q.outputs.delete(nt),nt[0]))})(this,j,x,w,C),I.length===0)throw c()}for(let W of I){let V=p([this],W);jo(V,h)}}})((cc=k,(s,t,e)=\u003e{let n=[];for(let i=0;i\u003ce.numberOfInputs;i+=1)n.push(new Set);cc.set(s,{activeInputs:n,outputs:new Set,passiveInputs:new WeakMap,renderer:t})}),((s,t,e,n,i,c,l,h,p,f,y,g,b)=\u003e(v,E,x,w,C)=\u003e{let{activeInputs:I,passiveInputs:q}=c(E),{outputs:j}=c(v),W=h(v),V=G=\u003e{let ct=p(E),H=p(v);if(G){let Q=tt(q,v,x,w);s(I,v,Q,!1),C||g(v)||e(H,ct,x,w),b(E)\u0026\u0026pt(E)}else{let Q=n(I,v,x,w);t(q,w,Q,!1),C||g(v)||i(H,ct,x,w);let nt=l(E);nt===0?y(E)\u0026\u0026Ht(E,I):setTimeout(()=\u003e{y(E)\u0026\u0026Ht(E,I)},1e3*nt)}};return!!f(j,[E,x,w],G=\u003eG[0]===E\u0026\u0026G[1]===x\u0026\u0026G[2]===w,!0)\u0026\u0026(W.add(V),y(v)?s(I,v,[x,w,V],!0):t(q,w,[v,x,V],!0),!0)})(ch,uh,mn,lh,zi,Z,hh,at,$t,Qt,Gt,$n,Gi),He,((s,t,e,n,i,c)=\u003el=\u003e(h,p)=\u003e{let f=s.get(h);if(f===void 0){if(!l\u0026\u0026c(h)){let y=n(h),{outputs:g}=e(h);for(let b of g)if(Bt(b)){let v=n(b[0]);t(y,v,b[1],b[2])}else{let v=i(b[0]);y.disconnect(v,b[1])}}s.set(h,p)}else s.set(h,f+p)})(z,zi,Z,$t,li,Gt),it,Xi,je,((s,t,e,n,i,c,l,h)=\u003e(p,f)=\u003e{let y=t.get(p);if(y===void 0)throw new Error(\"Missing the expected cycle count.\");let g=c(p.context),b=h(g);if(y===f){if(t.delete(p),!b\u0026\u0026l(p)){let v=n(p),{outputs:E}=e(p);for(let x of E)if(Bt(x)){let w=n(x[0]);s(v,w,x[1],x[2])}else{let w=i(x[0]);v.connect(w,x[1])}}}else t.set(p,y-f)})(mn,z,Z,$t,li,Zt,Gt,Ut),((s,t,e)=\u003efunction n(i,c){let l=gt(c)?c:e(s,c);if((p=\u003e\"delayTime\"in p)(l))return[];if(i[0]===l)return[i];if(i.includes(l))return[];let{outputs:h}=t(l);return Array.from(h).map(p=\u003en([...i,l],p[0])).reduce((p,f)=\u003ep.concat(f),[])})(ic,Z,B),rc,Zt,Uo,Yo,ac,Ut);var cc;let ph=((s,t,e,n,i,c)=\u003eclass extends s{constructor(l,h){let p=i(l),f={...re,...h},y=n(p,f);super(l,!1,y,c(p)?t():null),this._nativeAnalyserNode=y}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(l){this._nativeAnalyserNode.fftSize=l}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(l){let h=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=l,!(l\u003ethis._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=h,e()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(l){let h=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=l,!(this._nativeAnalyserNode.maxDecibels\u003el))throw this._nativeAnalyserNode.minDecibels=h,e()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(l){this._nativeAnalyserNode.smoothingTimeConstant=l}getByteFrequencyData(l){this._nativeAnalyserNode.getByteFrequencyData(l)}getByteTimeDomainData(l){this._nativeAnalyserNode.getByteTimeDomainData(l)}getFloatFrequencyData(l){this._nativeAnalyserNode.getFloatFrequencyData(l)}getFloatTimeDomainData(l){this._nativeAnalyserNode.getFloatTimeDomainData(l)}})(he,dh,it,Za,Zt,Ut),Xo=new WeakSet,uc=(s=\u003es===null?null:s.hasOwnProperty(\"AudioBuffer\")?s.AudioBuffer:null)(an),lc=(Qo=new Uint32Array(1),s=\u003e(Qo[0]=s,Qo[0]));var Qo;let Zo=((s,t)=\u003ee=\u003e{e.copyFromChannel=(n,i,c=0)=\u003e{let l=s(c),h=s(i);if(h\u003e=e.numberOfChannels)throw t();let p=e.length,f=e.getChannelData(h),y=n.length;for(let g=l\u003c0?-l:0;g+l\u003cp\u0026\u0026g\u003cy;g+=1)n[g]=f[g+l]},e.copyToChannel=(n,i,c=0)=\u003e{let l=s(c),h=s(i);if(h\u003e=e.numberOfChannels)throw t();let p=e.length,f=e.getChannelData(h),y=n.length;for(let g=l\u003c0?-l:0;g+l\u003cp\u0026\u0026g\u003cy;g+=1)f[g+l]=n[g]}})(lc,it),Ko=(s=\u003et=\u003e{t.copyFromChannel=(e=\u003e(n,i,c=0)=\u003e{let l=s(c),h=s(i);if(l\u003ct.length)return e.call(t,n,h,l)})(t.copyFromChannel),t.copyToChannel=(e=\u003e(n,i,c=0)=\u003e{let l=s(c),h=s(i);if(l\u003ct.length)return e.call(t,n,h,l)})(t.copyToChannel)})(lc),fh=((s,t,e,n,i,c,l,h)=\u003e{let p=null;return class jl{constructor(y){if(i===null)throw new Error(\"Missing the native OfflineAudioContext constructor.\");let{length:g,numberOfChannels:b,sampleRate:v}={...ht,...y};p===null\u0026\u0026(p=new i(1,1,44100));let E=n!==null\u0026\u0026t(c,c)?new n({length:g,numberOfChannels:b,sampleRate:v}):p.createBuffer(b,g,v);if(E.numberOfChannels===0)throw e();return typeof E.copyFromChannel!=\"function\"?(l(E),et(E)):t(J,()=\u003eJ(E))||h(E),s.add(E),E}static[Symbol.hasInstance](y){return y!==null\u0026\u0026typeof y==\"object\"\u0026\u0026Object.getPrototypeOf(y)===jl.prototype||s.has(y)}}})(Xo,He,je,uc,we,($o=uc,()=\u003e{if($o===null)return!1;try{new $o({length:1,sampleRate:44100})}catch{return!1}return!0}),Zo,Ko);var $o;let Ki=(hc=Fe,(s,t)=\u003e{let e=hc(s,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",gain:0});t.connect(e).connect(s.destination);let n=()=\u003e{t.removeEventListener(\"ended\",n),t.disconnect(e),e.disconnect()};t.addEventListener(\"ended\",n)});var hc;let dc=((s,t,e)=\u003easync(n,i,c,l)=\u003e{let h=t(n);await Promise.all(Array.from(h.activeInputs).map(async([p,f])=\u003e{let y=s(p),g=await y.render(p,i,l);e(p)||g.connect(c,f)}))})(Go,lt,$n),vn=(s=\u003e(t,e,n,i)=\u003es(e,t,n,i))(dc),ws=((s,t,e,n,i,c,l,h,p,f,y)=\u003e(g,b)=\u003e{let v=g.createBufferSource();return ve(v,b),ae(v,b,\"playbackRate\"),se(v,b,\"buffer\"),se(v,b,\"loop\"),se(v,b,\"loopEnd\"),se(v,b,\"loopStart\"),t(e,()=\u003ee(g))||(E=\u003e{E.start=(x=\u003e{let w=!1;return(C=0,I=0,q)=\u003e{if(w)throw fe();x.call(E,C,I,q),w=!0}})(E.start)})(v),t(n,()=\u003en(g))||p(v),t(i,()=\u003ei(g))||f(v,g),t(c,()=\u003ec(g))||Vo(v),t(l,()=\u003el(g))||y(v,g),t(h,()=\u003eh(g))||Lo(v),s(g,v),v})(Ki,He,s=\u003e{let t=s.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},s=\u003e{let t=s.createBufferSource(),e=s.createBuffer(1,1,44100);t.buffer=e;try{t.start(0,1)}catch{return!1}return!0},s=\u003e{let t=s.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},Wo,Ha,zo,s=\u003e{var t;s.start=(t=s.start,(e=0,n=0,i)=\u003e{let c=s.buffer,l=c===null?n:Math.min(c.duration,n);c!==null\u0026\u0026l\u003ec.duration-.5/s.context.sampleRate?t.call(s,e,0,0):t.call(s,e,l,i)})},(pc=Qi,(s,t)=\u003e{let e=t.createBuffer(1,1,44100);s.buffer===null\u0026\u0026(s.buffer=e),pc(s,\"buffer\",n=\u003e()=\u003e{let i=n.call(s);return i===e?null:i},n=\u003ei=\u003en.call(s,i===null?e:i))}),Ya);var pc;let _n=((s,t)=\u003e(e,n,i,c)=\u003e(s(n).replay(i),t(n,e,i,c)))((s=\u003et=\u003e{let e=s(t);if(e.renderer===null)throw new Error(\"Missing the renderer of the given AudioParam in the audio graph.\");return e.renderer})(lt),dc),mh=((s,t,e,n,i)=\u003e()=\u003e{let c=new WeakMap,l=null,h=null;return{set start(p){l=p},set stop(p){h=p},render(p,f,y){let g=c.get(f);return g!==void 0?Promise.resolve(g):(async(b,v,E)=\u003e{let x=e(b),w=L(x,v);if(!w){let C={buffer:x.buffer,channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation,loop:x.loop,loopEnd:x.loopEnd,loopStart:x.loopStart,playbackRate:x.playbackRate.value};x=t(v,C),l!==null\u0026\u0026x.start(...l),h!==null\u0026\u0026x.stop(h)}return c.set(v,x),w?await s(v,b.playbackRate,x.playbackRate,E):await n(v,b.playbackRate,x.playbackRate,E),await i(b,v,x,E),x})(p,f,y)}}})(vn,ws,$t,_n,ke),cn=((s,t,e,n,i,c,l,h,p,f,y,g,b)=\u003e(v,E,x,w=null,C=null)=\u003e{let I=new _.AutomationEventList(x.defaultValue),q=E?n(I):null,j={get defaultValue(){return x.defaultValue},get maxValue(){return w===null?x.maxValue:w},get minValue(){return C===null?x.minValue:C},get value(){return x.value},set value(W){x.value=W,j.setValueAtTime(W,v.context.currentTime)},cancelAndHoldAtTime(W){if(typeof x.cancelAndHoldAtTime==\"function\")q===null\u0026\u0026I.flush(v.context.currentTime),I.add(i(W)),x.cancelAndHoldAtTime(W);else{let V=Array.from(I).pop();q===null\u0026\u0026I.flush(v.context.currentTime),I.add(i(W));let G=Array.from(I).pop();x.cancelScheduledValues(W),V!==G\u0026\u0026G!==void 0\u0026\u0026(G.type===\"exponentialRampToValue\"?x.exponentialRampToValueAtTime(G.value,G.endTime):G.type===\"linearRampToValue\"?x.linearRampToValueAtTime(G.value,G.endTime):G.type===\"setValue\"?x.setValueAtTime(G.value,G.startTime):G.type===\"setValueCurve\"\u0026\u0026x.setValueCurveAtTime(G.values,G.startTime,G.duration))}return j},cancelScheduledValues:W=\u003e(q===null\u0026\u0026I.flush(v.context.currentTime),I.add(c(W)),x.cancelScheduledValues(W),j),exponentialRampToValueAtTime(W,V){if(W===0)throw new RangeError;if(!Number.isFinite(V)||V\u003c0)throw new RangeError;return q===null\u0026\u0026I.flush(v.context.currentTime),I.add(l(W,V)),x.exponentialRampToValueAtTime(W,V),j},linearRampToValueAtTime:(W,V)=\u003e(q===null\u0026\u0026I.flush(v.context.currentTime),I.add(h(W,V)),x.linearRampToValueAtTime(W,V),j),setTargetAtTime:(W,V,G)=\u003e(q===null\u0026\u0026I.flush(v.context.currentTime),I.add(p(W,V,G)),x.setTargetAtTime(W,V,G),j),setValueAtTime:(W,V)=\u003e(q===null\u0026\u0026I.flush(v.context.currentTime),I.add(f(W,V)),x.setValueAtTime(W,V),j),setValueCurveAtTime(W,V,G){let ct=W instanceof Float32Array?W:new Float32Array(W);if(g!==null\u0026\u0026g.name===\"webkitAudioContext\"){let H=V+G,Q=v.context.sampleRate,nt=Math.ceil(V*Q),dt=Math.floor(H*Q),bt=dt-nt,Ft=new Float32Array(bt);for(let Ct=0;Ct\u003cbt;Ct+=1){let Nt=(ct.length-1)/G*((nt+Ct)/Q-V),kt=Math.floor(Nt),Pt=Math.ceil(Nt);Ft[Ct]=kt===Pt?ct[kt]:(1-(Nt-kt))*ct[kt]+(1-(Pt-Nt))*ct[Pt]}q===null\u0026\u0026I.flush(v.context.currentTime),I.add(y(Ft,V,G)),x.setValueCurveAtTime(Ft,V,G);let vt=dt/Q;vt\u003cH\u0026\u0026b(j,Ft[Ft.length-1],vt),b(j,ct[ct.length-1],H)}else q===null\u0026\u0026I.flush(v.context.currentTime),I.add(y(ct,V,G)),x.setValueCurveAtTime(ct,V,G);return j}};return e.set(j,x),t.set(j,v),s(j,q),j})((fc=O,(s,t)=\u003e{fc.set(s,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})}),ic,A,s=\u003e({replay(t){for(let e of s)if(e.type===\"exponentialRampToValue\"){let{endTime:n,value:i}=e;t.exponentialRampToValueAtTime(i,n)}else if(e.type===\"linearRampToValue\"){let{endTime:n,value:i}=e;t.linearRampToValueAtTime(i,n)}else if(e.type===\"setTarget\"){let{startTime:n,target:i,timeConstant:c}=e;t.setTargetAtTime(i,n,c)}else if(e.type===\"setValue\"){let{startTime:n,value:i}=e;t.setValueAtTime(i,n)}else{if(e.type!==\"setValueCurve\")throw new Error(\"Can't apply an unknown automation.\");{let{duration:n,startTime:i,values:c}=e;t.setValueCurveAtTime(c,i,n)}}}}),_.createCancelAndHoldAutomationEvent,_.createCancelScheduledValuesAutomationEvent,_.createExponentialRampToValueAutomationEvent,_.createLinearRampToValueAutomationEvent,_.createSetTargetAutomationEvent,_.createSetValueAutomationEvent,_.createSetValueCurveAutomationEvent,kn,Ua);var fc;let gh=((s,t,e,n,i,c,l,h)=\u003eclass extends s{constructor(p,f){let y=c(p),g={...le,...f},b=i(y,g),v=l(y),E=v?t():null;super(p,!1,b,E),this._audioBufferSourceNodeRenderer=E,this._isBufferNullified=!1,this._isBufferSet=g.buffer!==null,this._nativeAudioBufferSourceNode=b,this._onended=null,this._playbackRate=e(this,v,b.playbackRate,At,rt)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(p){if(this._nativeAudioBufferSourceNode.buffer=p,p!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(p){this._nativeAudioBufferSourceNode.loop=p}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(p){this._nativeAudioBufferSourceNode.loopEnd=p}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(p){this._nativeAudioBufferSourceNode.loopStart=p}get onended(){return this._onended}set onended(p){let f=typeof p==\"function\"?h(this,p):null;this._nativeAudioBufferSourceNode.onended=f;let y=this._nativeAudioBufferSourceNode.onended;this._onended=y!==null\u0026\u0026y===f?p:y}get playbackRate(){return this._playbackRate}start(p=0,f=0,y){if(this._nativeAudioBufferSourceNode.start(p,f,y),this._audioBufferSourceNodeRenderer!==null\u0026\u0026(this._audioBufferSourceNodeRenderer.start=y===void 0?[p,f]:[p,f,y]),this.context.state!==\"closed\"){pt(this);let g=()=\u003e{this._nativeAudioBufferSourceNode.removeEventListener(\"ended\",g),Gt(this)\u0026\u0026jt(this)};this._nativeAudioBufferSourceNode.addEventListener(\"ended\",g)}}stop(p=0){this._nativeAudioBufferSourceNode.stop(p),this._audioBufferSourceNodeRenderer!==null\u0026\u0026(this._audioBufferSourceNodeRenderer.stop=p)}})(he,mh,cn,fe,ws,Zt,Ut,bs),vh=((s,t,e,n,i,c,l,h)=\u003eclass extends s{constructor(p,f){let y=c(p),g=l(y),b=i(y,f,g);super(p,!1,b,g?t(h):null),this._isNodeOfNativeOfflineAudioContext=g,this._nativeAudioDestinationNode=b}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(p){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(p\u003ethis._nativeAudioDestinationNode.maxChannelCount)throw e();this._nativeAudioDestinationNode.channelCount=p}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(p){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=p}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(he,s=\u003e{let t=null;return{render:(e,n,i)=\u003e(t===null\u0026\u0026(t=(async(c,l,h)=\u003e{let p=l.destination;return await s(c,l,p,h),p})(e,n,i)),t)}},it,fe,((s,t)=\u003e(e,n,i)=\u003e{let c=e.destination;if(c.channelCount!==n)try{c.channelCount=n}catch{}i\u0026\u0026c.channelCountMode!==\"explicit\"\u0026\u0026(c.channelCountMode=\"explicit\"),c.maxChannelCount===0\u0026\u0026Object.defineProperty(c,\"maxChannelCount\",{value:n});let l=s(e,{channelCount:n,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:1});return t(l,\"channelCount\",h=\u003e()=\u003eh.call(l),h=\u003ep=\u003e{h.call(l,p);try{c.channelCount=p}catch(f){if(p\u003ec.maxChannelCount)throw f}}),t(l,\"channelCountMode\",h=\u003e()=\u003eh.call(l),h=\u003ep=\u003e{h.call(l,p),c.channelCountMode=p}),t(l,\"channelInterpretation\",h=\u003e()=\u003eh.call(l),h=\u003ep=\u003e{h.call(l,p),c.channelInterpretation=p}),Object.defineProperty(l,\"maxChannelCount\",{get:()=\u003ec.maxChannelCount}),l.connect(c),l})(Fe,Qi),Zt,Ut,ke),_h=((s,t,e,n,i)=\u003e()=\u003e{let c=new WeakMap;return{render(l,h,p){let f=c.get(h);return f!==void 0?Promise.resolve(f):(async(y,g,b)=\u003e{let v=e(y),E=L(v,g);if(!E){let x={Q:v.Q.value,channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,detune:v.detune.value,frequency:v.frequency.value,gain:v.gain.value,type:v.type};v=t(g,x)}return c.set(g,v),E?(await s(g,y.Q,v.Q,b),await s(g,y.detune,v.detune,b),await s(g,y.frequency,v.frequency,b),await s(g,y.gain,v.gain,b)):(await n(g,y.Q,v.Q,b),await n(g,y.detune,v.detune,b),await n(g,y.frequency,v.frequency,b),await n(g,y.gain,v.gain,b)),await i(y,g,v,b),v})(l,h,p)}}})(vn,La,$t,_n,ke),Jn=(s=\u003e(t,e)=\u003es.set(t,e))(Qa),yh=(mc=he,mi=cn,gc=_h,Jo=Xi,vc=La,_c=Zt,yc=Ut,bc=Jn,class extends mc{constructor(s,t){let e=_c(s),n={...zl,...t},i=vc(e,n),c=yc(e);super(s,!1,i,c?gc():null),this._Q=mi(this,c,i.Q,At,rt),this._detune=mi(this,c,i.detune,1200*Math.log2(At),-1200*Math.log2(At)),this._frequency=mi(this,c,i.frequency,s.sampleRate/2,0),this._gain=mi(this,c,i.gain,40*Math.log10(At),rt),this._nativeBiquadFilterNode=i,bc(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(s){this._nativeBiquadFilterNode.type=s}getFrequencyResponse(s,t,e){try{this._nativeBiquadFilterNode.getFrequencyResponse(s,t,e)}catch(n){throw n.code===11?Jo():n}if(s.length!==t.length||t.length!==e.length)throw Jo()}});var mc,mi,gc,Jo,vc,_c,yc,bc;let Rn=((s,t)=\u003e(e,n,i)=\u003e{let c=new Set;var l,h;return e.connect=(l=e.connect,(p,f=0,y=0)=\u003e{let g=c.size===0;if(t(p))return l.call(e,p,f,y),s(c,[p,f,y],b=\u003eb[0]===p\u0026\u0026b[1]===f\u0026\u0026b[2]===y,!0),g\u0026\u0026n(),p;l.call(e,p,f),s(c,[p,f],b=\u003eb[0]===p\u0026\u0026b[1]===f,!0),g\u0026\u0026n()}),e.disconnect=(h=e.disconnect,(p,f,y)=\u003e{let g=c.size\u003e0;if(p===void 0)h.apply(e),c.clear();else if(typeof p==\"number\"){h.call(e,p);for(let v of c)v[1]===p\u0026\u0026c.delete(v)}else{t(p)?h.call(e,p,f,y):h.call(e,p,f);for(let v of c)v[0]!==p||f!==void 0\u0026\u0026v[1]!==f||y!==void 0\u0026\u0026v[2]!==y||c.delete(v)}let b=c.size===0;g\u0026\u0026b\u0026\u0026i()}),e})(Qt,Yo),bh=(ta=fe,wc=Rn,(s,t)=\u003e{t.channelCount=1,t.channelCountMode=\"explicit\",Object.defineProperty(t,\"channelCount\",{get:()=\u003e1,set:()=\u003e{throw ta()}}),Object.defineProperty(t,\"channelCountMode\",{get:()=\u003e\"explicit\",set:()=\u003e{throw ta()}});let e=s.createBufferSource();wc(t,()=\u003e{let n=t.numberOfInputs;for(let i=0;i\u003cn;i+=1)e.connect(t,0,i)},()=\u003ee.disconnect(t))});var ta,wc;let Fn=((s,t)=\u003e(e,n)=\u003e{let i=e.createChannelMerger(n.numberOfInputs);return s!==null\u0026\u0026s.name===\"webkitAudioContext\"\u0026\u0026t(e,i),ve(i,n),i})(kn,bh),wh=((s,t,e,n,i)=\u003eclass extends s{constructor(c,l){let h=n(c),p={...Gl,...l};super(c,!1,e(h,p),i(h)?t():null)}})(he,((s,t,e)=\u003e()=\u003e{let n=new WeakMap;return{render(i,c,l){let h=n.get(c);return h!==void 0?Promise.resolve(h):(async(p,f,y)=\u003e{let g=t(p);if(!L(g,f)){let b={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,numberOfInputs:g.numberOfInputs};g=s(f,b)}return n.set(f,g),await e(p,f,g,y),g})(i,c,l)}}})(Fn,$t,ke),Fn,Zt,Ut),xh=((s,t,e,n,i,c)=\u003eclass extends s{constructor(l,h){let p=n(l),f=c({...Bl,...h});super(l,!1,e(p,f),i(p)?t():null)}})(he,((s,t,e)=\u003e()=\u003e{let n=new WeakMap;return{render(i,c,l){let h=n.get(c);return h!==void 0?Promise.resolve(h):(async(p,f,y)=\u003e{let g=t(p);if(!L(g,f)){let b={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,numberOfOutputs:g.numberOfOutputs};g=s(f,b)}return n.set(f,g),await e(p,f,g,y),g})(i,c,l)}}})(di,$t,ke),di,Zt,Ut,s=\u003e({...s,channelCount:s.numberOfOutputs})),Th=((s,t,e,n)=\u003e(i,{offset:c,...l})=\u003e{let h=i.createBuffer(1,2,44100),p=t(i,{buffer:null,channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),f=e(i,{...l,gain:c}),y=h.getChannelData(0);y[0]=1,y[1]=1,p.buffer=h,p.loop=!0;let g={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(b){f.channelCount=b},get channelCountMode(){return f.channelCountMode},set channelCountMode(b){f.channelCountMode=b},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(b){f.channelInterpretation=b},get context(){return f.context},get inputs(){return[]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get offset(){return f.gain},get onended(){return p.onended},set onended(b){p.onended=b},addEventListener:(...b)=\u003ep.addEventListener(b[0],b[1],b[2]),dispatchEvent:(...b)=\u003ep.dispatchEvent(b[0]),removeEventListener:(...b)=\u003ep.removeEventListener(b[0],b[1],b[2]),start(b=0){p.start.call(p,b)},stop(b=0){p.stop.call(p,b)}};return s(i,p),n(ys(g,f),()=\u003ep.connect(f),()=\u003ep.disconnect(f))})(Ki,ws,Fe,Rn),xs=((s,t,e,n,i)=\u003e(c,l)=\u003e{if(c.createConstantSource===void 0)return e(c,l);let h=c.createConstantSource();return ve(h,l),ae(h,l,\"offset\"),t(n,()=\u003en(c))||Vo(h),t(i,()=\u003ei(c))||Lo(h),s(c,h),h})(Ki,He,Th,Wo,zo),Sh=((s,t,e,n,i,c,l)=\u003eclass extends s{constructor(h,p){let f=i(h),y={...Ul,...p},g=n(f,y),b=c(f),v=b?e():null;super(h,!1,g,v),this._constantSourceNodeRenderer=v,this._nativeConstantSourceNode=g,this._offset=t(this,b,g.offset,At,rt),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(h){let p=typeof h==\"function\"?l(this,h):null;this._nativeConstantSourceNode.onended=p;let f=this._nativeConstantSourceNode.onended;this._onended=f!==null\u0026\u0026f===p?h:f}start(h=0){if(this._nativeConstantSourceNode.start(h),this._constantSourceNodeRenderer!==null\u0026\u0026(this._constantSourceNodeRenderer.start=h),this.context.state!==\"closed\"){pt(this);let p=()=\u003e{this._nativeConstantSourceNode.removeEventListener(\"ended\",p),Gt(this)\u0026\u0026jt(this)};this._nativeConstantSourceNode.addEventListener(\"ended\",p)}}stop(h=0){this._nativeConstantSourceNode.stop(h),this._constantSourceNodeRenderer!==null\u0026\u0026(this._constantSourceNodeRenderer.stop=h)}})(he,cn,((s,t,e,n,i)=\u003e()=\u003e{let c=new WeakMap,l=null,h=null;return{set start(p){l=p},set stop(p){h=p},render(p,f,y){let g=c.get(f);return g!==void 0?Promise.resolve(g):(async(b,v,E)=\u003e{let x=e(b),w=L(x,v);if(!w){let C={channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation,offset:x.offset.value};x=t(v,C),l!==null\u0026\u0026x.start(l),h!==null\u0026\u0026x.stop(h)}return c.set(v,x),w?await s(v,b.offset,x.offset,E):await n(v,b.offset,x.offset,E),await i(b,v,x,E),x})(p,f,y)}}})(vn,xs,$t,_n,ke),xs,Zt,Ut,bs),xc=((s,t)=\u003e(e,n)=\u003e{let i=e.createConvolver();if(ve(i,n),n.disableNormalization===i.normalize\u0026\u0026(i.normalize=!n.disableNormalization),se(i,n,\"buffer\"),n.channelCount\u003e2||(t(i,\"channelCount\",c=\u003e()=\u003ec.call(i),c=\u003el=\u003e{if(l\u003e2)throw s();return c.call(i,l)}),n.channelCountMode===\"max\"))throw s();return t(i,\"channelCountMode\",c=\u003e()=\u003ec.call(i),c=\u003el=\u003e{if(l===\"max\")throw s();return c.call(i,l)}),i})(je,Qi),kh=((s,t,e,n,i,c)=\u003eclass extends s{constructor(l,h){let p=n(l),f={...Hl,...h},y=e(p,f);super(l,!1,y,i(p)?t():null),this._isBufferNullified=!1,this._nativeConvolverNode=y,f.buffer!==null\u0026\u0026c(this,f.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(l){if(this._nativeConvolverNode.buffer=l,l===null\u0026\u0026this._nativeConvolverNode.buffer!==null){let h=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=h.createBuffer(1,1,44100),this._isBufferNullified=!0,c(this,0)}else this._isBufferNullified=!1,c(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(l){this._nativeConvolverNode.normalize=l}})(he,((s,t,e)=\u003e()=\u003e{let n=new WeakMap;return{render(i,c,l){let h=n.get(c);return h!==void 0?Promise.resolve(h):(async(p,f,y)=\u003e{let g=t(p);if(!L(g,f)){let b={buffer:g.buffer,channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,disableNormalization:!g.normalize};g=s(f,b)}return n.set(f,g),Ue(g)?await e(p,f,g.inputs[0],y):await e(p,f,g,y),g})(i,c,l)}}})(xc,$t,ke),xc,Zt,Ut,Jn),Mh=((s,t,e,n,i,c,l)=\u003eclass extends s{constructor(h,p){let f=i(h),y={...Yl,...p},g=n(f,y),b=c(f);super(h,!1,g,b?e(y.maxDelayTime):null),this._delayTime=t(this,b,g.delayTime),l(this,y.maxDelayTime)}get delayTime(){return this._delayTime}})(he,cn,((s,t,e,n,i)=\u003ec=\u003e{let l=new WeakMap;return{render(h,p,f){let y=l.get(p);return y!==void 0?Promise.resolve(y):(async(g,b,v)=\u003e{let E=e(g),x=L(E,b);if(!x){let w={channelCount:E.channelCount,channelCountMode:E.channelCountMode,channelInterpretation:E.channelInterpretation,delayTime:E.delayTime.value,maxDelayTime:c};E=t(b,w)}return l.set(b,E),x?await s(b,g.delayTime,E.delayTime,v):await n(b,g.delayTime,E.delayTime,v),await i(g,b,E,v),E})(h,p,f)}}})(vn,Wa,$t,_n,ke),Wa,Zt,Ut,Jn),Tc=(ea=je,(s,t)=\u003e{let e=s.createDynamicsCompressor();if(ve(e,t),t.channelCount\u003e2||t.channelCountMode===\"max\")throw ea();return ae(e,t,\"attack\"),ae(e,t,\"knee\"),ae(e,t,\"ratio\"),ae(e,t,\"release\"),ae(e,t,\"threshold\"),e});var ea;let Ah=((s,t,e,n,i,c,l,h)=\u003eclass extends s{constructor(p,f){let y=c(p),g={...Xl,...f},b=n(y,g),v=l(y);super(p,!1,b,v?e():null),this._attack=t(this,v,b.attack),this._knee=t(this,v,b.knee),this._nativeDynamicsCompressorNode=b,this._ratio=t(this,v,b.ratio),this._release=t(this,v,b.release),this._threshold=t(this,v,b.threshold),h(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(p){let f=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=p,p\u003e2)throw this._nativeDynamicsCompressorNode.channelCount=f,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(p){let f=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=p,p===\"max\")throw this._nativeDynamicsCompressorNode.channelCountMode=f,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value==\"number\"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(he,cn,((s,t,e,n,i)=\u003e()=\u003e{let c=new WeakMap;return{render(l,h,p){let f=c.get(h);return f!==void 0?Promise.resolve(f):(async(y,g,b)=\u003e{let v=e(y),E=L(v,g);if(!E){let x={attack:v.attack.value,channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,knee:v.knee.value,ratio:v.ratio.value,release:v.release.value,threshold:v.threshold.value};v=t(g,x)}return c.set(g,v),E?(await s(g,y.attack,v.attack,b),await s(g,y.knee,v.knee,b),await s(g,y.ratio,v.ratio,b),await s(g,y.release,v.release,b),await s(g,y.threshold,v.threshold,b)):(await n(g,y.attack,v.attack,b),await n(g,y.knee,v.knee,b),await n(g,y.ratio,v.ratio,b),await n(g,y.release,v.release,b),await n(g,y.threshold,v.threshold,b)),await i(y,g,v,b),v})(l,h,p)}}})(vn,Tc,$t,_n,ke),Tc,je,Zt,Ut,Jn),Ch=((s,t,e,n,i,c)=\u003eclass extends s{constructor(l,h){let p=i(l),f={...Ql,...h},y=n(p,f),g=c(p);super(l,!1,y,g?e():null),this._gain=t(this,g,y.gain,At,rt)}get gain(){return this._gain}})(he,cn,((s,t,e,n,i)=\u003e()=\u003e{let c=new WeakMap;return{render(l,h,p){let f=c.get(h);return f!==void 0?Promise.resolve(f):(async(y,g,b)=\u003e{let v=e(y),E=L(v,g);if(!E){let x={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:v.gain.value};v=t(g,x)}return c.set(g,v),E?await s(g,y.gain,v.gain,b):await n(g,y.gain,v.gain,b),await i(y,g,v,b),v})(l,h,p)}}})(vn,Fe,$t,_n,ke),Fe,Zt,Ut),Oh=((s,t,e,n)=\u003e(i,c,{channelCount:l,channelCountMode:h,channelInterpretation:p,feedback:f,feedforward:y})=\u003e{let g=Va(c,i.sampleRate),b=f instanceof Float64Array?f:new Float64Array(f),v=y instanceof Float64Array?y:new Float64Array(y),E=b.length,x=v.length,w=Math.min(E,x);if(E===0||E\u003e20)throw n();if(b[0]===0)throw t();if(x===0||x\u003e20)throw n();if(v[0]===0)throw t();if(b[0]!==1){for(let V=0;V\u003cx;V+=1)v[V]/=b[0];for(let V=1;V\u003cE;V+=1)b[V]/=b[0]}let C=e(i,g,l,l);C.channelCount=l,C.channelCountMode=h,C.channelInterpretation=p;let I=[],q=[],j=[];for(let V=0;V\u003cl;V+=1){I.push(0);let G=new Float32Array(32),ct=new Float32Array(32);G.fill(0),ct.fill(0),q.push(G),j.push(ct)}C.onaudioprocess=V=\u003e{let G=V.inputBuffer,ct=V.outputBuffer,H=G.numberOfChannels;for(let Q=0;Q\u003cH;Q+=1){let nt=G.getChannelData(Q),dt=ct.getChannelData(Q);I[Q]=Ra(b,E,v,x,w,q[Q],j[Q],I[Q],32,nt,dt)}};let W=i.sampleRate/2;return ys({get bufferSize(){return g},get channelCount(){return C.channelCount},set channelCount(V){C.channelCount=V},get channelCountMode(){return C.channelCountMode},set channelCountMode(V){C.channelCountMode=V},get channelInterpretation(){return C.channelInterpretation},set channelInterpretation(V){C.channelInterpretation=V},get context(){return C.context},get inputs(){return[C]},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},addEventListener:(...V)=\u003eC.addEventListener(V[0],V[1],V[2]),dispatchEvent:(...V)=\u003eC.dispatchEvent(V[0]),getFrequencyResponse(V,G,ct){if(V.length!==G.length||G.length!==ct.length)throw s();let H=V.length;for(let Q=0;Q\u003cH;Q+=1){let nt=-Math.PI*(V[Q]/W),dt=[Math.cos(nt),Math.sin(nt)],bt=Jl(za(v,dt),za(b,dt));G[Q]=Math.sqrt(bt[0]*bt[0]+bt[1]*bt[1]),ct[Q]=Math.atan2(bt[1],bt[0])}},removeEventListener:(...V)=\u003eC.removeEventListener(V[0],V[1],V[2])},C)})(Xi,fe,pi,je),$i=((s,t,e,n)=\u003ei=\u003es(hi,()=\u003ehi(i))?Promise.resolve(s(n,n)).then(c=\u003e{if(!c){let l=e(i,512,0,1);i.oncomplete=()=\u003e{l.onaudioprocess=null,l.disconnect()},l.onaudioprocess=()=\u003ei.currentTime,l.connect(i.destination)}return i.startRendering()}):new Promise(c=\u003e{let l=t(i,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",gain:0});i.oncomplete=h=\u003e{l.disconnect(),c(h.renderedBuffer)},l.connect(i.destination),i.startRendering()}))(He,Fe,pi,((s,t)=\u003e()=\u003e{if(t===null)return Promise.resolve(!1);let e=new t(1,1,44100),n=s(e,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",gain:0});return new Promise(i=\u003e{e.oncomplete=()=\u003e{n.disconnect(),i(e.currentTime!==0)},e.startRendering()})})(Fe,we)),Dh=((s,t,e,n,i)=\u003e(c,l)=\u003e{let h=new WeakMap,p=null,f=async(y,g,b)=\u003e{let v=null,E=t(y),x=L(E,g);if(g.createIIRFilter===void 0?v=s(g,{buffer:null,channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):x||(E=g.createIIRFilter(l,c)),h.set(g,v===null?E:v),v!==null){if(p===null){if(e===null)throw new Error(\"Missing the native OfflineAudioContext constructor.\");let C=new e(y.context.destination.channelCount,y.context.length,g.sampleRate);p=(async()=\u003e(await n(y,C,C.destination,b),((I,q,j,W)=\u003e{let V=j instanceof Float64Array?j:new Float64Array(j),G=W instanceof Float64Array?W:new Float64Array(W),ct=V.length,H=G.length,Q=Math.min(ct,H);if(V[0]!==1){for(let vt=0;vt\u003cct;vt+=1)G[vt]/=V[0];for(let vt=1;vt\u003cH;vt+=1)V[vt]/=V[0]}let nt=new Float32Array(32),dt=new Float32Array(32),bt=q.createBuffer(I.numberOfChannels,I.length,I.sampleRate),Ft=I.numberOfChannels;for(let vt=0;vt\u003cFt;vt+=1){let Ct=I.getChannelData(vt),Nt=bt.getChannelData(vt);nt.fill(0),dt.fill(0),Ra(V,ct,G,H,Q,nt,dt,0,32,Ct,Nt)}return bt})(await i(C),g,c,l)))()}let w=await p;return v.buffer=w,v.start(0),v}return await n(y,g,E,b),E};return{render(y,g,b){let v=h.get(g);return v!==void 0?Promise.resolve(v):f(y,g,b)}}})(ws,$t,we,ke,$i);var Sc;let Ph=((s,t,e,n,i,c)=\u003eclass extends s{constructor(l,h){let p=n(l),f=i(p),y={...Zl,...h},g=t(p,f?null:l.baseLatency,y);super(l,!1,g,f?e(y.feedback,y.feedforward):null),(b=\u003e{var v;b.getFrequencyResponse=(v=b.getFrequencyResponse,(E,x,w)=\u003e{if(E.length!==x.length||x.length!==w.length)throw Xi();return v.call(b,E,x,w)})})(g),this._nativeIIRFilterNode=g,c(this,1)}getFrequencyResponse(l,h,p){return this._nativeIIRFilterNode.getFrequencyResponse(l,h,p)}})(he,(Sc=Oh,(s,t,e)=\u003e{if(s.createIIRFilter===void 0)return Sc(s,t,e);let n=s.createIIRFilter(e.feedforward,e.feedback);return ve(n,e),n}),Dh,Zt,Ut,Jn),Eh=((s,t,e,n,i)=\u003e(c,l)=\u003e{let h=l.listener,{forwardX:p,forwardY:f,forwardZ:y,positionX:g,positionY:b,positionZ:v,upX:E,upY:x,upZ:w}=h.forwardX===void 0?(()=\u003e{let C=t(l,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"speakers\",numberOfInputs:9}),I=i(l),q=n(l,256,9,0),j=(G,ct)=\u003e{let H=e(l,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",offset:ct});return H.connect(C,0,G),H.start(),Object.defineProperty(H.offset,\"defaultValue\",{get:()=\u003ect}),s({context:c},I,H.offset,At,rt)},W=[0,0,-1,0,1,0],V=[0,0,0];return q.onaudioprocess=({inputBuffer:G})=\u003e{let ct=[G.getChannelData(0)[0],G.getChannelData(1)[0],G.getChannelData(2)[0],G.getChannelData(3)[0],G.getChannelData(4)[0],G.getChannelData(5)[0]];ct.some((Q,nt)=\u003eQ!==W[nt])\u0026\u0026(h.setOrientation(...ct),W=ct);let H=[G.getChannelData(6)[0],G.getChannelData(7)[0],G.getChannelData(8)[0]];H.some((Q,nt)=\u003eQ!==V[nt])\u0026\u0026(h.setPosition(...H),V=H)},C.connect(q),{forwardX:j(0,0),forwardY:j(1,0),forwardZ:j(2,-1),positionX:j(6,0),positionY:j(7,0),positionZ:j(8,0),upX:j(3,0),upY:j(4,1),upZ:j(5,0)}})():h;return{get forwardX(){return p},get forwardY(){return f},get forwardZ(){return y},get positionX(){return g},get positionY(){return b},get positionZ(){return v},get upX(){return E},get upY(){return x},get upZ(){return w}}})(cn,Fn,xs,pi,Ut),kc=new WeakMap,na=((s,t,e,n,i,c)=\u003eclass extends e{constructor(l,h){super(l),this._nativeContext=l,N.set(this,l),n(l)\u0026\u0026i.set(l,new Set),this._destination=new s(this,h),this._listener=t(this,l),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(l){let h=typeof l==\"function\"?c(this,l):null;this._nativeContext.onstatechange=h;let p=this._nativeContext.onstatechange;this._onstatechange=p!==null\u0026\u0026p===h?l:p}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(vh,Eh,rc,Ut,kc,bs),Mc=((s,t,e,n,i,c)=\u003e(l,h)=\u003e{let p=l.createOscillator();return ve(p,h),ae(p,h,\"detune\"),ae(p,h,\"frequency\"),h.periodicWave!==void 0?p.setPeriodicWave(h.periodicWave):se(p,h,\"type\"),t(e,()=\u003ee(l))||Vo(p),t(n,()=\u003en(l))||c(p,l),t(i,()=\u003ei(l))||Lo(p),s(l,p),p})(Ki,He,Wo,Ha,zo,Ya),Nh=((s,t,e,n,i,c,l)=\u003eclass extends s{constructor(h,p){let f=i(h),y={...eh,...p},g=e(f,y),b=c(f),v=b?n():null,E=h.sampleRate/2;super(h,!1,g,v),this._detune=t(this,b,g.detune,153600,-153600),this._frequency=t(this,b,g.frequency,E,-E),this._nativeOscillatorNode=g,this._onended=null,this._oscillatorNodeRenderer=v,this._oscillatorNodeRenderer!==null\u0026\u0026y.periodicWave!==void 0\u0026\u0026(this._oscillatorNodeRenderer.periodicWave=y.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(h){let p=typeof h==\"function\"?l(this,h):null;this._nativeOscillatorNode.onended=p;let f=this._nativeOscillatorNode.onended;this._onended=f!==null\u0026\u0026f===p?h:f}get type(){return this._nativeOscillatorNode.type}set type(h){this._nativeOscillatorNode.type=h,this._oscillatorNodeRenderer!==null\u0026\u0026(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(h){this._nativeOscillatorNode.setPeriodicWave(h),this._oscillatorNodeRenderer!==null\u0026\u0026(this._oscillatorNodeRenderer.periodicWave=h)}start(h=0){if(this._nativeOscillatorNode.start(h),this._oscillatorNodeRenderer!==null\u0026\u0026(this._oscillatorNodeRenderer.start=h),this.context.state!==\"closed\"){pt(this);let p=()=\u003e{this._nativeOscillatorNode.removeEventListener(\"ended\",p),Gt(this)\u0026\u0026jt(this)};this._nativeOscillatorNode.addEventListener(\"ended\",p)}}stop(h=0){this._nativeOscillatorNode.stop(h),this._oscillatorNodeRenderer!==null\u0026\u0026(this._oscillatorNodeRenderer.stop=h)}})(he,cn,Mc,((s,t,e,n,i)=\u003e()=\u003e{let c=new WeakMap,l=null,h=null,p=null;return{set periodicWave(f){l=f},set start(f){h=f},set stop(f){p=f},render(f,y,g){let b=c.get(y);return b!==void 0?Promise.resolve(b):(async(v,E,x)=\u003e{let w=e(v),C=L(w,E);if(!C){let I={channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation,detune:w.detune.value,frequency:w.frequency.value,periodicWave:l===null?void 0:l,type:w.type};w=t(E,I),h!==null\u0026\u0026w.start(h),p!==null\u0026\u0026w.stop(p)}return c.set(E,w),C?(await s(E,v.detune,w.detune,x),await s(E,v.frequency,w.frequency,x)):(await n(E,v.detune,w.detune,x),await n(E,v.frequency,w.frequency,x)),await i(v,E,w,x),w})(f,y,g)}}})(vn,Mc,$t,_n,ke),Zt,Ut,bs),Ac=(Cc=ws,(s,t)=\u003e{let e=Cc(s,{buffer:null,channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),n=s.createBuffer(1,2,44100);return e.buffer=n,e.loop=!0,e.connect(t),e.start(),()=\u003e{e.stop(),e.disconnect(t)}});var Cc;let qh=((s,t,e,n,i)=\u003e(c,{curve:l,oversample:h,...p})=\u003e{let f=c.createWaveShaper(),y=c.createWaveShaper();ve(f,p),ve(y,p);let g=e(c,{...p,gain:1}),b=e(c,{...p,gain:-1}),v=e(c,{...p,gain:1}),E=e(c,{...p,gain:-1}),x=null,w=!1,C=null,I={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(q){g.channelCount=q,b.channelCount=q,f.channelCount=q,v.channelCount=q,y.channelCount=q,E.channelCount=q},get channelCountMode(){return f.channelCountMode},set channelCountMode(q){g.channelCountMode=q,b.channelCountMode=q,f.channelCountMode=q,v.channelCountMode=q,y.channelCountMode=q,E.channelCountMode=q},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(q){g.channelInterpretation=q,b.channelInterpretation=q,f.channelInterpretation=q,v.channelInterpretation=q,y.channelInterpretation=q,E.channelInterpretation=q},get context(){return f.context},get curve(){return C},set curve(q){if(q!==null\u0026\u0026q.length\u003c2)throw t();if(q===null)f.curve=q,y.curve=q;else{let j=q.length,W=new Float32Array(j+2-j%2),V=new Float32Array(j+2-j%2);W[0]=q[0],V[0]=-q[j-1];let G=Math.ceil((j+1)/2),ct=(j+1)/2-1;for(let H=1;H\u003cG;H+=1){let Q=H/G*ct,nt=Math.floor(Q),dt=Math.ceil(Q);W[H]=nt===dt?q[nt]:(1-(Q-nt))*q[nt]+(1-(dt-Q))*q[dt],V[H]=nt===dt?-q[j-1-nt]:-(1-(Q-nt))*q[j-1-nt]-(1-(dt-Q))*q[j-1-dt]}W[G]=j%2==1?q[G-1]:(q[G-2]+q[G-1])/2,f.curve=W,y.curve=V}C=q,w\u0026\u0026(n(C)\u0026\u0026x===null?x=s(c,g):x!==null\u0026\u0026(x(),x=null))},get inputs(){return[g]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get oversample(){return f.oversample},set oversample(q){f.oversample=q,y.oversample=q},addEventListener:(...q)=\u003eg.addEventListener(q[0],q[1],q[2]),dispatchEvent:(...q)=\u003eg.dispatchEvent(q[0]),removeEventListener:(...q)=\u003eg.removeEventListener(q[0],q[1],q[2])};return l!==null\u0026\u0026(I.curve=l instanceof Float32Array?l:new Float32Array(l)),h!==I.oversample\u0026\u0026(I.oversample=h),i(ys(I,v),()=\u003e{g.connect(f).connect(v),g.connect(b).connect(y).connect(E).connect(v),w=!0,n(C)\u0026\u0026(x=s(c,g))},()=\u003e{g.disconnect(f),f.disconnect(v),g.disconnect(b),b.disconnect(y),y.disconnect(E),E.disconnect(v),w=!1,x!==null\u0026\u0026(x(),x=null)})})(Ac,fe,Fe,Ba,Rn),Ji=((s,t,e,n,i,c,l)=\u003e(h,p)=\u003e{let f=h.createWaveShaper();if(c!==null\u0026\u0026c.name===\"webkitAudioContext\"\u0026\u0026h.createGain().gain.automationRate===void 0)return e(h,p);ve(f,p);let y=p.curve===null||p.curve instanceof Float32Array?p.curve:new Float32Array(p.curve);if(y!==null\u0026\u0026y.length\u003c2)throw t();se(f,{curve:y},\"curve\"),se(f,p,\"oversample\");let g=null,b=!1;return l(f,\"curve\",v=\u003e()=\u003ev.call(f),v=\u003eE=\u003e(v.call(f,E),b\u0026\u0026(n(E)\u0026\u0026g===null?g=s(h,f):n(E)||g===null||(g(),g=null)),E)),i(f,()=\u003e{b=!0,n(f.curve)\u0026\u0026(g=s(h,f))},()=\u003e{b=!1,g!==null\u0026\u0026(g(),g=null)})})(Ac,fe,qh,Ba,Rn,kn,Qi),Ih=((s,t,e,n,i,c,l,h,p)=\u003e(f,{coneInnerAngle:y,coneOuterAngle:g,coneOuterGain:b,distanceModel:v,maxDistance:E,orientationX:x,orientationY:w,orientationZ:C,panningModel:I,positionX:q,positionY:j,positionZ:W,refDistance:V,rolloffFactor:G,...ct})=\u003e{let H=f.createPanner();if(ct.channelCount\u003e2||ct.channelCountMode===\"max\")throw l();ve(H,ct);let Q={channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\"},nt=e(f,{...Q,channelInterpretation:\"speakers\",numberOfInputs:6}),dt=n(f,{...ct,gain:1}),bt=n(f,{...Q,gain:1}),Ft=n(f,{...Q,gain:0}),vt=n(f,{...Q,gain:0}),Ct=n(f,{...Q,gain:0}),Nt=n(f,{...Q,gain:0}),kt=n(f,{...Q,gain:0}),Pt=i(f,256,6,1),Vt=c(f,{...Q,curve:new Float32Array([1,1]),oversample:\"none\"}),de=[x,w,C],ye=[q,j,W];Pt.onaudioprocess=({inputBuffer:_t})=\u003e{let De=[_t.getChannelData(0)[0],_t.getChannelData(1)[0],_t.getChannelData(2)[0]];De.some(($e,Hn)=\u003e$e!==de[Hn])\u0026\u0026(H.setOrientation(...De),de=De);let Sn=[_t.getChannelData(3)[0],_t.getChannelData(4)[0],_t.getChannelData(5)[0]];Sn.some(($e,Hn)=\u003e$e!==ye[Hn])\u0026\u0026(H.setPosition(...Sn),ye=Sn)},Object.defineProperty(Ft.gain,\"defaultValue\",{get:()=\u003e0}),Object.defineProperty(vt.gain,\"defaultValue\",{get:()=\u003e0}),Object.defineProperty(Ct.gain,\"defaultValue\",{get:()=\u003e0}),Object.defineProperty(Nt.gain,\"defaultValue\",{get:()=\u003e0}),Object.defineProperty(kt.gain,\"defaultValue\",{get:()=\u003e0});let qt={get bufferSize(){},get channelCount(){return H.channelCount},set channelCount(_t){if(_t\u003e2)throw l();dt.channelCount=_t,H.channelCount=_t},get channelCountMode(){return H.channelCountMode},set channelCountMode(_t){if(_t===\"max\")throw l();dt.channelCountMode=_t,H.channelCountMode=_t},get channelInterpretation(){return H.channelInterpretation},set channelInterpretation(_t){dt.channelInterpretation=_t,H.channelInterpretation=_t},get coneInnerAngle(){return H.coneInnerAngle},set coneInnerAngle(_t){H.coneInnerAngle=_t},get coneOuterAngle(){return H.coneOuterAngle},set coneOuterAngle(_t){H.coneOuterAngle=_t},get coneOuterGain(){return H.coneOuterGain},set coneOuterGain(_t){if(_t\u003c0||_t\u003e1)throw t();H.coneOuterGain=_t},get context(){return H.context},get distanceModel(){return H.distanceModel},set distanceModel(_t){H.distanceModel=_t},get inputs(){return[dt]},get maxDistance(){return H.maxDistance},set maxDistance(_t){if(_t\u003c0)throw new RangeError;H.maxDistance=_t},get numberOfInputs(){return H.numberOfInputs},get numberOfOutputs(){return H.numberOfOutputs},get orientationX(){return bt.gain},get orientationY(){return Ft.gain},get orientationZ(){return vt.gain},get panningModel(){return H.panningModel},set panningModel(_t){H.panningModel=_t},get positionX(){return Ct.gain},get positionY(){return Nt.gain},get positionZ(){return kt.gain},get refDistance(){return H.refDistance},set refDistance(_t){if(_t\u003c0)throw new RangeError;H.refDistance=_t},get rolloffFactor(){return H.rolloffFactor},set rolloffFactor(_t){if(_t\u003c0)throw new RangeError;H.rolloffFactor=_t},addEventListener:(..._t)=\u003edt.addEventListener(_t[0],_t[1],_t[2]),dispatchEvent:(..._t)=\u003edt.dispatchEvent(_t[0]),removeEventListener:(..._t)=\u003edt.removeEventListener(_t[0],_t[1],_t[2])};return y!==qt.coneInnerAngle\u0026\u0026(qt.coneInnerAngle=y),g!==qt.coneOuterAngle\u0026\u0026(qt.coneOuterAngle=g),b!==qt.coneOuterGain\u0026\u0026(qt.coneOuterGain=b),v!==qt.distanceModel\u0026\u0026(qt.distanceModel=v),E!==qt.maxDistance\u0026\u0026(qt.maxDistance=E),x!==qt.orientationX.value\u0026\u0026(qt.orientationX.value=x),w!==qt.orientationY.value\u0026\u0026(qt.orientationY.value=w),C!==qt.orientationZ.value\u0026\u0026(qt.orientationZ.value=C),I!==qt.panningModel\u0026\u0026(qt.panningModel=I),q!==qt.positionX.value\u0026\u0026(qt.positionX.value=q),j!==qt.positionY.value\u0026\u0026(qt.positionY.value=j),W!==qt.positionZ.value\u0026\u0026(qt.positionZ.value=W),V!==qt.refDistance\u0026\u0026(qt.refDistance=V),G!==qt.rolloffFactor\u0026\u0026(qt.rolloffFactor=G),de[0]===1\u0026\u0026de[1]===0\u0026\u0026de[2]===0||H.setOrientation(...de),ye[0]===0\u0026\u0026ye[1]===0\u0026\u0026ye[2]===0||H.setPosition(...ye),p(ys(qt,H),()=\u003e{dt.connect(H),s(dt,Vt,0,0),Vt.connect(bt).connect(nt,0,0),Vt.connect(Ft).connect(nt,0,1),Vt.connect(vt).connect(nt,0,2),Vt.connect(Ct).connect(nt,0,3),Vt.connect(Nt).connect(nt,0,4),Vt.connect(kt).connect(nt,0,5),nt.connect(Pt).connect(f.destination)},()=\u003e{dt.disconnect(H),h(dt,Vt,0,0),Vt.disconnect(bt),bt.disconnect(nt),Vt.disconnect(Ft),Ft.disconnect(nt),Vt.disconnect(vt),vt.disconnect(nt),Vt.disconnect(Ct),Ct.disconnect(nt),Vt.disconnect(Nt),Nt.disconnect(nt),Vt.disconnect(kt),kt.disconnect(nt),nt.disconnect(Pt),Pt.disconnect(f.destination)})})(mn,fe,Fn,Fe,pi,Ji,je,zi,Rn),Oc=(Dc=Ih,(s,t)=\u003e{let e=s.createPanner();return e.orientationX===void 0?Dc(s,t):(ve(e,t),ae(e,t,\"orientationX\"),ae(e,t,\"orientationY\"),ae(e,t,\"orientationZ\"),ae(e,t,\"positionX\"),ae(e,t,\"positionY\"),ae(e,t,\"positionZ\"),se(e,t,\"coneInnerAngle\"),se(e,t,\"coneOuterAngle\"),se(e,t,\"coneOuterGain\"),se(e,t,\"distanceModel\"),se(e,t,\"maxDistance\"),se(e,t,\"panningModel\"),se(e,t,\"refDistance\"),se(e,t,\"rolloffFactor\"),e)});var Dc;let jh=((s,t,e,n,i,c,l)=\u003eclass extends s{constructor(h,p){let f=i(h),y={...nh,...p},g=e(f,y),b=c(f);super(h,!1,g,b?n():null),this._nativePannerNode=g,this._orientationX=t(this,b,g.orientationX,At,rt),this._orientationY=t(this,b,g.orientationY,At,rt),this._orientationZ=t(this,b,g.orientationZ,At,rt),this._positionX=t(this,b,g.positionX,At,rt),this._positionY=t(this,b,g.positionY,At,rt),this._positionZ=t(this,b,g.positionZ,At,rt),l(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(h){this._nativePannerNode.coneInnerAngle=h}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(h){this._nativePannerNode.coneOuterAngle=h}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(h){this._nativePannerNode.coneOuterGain=h}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(h){this._nativePannerNode.distanceModel=h}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(h){this._nativePannerNode.maxDistance=h}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(h){this._nativePannerNode.panningModel=h}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(h){this._nativePannerNode.refDistance=h}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(h){this._nativePannerNode.rolloffFactor=h}})(he,cn,Oc,((s,t,e,n,i,c,l,h,p,f)=\u003e()=\u003e{let y=new WeakMap,g=null;return{render(b,v,E){let x=y.get(v);return x!==void 0?Promise.resolve(x):(async(w,C,I)=\u003e{let q=null,j=c(w),W={channelCount:j.channelCount,channelCountMode:j.channelCountMode,channelInterpretation:j.channelInterpretation},V={...W,coneInnerAngle:j.coneInnerAngle,coneOuterAngle:j.coneOuterAngle,coneOuterGain:j.coneOuterGain,distanceModel:j.distanceModel,maxDistance:j.maxDistance,panningModel:j.panningModel,refDistance:j.refDistance,rolloffFactor:j.rolloffFactor},G=L(j,C);if(\"bufferSize\"in j)q=n(C,{...W,gain:1});else if(!G){let ct={...V,orientationX:j.orientationX.value,orientationY:j.orientationY.value,orientationZ:j.orientationZ.value,positionX:j.positionX.value,positionY:j.positionY.value,positionZ:j.positionZ.value};j=i(C,ct)}if(y.set(C,q===null?j:q),q!==null){if(g===null){if(l===null)throw new Error(\"Missing the native OfflineAudioContext constructor.\");let vt=new l(6,w.context.length,C.sampleRate),Ct=t(vt,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"speakers\",numberOfInputs:6});Ct.connect(vt.destination),g=(async()=\u003e{let Nt=await Promise.all([w.orientationX,w.orientationY,w.orientationZ,w.positionX,w.positionY,w.positionZ].map(async(kt,Pt)=\u003e{let Vt=e(vt,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",offset:Pt===0?1:0});return await h(vt,kt,Vt.offset,I),Vt}));for(let kt=0;kt\u003c6;kt+=1)Nt[kt].connect(Ct,0,kt),Nt[kt].start(0);return f(vt)})()}let ct=await g,H=n(C,{...W,gain:1});await p(w,C,H,I);let Q=[];for(let vt=0;vt\u003cct.numberOfChannels;vt+=1)Q.push(ct.getChannelData(vt));let nt=[Q[0][0],Q[1][0],Q[2][0]],dt=[Q[3][0],Q[4][0],Q[5][0]],bt=n(C,{...W,gain:1}),Ft=i(C,{...V,orientationX:nt[0],orientationY:nt[1],orientationZ:nt[2],positionX:dt[0],positionY:dt[1],positionZ:dt[2]});H.connect(bt).connect(Ft.inputs[0]),Ft.connect(q);for(let vt=128;vt\u003cct.length;vt+=128){let Ct=[Q[0][vt],Q[1][vt],Q[2][vt]],Nt=[Q[3][vt],Q[4][vt],Q[5][vt]];if(Ct.some((kt,Pt)=\u003ekt!==nt[Pt])||Nt.some((kt,Pt)=\u003ekt!==dt[Pt])){nt=Ct,dt=Nt;let kt=vt/C.sampleRate;bt.gain.setValueAtTime(0,kt),bt=n(C,{...W,gain:0}),Ft=i(C,{...V,orientationX:nt[0],orientationY:nt[1],orientationZ:nt[2],positionX:dt[0],positionY:dt[1],positionZ:dt[2]}),bt.gain.setValueAtTime(1,kt),H.connect(bt).connect(Ft.inputs[0]),Ft.connect(q)}}return q}return G?(await s(C,w.orientationX,j.orientationX,I),await s(C,w.orientationY,j.orientationY,I),await s(C,w.orientationZ,j.orientationZ,I),await s(C,w.positionX,j.positionX,I),await s(C,w.positionY,j.positionY,I),await s(C,w.positionZ,j.positionZ,I)):(await h(C,w.orientationX,j.orientationX,I),await h(C,w.orientationY,j.orientationY,I),await h(C,w.orientationZ,j.orientationZ,I),await h(C,w.positionX,j.positionX,I),await h(C,w.positionY,j.positionY,I),await h(C,w.positionZ,j.positionZ,I)),Ue(j)?await p(w,C,j.inputs[0],I):await p(w,C,j,I),j})(b,v,E)}}})(vn,Fn,xs,Fe,Oc,$t,we,_n,ke,$i),Zt,Ut,Jn),Rh=((s,t,e,n)=\u003eclass Rl{constructor(c,l){let h=t(c),p=n({...sh,...l}),f=s(h,p);return e.add(f),f}static[Symbol.hasInstance](c){return c!==null\u0026\u0026typeof c==\"object\"\u0026\u0026Object.getPrototypeOf(c)===Rl.prototype||e.has(c)}})((s=\u003e(t,{disableNormalization:e,imag:n,real:i})=\u003e{let c=n instanceof Float32Array?n:new Float32Array(n),l=i instanceof Float32Array?i:new Float32Array(i),h=t.createPeriodicWave(l,c,{disableNormalization:e});if(Array.from(n).length\u003c2)throw s();return h})(it),Zt,new WeakSet,s=\u003e{let{imag:t,real:e}=s;return t===void 0?e===void 0?{...s,imag:[0,0],real:[0,0]}:{...s,imag:Array.from(e,()=\u003e0),real:e}:e===void 0?{...s,imag:t,real:Array.from(t,()=\u003e0)}:{...s,imag:t,real:e}}),Pc=((s,t)=\u003e(e,n)=\u003e{let i=n.channelCountMode;if(i===\"clamped-max\")throw t();if(e.createStereoPanner===void 0)return s(e,n);let c=e.createStereoPanner();return ve(c,n),ae(c,n,\"pan\"),Object.defineProperty(c,\"channelCountMode\",{get:()=\u003ei,set:l=\u003e{if(l!==i)throw t()}}),c})(((s,t,e,n,i,c)=\u003e{let l=new Float32Array([1,1]),h=Math.PI/2,p={channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\"},f={...p,oversample:\"none\"},y=(g,b,v,E,x)=\u003e{if(b===1)return((w,C,I,q)=\u003e{let j=new Float32Array(16385),W=new Float32Array(16385);for(let nt=0;nt\u003c16385;nt+=1){let dt=nt/16384*h;j[nt]=Math.cos(dt),W[nt]=Math.sin(dt)}let V=e(w,{...p,gain:0}),G=n(w,{...f,curve:j}),ct=n(w,{...f,curve:l}),H=e(w,{...p,gain:0}),Q=n(w,{...f,curve:W});return{connectGraph(){C.connect(V),C.connect(ct.inputs===void 0?ct:ct.inputs[0]),C.connect(H),ct.connect(I),I.connect(G.inputs===void 0?G:G.inputs[0]),I.connect(Q.inputs===void 0?Q:Q.inputs[0]),G.connect(V.gain),Q.connect(H.gain),V.connect(q,0,0),H.connect(q,0,1)},disconnectGraph(){C.disconnect(V),C.disconnect(ct.inputs===void 0?ct:ct.inputs[0]),C.disconnect(H),ct.disconnect(I),I.disconnect(G.inputs===void 0?G:G.inputs[0]),I.disconnect(Q.inputs===void 0?Q:Q.inputs[0]),G.disconnect(V.gain),Q.disconnect(H.gain),V.disconnect(q,0,0),H.disconnect(q,0,1)}}})(g,v,E,x);if(b===2)return((w,C,I,q)=\u003e{let j=new Float32Array(16385),W=new Float32Array(16385),V=new Float32Array(16385),G=new Float32Array(16385),ct=Math.floor(8192.5);for(let Pt=0;Pt\u003c16385;Pt+=1)if(Pt\u003ect){let Vt=(Pt-ct)/(16384-ct)*h;j[Pt]=Math.cos(Vt),W[Pt]=Math.sin(Vt),V[Pt]=0,G[Pt]=1}else{let Vt=Pt/(16384-ct)*h;j[Pt]=1,W[Pt]=0,V[Pt]=Math.cos(Vt),G[Pt]=Math.sin(Vt)}let H=t(w,{channelCount:2,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",numberOfOutputs:2}),Q=e(w,{...p,gain:0}),nt=n(w,{...f,curve:j}),dt=e(w,{...p,gain:0}),bt=n(w,{...f,curve:W}),Ft=n(w,{...f,curve:l}),vt=e(w,{...p,gain:0}),Ct=n(w,{...f,curve:V}),Nt=e(w,{...p,gain:0}),kt=n(w,{...f,curve:G});return{connectGraph(){C.connect(H),C.connect(Ft.inputs===void 0?Ft:Ft.inputs[0]),H.connect(Q,0),H.connect(dt,0),H.connect(vt,1),H.connect(Nt,1),Ft.connect(I),I.connect(nt.inputs===void 0?nt:nt.inputs[0]),I.connect(bt.inputs===void 0?bt:bt.inputs[0]),I.connect(Ct.inputs===void 0?Ct:Ct.inputs[0]),I.connect(kt.inputs===void 0?kt:kt.inputs[0]),nt.connect(Q.gain),bt.connect(dt.gain),Ct.connect(vt.gain),kt.connect(Nt.gain),Q.connect(q,0,0),vt.connect(q,0,0),dt.connect(q,0,1),Nt.connect(q,0,1)},disconnectGraph(){C.disconnect(H),C.disconnect(Ft.inputs===void 0?Ft:Ft.inputs[0]),H.disconnect(Q,0),H.disconnect(dt,0),H.disconnect(vt,1),H.disconnect(Nt,1),Ft.disconnect(I),I.disconnect(nt.inputs===void 0?nt:nt.inputs[0]),I.disconnect(bt.inputs===void 0?bt:bt.inputs[0]),I.disconnect(Ct.inputs===void 0?Ct:Ct.inputs[0]),I.disconnect(kt.inputs===void 0?kt:kt.inputs[0]),nt.disconnect(Q.gain),bt.disconnect(dt.gain),Ct.disconnect(vt.gain),kt.disconnect(Nt.gain),Q.disconnect(q,0,0),vt.disconnect(q,0,0),dt.disconnect(q,0,1),Nt.disconnect(q,0,1)}}})(g,v,E,x);throw i()};return(g,{channelCount:b,channelCountMode:v,pan:E,...x})=\u003e{if(v===\"max\")throw i();let w=s(g,{...x,channelCount:1,channelCountMode:v,numberOfInputs:2}),C=e(g,{...x,channelCount:b,channelCountMode:v,gain:1}),I=e(g,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",gain:E}),{connectGraph:q,disconnectGraph:j}=y(g,b,C,I,w);Object.defineProperty(I.gain,\"defaultValue\",{get:()=\u003e0}),Object.defineProperty(I.gain,\"maxValue\",{get:()=\u003e1}),Object.defineProperty(I.gain,\"minValue\",{get:()=\u003e-1});let W={get bufferSize(){},get channelCount(){return C.channelCount},set channelCount(G){C.channelCount!==G\u0026\u0026(V\u0026\u0026j(),{connectGraph:q,disconnectGraph:j}=y(g,G,C,I,w),V\u0026\u0026q()),C.channelCount=G},get channelCountMode(){return C.channelCountMode},set channelCountMode(G){if(G===\"clamped-max\"||G===\"max\")throw i();C.channelCountMode=G},get channelInterpretation(){return C.channelInterpretation},set channelInterpretation(G){C.channelInterpretation=G},get context(){return C.context},get inputs(){return[C]},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get pan(){return I.gain},addEventListener:(...G)=\u003eC.addEventListener(G[0],G[1],G[2]),dispatchEvent:(...G)=\u003eC.dispatchEvent(G[0]),removeEventListener:(...G)=\u003eC.removeEventListener(G[0],G[1],G[2])},V=!1;return c(ys(W,w),()=\u003e{q(),V=!0},()=\u003e{j(),V=!1})}})(Fn,di,Fe,Ji,je,Rn),je),Fh=((s,t,e,n,i,c)=\u003eclass extends s{constructor(l,h){let p=i(l),f={...ih,...h},y=e(p,f),g=c(p);super(l,!1,y,g?n():null),this._pan=t(this,g,y.pan)}get pan(){return this._pan}})(he,cn,Pc,((s,t,e,n,i)=\u003e()=\u003e{let c=new WeakMap;return{render(l,h,p){let f=c.get(h);return f!==void 0?Promise.resolve(f):(async(y,g,b)=\u003e{let v=e(y),E=L(v,g);if(!E){let x={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,pan:v.pan.value};v=t(g,x)}return c.set(g,v),E?await s(g,y.pan,v.pan,b):await n(g,y.pan,v.pan,b),Ue(v)?await i(y,g,v.inputs[0],b):await i(y,g,v,b),v})(l,h,p)}}})(vn,Pc,$t,_n,ke),Zt,Ut),Vh=((s,t,e)=\u003e()=\u003e{let n=new WeakMap;return{render(i,c,l){let h=n.get(c);return h!==void 0?Promise.resolve(h):(async(p,f,y)=\u003e{let g=t(p);if(!L(g,f)){let b={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,curve:g.curve,oversample:g.oversample};g=s(f,b)}return n.set(f,g),Ue(g)?await e(p,f,g.inputs[0],y):await e(p,f,g,y),g})(i,c,l)}}})(Ji,$t,ke),Lh=((s,t,e,n,i,c,l)=\u003eclass extends s{constructor(h,p){let f=i(h),y={...rh,...p},g=e(f,y);super(h,!0,g,c(f)?n():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=g,l(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(h){if(h===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(h.length\u003c2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=h}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(h){this._nativeWaveShaperNode.oversample=h}})(he,fe,Ji,Vh,Zt,Ut,Jn),Ec=(s=\u003es!==null\u0026\u0026s.isSecureContext)(an),sa=(s=\u003e(t,e,n)=\u003e{Object.defineProperties(s,{currentFrame:{configurable:!0,get:()=\u003eMath.round(t*e)},currentTime:{configurable:!0,get:()=\u003et}});try{return n()}finally{s!==null\u0026\u0026(delete s.currentFrame,delete s.currentTime)}})(an),Nc=new WeakMap,Wh=((s,t)=\u003ee=\u003e{let n=s.get(e);if(n!==void 0)return n;if(t===null)throw new Error(\"Missing the native OfflineAudioContext constructor.\");return n=new t(1,1,8e3),s.set(e,n),n})(Nc,we),tr=(s=\u003es===null?null:s.hasOwnProperty(\"AudioWorkletNode\")?s.AudioWorkletNode:null)(an),zh=Ec?((s,t,e,n,i,c,l,h,p,f,y,g)=\u003e(b,v,E={credentials:\"omit\"})=\u003e{let x=c(b);if(x.audioWorklet!==void 0)return Promise.all([i(v),Promise.resolve(s(y,y))]).then(([[q,j],W])=\u003e{let[V,G]=st(q,j),ct=W?G:G.replace(/\\s+extends\\s+AudioWorkletProcessor\\s*{/,\" extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=\u003ep.postMessage=(q=\u003e(m,t)=\u003eq.call(p,m,t?t.filter(u=\u003e!this.__b.has(u)):t))(p.postMessage))(this.port)}}){\"),H=new Blob([`${V};(registerProcessor=\u003e{${ct}\n})((n,p)=\u003eregisterProcessor(n,class extends p{${W?\"\":\"__c = (a) =\u003e a.forEach(e=\u003ethis.__b.add(e.buffer));\"}process(i,o,p){${W?\"\":\"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));\"}return super.process(i.map(j=\u003ej.some(k=\u003ek.length===0)?[]:j),o,p)}}))`],{type:\"application/javascript; charset=utf-8\"}),Q=URL.createObjectURL(H);return x.audioWorklet.addModule(Q,E).then(()=\u003e{if(!h(x))return l(x).audioWorklet.addModule(Q,E)}).finally(()=\u003eURL.revokeObjectURL(Q))});let w=f.get(b);if(w!==void 0\u0026\u0026w.has(v))return Promise.resolve();let C=p.get(b);if(C!==void 0){let q=C.get(v);if(q!==void 0)return q}let I=i(v).then(([q,j])=\u003e{let[W,V]=st(q,j);return e(`${W};((a,b)=\u003e{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=\u003e{${V}\n})})(window,'_AWGS')`)}).then(()=\u003e{let q=g._AWGS.pop();if(q===void 0)throw new SyntaxError;n(x.currentTime,x.sampleRate,()=\u003eq(class{},void 0,(j,W)=\u003e{if(j.trim()===\"\")throw t();let V=X.get(x);if(V!==void 0){if(V.has(j))throw t();P(W),R(W.parameterDescriptors),V.set(j,W)}else P(W),R(W.parameterDescriptors),X.set(x,new Map([[j,W]]))},x.sampleRate,void 0,void 0))});return C===void 0?p.set(b,new Map([[v,I]])):C.set(v,I),I.then(()=\u003e{let q=f.get(b);q===void 0?f.set(b,new Set([v])):q.add(v)}).finally(()=\u003e{let q=p.get(b);q!==void 0\u0026\u0026q.delete(v)}),I})(He,je,(s=\u003et=\u003enew Promise((e,n)=\u003e{if(s===null)return void n(new SyntaxError);let i=s.document.head;if(i===null)n(new SyntaxError);else{let c=s.document.createElement(\"script\"),l=new Blob([t],{type:\"application/javascript\"}),h=URL.createObjectURL(l),p=s.onerror,f=()=\u003e{s.onerror=p,URL.revokeObjectURL(h)};s.onerror=(y,g,b,v,E)=\u003eg===h||g===s.location.href\u0026\u0026b===1\u0026\u0026v===1?(f(),n(E),!1):p!==null?p(y,g,b,v,E):void 0,c.onerror=()=\u003e{f(),n(new SyntaxError)},c.onload=()=\u003e{f(),e()},c.src=h,c.type=\"module\",i.appendChild(c)}}))(an),sa,(s=\u003easync t=\u003e{try{let e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw s()})(()=\u003enew DOMException(\"\",\"AbortError\")),Zt,Wh,Ut,new WeakMap,new WeakMap,((s,t)=\u003easync()=\u003e{if(s===null)return!0;if(t===null)return!1;let e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor(\"a\",A)'],{type:\"application/javascript; charset=utf-8\"}),n=new t(1,128,8e3),i=URL.createObjectURL(e),c=!1,l=!1;try{await n.audioWorklet.addModule(i);let h=new s(n,\"a\",{numberOfOutputs:0}),p=n.createOscillator();h.port.onmessage=()=\u003ec=!0,h.onprocessorerror=()=\u003el=!0,p.connect(h),await n.startRendering()}catch{}finally{URL.revokeObjectURL(i)}return c\u0026\u0026!l})(tr,we),an):void 0,Gh=((s,t)=\u003ee=\u003es(e)||t(e))(Uo,Ut),qc=((s,t,e,n,i,c,l,h,p,f,y,g,b,v,E,x,w,C,I,q)=\u003eclass extends E{constructor(j,W){super(j,W),this._nativeContext=j,this._audioWorklet=s===void 0?void 0:{addModule:(V,G)=\u003es(this,V,G)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new i(this)}createBuffer(j,W,V){return new e({length:W,numberOfChannels:j,sampleRate:V})}createBufferSource(){return new n(this)}createChannelMerger(j=6){return new c(this,{numberOfInputs:j})}createChannelSplitter(j=6){return new l(this,{numberOfOutputs:j})}createConstantSource(){return new h(this)}createConvolver(){return new p(this)}createDelay(j=1){return new y(this,{maxDelayTime:j})}createDynamicsCompressor(){return new g(this)}createGain(){return new b(this)}createIIRFilter(j,W){return new v(this,{feedback:W,feedforward:j})}createOscillator(){return new x(this)}createPanner(){return new w(this)}createPeriodicWave(j,W,V={disableNormalization:!1}){return new C(this,{...V,imag:W,real:j})}createStereoPanner(){return new I(this)}createWaveShaper(){return new q(this)}decodeAudioData(j,W,V){return f(this._nativeContext,j).then(G=\u003e(typeof W==\"function\"\u0026\u0026W(G),G)).catch(G=\u003e{throw typeof V==\"function\"\u0026\u0026V(G),G})}})(zh,ph,fh,gh,yh,wh,xh,Sh,kh,((s,t,e,n,i,c,l,h,p,f,y)=\u003e(g,b)=\u003e{let v=l(g)?g:c(g);if(i.has(b)){let E=e();return Promise.reject(E)}try{i.add(b)}catch{}return t(p,()=\u003ep(v))?v.decodeAudioData(b).then(E=\u003e(t(h,()=\u003eh(E))||y(E),s.add(E),E)):new Promise((E,x)=\u003e{let w=()=\u003e{try{(I=\u003e{let{port1:q}=new MessageChannel;q.postMessage(I,[I])})(b)}catch{}},C=I=\u003e{x(I),w()};try{v.decodeAudioData(b,I=\u003e{typeof I.copyFromChannel!=\"function\"\u0026\u0026(f(I),et(I)),s.add(I),w(),E(I)},I=\u003e{C(I===null?n():I)})}catch(I){C(I)}})})(Xo,He,()=\u003enew DOMException(\"\",\"DataCloneError\"),()=\u003enew DOMException(\"\",\"EncodingError\"),new WeakSet,Zt,Gh,J,hi,Zo,Ko),Mh,Ah,Ch,Ph,na,Nh,jh,Rh,Fh,Lh),Bh=((s,t,e,n)=\u003eclass extends s{constructor(i,c){let l=e(i),h=t(l,c);if(n(l))throw TypeError();super(i,!0,h,null),this._nativeMediaElementAudioSourceNode=h}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(he,(s,t)=\u003es.createMediaElementSource(t.mediaElement),Zt,Ut),Uh=((s,t,e,n)=\u003eclass extends s{constructor(i,c){let l=e(i);if(n(l))throw new TypeError;let h={...Kl,...c},p=t(l,h);super(i,!1,p,null),this._nativeMediaStreamAudioDestinationNode=p}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(he,(s,t)=\u003e{let e=s.createMediaStreamDestination();return ve(e,t),e.numberOfOutputs===1\u0026\u0026Object.defineProperty(e,\"numberOfOutputs\",{get:()=\u003e0}),e},Zt,Ut),Hh=((s,t,e,n)=\u003eclass extends s{constructor(i,c){let l=e(i),h=t(l,c);if(n(l))throw new TypeError;super(i,!0,h,null),this._nativeMediaStreamAudioSourceNode=h}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(he,(s,{mediaStream:t})=\u003e{let e=t.getAudioTracks();e.sort((c,l)=\u003ec.id\u003cl.id?-1:c.id\u003el.id?1:0);let n=e.slice(0,1),i=s.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(i,\"mediaStream\",{value:t}),i},Zt,Ut),Yh=((s,t,e)=\u003eclass extends s{constructor(n,i){let c=e(n);super(n,!0,t(c,i),null)}})(he,((s,t)=\u003e(e,{mediaStreamTrack:n})=\u003e{if(typeof e.createMediaStreamTrackSource==\"function\")return e.createMediaStreamTrackSource(n);let i=new MediaStream([n]),c=e.createMediaStreamSource(i);if(n.kind!==\"audio\")throw s();if(t(e))throw new TypeError;return c})(fe,Ut),Zt),Xh=((s,t,e,n,i,c,l,h,p)=\u003eclass extends s{constructor(f={}){if(p===null)throw new Error(\"Missing the native AudioContext constructor.\");let y=new p(f);if(y===null)throw n();if(!Tt(f.latencyHint))throw new TypeError(`The provided value '${f.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(f.sampleRate!==void 0\u0026\u0026y.sampleRate!==f.sampleRate)throw e();super(y,2);let{latencyHint:g}=f,{sampleRate:b}=y;if(this._baseLatency=typeof y.baseLatency==\"number\"?y.baseLatency:g===\"balanced\"?512/b:g===\"interactive\"||g===void 0?256/b:g===\"playback\"?1024/b:128*Math.max(2,Math.min(128,Math.round(g*b/128)))/b,this._nativeAudioContext=y,p.name===\"webkitAudioContext\"?(this._nativeGainNode=y.createGain(),this._nativeOscillatorNode=y.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(y.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,y.state===\"running\"){this._state=\"suspended\";let v=()=\u003e{this._state===\"suspended\"\u0026\u0026(this._state=null),y.removeEventListener(\"statechange\",v)};y.addEventListener(\"statechange\",v)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state===\"closed\"?this._nativeAudioContext.close().then(()=\u003e{throw t()}):(this._state===\"suspended\"\u0026\u0026(this._state=null),this._nativeAudioContext.close().then(()=\u003e{this._nativeGainNode!==null\u0026\u0026this._nativeOscillatorNode!==null\u0026\u0026(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Mt(this)}))}createMediaElementSource(f){return new i(this,{mediaElement:f})}createMediaStreamDestination(){return new c(this)}createMediaStreamSource(f){return new l(this,{mediaStream:f})}createMediaStreamTrackSource(f){return new h(this,{mediaStreamTrack:f})}resume(){return this._state===\"suspended\"?new Promise((f,y)=\u003e{let g=()=\u003e{this._nativeAudioContext.removeEventListener(\"statechange\",g),this._nativeAudioContext.state===\"running\"?f():this.resume().then(f,y)};this._nativeAudioContext.addEventListener(\"statechange\",g)}):this._nativeAudioContext.resume().catch(f=\u003e{throw f===void 0||f.code===15?t():f})}suspend(){return this._nativeAudioContext.suspend().catch(f=\u003e{throw f===void 0?t():f})}})(qc,fe,je,Ga,Bh,Uh,Hh,Yh,kn),ia=(Ic=kc,s=\u003e{let t=Ic.get(s);if(t===void 0)throw new Error(\"The context has no set of AudioWorkletNodes.\");return t});var Ic;let Qh=(jc=ia,(s,t)=\u003e{jc(s).add(t)});var jc;let Rc=(s=\u003e(t,e,n=0,i=0)=\u003e{let c=t[n];if(c===void 0)throw s();return Bi(e)?c.connect(e,0,i):c.connect(e,0)})(it),Zh=(s=\u003e(t,e)=\u003e{s(t).delete(e)})(ia),Fc=(s=\u003e(t,e,n,i=0)=\u003ee===void 0?t.forEach(c=\u003ec.disconnect()):typeof e==\"number\"?Yi(s,t,e).disconnect():Bi(e)?n===void 0?t.forEach(c=\u003ec.disconnect(e)):i===void 0?Yi(s,t,n).disconnect(e,0):Yi(s,t,n).disconnect(e,0,i):n===void 0?t.forEach(c=\u003ec.disconnect(e)):Yi(s,t,n).disconnect(e,0))(it),Vc=new WeakMap,Kh=((s,t)=\u003ee=\u003et(s,e))(Vc,B),$h=((s,t,e,n,i,c,l,h,p,f,y,g,b)=\u003e(v,E,x,w)=\u003e{if(w.numberOfInputs===0\u0026\u0026w.numberOfOutputs===0)throw p();let C=Array.isArray(w.outputChannelCount)?w.outputChannelCount:Array.from(w.outputChannelCount);if(C.some(ut=\u003eut\u003c1))throw p();if(C.length!==w.numberOfOutputs)throw t();if(w.channelCountMode!==\"explicit\")throw p();let I=w.channelCount*w.numberOfInputs,q=C.reduce((ut,Wt)=\u003eut+Wt,0),j=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length;if(I+j\u003e6||q\u003e6)throw p();let W=new MessageChannel,V=[],G=[];for(let ut=0;ut\u003cw.numberOfInputs;ut+=1)V.push(l(v,{channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation,gain:1})),G.push(i(v,{channelCount:w.channelCount,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",numberOfOutputs:w.channelCount}));let ct=[];if(x.parameterDescriptors!==void 0)for(let{defaultValue:ut,maxValue:Wt,minValue:Pe,name:ie}of x.parameterDescriptors){let Lt=c(v,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",offset:w.parameterData[ie]!==void 0?w.parameterData[ie]:ut===void 0?0:ut});Object.defineProperties(Lt.offset,{defaultValue:{get:()=\u003eut===void 0?0:ut},maxValue:{get:()=\u003eWt===void 0?At:Wt},minValue:{get:()=\u003ePe===void 0?rt:Pe}}),ct.push(Lt)}let H=n(v,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"speakers\",numberOfInputs:Math.max(1,I+j)}),Q=Va(E,v.sampleRate),nt=h(v,Q,I+j,Math.max(1,q)),dt=i(v,{channelCount:Math.max(1,q),channelCountMode:\"explicit\",channelInterpretation:\"discrete\",numberOfOutputs:Math.max(1,q)}),bt=[];for(let ut=0;ut\u003cw.numberOfOutputs;ut+=1)bt.push(n(v,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"speakers\",numberOfInputs:C[ut]}));for(let ut=0;ut\u003cw.numberOfInputs;ut+=1){V[ut].connect(G[ut]);for(let Wt=0;Wt\u003cw.channelCount;Wt+=1)G[ut].connect(H,Wt,ut*w.channelCount+Wt)}let Ft=new Ia(x.parameterDescriptors===void 0?[]:x.parameterDescriptors.map(({name:ut},Wt)=\u003e{let Pe=ct[Wt];return Pe.connect(H,0,I+Wt),Pe.start(0),[ut,Pe.offset]}));H.connect(nt);let vt=w.channelInterpretation,Ct=null,Nt=w.numberOfOutputs===0?[nt]:bt,kt={get bufferSize(){return Q},get channelCount(){return w.channelCount},set channelCount(ut){throw e()},get channelCountMode(){return w.channelCountMode},set channelCountMode(ut){throw e()},get channelInterpretation(){return vt},set channelInterpretation(ut){for(let Wt of V)Wt.channelInterpretation=ut;vt=ut},get context(){return nt.context},get inputs(){return V},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},get onprocessorerror(){return Ct},set onprocessorerror(ut){typeof Ct==\"function\"\u0026\u0026kt.removeEventListener(\"processorerror\",Ct),Ct=typeof ut==\"function\"?ut:null,typeof Ct==\"function\"\u0026\u0026kt.addEventListener(\"processorerror\",Ct)},get parameters(){return Ft},get port(){return W.port2},addEventListener:(...ut)=\u003ent.addEventListener(ut[0],ut[1],ut[2]),connect:s.bind(null,Nt),disconnect:f.bind(null,Nt),dispatchEvent:(...ut)=\u003ent.dispatchEvent(ut[0]),removeEventListener:(...ut)=\u003ent.removeEventListener(ut[0],ut[1],ut[2])},Pt=new Map;var Vt,de;W.port1.addEventListener=(Vt=W.port1.addEventListener,(...ut)=\u003e{if(ut[0]===\"message\"){let Wt=typeof ut[1]==\"function\"?ut[1]:typeof ut[1]==\"object\"\u0026\u0026ut[1]!==null\u0026\u0026typeof ut[1].handleEvent==\"function\"?ut[1].handleEvent:null;if(Wt!==null){let Pe=Pt.get(ut[1]);Pe!==void 0?ut[1]=Pe:(ut[1]=ie=\u003e{y(v.currentTime,v.sampleRate,()=\u003eWt(ie))},Pt.set(Wt,ut[1]))}}return Vt.call(W.port1,ut[0],ut[1],ut[2])}),W.port1.removeEventListener=(de=W.port1.removeEventListener,(...ut)=\u003e{if(ut[0]===\"message\"){let Wt=Pt.get(ut[1]);Wt!==void 0\u0026\u0026(Pt.delete(ut[1]),ut[1]=Wt)}return de.call(W.port1,ut[0],ut[1],ut[2])});let ye=null;Object.defineProperty(W.port1,\"onmessage\",{get:()=\u003eye,set:ut=\u003e{typeof ye==\"function\"\u0026\u0026W.port1.removeEventListener(\"message\",ye),ye=typeof ut==\"function\"?ut:null,typeof ye==\"function\"\u0026\u0026(W.port1.addEventListener(\"message\",ye),W.port1.start())}}),x.prototype.port=W.port1;let qt=null;((ut,Wt,Pe,ie)=\u003e{let Lt=K.get(ut);Lt===void 0\u0026\u0026(Lt=new WeakMap,K.set(ut,Lt));let ne=$l(Pe,ie);return Lt.set(Wt,ne),ne})(v,kt,x,w).then(ut=\u003eqt=ut);let _t=Hi(w.numberOfInputs,w.channelCount),De=Hi(w.numberOfOutputs,C),Sn=x.parameterDescriptors===void 0?[]:x.parameterDescriptors.reduce((ut,{name:Wt})=\u003e({...ut,[Wt]:new Float32Array(128)}),{}),$e=!0,Hn=()=\u003e{w.numberOfOutputs\u003e0\u0026\u0026nt.disconnect(dt);for(let ut=0,Wt=0;ut\u003cw.numberOfOutputs;ut+=1){let Pe=bt[ut];for(let ie=0;ie\u003cC[ut];ie+=1)dt.disconnect(Pe,Wt+ie,ie);Wt+=C[ut]}},Yn=new Map;nt.onaudioprocess=({inputBuffer:ut,outputBuffer:Wt})=\u003e{if(qt!==null){let Pe=g(kt);for(let ie=0;ie\u003cQ;ie+=128){for(let Lt=0;Lt\u003cw.numberOfInputs;Lt+=1)for(let ne=0;ne\u003cw.channelCount;ne+=1)Ui(ut,_t[Lt],ne,ne,ie);x.parameterDescriptors!==void 0\u0026\u0026x.parameterDescriptors.forEach(({name:Lt},ne)=\u003e{Ui(ut,Sn,Lt,I+ne,ie)});for(let Lt=0;Lt\u003cw.numberOfInputs;Lt+=1)for(let ne=0;ne\u003cC[Lt];ne+=1)De[Lt][ne].byteLength===0\u0026\u0026(De[Lt][ne]=new Float32Array(128));try{let Lt=_t.map((sn,Xn)=\u003e{if(Pe[Xn].size\u003e0)return Yn.set(Xn,Q/128),sn;let Qn=Yn.get(Xn);return Qn===void 0?[]:(sn.every(Kd=\u003eKd.every($d=\u003e$d===0))\u0026\u0026(Qn===1?Yn.delete(Xn):Yn.set(Xn,Qn-1)),sn)});$e=y(v.currentTime+ie/v.sampleRate,v.sampleRate,()=\u003eqt.process(Lt,De,Sn));for(let sn=0,Xn=0;sn\u003cw.numberOfOutputs;sn+=1){for(let Qn=0;Qn\u003cC[sn];Qn+=1)ja(Wt,De[sn],Qn,Xn+Qn,ie);Xn+=C[sn]}}catch(Lt){$e=!1,kt.dispatchEvent(new ErrorEvent(\"processorerror\",{colno:Lt.colno,filename:Lt.filename,lineno:Lt.lineno,message:Lt.message}))}if(!$e){for(let Lt=0;Lt\u003cw.numberOfInputs;Lt+=1){V[Lt].disconnect(G[Lt]);for(let ne=0;ne\u003cw.channelCount;ne+=1)G[ie].disconnect(H,ne,Lt*w.channelCount+ne)}if(x.parameterDescriptors!==void 0){let Lt=x.parameterDescriptors.length;for(let ne=0;ne\u003cLt;ne+=1){let sn=ct[ne];sn.disconnect(H,0,I+ne),sn.stop()}}H.disconnect(nt),nt.onaudioprocess=null,ge?Hn():_u();break}}}};let ge=!1,Ge=l(v,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",gain:0}),vu=()=\u003ent.connect(Ge).connect(v.destination),_u=()=\u003e{nt.disconnect(Ge),Ge.disconnect()};return vu(),b(kt,()=\u003e{if($e){_u(),w.numberOfOutputs\u003e0\u0026\u0026nt.connect(dt);for(let ut=0,Wt=0;ut\u003cw.numberOfOutputs;ut+=1){let Pe=bt[ut];for(let ie=0;ie\u003cC[ut];ie+=1)dt.connect(Pe,Wt+ie,ie);Wt+=C[ut]}}ge=!0},()=\u003e{$e\u0026\u0026(vu(),Hn()),ge=!1})})(Rc,it,fe,Fn,di,xs,Fe,pi,je,Fc,sa,Kh,Rn),Jh=((s,t,e,n,i)=\u003e(c,l,h,p,f,y)=\u003e{if(h!==null)try{let v=new h(c,p,y),E=new Map,x=null;if(Object.defineProperties(v,{channelCount:{get:()=\u003ey.channelCount,set:()=\u003e{throw s()}},channelCountMode:{get:()=\u003e\"explicit\",set:()=\u003e{throw s()}},onprocessorerror:{get:()=\u003ex,set:w=\u003e{typeof x==\"function\"\u0026\u0026v.removeEventListener(\"processorerror\",x),x=typeof w==\"function\"?w:null,typeof x==\"function\"\u0026\u0026v.addEventListener(\"processorerror\",x)}}}),v.addEventListener=(b=v.addEventListener,(...w)=\u003e{if(w[0]===\"processorerror\"){let C=typeof w[1]==\"function\"?w[1]:typeof w[1]==\"object\"\u0026\u0026w[1]!==null\u0026\u0026typeof w[1].handleEvent==\"function\"?w[1].handleEvent:null;if(C!==null){let I=E.get(w[1]);I!==void 0?w[1]=I:(w[1]=q=\u003e{q.type===\"error\"?(Object.defineProperties(q,{type:{value:\"processorerror\"}}),C(q)):C(new ErrorEvent(w[0],{...q}))},E.set(C,w[1]))}}return b.call(v,\"error\",w[1],w[2]),b.call(v,...w)}),v.removeEventListener=(g=v.removeEventListener,(...w)=\u003e{if(w[0]===\"processorerror\"){let C=E.get(w[1]);C!==void 0\u0026\u0026(E.delete(w[1]),w[1]=C)}return g.call(v,\"error\",w[1],w[2]),g.call(v,w[0],w[1],w[2])}),y.numberOfOutputs!==0){let w=e(c,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",gain:0});return v.connect(w).connect(c.destination),i(v,()=\u003ew.disconnect(),()=\u003ew.connect(c.destination))}return v}catch(v){throw v.code===11?n():v}var g,b;if(f===void 0)throw n();return(v=\u003e{let{port1:E}=new MessageChannel;try{E.postMessage(v)}finally{E.close()}})(y),t(c,l,f,y)})(fe,$h,Fe,je,Rn),td=((s,t,e,n,i,c,l,h,p,f,y,g,b,v,E,x)=\u003e(w,C,I)=\u003e{let q=new WeakMap,j=null;return{render(W,V,G){h(V,W);let ct=q.get(V);return ct!==void 0?Promise.resolve(ct):(async(H,Q,nt)=\u003e{let dt=y(H),bt=null,Ft=L(dt,Q),vt=Array.isArray(C.outputChannelCount)?C.outputChannelCount:Array.from(C.outputChannelCount);if(g===null){let Ct=vt.reduce((Vt,de)=\u003eVt+de,0),Nt=i(Q,{channelCount:Math.max(1,Ct),channelCountMode:\"explicit\",channelInterpretation:\"discrete\",numberOfOutputs:Math.max(1,Ct)}),kt=[];for(let Vt=0;Vt\u003cH.numberOfOutputs;Vt+=1)kt.push(n(Q,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"speakers\",numberOfInputs:vt[Vt]}));let Pt=l(Q,{channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation,gain:1});Pt.connect=t.bind(null,kt),Pt.disconnect=p.bind(null,kt),bt=[Nt,kt,Pt]}else Ft||(dt=new g(Q,w));if(q.set(Q,bt===null?dt:bt[2]),bt!==null){if(j===null){if(I===void 0)throw new Error(\"Missing the processor constructor.\");if(b===null)throw new Error(\"Missing the native OfflineAudioContext constructor.\");let de=H.channelCount*H.numberOfInputs,ye=I.parameterDescriptors===void 0?0:I.parameterDescriptors.length,qt=de+ye;j=Wl(H,qt===0?null:await(async()=\u003e{let De=new b(qt,128*Math.ceil(H.context.length/128),Q.sampleRate),Sn=[],$e=[];for(let ge=0;ge\u003cC.numberOfInputs;ge+=1)Sn.push(l(De,{channelCount:C.channelCount,channelCountMode:C.channelCountMode,channelInterpretation:C.channelInterpretation,gain:1})),$e.push(i(De,{channelCount:C.channelCount,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",numberOfOutputs:C.channelCount}));let Hn=await Promise.all(Array.from(H.parameters.values()).map(async ge=\u003e{let Ge=c(De,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"discrete\",offset:ge.value});return await v(De,ge,Ge.offset,nt),Ge})),Yn=n(De,{channelCount:1,channelCountMode:\"explicit\",channelInterpretation:\"speakers\",numberOfInputs:Math.max(1,de+ye)});for(let ge=0;ge\u003cC.numberOfInputs;ge+=1){Sn[ge].connect($e[ge]);for(let Ge=0;Ge\u003cC.channelCount;Ge+=1)$e[ge].connect(Yn,Ge,ge*C.channelCount+Ge)}for(let[ge,Ge]of Hn.entries())Ge.connect(Yn,0,de+ge),Ge.start(0);return Yn.connect(De.destination),await Promise.all(Sn.map(ge=\u003eE(H,De,ge,nt))),x(De)})(),Q,C,vt,I,f)}let Ct=await j,Nt=e(Q,{buffer:null,channelCount:2,channelCountMode:\"max\",channelInterpretation:\"speakers\",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[kt,Pt,Vt]=bt;Ct!==null\u0026\u0026(Nt.buffer=Ct,Nt.start(0)),Nt.connect(kt);for(let de=0,ye=0;de\u003cH.numberOfOutputs;de+=1){let qt=Pt[de];for(let _t=0;_t\u003cvt[de];_t+=1)kt.connect(qt,ye+_t,_t);ye+=vt[de]}return Vt}if(Ft)for(let[Ct,Nt]of H.parameters.entries())await s(Q,Nt,dt.parameters.get(Ct),nt);else for(let[Ct,Nt]of H.parameters.entries())await v(Q,Nt,dt.parameters.get(Ct),nt);return await E(H,Q,dt,nt),dt})(W,V,G)}}})(vn,Rc,ws,Fn,di,xs,Fe,Zh,Fc,sa,$t,tr,we,_n,ke,$i),ed=(s=\u003et=\u003es.get(t))(Nc),nd=(s=\u003e(t,e)=\u003e{s.set(t,e)})(Vc),Lc=Ec?((s,t,e,n,i,c,l,h,p,f,y,g,b)=\u003eclass extends t{constructor(v,E,x){var w;let C=h(v),I=p(C),q=y({...Ll,...x}),j=X.get(C),W=j==null?void 0:j.get(E),V=I||C.state!==\"closed\"?C:(w=l(C))!==null\u0026\u0026w!==void 0?w:C,G=i(V,I?null:v.baseLatency,f,E,W,q);super(v,!0,G,I?n(E,q,W):null);let ct=[];G.parameters.forEach((Q,nt)=\u003e{let dt=e(this,I,Q);ct.push([nt,dt])}),this._nativeAudioWorkletNode=G,this._onprocessorerror=null,this._parameters=new Ia(ct),I\u0026\u0026s(C,this);let{activeInputs:H}=c(this);g(G,H)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(v){let E=typeof v==\"function\"?b(this,v):null;this._nativeAudioWorkletNode.onprocessorerror=E;let x=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=x!==null\u0026\u0026x===E?v:x}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(Qh,he,cn,td,Jh,Z,ed,Zt,Ut,tr,s=\u003e({...s,outputChannelCount:s.outputChannelCount!==void 0?s.outputChannelCount:s.numberOfInputs===1\u0026\u0026s.numberOfOutputs===1?[s.channelCount]:Array.from({length:s.numberOfOutputs},()=\u003e1)}),nd,bs):void 0,Wc=(((s,t,e,n,i)=\u003e{})(fe,je,Ga,na,kn),((s,t)=\u003e(e,n,i)=\u003e{if(t===null)throw new Error(\"Missing the native OfflineAudioContext constructor.\");try{return new t(e,n,i)}catch(c){throw c.name===\"SyntaxError\"?s():c}})(je,we)),zc=((s,t,e,n,i,c,l,h)=\u003e{let p=[];return(f,y)=\u003ee(f).render(f,y,p).then(()=\u003ePromise.all(Array.from(n(y)).map(g=\u003ee(g).render(g,y,p)))).then(()=\u003ei(y)).then(g=\u003e(typeof g.copyFromChannel!=\"function\"?(l(g),et(g)):t(c,()=\u003ec(g))||h(g),s.add(g),g))})(Xo,He,Go,ia,$i,J,Zo,Ko),sd=(((s,t,e,n,i)=\u003e{})(He,fe,Wc,na,zc),((s,t,e,n,i)=\u003eclass extends s{constructor(c,l,h){let p;if(typeof c==\"number\"\u0026\u0026l!==void 0\u0026\u0026h!==void 0)p={length:l,numberOfChannels:c,sampleRate:h};else{if(typeof c!=\"object\")throw new Error(\"The given parameters are not valid.\");p=c}let{length:f,numberOfChannels:y,sampleRate:g}={...th,...p},b=n(y,f,g);t(hi,()=\u003ehi(b))||b.addEventListener(\"statechange\",(()=\u003e{let v=0,E=x=\u003e{this._state===\"running\"\u0026\u0026(v\u003e0?(b.removeEventListener(\"statechange\",E),x.stopImmediatePropagation(),this._waitForThePromiseToSettle(x)):v+=1)};return E})()),super(b,y),this._length=f,this._nativeOfflineAudioContext=b,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state===\"running\"?Promise.reject(e()):(this._state=\"running\",i(this.destination,this._nativeOfflineAudioContext).finally(()=\u003e{this._state=null,Mt(this)}))}_waitForThePromiseToSettle(c){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(c):setTimeout(()=\u003ethis._waitForThePromiseToSettle(c))}})(qc,He,fe,Wc,zc)),id=((s,t)=\u003ee=\u003e{let n=s.get(e);return t(n)||t(e)})(N,Uo),rd=(Gc=D,Bc=Yo,s=\u003eGc.has(s)||Bc(s));var Gc,Bc;let od=(Uc=A,Hc=ac,s=\u003eUc.has(s)||Hc(s));var Uc,Hc;let ad=((s,t)=\u003ee=\u003e{let n=s.get(e);return t(n)||t(e)})(N,Ut),cd=()=\u003e(async(s,t,e,n,i,c,l,h,p,f,y,g,b,v,E,x)=\u003es(t,t)\u0026\u0026s(e,e)\u0026\u0026s(i,i)\u0026\u0026s(c,c)\u0026\u0026s(h,h)\u0026\u0026s(p,p)\u0026\u0026s(f,f)\u0026\u0026s(y,y)\u0026\u0026s(g,g)\u0026\u0026s(b,b)\u0026\u0026s(v,v)?(await Promise.all([s(n,n),s(l,l),s(E,E),s(x,x)])).every(w=\u003ew):!1)(He,(s=\u003e()=\u003e{if(s===null)return!1;let t=new s(1,1,44100).createBuffer(1,1,44100);if(t.copyToChannel===void 0)return!0;let e=new Float32Array(2);try{t.copyFromChannel(e,0,0)}catch{return!1}return!0})(we),(s=\u003e()=\u003e{if(s===null)return!1;if(s.prototype!==void 0\u0026\u0026s.prototype.close!==void 0)return!0;let t=new s,e=t.close!==void 0;try{t.close()}catch{}return e})(kn),(s=\u003e()=\u003e{if(s===null)return Promise.resolve(!1);let t=new s(1,1,44100);return new Promise(e=\u003e{let n=!0,i=l=\u003e{n\u0026\u0026(n=!1,t.startRendering(),e(l instanceof TypeError))},c;try{c=t.decodeAudioData(null,()=\u003e{},i)}catch(l){i(l)}c!==void 0\u0026\u0026c.catch(i)})})(we),(s=\u003e()=\u003e{if(s===null)return!1;let t;try{t=new s({latencyHint:\"balanced\"})}catch{return!1}return t.close(),!0})(kn),(s=\u003e()=\u003e{if(s===null)return!1;let t=new s(1,1,44100).createGain(),e=t.connect(t)===t;return t.disconnect(t),e})(we),((s,t)=\u003easync()=\u003e{if(s===null)return!0;if(t===null)return!1;let e=new Blob(['class A extends AudioWorkletProcessor{process(){this.port.postMessage(0)}}registerProcessor(\"a\",A)'],{type:\"application/javascript; charset=utf-8\"}),n=new t(1,128,8e3),i=URL.createObjectURL(e),c=!1;try{await n.audioWorklet.addModule(i);let l=new s(n,\"a\",{numberOfOutputs:0}),h=n.createOscillator();l.port.onmessage=()=\u003ec=!0,h.connect(l),h.start(0),await n.startRendering(),c||await new Promise(p=\u003esetTimeout(p,5))}catch{}finally{URL.revokeObjectURL(i)}return c})(tr,we),(s=\u003e()=\u003e{if(s===null)return!1;let t=new s(1,1,44100).createChannelMerger();if(t.channelCountMode===\"max\")return!0;try{t.channelCount=2}catch{return!0}return!1})(we),(s=\u003e()=\u003e{if(s===null)return!1;let t=new s(1,1,44100);return t.createConstantSource===void 0?!0:t.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(we),(s=\u003e()=\u003e{if(s===null)return!1;let t=new s(1,1,44100),e=t.createConvolver();e.buffer=t.createBuffer(1,1,t.sampleRate);try{e.buffer=t.createBuffer(1,1,t.sampleRate)}catch{return!1}return!0})(we),(s=\u003e()=\u003e{if(s===null)return!1;let t=new s(1,1,44100).createConvolver();try{t.channelCount=1}catch{return!1}return!0})(we),oh,(s=\u003e()=\u003es!==null\u0026\u0026s.hasOwnProperty(\"isSecureContext\"))(an),(s=\u003e()=\u003e{if(s===null)return!1;let t=new s;try{return t.createMediaStreamSource(new MediaStream),!1}catch(e){return!0}})(kn),(s=\u003e()=\u003e{if(s===null)return Promise.resolve(!1);let t=new s(1,1,44100);if(t.createStereoPanner===void 0||t.createConstantSource===void 0)return Promise.resolve(!0);let e=t.createConstantSource(),n=t.createStereoPanner();return e.channelCount=1,e.offset.value=1,n.channelCount=1,e.start(),e.connect(n).connect(t.destination),t.startRendering().then(i=\u003ei.getChannelData(0)[0]!==1)})(we),ah);function mt(s,t){if(!s)throw new Error(t)}function Me(s,t,e=1/0){if(!(t\u003c=s\u0026\u0026s\u003c=e))throw new RangeError(`Value must be within [${t}, ${e}], got: ${s}`)}function ra(s){s.isOffline||s.state===\"running\"||gi('The AudioContext is \"suspended\". Invoke Tone.start() from a user action to start the audio.')}let oa=console;function ud(s){oa=s}function Yc(...s){oa.log(...s)}function gi(...s){oa.warn(...s)}function Ve(s){return s===void 0}function Ot(s){return!Ve(s)}function Xc(s){return typeof s==\"function\"}function Ye(s){return typeof s==\"number\"}function Mn(s){return Object.prototype.toString.call(s)===\"[object Object]\"\u0026\u0026s.constructor===Object}function aa(s){return typeof s==\"boolean\"}function Ae(s){return Array.isArray(s)}function Je(s){return typeof s==\"string\"}function vi(s){return Je(s)\u0026\u0026/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(s)}let An=typeof self==\"object\"?self:null,ld=An\u0026\u0026(An.hasOwnProperty(\"AudioContext\")||An.hasOwnProperty(\"webkitAudioContext\"));function un(s,t,e,n){var i,c=arguments.length,l=c\u003c3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect==\"object\"\u0026\u0026typeof Reflect.decorate==\"function\")l=Reflect.decorate(s,t,e,n);else for(var h=s.length-1;h\u003e=0;h--)(i=s[h])\u0026\u0026(l=(c\u003c3?i(l):c\u003e3?i(t,e,l):i(t,e))||l);return c\u003e3\u0026\u0026l\u0026\u0026Object.defineProperty(t,e,l),l}function Yt(s,t,e,n){return new(e||(e=Promise))(function(i,c){function l(f){try{p(n.next(f))}catch(y){c(y)}}function h(f){try{p(n.throw(f))}catch(y){c(y)}}function p(f){var y;f.done?i(f.value):(y=f.value,y instanceof e?y:new e(function(g){g(y)})).then(l,h)}p((n=n.apply(s,t||[])).next())})}class hd{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){let t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:\"text/javascript\"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=\u003e{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if(this._type===\"worker\")try{this._createWorker()}catch(t){this._type=\"timeout\",this._createClock()}else this._type===\"timeout\"\u0026\u0026this._createTimeout()}_disposeClock(){this._timeout\u0026\u0026(clearTimeout(this._timeout),this._timeout=0),this._worker\u0026\u0026(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),this._type===\"worker\"\u0026\u0026this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function ts(s){return od(s)}function Vn(s){return rd(s)}function er(s){return ad(s)}function Ts(s){return id(s)}function Qc(s){return s instanceof AudioBuffer}function dd(s,t){return s===\"value\"||ts(t)||Vn(t)||Qc(t)}function tn(s,...t){if(!t.length)return s;let e=t.shift();if(Mn(s)\u0026\u0026Mn(e))for(let n in e)dd(n,e[n])?s[n]=e[n]:Mn(e[n])?(s[n]||Object.assign(s,{[n]:{}}),tn(s[n],e[n])):Object.assign(s,{[n]:e[n]});return tn(s,...t)}function S(s,t,e=[],n){let i={},c=Array.from(t);if(Mn(c[0])\u0026\u0026n\u0026\u0026!Reflect.has(c[0],n)\u0026\u0026(Object.keys(c[0]).some(l=\u003eReflect.has(s,l))||(tn(i,{[n]:c[0]}),e.splice(e.indexOf(n),1),c.shift())),c.length===1\u0026\u0026Mn(c[0]))tn(i,c[0]);else for(let l=0;l\u003ce.length;l++)Ot(c[l])\u0026\u0026(i[e[l]]=c[l]);return tn(s,i)}function en(s,t){return Ve(s)?t:s}function Ce(s,t){return t.forEach(e=\u003e{Reflect.has(s,e)\u0026\u0026delete s[e]}),s}class Cn{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||An\u0026\u0026this.toString()===An.TONE_DEBUG_CLASS)\u0026\u0026Yc(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Cn.version=m;function nr(s,t){return s\u003et+1e-6}function ca(s,t){return nr(s,t)||ln(s,t)}function Zc(s,t){return s+1e-6\u003ct}function ln(s,t){return Math.abs(s-t)\u003c1e-6}function Kc(s,t,e){return Math.max(Math.min(s,e),t)}class hn extends Cn{constructor(){super(),this.name=\"Timeline\",this._timeline=[];let t=S(hn.getDefaults(),arguments,[\"memory\"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(mt(Reflect.has(t,\"time\"),\"Timeline: events must have a time attribute\"),t.time=t.time.valueOf(),this.increasing\u0026\u0026this.length){let e=this._timeline[this.length-1];mt(ca(t.time,e.time),\"The time must be greater than or equal to the last scheduled time\"),this._timeline.push(t)}else{let e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length\u003ethis.memory){let e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(t){let e=this._timeline.indexOf(t);return e!==-1\u0026\u0026this._timeline.splice(e,1),this}get(t,e=\"time\"){let n=this._search(t,e);return n!==-1?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e=\"time\"){let n=this._search(t,e);return n+1\u003cthis._timeline.length?this._timeline[n+1]:null}getBefore(t){let e=this._timeline.length;if(e\u003e0\u0026\u0026this._timeline[e-1].time\u003ct)return this._timeline[e-1];let n=this._search(t);return n-1\u003e=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length\u003e1){let e=this._search(t);if(e\u003e=0)if(ln(this._timeline[e].time,t)){for(let n=e;n\u003e=0\u0026\u0026ln(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else this._timeline.length===1\u0026\u0026ca(this._timeline[0].time,t)\u0026\u0026(this._timeline=[]);return this}cancelBefore(t){let e=this._search(t);return e\u003e=0\u0026\u0026(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){let e=this._timeline.indexOf(t);return e\u003e0?this._timeline[e-1]:null}_search(t,e=\"time\"){if(this._timeline.length===0)return-1;let n=0,i=this._timeline.length,c=i;if(i\u003e0\u0026\u0026this._timeline[i-1][e]\u003c=t)return i-1;for(;n\u003cc;){let l=Math.floor(n+(c-n)/2),h=this._timeline[l],p=this._timeline[l+1];if(ln(h[e],t)){for(let f=l;f\u003cthis._timeline.length\u0026\u0026ln(this._timeline[f][e],t);f++)l=f;return l}if(Zc(h[e],t)\u0026\u0026nr(p[e],t))return l;nr(h[e],t)?c=l:n=l+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){let n=this._search(t);return n!==-1\u0026\u0026this._iterate(e,0,n),this}forEachAfter(t,e){let n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),c=this._search(e);return i!==-1\u0026\u0026c!==-1?(this._timeline[i].time!==t\u0026\u0026(i+=1),this._timeline[c].time===e\u0026\u0026(c-=1),this._iterate(n,i,c)):i===-1\u0026\u0026this._iterate(n,0,c),this}forEachFrom(t,e){let n=this._search(t);for(;n\u003e=0\u0026\u0026this._timeline[n].time\u003e=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){let n=this._search(t);if(n!==-1\u0026\u0026ln(this._timeline[n].time,t)){let i=n;for(let c=n;c\u003e=0\u0026\u0026ln(this._timeline[c].time,t);c--)i=c;this._iterate(c=\u003e{e(c)},i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}let $c=[];function sr(s){$c.push(s)}let Jc=[];function ir(s){Jc.push(s)}class Ss extends Cn{constructor(){super(...arguments),this.name=\"Emitter\"}on(t,e){return t.split(/\\W+/).forEach(n=\u003e{Ve(this._events)\u0026\u0026(this._events={}),this._events.hasOwnProperty(n)||(this._events[n]=[]),this._events[n].push(e)}),this}once(t,e){let n=(...i)=\u003e{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\\W+/).forEach(n=\u003e{if(Ve(this._events)\u0026\u0026(this._events={}),this._events.hasOwnProperty(t))if(Ve(e))this._events[t]=[];else{let i=this._events[t];for(let c=i.length-1;c\u003e=0;c--)i[c]===e\u0026\u0026i.splice(c,1)}}),this}emit(t,...e){if(this._events\u0026\u0026this._events.hasOwnProperty(t)){let n=this._events[t].slice(0);for(let i=0,c=n.length;i\u003cc;i++)n[i].apply(this,e)}return this}static mixin(t){[\"on\",\"once\",\"off\",\"emit\"].forEach(e=\u003e{let n=Object.getOwnPropertyDescriptor(Ss.prototype,e);Object.defineProperty(t.prototype,e,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class ua extends Ss{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class ks extends ua{constructor(){super(),this.name=\"Context\",this._constants=new Map,this._timeouts=new hn,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;let t=S(ks.getDefaults(),arguments,[\"context\"]);t.context?this._context=t.context:this._context=function(e){return new Xh(e)}({latencyHint:t.latencyHint}),this._ticker=new hd(this.emit.bind(this,\"tick\"),t.clockSource,t.updateInterval),this.on(\"tick\",this._timeoutLoop.bind(this)),this._context.onstatechange=()=\u003e{this.emit(\"statechange\",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:\"worker\",latencyHint:\"interactive\",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,$c.forEach(e=\u003ee(t)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return mt(Ts(this._context),\"Not available if OfflineAudioContext\"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return mt(Ts(this._context),\"Not available if OfflineAudioContext\"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return mt(Ts(this._context),\"Not available if OfflineAudioContext\"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){mt(!this._initialized,\"The listener cannot be set after initialization.\"),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){mt(!this._initialized,\"The transport cannot be set after initialization.\"),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){mt(!this._initialized,\"Draw cannot be set after initialization.\"),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){mt(!this._initialized,\"The destination cannot be set after initialization.\"),this._destination=t}createAudioWorkletNode(t,e){return function(n,i,c){return mt(Ot(Lc),\"This node only works in a secure context (https or localhost)\"),new Lc(n,i,c)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return Yt(this,void 0,void 0,function*(){mt(Ot(this.rawContext.audioWorklet),\"AudioWorkletNode is only available in a secure context (https or localhost)\"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)})}workletsAreReady(){return Yt(this,void 0,void 0,function*(){let t=[];this._workletModules.forEach(e=\u003et.push(e)),yield Promise.all(t)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Je(t))switch(t){case\"interactive\":e=.1;break;case\"playback\":e=.5;break;case\"balanced\":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return Ts(this._context)?this._context.resume():Promise.resolve()}close(){return Yt(this,void 0,void 0,function*(){var t;Ts(this._context)\u0026\u0026(yield this._context.close()),this._initialized\u0026\u0026(t=this,Jc.forEach(e=\u003ee(t)))})}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{let e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let c=0;c\u003cn.length;c++)n[c]=t;let i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode=\"explicit\",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=\u003ethis._constants[t].disconnect()),this}_timeoutLoop(){let t=this.now(),e=this._timeouts.peek();for(;this._timeouts.length\u0026\u0026e\u0026\u0026e.time\u003c=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;let n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=\u003e{e.id===t\u0026\u0026this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){let n=++this._timeoutIds,i=()=\u003e{let c=this.now();this._timeouts.add({callback:()=\u003e{t(),i()},id:n,time:c+e})};return i(),n}}function yt(s,t){Ae(t)?t.forEach(e=\u003eyt(s,e)):Object.defineProperty(s,t,{enumerable:!0,writable:!1})}function _i(s,t){Ae(t)?t.forEach(e=\u003e_i(s,e)):Object.defineProperty(s,t,{writable:!0})}let Et=()=\u003e{};class Rt extends Cn{constructor(){super(),this.name=\"ToneAudioBuffer\",this.onload=Et;let t=S(Rt.getDefaults(),arguments,[\"url\",\"onload\",\"onerror\"]);this.reverse=t.reverse,this.onload=t.onload,t.url\u0026\u0026Qc(t.url)||t.url instanceof Rt?this.set(t.url):Je(t.url)\u0026\u0026this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:Et,onload:Et,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Jt().sampleRate}set(t){return t instanceof Rt?t.loaded?this._buffer=t.get():t.onload=()=\u003e{this.set(t),this.onload(this)}:this._buffer=t,this._reversed\u0026\u0026this._reverse(),this}get(){return this._buffer}load(t){return Yt(this,void 0,void 0,function*(){let e=Rt.load(t).then(n=\u003e{this.set(n),this.onload(this)});Rt.downloads.push(e);try{yield e}finally{let n=Rt.downloads.indexOf(e);Rt.downloads.splice(n,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){let e=Ae(t)\u0026\u0026t[0].length\u003e0,n=e?t.length:1,i=e?t[0].length:t.length,c=Jt(),l=c.createBuffer(n,i,c.sampleRate),h=e||n!==1?t:[t];for(let p=0;p\u003cn;p++)l.copyToChannel(h[p],p);return this._buffer=l,this}toMono(t){if(Ye(t))this.fromArray(this.toArray(t));else{let e=new Float32Array(this.length),n=this.numberOfChannels;for(let i=0;i\u003cn;i++){let c=this.toArray(i);for(let l=0;l\u003cc.length;l++)e[l]+=c[l]}e=e.map(i=\u003ei/n),this.fromArray(e)}return this}toArray(t){if(Ye(t))return this.getChannelData(t);if(this.numberOfChannels===1)return this.toArray(0);{let e=[];for(let n=0;n\u003cthis.numberOfChannels;n++)e[n]=this.getChannelData(n);return e}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){let n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);mt(n\u003ci,\"The start time must be less than the end time\");let c=i-n,l=Jt().createBuffer(this.numberOfChannels,c,this.sampleRate);for(let h=0;h\u003cthis.numberOfChannels;h++)l.copyToChannel(this.getChannelData(h).subarray(n,i),h);return new Rt(l)}_reverse(){if(this.loaded)for(let t=0;t\u003cthis.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length\u003e0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t\u0026\u0026(this._reversed=t,this._reverse())}static fromArray(t){return new Rt().fromArray(t)}static fromUrl(t){return Yt(this,void 0,void 0,function*(){return yield new Rt().load(t)})}static load(t){return Yt(this,void 0,void 0,function*(){let e=t.match(/\\[([^\\]\\[]+\\|.+)\\]$/);if(e){let l=e[1].split(\"|\"),h=l[0];for(let p of l)if(Rt.supportsType(p)){h=p;break}t=t.replace(e[0],h)}let n=Rt.baseUrl===\"\"||Rt.baseUrl.endsWith(\"/\")?Rt.baseUrl:Rt.baseUrl+\"/\",i=yield fetch(n+t);if(!i.ok)throw new Error(\"could not load url: \"+t);let c=yield i.arrayBuffer();return yield Jt().decodeAudioData(c)})}static supportsType(t){let e=t.split(\".\"),n=e[e.length-1];return document.createElement(\"audio\").canPlayType(\"audio/\"+n)!==\"\"}static loaded(){return Yt(this,void 0,void 0,function*(){for(yield Promise.resolve();Rt.downloads.length;)yield Rt.downloads[0]})}}Rt.baseUrl=\"\",Rt.downloads=[];class Ms extends ks{constructor(){var t,e,n;super({clockSource:\"offline\",context:er(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new sd(t,e,n)),lookAhead:0,updateInterval:er(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name=\"OfflineContext\",this._currentTime=0,this.isOffline=!0,this._duration=er(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Yt(this,void 0,void 0,function*(){let e=0;for(;this._duration-this._currentTime\u003e=0;){this.emit(\"tick\"),this._currentTime+=128/this.sampleRate,e++;let n=Math.floor(this.sampleRate/128);t\u0026\u0026e%n==0\u0026\u0026(yield new Promise(i=\u003esetTimeout(i,1)))}})}render(t=!0){return Yt(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(t);let e=yield this._context.startRendering();return new Rt(e)})}close(){return Promise.resolve()}}let tu=new class extends ua{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(s,t,e){return{}}createChannelMerger(s){return{}}createChannelSplitter(s){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(s){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(s,t){return{}}createPanner(){return{}}createPeriodicWave(s,t,e){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(s){return{}}createMediaElementSource(s){return{}}createMediaStreamDestination(){return{}}decodeAudioData(s){return Promise.resolve({})}createAudioWorkletNode(s,t){return{}}get rawContext(){return{}}addAudioWorkletModule(s,t){return Yt(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(s,t){return 0}clearTimeout(s){return this}setInterval(s,t){return 0}clearInterval(s){return this}getConstant(s){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(s){}get destination(){return{}}set destination(s){}now(){return 0}immediate(){return 0}},rr=tu;function Jt(){return rr===tu\u0026\u0026ld\u0026\u0026or(new ks),rr}function or(s){rr=Ts(s)?new ks(s):er(s)?new Ms(s):s}function pd(){return rr.resume()}if(An\u0026\u0026!An.TONE_SILENCE_LOGGING){let s=\"v\";m===\"dev\"\u0026\u0026(s=\"\");let t=` * Tone.js ${s}${m} * `;console.log(\"%c\"+t,\"background: #000; color: #fff\")}function As(s){return Math.pow(10,s/20)}function yi(s){return Math.log(s)/Math.LN10*20}function Cs(s){return Math.pow(2,s/12)}let ar=440;function Ln(s){return Math.round(eu(s))}function eu(s){return 69+12*Math.log2(s/ar)}function la(s){return ar*Math.pow(2,(s-69)/12)}class ha extends Cn{constructor(t,e,n){super(),this.defaultUnits=\"s\",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=\u003ethis._frequencyToUnits(parseFloat(t)),regexp:/^(\\d+(?:\\.\\d+)?)hz$/i},i:{method:t=\u003ethis._ticksToUnits(parseInt(t,10)),regexp:/^(\\d+)i$/i},m:{method:t=\u003ethis._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\\d+)m$/i},n:{method:(t,e)=\u003e{let n=parseInt(t,10),i=e===\".\"?1.5:1;return n===1?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\\d+)n(\\.?)$/i},number:{method:t=\u003ethis._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\\d+(?:\\.\\d+)?)$/},s:{method:t=\u003ethis._secondsToUnits(parseFloat(t)),regexp:/^(\\d+(?:\\.\\d+)?)s$/},samples:{method:t=\u003eparseInt(t,10)/this.context.sampleRate,regexp:/^(\\d+)samples$/},t:{method:t=\u003e{let e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\\d+)t$/i},tr:{method:(t,e,n)=\u003e{let i=0;return t\u0026\u0026t!==\"0\"\u0026\u0026(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e\u0026\u0026e!==\"0\"\u0026\u0026(i+=this._beatsToUnits(parseFloat(e))),n\u0026\u0026n!==\"0\"\u0026\u0026(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\\d+(?:\\.\\d+)?):(\\d+(?:\\.\\d+)?):?(\\d+(?:\\.\\d+)?)?$/}}}valueOf(){if(this._val instanceof ha\u0026\u0026this.fromType(this._val),Ve(this._val))return this._noArg();if(Je(this._val)\u0026\u0026Ve(this._units)){for(let t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Mn(this._val)){let t=0;for(let e in this._val)if(Ot(this._val[e])){let n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(Ot(this._units)){let t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return Je(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case\"s\":this._val=t.toSeconds();break;case\"i\":this._val=t.toTicks();break;case\"hz\":this._val=t.toFrequency();break;case\"midi\":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class Xe extends ha{constructor(){super(...arguments),this.name=\"TimeClass\"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=\u003ethis._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\\+(.+)/},quantize:{method:t=\u003e{let e=new Xe(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){let n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){let t=this.toSeconds(),e=[\"1m\"];for(let c=1;c\u003c9;c++){let l=Math.pow(2,c);e.push(l+\"n.\"),e.push(l+\"n\"),e.push(l+\"t\")}e.push(\"0\");let n=e[0],i=new Xe(this.context,e[0]).toSeconds();return e.forEach(c=\u003e{let l=new Xe(this.context,c).toSeconds();Math.abs(l-t)\u003cMath.abs(i-t)\u0026\u0026(n=c,i=l)}),n}toBarsBeatsSixteenths(){let t=this._beatsToUnits(1),e=this.valueOf()/t;e=parseFloat(e.toFixed(4));let n=Math.floor(e/this._getTimeSignature()),i=e%1*4;e=Math.floor(e)%this._getTimeSignature();let c=i.toString();return c.length\u003e3\u0026\u0026(i=parseFloat(parseFloat(c).toFixed(3))),[n,e,i].join(\":\")}toTicks(){let t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Ln(this.toFrequency())}_now(){return this.context.now()}}function fd(s,t){return new Xe(Jt(),s,t)}class Re extends Xe{constructor(){super(...arguments),this.name=\"Frequency\",this.defaultUnits=\"hz\"}static get A4(){return ar}static set A4(t){(function(e){ar=e})(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\\d+(?:\\.\\d+)?midi)/,method(t){return this.defaultUnits===\"midi\"?t:Re.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){let n=md[t.toLowerCase()]+12*(parseInt(e,10)+1);return this.defaultUnits===\"midi\"?n:Re.mtof(n)}},tr:{regexp:/^(\\d+(?:\\.\\d+)?):(\\d+(?:\\.\\d+)?):?(\\d+(?:\\.\\d+)?)?/,method(t,e,n){let i=1;return t\u0026\u0026t!==\"0\"\u0026\u0026(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e\u0026\u0026e!==\"0\"\u0026\u0026(i*=this._beatsToUnits(parseFloat(e))),n\u0026\u0026n!==\"0\"\u0026\u0026(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new Re(this.context,this.valueOf()*Cs(t))}harmonize(t){return t.map(e=\u003ethis.transpose(e))}toMidi(){return Ln(this.valueOf())}toNote(){let t=this.toFrequency(),e=Math.log2(t/Re.A4),n=Math.round(12*e)+57,i=Math.floor(n/12);return i\u003c0\u0026\u0026(n+=-12*i),gd[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return la(t)}static ftom(t){return Ln(t)}}let md={cbb:-2,cb:-1,c:0,\"c#\":1,cx:2,dbb:0,db:1,d:2,\"d#\":3,dx:4,ebb:2,eb:3,e:4,\"e#\":5,ex:6,fbb:3,fb:4,f:5,\"f#\":6,fx:7,gbb:5,gb:6,g:7,\"g#\":8,gx:9,abb:7,ab:8,a:9,\"a#\":10,ax:11,bbb:9,bb:10,b:11,\"b#\":12,bx:13},gd=[\"C\",\"C#\",\"D\",\"D#\",\"E\",\"F\",\"F#\",\"G\",\"G#\",\"A\",\"A#\",\"B\"];function vd(s,t){return new Re(Jt(),s,t)}class me extends Xe{constructor(){super(...arguments),this.name=\"TransportTime\"}_now(){return this.context.transport.seconds}}function _d(s,t){return new me(Jt(),s,t)}class xe extends Cn{constructor(){super();let t=S(xe.getDefaults(),arguments,[\"context\"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Jt()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new Xe(this.context,t).toSeconds()}toFrequency(t){return new Re(this.context,t).toFrequency()}toTicks(t){return new me(this.context,t).toTicks()}_getPartialProperties(t){let e=this.get();return Object.keys(e).forEach(n=\u003e{Ve(t[n])\u0026\u0026delete e[n]}),e}get(){let t=this.constructor.getDefaults();return Object.keys(t).forEach(e=\u003e{if(Reflect.has(this,e)){let n=this[e];Ot(n)\u0026\u0026Ot(n.value)\u0026\u0026Ot(n.setValueAtTime)?t[e]=n.value:n instanceof xe?t[e]=n._getPartialProperties(t[e]):Ae(n)||Ye(n)||Je(n)||aa(n)?t[e]=n:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=\u003e{Reflect.has(this,e)\u0026\u0026Ot(this[e])\u0026\u0026(this[e]\u0026\u0026Ot(this[e].value)\u0026\u0026Ot(this[e].setValueAtTime)?this[e].value!==t[e]\u0026\u0026(this[e].value=t[e]):this[e]instanceof xe?this[e].set(t[e]):this[e]=t[e])}),this}}class Os extends hn{constructor(t=\"stopped\"){super(),this.name=\"StateTimeline\",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){let e=this.get(t);return e!==null?e.state:this._initial}setStateAtTime(t,e,n){return Me(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n\u003e=0;n--){let i=this._timeline[n];if(i.state===t)return i}}getNextState(t,e){let n=this._search(e);if(n!==-1)for(let i=n;i\u003cthis._timeline.length;i++){let c=this._timeline[i];if(c.state===t)return c}}}class St extends xe{constructor(){super(S(St.getDefaults(),arguments,[\"param\",\"units\",\"convert\"])),this.name=\"Param\",this.overridden=!1,this._minOutput=1e-7;let t=S(St.getDefaults(),arguments,[\"param\",\"units\",\"convert\"]);for(mt(Ot(t.param)\u0026\u0026(ts(t.param)||t.param instanceof St),\"param must be an AudioParam\");!ts(t.param);)t.param=t.param._param;this._swappable=!!Ot(t.swappable)\u0026\u0026t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new hn(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Ot(t.value)\u0026\u0026t.value!==this._toType(this._initialValue)\u0026\u0026this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(xe.getDefaults(),{convert:!0,units:\"number\"})}get value(){let t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Ot(this._minValue)?this._minValue:this.units===\"time\"||this.units===\"frequency\"||this.units===\"normalRange\"||this.units===\"positive\"||this.units===\"transportTime\"||this.units===\"ticks\"||this.units===\"bpm\"||this.units===\"hertz\"||this.units===\"samples\"?0:this.units===\"audioRange\"?-1:this.units===\"decibels\"?-1/0:this._param.minValue}get maxValue(){return Ot(this._maxValue)?this._maxValue:this.units===\"normalRange\"||this.units===\"audioRange\"?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Ot(this.maxValue)\u0026\u0026Ot(this.minValue)\u0026\u0026Me(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert\u0026\u0026!this.overridden?this._is(t,\"time\")?this.toSeconds(t):this._is(t,\"decibels\")?As(t):this._is(t,\"frequency\")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert\u0026\u0026this.units===\"decibels\"?yi(t):t}setValueAtTime(t,e){let n=this.toSeconds(e),i=this._fromType(t);return mt(isFinite(i)\u0026\u0026isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,\"setValueAtTime\",t,n),this._events.add({time:n,type:\"setValueAtTime\",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){let e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e),c=this._initialValue;if(i===null)c=this._initialValue;else if(i.type!==\"setTargetAtTime\"||n!==null\u0026\u0026n.type!==\"setValueAtTime\")if(n===null)c=i.value;else if(n.type===\"linearRampToValueAtTime\"||n.type===\"exponentialRampToValueAtTime\"){let l=i.value;if(i.type===\"setTargetAtTime\"){let h=this._events.getBefore(i.time);l=h===null?this._initialValue:h.value}c=n.type===\"linearRampToValueAtTime\"?this._linearInterpolate(i.time,l,n.time,n.value,e):this._exponentialInterpolate(i.time,l,n.time,n.value,e)}else c=i.value;else{let l=this._events.getBefore(i.time),h;h=l===null?this._initialValue:l.value,i.type===\"setTargetAtTime\"\u0026\u0026(c=this._exponentialApproach(i.time,h,i.value,i.constant,e))}return this._toType(c)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),this._fromType(e)===0\u0026\u0026(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){let n=this._fromType(t),i=this.toSeconds(e);return mt(isFinite(n)\u0026\u0026isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:\"linearRampToValueAtTime\",value:n}),this.log(this.units,\"linearRampToValueAtTime\",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=ln(n,0)?this._minOutput:n,this._assertRange(n);let i=this.toSeconds(e);return mt(isFinite(n)\u0026\u0026isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:\"exponentialRampToValueAtTime\",value:n}),this.log(this.units,\"exponentialRampToValueAtTime\",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);let i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){let i=this._fromType(t);mt(isFinite(n)\u0026\u0026n\u003e0,\"timeConstant must be a number greater than 0\");let c=this.toSeconds(e);return this._assertRange(i),mt(isFinite(i)\u0026\u0026isFinite(c),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:c,type:\"setTargetAtTime\",value:i}),this.log(this.units,\"setTargetAtTime\",t,c,n),this._param.setTargetAtTime(i,c,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);let c=this._fromType(t[0])*i;this.setValueAtTime(this._toType(c),e);let l=n/(t.length-1);for(let h=1;h\u003ct.length;h++){let p=this._fromType(t[h])*i;this.linearRampToValueAtTime(this._toType(p),e+h*l)}return this}cancelScheduledValues(t){let e=this.toSeconds(t);return mt(isFinite(e),\"Invalid argument to cancelScheduledValues: \"+JSON.stringify(t)),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,\"cancelScheduledValues\",e),this}cancelAndHoldAtTime(t){let e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));mt(isFinite(e),\"Invalid argument to cancelAndHoldAtTime: \"+JSON.stringify(t)),this.log(this.units,\"cancelAndHoldAtTime\",e,\"value=\"+n);let i=this._events.get(e),c=this._events.getAfter(e);return i\u0026\u0026ln(i.time,e)?c?(this._param.cancelScheduledValues(c.time),this._events.cancel(c.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):c\u0026\u0026(this._param.cancelScheduledValues(c.time),this._events.cancel(c.time),c.type===\"linearRampToValueAtTime\"?this.linearRampToValueAtTime(this._toType(n),e):c.type===\"exponentialRampToValueAtTime\"\u0026\u0026this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:\"setValueAtTime\",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return this.units===\"frequency\"||this.units===\"bpm\"||this.units===\"decibels\"?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){let e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);let n=this._events.get(e);if(n\u0026\u0026n.type===\"setTargetAtTime\"){let i=this._events.getAfter(n.time),c=i?i.time:e+2,l=(c-e)/10;for(let h=e;h\u003cc;h+=l)t.linearRampToValueAtTime(this.getValueAtTime(h),h)}return this._events.forEachAfter(this.context.currentTime,i=\u003e{i.type===\"cancelScheduledValues\"?t.cancelScheduledValues(i.time):i.type===\"setTargetAtTime\"?t.setTargetAtTime(i.value,i.time,i.constant):t[i.type](i.value,i.time)}),this}setParam(t){mt(this._swappable,\"The Param must be assigned as 'swappable' in the constructor\");let e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,c){return n+(e-n)*Math.exp(-(c-t)/i)}_linearInterpolate(t,e,n,i,c){return e+(c-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,c){return e*Math.pow(i/e,(c-t)/(n-t))}}class ot extends xe{constructor(){super(...arguments),this.name=\"ToneAudioNode\",this._internalChannels=[]}get numberOfInputs(){return Ot(this.input)?ts(this.input)||this.input instanceof St?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Ot(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Ot(t)\u0026\u0026(t instanceof ot||Vn(t))}_getInternalNodes(){let t=this._internalChannels.slice(0);return this._isAudioNode(this.input)\u0026\u0026t.push(this.input),this._isAudioNode(this.output)\u0026\u0026this.input!==this.output\u0026\u0026t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(e=\u003e{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){let t=this._getInternalNodes();mt(t.length\u003e0,\"ToneAudioNode does not have any internal nodes\");let e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return Le(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return gi(\"toMaster() has been renamed toDestination()\"),this.toDestination()}disconnect(t,e=0,n=0){return da(this,t,e,n),this}chain(...t){return Qe(this,...t),this}fan(...t){return t.forEach(e=\u003ethis.connect(e)),this}dispose(){return super.dispose(),Ot(this.input)\u0026\u0026(this.input instanceof ot?this.input.dispose():Vn(this.input)\u0026\u0026this.input.disconnect()),Ot(this.output)\u0026\u0026(this.output instanceof ot?this.output.dispose():Vn(this.output)\u0026\u0026this.output.disconnect()),this._internalChannels=[],this}}function Qe(...s){let t=s.shift();s.reduce((e,n)=\u003e(e instanceof ot?e.connect(n):Vn(e)\u0026\u0026Le(e,n),n),t)}function Le(s,t,e=0,n=0){for(mt(Ot(s),\"Cannot connect from undefined node\"),mt(Ot(t),\"Cannot connect to undefined node\"),(t instanceof ot||Vn(t))\u0026\u0026mt(t.numberOfInputs\u003e0,\"Cannot connect to node with no inputs\"),mt(s.numberOfOutputs\u003e0,\"Cannot connect from node with no outputs\");t instanceof ot||t instanceof St;)Ot(t.input)\u0026\u0026(t=t.input);for(;s instanceof ot;)Ot(s.output)\u0026\u0026(s=s.output);ts(t)?s.connect(t,e):s.connect(t,e,n)}function da(s,t,e=0,n=0){if(Ot(t))for(;t instanceof ot;)t=t.input;for(;!Vn(s);)Ot(s.output)\u0026\u0026(s=s.output);ts(t)?s.disconnect(t,e):Vn(t)?s.disconnect(t,e,n):s.disconnect()}class ft extends ot{constructor(){super(S(ft.getDefaults(),arguments,[\"gain\",\"units\"])),this.name=\"Gain\",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let t=S(ft.getDefaults(),arguments,[\"gain\",\"units\"]);this.gain=new St({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),yt(this,\"gain\")}static getDefaults(){return Object.assign(ot.getDefaults(),{convert:!0,gain:1,units:\"gain\"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Ds extends ot{constructor(t){super(t),this.onended=Et,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new ft({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){let n=this.toSeconds(e);return this._startTime!==-1\u0026\u0026n\u003e=this._startTime\u0026\u0026(this._stopTime===-1||n\u003c=this._stopTime)?\"started\":\"stopped\"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(ot.getDefaults(),{curve:\"linear\",fadeIn:0,fadeOut:0,onended:Et})}_startGain(t,e=1){mt(this._startTime===-1,\"Source cannot be started more than once\");let n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n\u003e0?(this._gainNode.gain.setValueAtTime(0,t),this._curve===\"linear\"?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log(\"stop\",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){mt(this._startTime!==-1,\"'start' must be called before 'stop'\"),this.cancelStop();let e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e\u003e0?this._curve===\"linear\"?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=\u003e{let n=this._curve===\"exponential\"?2*e:0;this._stopSource(this.now()+n),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Et\u0026\u0026(this.onended(this),this.onended=Et,!this.context.isOffline)){let t=()=\u003ethis.dispose();window.requestIdleCallback!==void 0?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log(\"cancelStop\"),mt(this._startTime!==-1,\"Source is not started\"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class bi extends Ds{constructor(){super(S(bi.getDefaults(),arguments,[\"offset\"])),this.name=\"ToneConstantSource\",this._source=this.context.createConstantSource();let t=S(bi.getDefaults(),arguments,[\"offset\"]);Le(this._source,this._gainNode),this.offset=new St({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Ds.getDefaults(),{convert:!0,offset:1,units:\"number\"})}start(t){let e=this.toSeconds(t);return this.log(\"start\",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),this.state===\"started\"\u0026\u0026this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class wt extends ot{constructor(){super(S(wt.getDefaults(),arguments,[\"value\",\"units\"])),this.name=\"Signal\",this.override=!0;let t=S(wt.getDefaults(),arguments,[\"value\",\"units\"]);this.output=this._constantSource=new bi({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(ot.getDefaults(),{convert:!0,units:\"number\",value:0})}connect(t,e=0,n=0){return wi(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function wi(s,t,e,n){(t instanceof St||ts(t)||t instanceof wt\u0026\u0026t.override)\u0026\u0026(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof wt\u0026\u0026(t.overridden=!0)),Le(s,t,e,n)}class cr extends St{constructor(){super(S(cr.getDefaults(),arguments,[\"value\"])),this.name=\"TickParam\",this._events=new hn(1/0),this._multiplier=1;let t=S(cr.getDefaults(),arguments,[\"value\"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:\"setValueAtTime\",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(St.getDefaults(),{multiplier:1,units:\"hertz\",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);let i=this._fromType(t),c=this._events.get(e),l=Math.round(Math.max(1/n,1));for(let h=0;h\u003c=l;h++){let p=n*h+e,f=this._exponentialApproach(c.time,c.value,i,n,p);this.linearRampToValueAtTime(this._toType(f),p)}return this}setValueAtTime(t,e){let n=this.toSeconds(e);super.setValueAtTime(t,e);let i=this._events.get(n),c=this._events.previousEvent(i),l=this._getTicksUntilEvent(c,n);return i.ticks=Math.max(l,0),this}linearRampToValueAtTime(t,e){let n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);let i=this._events.get(n),c=this._events.previousEvent(i),l=this._getTicksUntilEvent(c,n);return i.ticks=Math.max(l,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);let n=this._fromType(t),i=this._events.get(e),c=Math.round(Math.max(10*(e-i.time),1)),l=(e-i.time)/c;for(let h=0;h\u003c=c;h++){let p=l*h+i.time,f=this._exponentialInterpolate(i.time,i.value,e,n,p);this.linearRampToValueAtTime(this._toType(f),p)}return this}_getTicksUntilEvent(t,e){if(t===null)t={ticks:0,time:0,type:\"setValueAtTime\",value:0};else if(Ve(t.ticks)){let l=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(l,t.time)}let n=this._fromType(this.getValueAtTime(t.time)),i=this._fromType(this.getValueAtTime(e)),c=this._events.get(e);return c\u0026\u0026c.time===e\u0026\u0026c.type===\"setValueAtTime\"\u0026\u0026(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){let e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){let n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){let e=this._events.get(t,\"ticks\"),n=this._events.getAfter(t,\"ticks\");if(e\u0026\u0026e.ticks===t)return e.time;if(e\u0026\u0026n\u0026\u0026n.type===\"linearRampToValueAtTime\"\u0026\u0026e.value!==n.value){let i=this._fromType(this.getValueAtTime(e.time)),c=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),l=Math.sqrt(Math.pow(i,2)-2*c*(e.ticks-t)),h=(-i+l)/c,p=(-i-l)/c;return(h\u003e0?h:p)+e.time}return e?e.value===0?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){let n=this.toSeconds(e),i=this.toSeconds(t),c=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-c}_fromType(t){return this.units===\"bpm\"\u0026\u0026this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return this.units===\"bpm\"\u0026\u0026this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){let e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class ur extends wt{constructor(){super(S(ur.getDefaults(),arguments,[\"value\"])),this.name=\"TickSignal\";let t=S(ur.getDefaults(),arguments,[\"value\"]);this.input=this._param=new cr({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(wt.getDefaults(),{multiplier:1,units:\"hertz\",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class lr extends xe{constructor(){super(S(lr.getDefaults(),arguments,[\"frequency\"])),this.name=\"TickSource\",this._state=new Os,this._tickOffset=new hn;let t=S(lr.getDefaults(),arguments,[\"frequency\"]);this.frequency=new ur({context:this.context,units:t.units,value:t.frequency}),yt(this,\"frequency\"),this._state.setStateAtTime(\"stopped\",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:\"hertz\"},xe.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){let n=this.toSeconds(t);return this._state.getValueAtTime(n)!==\"started\"\u0026\u0026(this._state.setStateAtTime(\"started\",n),Ot(e)\u0026\u0026this.setTicksAtTime(e,n)),this}stop(t){let e=this.toSeconds(t);if(this._state.getValueAtTime(e)===\"stopped\"){let n=this._state.get(e);n\u0026\u0026n.time\u003e0\u0026\u0026(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(e),this._state.setStateAtTime(\"stopped\",e),this.setTicksAtTime(0,e),this}pause(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)===\"started\"\u0026\u0026this._state.setStateAtTime(\"paused\",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){let e=this.toSeconds(t),n=this._state.getLastState(\"stopped\",e),i={state:\"paused\",time:e};this._state.add(i);let c=n,l=0;return this._state.forEachBetween(n.time,e+this.sampleTime,h=\u003e{let p=c.time,f=this._tickOffset.get(h.time);f\u0026\u0026f.time\u003e=c.time\u0026\u0026(l=f.ticks,p=f.time),c.state===\"started\"\u0026\u0026h.state!==\"started\"\u0026\u0026(l+=this.frequency.getTicksAtTime(h.time)-this.frequency.getTicksAtTime(p)),c=h}),this._state.remove(i),l}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){let e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);let e=this._state.getLastState(\"stopped\",t),n={state:\"paused\",time:t};this._state.add(n);let i=e,c=0;return this._state.forEachBetween(e.time,t+this.sampleTime,l=\u003e{let h=i.time,p=this._tickOffset.get(l.time);p\u0026\u0026p.time\u003e=i.time\u0026\u0026(c=p.seconds,h=p.time),i.state===\"started\"\u0026\u0026l.state!==\"started\"\u0026\u0026(c+=l.time-h),i=l}),this._state.remove(n),c}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){let n=this._tickOffset.get(e),i=this._state.get(e),c=Math.max(n.time,i.time),l=this.frequency.getTicksAtTime(c)+t-n.ticks;return this.frequency.getTimeOfTick(l)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,l=\u003e{i\u0026\u0026i.state===\"started\"\u0026\u0026l.state!==\"started\"\u0026\u0026this.forEachTickBetween(Math.max(i.time,t),l.time-this.sampleTime,n),i=l});let c=null;if(i\u0026\u0026i.state===\"started\"){let l=Math.max(i.time,t),h=this.frequency.getTicksAtTime(l),p=h-this.frequency.getTicksAtTime(i.time),f=Math.ceil(p)-p;f=ln(f,1)?0:f;let y=this.frequency.getTimeOfTick(h+f);for(;y\u003ce;){try{n(y,Math.round(this.getTicksAtTime(y)))}catch(g){c=g;break}y+=this.frequency.getDurationOfTicks(1,y)}}if(c)throw c;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class es extends xe{constructor(){super(S(es.getDefaults(),arguments,[\"callback\",\"frequency\"])),this.name=\"Clock\",this.callback=Et,this._lastUpdate=0,this._state=new Os(\"stopped\"),this._boundLoop=this._loop.bind(this);let t=S(es.getDefaults(),arguments,[\"callback\",\"frequency\"]);this.callback=t.callback,this._tickSource=new lr({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,yt(this,\"frequency\"),this._state.setStateAtTime(\"stopped\",0),this.context.on(\"tick\",this._boundLoop)}static getDefaults(){return Object.assign(xe.getDefaults(),{callback:Et,frequency:1,units:\"hertz\"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){ra(this.context);let n=this.toSeconds(t);return this.log(\"start\",n),this._state.getValueAtTime(n)!==\"started\"\u0026\u0026(this._state.setStateAtTime(\"started\",n),this._tickSource.start(n,e),n\u003cthis._lastUpdate\u0026\u0026this.emit(\"start\",n,e)),this}stop(t){let e=this.toSeconds(t);return this.log(\"stop\",e),this._state.cancel(e),this._state.setStateAtTime(\"stopped\",e),this._tickSource.stop(e),e\u003cthis._lastUpdate\u0026\u0026this.emit(\"stop\",e),this}pause(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)===\"started\"\u0026\u0026(this._state.setStateAtTime(\"paused\",e),this._tickSource.pause(e),e\u003cthis._lastUpdate\u0026\u0026this.emit(\"pause\",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){let n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){let t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log(\"loop\",t,e),t!==e\u0026\u0026(this._state.forEachBetween(t,e,n=\u003e{switch(n.state){case\"started\":let i=this._tickSource.getTicksAtTime(n.time);this.emit(\"start\",n.time,i);break;case\"stopped\":n.time!==0\u0026\u0026this.emit(\"stop\",n.time);break;case\"paused\":this.emit(\"pause\",n.time)}}),this._tickSource.forEachTickBetween(t,e,(n,i)=\u003e{this.callback(n,i)}))}getStateAtTime(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off(\"tick\",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Ss.mixin(es);class We extends ot{constructor(){super(S(We.getDefaults(),arguments,[\"delayTime\",\"maxDelay\"])),this.name=\"Delay\";let t=S(We.getDefaults(),arguments,[\"delayTime\",\"maxDelay\"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new St({context:this.context,param:this._delayNode.delayTime,units:\"time\",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),yt(this,\"delayTime\")}static getDefaults(){return Object.assign(ot.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function yd(s,t,e=2,n=Jt().sampleRate){return Yt(this,void 0,void 0,function*(){let i=Jt(),c=new Ms(e,t,n);or(c),yield s(c);let l=c.render();or(i);let h=yield l;return new Rt(h)})}class Ps extends Cn{constructor(){super(),this.name=\"ToneAudioBuffers\",this._buffers=new Map,this._loadingCount=0;let t=S(Ps.getDefaults(),arguments,[\"urls\",\"onload\",\"baseUrl\"],\"urls\");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=\u003e{this._loadingCount++;let n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:\"\",onerror:Et,onload:Et,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return mt(this.has(t),\"ToneAudioBuffers has no buffer named: \"+t),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,this._loadingCount===0\u0026\u0026t\u0026\u0026t()}get loaded(){return Array.from(this._buffers).every(([t,e])=\u003ee.loaded)}add(t,e,n=Et,i=Et){return Je(e)?this._buffers.set(t.toString(),new Rt(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new Rt(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach(t=\u003et.dispose()),this._buffers.clear(),this}}class Es extends Re{constructor(){super(...arguments),this.name=\"MidiClass\",this.defaultUnits=\"midi\"}_frequencyToUnits(t){return Ln(super._frequencyToUnits(t))}_ticksToUnits(t){return Ln(super._ticksToUnits(t))}_beatsToUnits(t){return Ln(super._beatsToUnits(t))}_secondsToUnits(t){return Ln(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return la(this.toMidi())}transpose(t){return new Es(this.context,this.toMidi()+t)}}function bd(s,t){return new Es(Jt(),s,t)}class Xt extends me{constructor(){super(...arguments),this.name=\"Ticks\",this.defaultUnits=\"i\"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function wd(s,t){return new Xt(Jt(),s,t)}class xd extends xe{constructor(){super(...arguments),this.name=\"Draw\",this.expiration=.25,this.anticipation=.008,this._events=new hn,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),this._events.length===1\u0026\u0026(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){let t=this.context.currentTime;for(;this._events.length\u0026\u0026this._events.peek().time-this.anticipation\u003c=t;){let e=this._events.shift();e\u0026\u0026t-e.time\u003c=this.expiration\u0026\u0026e.callback()}this._events.length\u003e0\u0026\u0026(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}sr(s=\u003e{s.draw=new xd({context:s})}),ir(s=\u003e{s.draw.dispose()});class nu extends Cn{constructor(){super(...arguments),this.name=\"IntervalTimeline\",this._root=null,this._length=0}add(t){mt(Ot(t.time),\"Events must have a time property\"),mt(Ot(t.duration),\"Events must have a duration parameter\"),t.time=t.time.valueOf();let e=new Td(t.time,t.time+t.duration,t);for(this._root===null?this._root=e:this._root.insert(e),this._length++;e!==null;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(this._root!==null){let e=[];this._root.search(t.time,e);for(let n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,e=\u003ethis.remove(e)),this}_setRoot(t){this._root=t,this._root!==null\u0026\u0026(this._root.parent=null)}_replaceNodeInParent(t,e){t.parent!==null?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(t.left===null\u0026\u0026t.right===null)this._replaceNodeInParent(t,null);else if(t.right===null)this._replaceNodeInParent(t,t.left);else if(t.left===null)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()\u003e0)if(t.left.right===null)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;e.right!==null;)e=e.right;e.parent\u0026\u0026(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(t.right.left===null)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;e.left!==null;)e=e.left;e.parent\u0026\u0026(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}t.parent!==null?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n\u0026\u0026this._rebalance(n)}t.dispose()}_rotateLeft(t){let e=t.parent,n=t.isLeftChild(),i=t.right;i\u0026\u0026(t.right=i.left,i.left=t),e!==null?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){let e=t.parent,n=t.isLeftChild(),i=t.left;i\u0026\u0026(t.left=i.right,i.right=t),e!==null?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){let e=t.getBalance();e\u003e1\u0026\u0026t.left?t.left.getBalance()\u003c0?this._rotateLeft(t.left):this._rotateRight(t):e\u003c-1\u0026\u0026t.right\u0026\u0026(t.right.getBalance()\u003e0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(this._root!==null){let e=[];if(this._root.search(t,e),e.length\u003e0){let n=e[0];for(let i=1;i\u003ce.length;i++)e[i].low\u003en.low\u0026\u0026(n=e[i]);return n.event}}return null}forEach(t){if(this._root!==null){let e=[];this._root.traverse(n=\u003ee.push(n)),e.forEach(n=\u003e{n.event\u0026\u0026t(n.event)})}return this}forEachAtTime(t,e){if(this._root!==null){let n=[];this._root.search(t,n),n.forEach(i=\u003e{i.event\u0026\u0026e(i.event)})}return this}forEachFrom(t,e){if(this._root!==null){let n=[];this._root.searchAfter(t,n),n.forEach(i=\u003e{i.event\u0026\u0026e(i.event)})}return this}dispose(){return super.dispose(),this._root!==null\u0026\u0026this._root.traverse(t=\u003et.dispose()),this._root=null,this}}class Td{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low\u003c=this.low?this.left===null?this.left=t:this.left.insert(t):this.right===null?this.right=t:this.right.insert(t)}search(t,e){t\u003ethis.max||(this.left!==null\u0026\u0026this.left.search(t,e),this.low\u003c=t\u0026\u0026this.high\u003et\u0026\u0026e.push(this),this.low\u003et||this.right!==null\u0026\u0026this.right.search(t,e))}searchAfter(t,e){this.low\u003e=t\u0026\u0026(e.push(this),this.left!==null\u0026\u0026this.left.searchAfter(t,e)),this.right!==null\u0026\u0026this.right.searchAfter(t,e)}traverse(t){t(this),this.left!==null\u0026\u0026this.left.traverse(t),this.right!==null\u0026\u0026this.right.traverse(t)}updateHeight(){this.left!==null\u0026\u0026this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null\u0026\u0026(this.max=Math.max(this.max,this.left.max)),this.right!==null\u0026\u0026(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return this.left!==null\u0026\u0026this.right!==null?t=this.left.height-this.right.height:this.left!==null?t=this.left.height+1:this.right!==null\u0026\u0026(t=-(this.right.height+1)),t}isLeftChild(){return this.parent!==null\u0026\u0026this.parent.left===this}get left(){return this._left}set left(t){this._left=t,t!==null\u0026\u0026(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,t!==null\u0026\u0026(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class yn extends ot{constructor(){super(S(yn.getDefaults(),arguments,[\"volume\"])),this.name=\"Volume\";let t=S(yn.getDefaults(),arguments,[\"volume\"]);this.input=this.output=new ft({context:this.context,gain:t.volume,units:\"decibels\"}),this.volume=this.output.gain,yt(this,\"volume\"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(ot.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute\u0026\u0026t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute\u0026\u0026!t\u0026\u0026(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class hr extends ot{constructor(){super(S(hr.getDefaults(),arguments)),this.name=\"Destination\",this.input=new yn({context:this.context}),this.output=new ft({context:this.context}),this.volume=this.input.volume;let t=S(hr.getDefaults(),arguments);Qe(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(ot.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Qe(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}sr(s=\u003e{s.destination=new hr({context:s})}),ir(s=\u003e{s.destination.dispose()});class Sd extends Cn{constructor(t){super(),this.name=\"TimelineValue\",this._timeline=new hn({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){let e=this._timeline.get(t);return e?e.value:this._initialValue}}class Wn{constructor(t,e){this.id=Wn._eventId++;let n=Object.assign(Wn.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:Et,once:!1,time:0}}invoke(t){this.callback\u0026\u0026(this.callback(t),this._once\u0026\u0026this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}Wn._eventId=0;class pa extends Wn{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let n=Object.assign(pa.getDefaults(),e);this.duration=new Xt(t.context,n.duration).valueOf(),this._interval=new Xt(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on(\"start\",this._boundRestart),this.transport.on(\"loopStart\",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Wn.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){let e=this.transport.getTicksAtTime(t);e\u003e=this.time\u0026\u0026e\u003e=this._nextTick\u0026\u0026this._nextTick+this._interval\u003cthis.time+this.duration\u0026\u0026(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Xt(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;let e=this.transport.getTicksAtTime(t);e\u003ethis.time\u0026\u0026(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Xt(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Xt(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off(\"start\",this._boundRestart),this.transport.off(\"loopStart\",this._boundRestart),this}}class xi extends xe{constructor(){super(S(xi.getDefaults(),arguments)),this.name=\"Transport\",this._loop=new Sd(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new hn,this._repeatedEvents=new nu,this._syncedSignals=[],this._swingAmount=0;let t=S(xi.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new es({callback:this._processTick.bind(this),context:this.context,frequency:0,units:\"bpm\"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),yt(this,\"bpm\"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(xe.getDefaults(),{bpm:120,loopEnd:\"4m\",loopStart:0,ppq:192,swing:0,swingSubdivision:\"8n\",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)\u0026\u0026e\u003e=this._loopEnd\u0026\u0026(this.emit(\"loopEnd\",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit(\"loopStart\",t,this._clock.getSecondsAtTime(t)),this.emit(\"loop\",t)),this._swingAmount\u003e0\u0026\u0026e%this._ppq!=0\u0026\u0026e%(2*this._swingTicks)!=0){let n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new Xt(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,n=\u003en.invoke(t))}schedule(t,e){let n=new Wn(this,{callback:t,time:new me(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){let c=new pa(this,{callback:t,duration:new Xe(this.context,i).toTicks(),interval:new Xe(this.context,e).toTicks(),time:new me(this.context,n).toTicks()});return this._addEvent(c,this._repeatedEvents)}scheduleOnce(t,e){let n=new Wn(this,{callback:t,once:!0,time:new me(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){let e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){let e=this.toTicks(t);return this._timeline.forEachFrom(e,n=\u003ethis.clear(n.id)),this._repeatedEvents.forEachFrom(e,n=\u003ethis.clear(n.id)),this}_bindClockEvents(){this._clock.on(\"start\",(t,e)=\u003e{e=new Xt(this.context,e).toSeconds(),this.emit(\"start\",t,e)}),this._clock.on(\"stop\",t=\u003e{this.emit(\"stop\",t)}),this._clock.on(\"pause\",t=\u003e{this.emit(\"pause\",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return Ot(e)\u0026\u0026(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),this._clock.getStateAtTime(t)!==\"started\"?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Ae(t)\u0026\u0026(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Xe(this.context,this._loopStart,\"i\").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Xe(this.context,this._loopEnd,\"i\").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new Xt(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){let t=this.now(),e=this._clock.getTicksAtTime(t);return new Xt(this.context,e).toBarsBeatsSixteenths()}set position(t){let e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){let e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){let t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){let e=this.now();if(this.state===\"started\"){let n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit(\"stop\",i),this._clock.setTicksAtTime(t,i),this.emit(\"start\",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),this.state!==\"started\")return 0;{let e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){let i=this.now();if(t.getValueAtTime(i)!==0){let c=1/(60/this.bpm.getValueAtTime(i)/this.PPQ);e=t.getValueAtTime(i)/c}else e=0}let n=new ft(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e\u003e=0;e--){let n=this._syncedSignals[e];n.signal===t\u0026\u0026(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),_i(this,\"bpm\"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Ss.mixin(xi),sr(s=\u003e{s.transport=new xi({context:s})}),ir(s=\u003e{s.transport.dispose()});class ce extends ot{constructor(t){super(t),this.input=void 0,this._state=new Os(\"stopped\"),this._synced=!1,this._scheduled=[],this._syncedStart=Et,this._syncedStop=Et,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new yn({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,yt(this,\"volume\"),this.onstop=t.onstop}static getDefaults(){return Object.assign(ot.getDefaults(),{mute:!1,onstop:Et,volume:0})}get state(){return this._synced?this.context.transport.state===\"started\"?this._state.getValueAtTime(this.context.transport.seconds):\"stopped\":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=Ve(t)\u0026\u0026this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||this._state.getValueAtTime(i)!==\"started\")if(this.log(\"start\",i),this._state.setStateAtTime(\"started\",i),this._synced){let c=this._state.get(i);c\u0026\u0026(c.offset=this.toSeconds(en(e,0)),c.duration=n?this.toSeconds(n):void 0);let l=this.context.transport.schedule(h=\u003e{this._start(h,e,n)},i);this._scheduled.push(l),this.context.transport.state===\"started\"\u0026\u0026this.context.transport.getSecondsAtTime(this.immediate())\u003ei\u0026\u0026this._syncedStart(this.now(),this.context.transport.seconds)}else ra(this.context),this._start(i,e,n);else mt(nr(i,this._state.get(i).time),\"Start time must be strictly greater than previous start time\"),this._state.cancel(i),this._state.setStateAtTime(\"started\",i),this.log(\"restart\",i),this.restart(i,e,n);return this}stop(t){let e=Ve(t)\u0026\u0026this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),this._state.getValueAtTime(e)===\"started\"||Ot(this._state.getNextState(\"started\",e))){if(this.log(\"stop\",e),this._synced){let n=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(n)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime(\"stopped\",e)}return this}restart(t,e,n){return t=this.toSeconds(t),this._state.getValueAtTime(t)===\"started\"\u0026\u0026(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=\u003e{if(e\u003e0){let n=this._state.get(e);if(n\u0026\u0026n.state===\"started\"\u0026\u0026n.time!==e){let i=e-this.toSeconds(n.time),c;n.duration\u0026\u0026(c=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,c)}}},this._syncedStop=t=\u003e{let e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));this._state.getValueAtTime(e)===\"started\"\u0026\u0026this._stop(t)},this.context.transport.on(\"start\",this._syncedStart),this.context.transport.on(\"loopStart\",this._syncedStart),this.context.transport.on(\"stop\",this._syncedStop),this.context.transport.on(\"pause\",this._syncedStop),this.context.transport.on(\"loopEnd\",this._syncedStop)),this}unsync(){return this._synced\u0026\u0026(this.context.transport.off(\"stop\",this._syncedStop),this.context.transport.off(\"pause\",this._syncedStop),this.context.transport.off(\"loopEnd\",this._syncedStop),this.context.transport.off(\"start\",this._syncedStart),this.context.transport.off(\"loopStart\",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=\u003ethis.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Et,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class On extends Ds{constructor(){super(S(On.getDefaults(),arguments,[\"url\",\"onload\"])),this.name=\"ToneBufferSource\",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let t=S(On.getDefaults(),arguments,[\"url\",\"onload\"]);Le(this._source,this._gainNode),this._source.onended=()=\u003ethis._stopSource(),this.playbackRate=new St({context:this.context,param:this._source.playbackRate,units:\"positive\",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Rt(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Ds.getDefaults(),{url:new Rt,loop:!1,loopEnd:0,loopStart:0,onload:Et,onerror:Et,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){mt(this.buffer.loaded,\"buffer is either not set or not loaded\");let c=this.toSeconds(t);this._startGain(c,i),e=this.loop?en(e,this.loopStart):en(e,0);let l=Math.max(this.toSeconds(e),0);if(this.loop){let h=this.toSeconds(this.loopEnd)||this.buffer.duration,p=this.toSeconds(this.loopStart),f=h-p;ca(l,h)\u0026\u0026(l=(l-p)%f+p),ln(l,this.buffer.duration)\u0026\u0026(l=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Zc(l,this.buffer.duration)\u0026\u0026(this._sourceStarted=!0,this._source.start(c,l)),Ot(n)){let h=this.toSeconds(n);h=Math.max(h,0),this.stop(c+h)}return this}_stopSource(t){!this._sourceStopped\u0026\u0026this._sourceStarted\u0026\u0026(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted\u0026\u0026this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class Dn extends ce{constructor(){super(S(Dn.getDefaults(),arguments,[\"type\"])),this.name=\"Noise\",this._source=null;let t=S(Dn.getDefaults(),arguments,[\"type\"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ce.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:\"white\"})}get type(){return this._type}set type(t){if(mt(t in su,\"Noise: invalid type: \"+t),this._type!==t\u0026\u0026(this._type=t,this.state===\"started\")){let e=this.now();this._stop(e),this._start(e)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source\u0026\u0026(this._source.playbackRate.value=t)}_start(t){let e=su[this._type];this._source=new On({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=\u003ethis.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source\u0026\u0026(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source\u0026\u0026(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source\u0026\u0026(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source\u0026\u0026this._source.disconnect(),this}}let Pn={brown:null,pink:null,white:null},su={get brown(){if(!Pn.brown){let s=[];for(let t=0;t\u003c2;t++){let e=new Float32Array(220500);s[t]=e;let n=0;for(let i=0;i\u003c220500;i++){let c=2*Math.random()-1;e[i]=(n+.02*c)/1.02,n=e[i],e[i]*=3.5}}Pn.brown=new Rt().fromArray(s)}return Pn.brown},get pink(){if(!Pn.pink){let s=[];for(let t=0;t\u003c2;t++){let e=new Float32Array(220500),n,i,c,l,h,p,f;s[t]=e,n=i=c=l=h=p=f=0;for(let y=0;y\u003c220500;y++){let g=2*Math.random()-1;n=.99886*n+.0555179*g,i=.99332*i+.0750759*g,c=.969*c+.153852*g,l=.8665*l+.3104856*g,h=.55*h+.5329522*g,p=-.7616*p-.016898*g,e[y]=n+i+c+l+h+p+f+.5362*g,e[y]*=.11,f=.115926*g}}Pn.pink=new Rt().fromArray(s)}return Pn.pink},get white(){if(!Pn.white){let s=[];for(let t=0;t\u003c2;t++){let e=new Float32Array(220500);s[t]=e;for(let n=0;n\u003c220500;n++)e[n]=2*Math.random()-1}Pn.white=new Rt().fromArray(s)}return Pn.white}};class Ns extends ot{constructor(){super(S(Ns.getDefaults(),arguments,[\"volume\"])),this.name=\"UserMedia\";let t=S(Ns.getDefaults(),arguments,[\"volume\"]);this._volume=this.output=new yn({context:this.context,volume:t.volume}),this.volume=this._volume.volume,yt(this,\"volume\"),this.mute=t.mute}static getDefaults(){return Object.assign(ot.getDefaults(),{mute:!1,volume:0})}open(t){return Yt(this,void 0,void 0,function*(){mt(Ns.supported,\"UserMedia is not supported\"),this.state===\"started\"\u0026\u0026this.close();let e=yield Ns.enumerateDevices();Ye(t)?this._device=e[t]:(this._device=e.find(c=\u003ec.label===t||c.deviceId===t),!this._device\u0026\u0026e.length\u003e0\u0026\u0026(this._device=e[0]),mt(Ot(this._device),\"No matching device \"+t));let n={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device\u0026\u0026(n.audio.deviceId=this._device.deviceId);let i=yield navigator.mediaDevices.getUserMedia(n);if(!this._stream){this._stream=i;let c=this.context.createMediaStreamSource(i);Le(c,this.output),this._mediaStream=c}return this})}close(){return this._stream\u0026\u0026this._mediaStream\u0026\u0026(this._stream.getAudioTracks().forEach(t=\u003e{t.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return Yt(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(t=\u003et.kind===\"audioinput\")})}get state(){return this._stream\u0026\u0026this._stream.active?\"started\":\"stopped\"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return Ot(navigator.mediaDevices)\u0026\u0026Ot(navigator.mediaDevices.getUserMedia)}}function ns(s,t){return Yt(this,void 0,void 0,function*(){let e=t/s.context.sampleRate,n=new Ms(1,e,s.context.sampleRate);return new s.constructor(Object.assign(s.get(),{frequency:2/e,detune:0,context:n})).toDestination().start(0),(yield n.render()).getChannelData(0)})}class qs extends Ds{constructor(){super(S(qs.getDefaults(),arguments,[\"frequency\",\"type\"])),this.name=\"ToneOscillatorNode\",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let t=S(qs.getDefaults(),arguments,[\"frequency\",\"type\"]);Le(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new St({context:this.context,param:this._oscillator.frequency,units:\"frequency\",value:t.frequency}),this.detune=new St({context:this.context,param:this._oscillator.detune,units:\"cents\",value:t.detune}),yt(this,[\"frequency\",\"detune\"])}static getDefaults(){return Object.assign(Ds.getDefaults(),{detune:0,frequency:440,type:\"sine\"})}start(t){let e=this.toSeconds(t);return this.log(\"start\",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),this.state===\"started\"\u0026\u0026this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class te extends ce{constructor(){super(S(te.getDefaults(),arguments,[\"frequency\",\"type\"])),this.name=\"Oscillator\",this._oscillator=null;let t=S(te.getDefaults(),arguments,[\"frequency\",\"type\"]);this.frequency=new wt({context:this.context,units:\"frequency\",value:t.frequency}),yt(this,\"frequency\"),this.detune=new wt({context:this.context,units:\"cents\",value:t.detune}),yt(this,\"detune\"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount\u0026\u0026t.type!==\"custom\"\u0026\u0026(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(ce.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:\"sine\"})}_start(t){let e=this.toSeconds(t),n=new qs({context:this.context,onended:()=\u003ethis.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){let e=this.toSeconds(t);this._oscillator\u0026\u0026this._oscillator.stop(e)}_restart(t){let e=this.toSeconds(t);return this.log(\"restart\",e),this._oscillator\u0026\u0026this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type===\"custom\")return te._periodicWaveCache.find(t=\u003e{return t.phase===this._phase\u0026\u0026(e=t.partials,n=this._partials,e.length===n.length\u0026\u0026e.every((i,c)=\u003en[c]===i));var e,n});{let t=te._periodicWaveCache.find(e=\u003ee.type===this._type\u0026\u0026e.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;let e=[\"sine\",\"square\",\"sawtooth\",\"triangle\"].indexOf(t)!==-1;if(this._phase===0\u0026\u0026e)this._wave=void 0,this._partialCount=0,this._oscillator!==null\u0026\u0026(this._oscillator.type=t);else{let n=this._getCachedPeriodicWave();if(Ot(n)){let{partials:i,wave:c}=n;this._wave=c,this._partials=i,this._oscillator!==null\u0026\u0026this._oscillator.setPeriodicWave(this._wave)}else{let[i,c]=this._getRealImaginary(t,this._phase),l=this.context.createPeriodicWave(i,c);this._wave=l,this._oscillator!==null\u0026\u0026this._oscillator.setPeriodicWave(this._wave),te._periodicWaveCache.push({imag:c,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:i,type:this._type,wave:this._wave}),te._periodicWaveCache.length\u003e100\u0026\u0026te._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),\"\")}set baseType(t){this.partialCount\u0026\u0026this._type!==\"custom\"\u0026\u0026t!==\"custom\"?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Me(t,0);let e=this._type,n=/^(sine|triangle|square|sawtooth)(\\d+)$/.exec(this._type);if(n\u0026\u0026(e=n[1]),this._type!==\"custom\")this.type=t===0?e:e+t.toString();else{let i=new Float32Array(t);this._partials.forEach((c,l)=\u003ei[l]=c),this._partials=Array.from(i),this.type=this._type}}_getRealImaginary(t,e){let n=2048,i=new Float32Array(n),c=new Float32Array(n),l=1;if(t===\"custom\"){if(l=this._partials.length+1,this._partialCount=this._partials.length,n=l,this._partials.length===0)return[i,c]}else{let h=/^(sine|triangle|square|sawtooth)(\\d+)$/.exec(t);h?(l=parseInt(h[2],10)+1,this._partialCount=parseInt(h[2],10),t=h[1],l=Math.max(l,2),n=l):this._partialCount=0,this._partials=[]}for(let h=1;h\u003cn;++h){let p=2/(h*Math.PI),f;switch(t){case\"sine\":f=h\u003c=l?1:0,this._partials[h-1]=f;break;case\"square\":f=1\u0026h?2*p:0,this._partials[h-1]=f;break;case\"sawtooth\":f=p*(1\u0026h?1:-1),this._partials[h-1]=f;break;case\"triangle\":f=1\u0026h?p*p*2*(h-1\u003e\u003e1\u00261?-1:1):0,this._partials[h-1]=f;break;case\"custom\":f=this._partials[h-1];break;default:throw new TypeError(\"Oscillator: invalid type: \"+t)}f!==0?(i[h]=-f*Math.sin(e*h),c[h]=f*Math.cos(e*h)):(i[h]=0,c[h]=0)}return[i,c]}_inverseFFT(t,e,n){let i=0,c=t.length;for(let l=0;l\u003cc;l++)i+=t[l]*Math.cos(l*n)+e[l]*Math.sin(l*n);return i}getInitialValue(){let[t,e]=this._getRealImaginary(this._type,0),n=0,i=2*Math.PI;for(let c=0;c\u003c32;c++)n=Math.max(this._inverseFFT(t,e,c/32*i),n);return Kc(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length\u0026\u0026(this.type=\"custom\")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return Yt(this,void 0,void 0,function*(){return ns(this,t)})}dispose(){return super.dispose(),this._oscillator!==null\u0026\u0026this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}te._periodicWaveCache=[];class Ze extends ot{constructor(){super(Object.assign(S(Ze.getDefaults(),arguments,[\"context\"])))}connect(t,e=0,n=0){return wi(this,t,e,n),this}}class nn extends Ze{constructor(){super(Object.assign(S(nn.getDefaults(),arguments,[\"mapping\",\"length\"]))),this.name=\"WaveShaper\",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let t=S(nn.getDefaults(),arguments,[\"mapping\",\"length\"]);Ae(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):Xc(t.mapping)\u0026\u0026this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(wt.getDefaults(),{length:1024})}setMap(t,e=1024){let n=new Float32Array(e);for(let i=0,c=e;i\u003cc;i++){let l=i/(c-1)*2-1;n[i]=t(l,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){mt([\"none\",\"2x\",\"4x\"].some(e=\u003ee.includes(t)),\"oversampling must be either 'none', '2x', or '4x'\"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class dr extends Ze{constructor(){super(...arguments),this.name=\"AudioToGain\",this._norm=new nn({context:this.context,mapping:t=\u003e(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class ee extends wt{constructor(){super(Object.assign(S(ee.getDefaults(),arguments,[\"value\"]))),this.name=\"Multiply\",this.override=!1;let t=S(ee.getDefaults(),arguments,[\"value\"]);this._mult=this.input=this.output=new ft({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(wt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Is extends ce{constructor(){super(S(Is.getDefaults(),arguments,[\"frequency\",\"type\",\"modulationType\"])),this.name=\"AMOscillator\",this._modulationScale=new dr({context:this.context}),this._modulationNode=new ft({context:this.context});let t=S(Is.getDefaults(),arguments,[\"frequency\",\"type\",\"modulationType\"]);this._carrier=new te({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=\u003ethis.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new te({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ee({context:this.context,units:\"positive\",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),yt(this,[\"frequency\",\"detune\",\"harmonicity\"])}static getDefaults(){return Object.assign(te.getDefaults(),{harmonicity:1,modulationType:\"square\"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Yt(this,void 0,void 0,function*(){return ns(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class ss extends ce{constructor(){super(S(ss.getDefaults(),arguments,[\"frequency\",\"type\",\"modulationType\"])),this.name=\"FMOscillator\",this._modulationNode=new ft({context:this.context,gain:0});let t=S(ss.getDefaults(),arguments,[\"frequency\",\"type\",\"modulationType\"]);this._carrier=new te({context:this.context,detune:t.detune,frequency:0,onstop:()=\u003ethis.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new wt({context:this.context,units:\"frequency\",value:t.frequency}),this._modulator=new te({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ee({context:this.context,units:\"positive\",value:t.harmonicity}),this.modulationIndex=new ee({context:this.context,units:\"positive\",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),yt(this,[\"modulationIndex\",\"frequency\",\"detune\",\"harmonicity\"])}static getDefaults(){return Object.assign(te.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:\"square\"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Yt(this,void 0,void 0,function*(){return ns(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class is extends ce{constructor(){super(S(is.getDefaults(),arguments,[\"frequency\",\"width\"])),this.name=\"PulseOscillator\",this._widthGate=new ft({context:this.context,gain:0}),this._thresh=new nn({context:this.context,mapping:e=\u003ee\u003c=0?-1:1});let t=S(is.getDefaults(),arguments,[\"frequency\",\"width\"]);this.width=new wt({context:this.context,units:\"audioRange\",value:t.width}),this._triangle=new te({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=\u003ethis.onstop(this),phase:t.phase,type:\"triangle\"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),yt(this,[\"width\",\"frequency\",\"detune\"])}static getDefaults(){return Object.assign(ce.getDefaults(),{detune:0,frequency:440,phase:0,type:\"pulse\",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return\"pulse\"}get baseType(){return\"pulse\"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return Yt(this,void 0,void 0,function*(){return ns(this,t)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class js extends ce{constructor(){super(S(js.getDefaults(),arguments,[\"frequency\",\"type\",\"spread\"])),this.name=\"FatOscillator\",this._oscillators=[];let t=S(js.getDefaults(),arguments,[\"frequency\",\"type\",\"spread\"]);this.frequency=new wt({context:this.context,units:\"frequency\",value:t.frequency}),this.detune=new wt({context:this.context,units:\"cents\",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,yt(this,[\"frequency\",\"detune\"])}static getDefaults(){return Object.assign(te.getDefaults(),{count:3,spread:20,type:\"sawtooth\"})}_start(t){t=this.toSeconds(t),this._forEach(e=\u003ee.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=\u003ee.stop(t))}_restart(t){this._forEach(e=\u003ee.restart(t))}_forEach(t){for(let e=0;e\u003cthis._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=\u003ee.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length\u003e1){let e=-t/2,n=t/(this._oscillators.length-1);this._forEach((i,c)=\u003ei.detune.value=e+n*c)}}get count(){return this._oscillators.length}set count(t){if(Me(t,1),this._oscillators.length!==t){this._forEach(e=\u003ee.dispose()),this._oscillators=[];for(let e=0;e\u003ct;e++){let n=new te({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:e===0?()=\u003ethis.onstop(this):Et});this.type===\"custom\"\u0026\u0026(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,this.state===\"started\"\u0026\u0026this._forEach(e=\u003ee.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((e,n)=\u003ee.phase=this._phase+n/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=\u003ee.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length\u0026\u0026(this._type=\"custom\",this._forEach(e=\u003ee.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=\u003ee.partialCount=t),this._type=this._oscillators[0].type}asArray(t=1024){return Yt(this,void 0,void 0,function*(){return ns(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=\u003et.dispose()),this}}class Rs extends ce{constructor(){super(S(Rs.getDefaults(),arguments,[\"frequency\",\"modulationFrequency\"])),this.name=\"PWMOscillator\",this.sourceType=\"pwm\",this._scale=new ee({context:this.context,value:2});let t=S(Rs.getDefaults(),arguments,[\"frequency\",\"modulationFrequency\"]);this._pulse=new is({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType=\"sine\",this.modulationFrequency=this._pulse.frequency,this._modulator=new te({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=\u003ethis.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),yt(this,[\"modulationFrequency\",\"frequency\",\"detune\"])}static getDefaults(){return Object.assign(ce.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:\"pwm\"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return\"pwm\"}get baseType(){return\"pwm\"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return Yt(this,void 0,void 0,function*(){return ns(this,t)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}let iu={am:Is,fat:js,fm:ss,oscillator:te,pulse:is,pwm:Rs};class bn extends ce{constructor(){super(S(bn.getDefaults(),arguments,[\"frequency\",\"type\"])),this.name=\"OmniOscillator\";let t=S(bn.getDefaults(),arguments,[\"frequency\",\"type\"]);this.frequency=new wt({context:this.context,units:\"frequency\",value:t.frequency}),this.detune=new wt({context:this.context,units:\"cents\",value:t.detune}),yt(this,[\"frequency\",\"detune\"]),this.set(t)}static getDefaults(){return Object.assign(te.getDefaults(),ss.getDefaults(),Is.getDefaults(),js.getDefaults(),is.getDefaults(),Rs.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t=\"\";return[\"am\",\"fm\",\"fat\"].some(e=\u003ethis._sourceType===e)\u0026\u0026(t=this._sourceType),t+this._oscillator.type}set type(t){t.substr(0,2)===\"fm\"?(this._createNewOscillator(\"fm\"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,2)===\"am\"?(this._createNewOscillator(\"am\"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,3)===\"fat\"?(this._createNewOscillator(\"fat\"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):t===\"pwm\"?(this._createNewOscillator(\"pwm\"),this._oscillator=this._oscillator):t===\"pulse\"?this._createNewOscillator(\"pulse\"):(this._createNewOscillator(\"oscillator\"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,\"pulse\")||this._getOscType(this._oscillator,\"pwm\")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,\"pulse\")||this._getOscType(this._oscillator,\"pwm\")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,\"type\")\u0026\u0026t.type\u0026\u0026(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;let e=iu[t],n=this.now();if(this._oscillator){let i=this._oscillator;i.stop(n),this.context.setTimeout(()=\u003ei.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=\u003ethis.onstop(this),this.state===\"started\"\u0026\u0026this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e=\"sine\";this._oscillator.type!==\"pwm\"\u0026\u0026this._oscillator.type!==\"pulse\"\u0026\u0026(e=this._oscillator.type),t===\"fm\"?this.type=\"fm\"+e:t===\"am\"?this.type=\"am\"+e:t===\"fat\"?this.type=\"fat\"+e:t===\"oscillator\"?this.type=e:t===\"pulse\"?this.type=\"pulse\":t===\"pwm\"\u0026\u0026(this.type=\"pwm\")}_getOscType(t,e){return t instanceof iu[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,\"pulse\")||this._getOscType(this._oscillator,\"pwm\")||t===\"pulse\"||t===\"pwm\"||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,\"pulse\")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,\"fat\")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,\"fat\")\u0026\u0026Ye(t)\u0026\u0026(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,\"fat\")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,\"fat\")\u0026\u0026Ye(t)\u0026\u0026(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,\"fm\")||this._getOscType(this._oscillator,\"am\")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,\"fm\")||this._getOscType(this._oscillator,\"am\"))\u0026\u0026Je(t)\u0026\u0026(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,\"fm\")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,\"fm\")||this._getOscType(this._oscillator,\"am\")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,\"pwm\")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return Yt(this,void 0,void 0,function*(){return ns(this,t)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class rs extends wt{constructor(){super(Object.assign(S(rs.getDefaults(),arguments,[\"value\"]))),this.override=!1,this.name=\"Add\",this._sum=new ft({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Qe(this._constantSource,this._sum)}static getDefaults(){return Object.assign(wt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class wn extends Ze{constructor(){super(Object.assign(S(wn.getDefaults(),arguments,[\"min\",\"max\"]))),this.name=\"Scale\";let t=S(wn.getDefaults(),arguments,[\"min\",\"max\"]);this._mult=this.input=new ee({context:this.context,value:t.max-t.min}),this._add=this.output=new rs({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Ze.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class pr extends Ze{constructor(){super(Object.assign(S(pr.getDefaults(),arguments))),this.name=\"Zero\",this._gain=new ft({context:this.context}),this.output=this._gain,this.input=void 0,Le(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),da(this.context.getConstant(0),this._gain),this}}class Ne extends ot{constructor(){super(S(Ne.getDefaults(),arguments,[\"frequency\",\"min\",\"max\"])),this.name=\"LFO\",this._stoppedValue=0,this._units=\"number\",this.convert=!0,this._fromType=St.prototype._fromType,this._toType=St.prototype._toType,this._is=St.prototype._is,this._clampValue=St.prototype._clampValue;let t=S(Ne.getDefaults(),arguments,[\"frequency\",\"min\",\"max\"]);this._oscillator=new te(t),this.frequency=this._oscillator.frequency,this._amplitudeGain=new ft({context:this.context,gain:t.amplitude,units:\"normalRange\"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new wt({context:this.context,units:\"audioRange\",value:0}),this._zeros=new pr({context:this.context}),this._a2g=new dr({context:this.context}),this._scaler=this.output=new wn({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),yt(this,[\"amplitude\",\"frequency\"]),this.phase=t.phase}static getDefaults(){return Object.assign(te.getDefaults(),{amplitude:1,frequency:\"4n\",max:1,min:0,type:\"sine\",units:\"number\"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(t){this._oscillator.partials=t,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._setStoppedValue()}get units(){return this._units}set units(t){let e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}get state(){return this._oscillator.state}connect(t,e,n){return(t instanceof St||t instanceof wt)\u0026\u0026(this.convert=t.convert,this.units=t.units),wi(this,t,e,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function ru(s,t=1/0){let e=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(c){Me(c,s,t),e.set(this,c)}})}}function En(s,t=1/0){let e=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(c){Me(this.toSeconds(c),s,t),e.set(this,c)}})}}class os extends ce{constructor(){super(S(os.getDefaults(),arguments,[\"url\",\"onload\"])),this.name=\"Player\",this._activeSources=new Set;let t=S(os.getDefaults(),arguments,[\"url\",\"onload\"]);this._buffer=new Rt({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ce.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Et,onerror:Et,playbackRate:1,reverse:!1})}load(t){return Yt(this,void 0,void 0,function*(){return yield this._buffer.load(t),this._onload(),this})}_onload(t=Et){t(),this.autostart\u0026\u0026this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),this._activeSources.size!==0||this._synced||this._state.getValueAtTime(this.now())!==\"started\"||(this._state.cancel(this.now()),this._state.setStateAtTime(\"stopped\",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?en(e,this._loopStart):en(e,0);let i=this.toSeconds(e),c=n;n=en(n,Math.max(this._buffer.duration-i,0));let l=this.toSeconds(n);l/=this._playbackRate,t=this.toSeconds(t);let h=new On({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+l),this._state.setStateAtTime(\"stopped\",t+l,{implicitEnd:!0})),this._activeSources.add(h),this._loop\u0026\u0026Ve(c)?h.start(t,i):h.start(t,i,l-this.toSeconds(this.fadeOut))}_stop(t){let e=this.toSeconds(t);this._activeSources.forEach(n=\u003en.stop(e))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){let n=this.toSeconds(e);if(this._state.getValueAtTime(n)===\"started\"){let i=this.toSeconds(t);this._stop(n),this._start(n,i)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded\u0026\u0026Me(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=\u003e{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded\u0026\u0026Me(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=\u003e{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t\u0026\u0026(this._loop=t,this._activeSources.forEach(e=\u003e{e.loop=t}),t)){let e=this._state.getNextState(\"stopped\",this.now());e\u0026\u0026this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;let e=this.now(),n=this._state.getNextState(\"stopped\",e);n\u0026\u0026n.implicitEnd\u0026\u0026(this._state.cancel(n.time),this._activeSources.forEach(i=\u003ei.cancelStop())),this._activeSources.forEach(i=\u003e{i.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=\u003et.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}un([En(0)],os.prototype,\"fadeIn\",void 0),un([En(0)],os.prototype,\"fadeOut\",void 0);class fr extends ot{constructor(){super(S(fr.getDefaults(),arguments,[\"urls\",\"onload\"],\"urls\")),this.name=\"Players\",this.input=void 0,this._players=new Map;let t=S(fr.getDefaults(),arguments,[\"urls\",\"onload\"],\"urls\");this._volume=this.output=new yn({context:this.context,volume:t.volume}),this.volume=this._volume.volume,yt(this,\"volume\"),this._buffers=new Ps({urls:t.urls,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.mute=t.mute,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ce.getDefaults(),{baseUrl:\"\",fadeIn:0,fadeOut:0,mute:!1,onload:Et,onerror:Et,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._players.forEach(e=\u003e{e.fadeIn=t})}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._players.forEach(e=\u003e{e.fadeOut=t})}get state(){return Array.from(this._players).some(([t,e])=\u003ee.state===\"started\")?\"started\":\"stopped\"}has(t){return this._buffers.has(t)}player(t){if(mt(this.has(t),`No Player with the name ${t} exists on this object`),!this._players.has(t)){let e=new os({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}get loaded(){return this._buffers.loaded}add(t,e,n){return mt(!this._buffers.has(t),\"A buffer with that name already exists on this object\"),this._buffers.add(t,e,n),this}stopAll(t){return this._players.forEach(e=\u003ee.stop(t)),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach(t=\u003et.dispose()),this._buffers.dispose(),this}}class mr extends ce{constructor(){super(S(mr.getDefaults(),arguments,[\"url\",\"onload\"])),this.name=\"GrainPlayer\",this._loopStart=0,this._loopEnd=0,this._activeSources=[];let t=S(mr.getDefaults(),arguments,[\"url\",\"onload\"]);this.buffer=new Rt({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new es({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on(\"stop\",this._onstop.bind(this))}static getDefaults(){return Object.assign(ce.getDefaults(),{onload:Et,onerror:Et,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,n){e=en(e,0),e=this.toSeconds(e),t=this.toSeconds(t);let i=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/i),n\u0026\u0026this.stop(t+this.toSeconds(n))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach(e=\u003e{e.fadeOut=0,e.stop(t)}),this.onstop(this)}_tick(t){let e=this._clock.getTicksAtTime(t),n=e*this._grainSize;if(this.log(\"offset\",n),!this.loop\u0026\u0026n\u003ethis.buffer.duration)return void this.stop(t);let i=n\u003cthis._overlap?0:this._overlap,c=new On({context:this.context,url:this.buffer,fadeIn:i,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:Cs(this.detune/100)}).connect(this.output);c.start(t,this._grainSize*e),c.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(c),c.onended=()=\u003e{let l=this._activeSources.indexOf(c);l!==-1\u0026\u0026this._activeSources.splice(l,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){Me(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded\u0026\u0026Me(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded\u0026\u0026Me(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){let e=this.toSeconds(t);Me(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(t=\u003et.dispose()),this}}class ou extends Ze{constructor(){super(...arguments),this.name=\"Abs\",this._abs=new nn({context:this.context,mapping:t=\u003eMath.abs(t)\u003c.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class au extends Ze{constructor(){super(...arguments),this.name=\"GainToAudio\",this._norm=new nn({context:this.context,mapping:t=\u003e2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class fa extends Ze{constructor(){super(...arguments),this.name=\"Negate\",this._multiply=new ee({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class as extends wt{constructor(){super(Object.assign(S(as.getDefaults(),arguments,[\"value\"]))),this.override=!1,this.name=\"Subtract\",this._sum=new ft({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new fa({context:this.context}),this.subtrahend=this._param,Qe(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(wt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class gr extends Ze{constructor(){super(Object.assign(S(gr.getDefaults(),arguments))),this.name=\"GreaterThanZero\",this._thresh=this.output=new nn({context:this.context,length:127,mapping:t=\u003et\u003c=0?0:1}),this._scale=this.input=new ee({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class Ti extends wt{constructor(){super(Object.assign(S(Ti.getDefaults(),arguments,[\"value\"]))),this.name=\"GreaterThan\",this.override=!1;let t=S(Ti.getDefaults(),arguments,[\"value\"]);this._subtract=this.input=new as({context:this.context,value:t.value}),this._gtz=this.output=new gr({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,yt(this,\"comparator\"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(wt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class Fs extends Ze{constructor(){super(Object.assign(S(Fs.getDefaults(),arguments,[\"value\"]))),this.name=\"Pow\";let t=S(Fs.getDefaults(),arguments,[\"value\"]);this._exponentScaler=this.input=this.output=new nn({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(Ze.getDefaults(),{value:1})}_expFunc(t){return e=\u003eMath.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Si extends wn{constructor(){super(Object.assign(S(Si.getDefaults(),arguments,[\"min\",\"max\",\"exponent\"]))),this.name=\"ScaleExp\";let t=S(Si.getDefaults(),arguments,[\"min\",\"max\",\"exponent\"]);this.input=this._exp=new Fs({context:this.context,value:t.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(wn.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(t){this._exp.value=t}dispose(){return super.dispose(),this._exp.dispose(),this}}class kd extends wt{constructor(){super(S(wt.getDefaults(),arguments,[\"value\",\"units\"])),this.name=\"SyncedSignal\",this.override=!1;let t=S(wt.getDefaults(),arguments,[\"value\",\"units\"]);this._lastVal=t.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),\"1i\"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on(\"start\",this._syncedCallback),this.context.transport.on(\"pause\",this._syncedCallback),this.context.transport.on(\"stop\",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new bi({context:this.context,offset:t.value,units:t.units}).start(0),this.setValueAtTime(t.value,0)}_onTick(t){let e=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==e\u0026\u0026(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}_anchorValue(t){let e=super.getValueAtTime(this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}getValueAtTime(t){let e=new me(this.context,t).toSeconds();return super.getValueAtTime(e)}setValueAtTime(t,e){let n=new me(this.context,e).toSeconds();return super.setValueAtTime(t,n),this}linearRampToValueAtTime(t,e){let n=new me(this.context,e).toSeconds();return super.linearRampToValueAtTime(t,n),this}exponentialRampToValueAtTime(t,e){let n=new me(this.context,e).toSeconds();return super.exponentialRampToValueAtTime(t,n),this}setTargetAtTime(t,e,n){let i=new me(this.context,e).toSeconds();return super.setTargetAtTime(t,i,n),this}cancelScheduledValues(t){let e=new me(this.context,t).toSeconds();return super.cancelScheduledValues(e),this}setValueCurveAtTime(t,e,n,i){let c=new me(this.context,e).toSeconds();return n=this.toSeconds(n),super.setValueCurveAtTime(t,c,n,i),this}cancelAndHoldAtTime(t){let e=new me(this.context,t).toSeconds();return super.cancelAndHoldAtTime(e),this}setRampPoint(t){let e=new me(this.context,t).toSeconds();return super.setRampPoint(e),this}exponentialRampTo(t,e,n){let i=new me(this.context,n).toSeconds();return super.exponentialRampTo(t,e,i),this}linearRampTo(t,e,n){let i=new me(this.context,n).toSeconds();return super.linearRampTo(t,e,i),this}targetRampTo(t,e,n){let i=new me(this.context,n).toSeconds();return super.targetRampTo(t,e,i),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off(\"start\",this._syncedCallback),this.context.transport.off(\"pause\",this._syncedCallback),this.context.transport.off(\"stop\",this._syncedCallback),this._constantSource.dispose(),this}}class Te extends ot{constructor(){super(S(Te.getDefaults(),arguments,[\"attack\",\"decay\",\"sustain\",\"release\"])),this.name=\"Envelope\",this._sig=new wt({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let t=S(Te.getDefaults(),arguments,[\"attack\",\"decay\",\"sustain\",\"release\"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(ot.getDefaults(),{attack:.01,attackCurve:\"linear\",decay:.1,decayCurve:\"exponential\",release:1,releaseCurve:\"exponential\",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Je(t))return t;{let n;for(n in vr)if(vr[n][e]===t)return n;return t}}_setCurve(t,e,n){if(Je(n)\u0026\u0026Reflect.has(vr,n)){let i=vr[n];Mn(i)?t!==\"_decayCurve\"\u0026\u0026(this[t]=i[e]):this[t]=i}else{if(!Ae(n)||t===\"_decayCurve\")throw new Error(\"Envelope: invalid curve: \"+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,\"In\")}set attackCurve(t){this._setCurve(\"_attackCurve\",\"In\",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,\"Out\")}set releaseCurve(t){this._setCurve(\"_releaseCurve\",\"Out\",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){mt([\"linear\",\"exponential\"].some(e=\u003ee===t),\"Invalid envelope curve: \"+t),this._decayCurve=t}triggerAttack(t,e=1){this.log(\"triggerAttack\",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack),i=this.toSeconds(this.decay),c=this.getValueAtTime(t);if(c\u003e0\u0026\u0026(n=(1-c)/(1/n)),n\u003cthis.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if(this._attackCurve===\"linear\")this._sig.linearRampTo(e,n,t);else if(this._attackCurve===\"exponential\")this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let l=this._attackCurve;for(let h=1;h\u003cl.length;h++)if(l[h-1]\u003c=c\u0026\u0026c\u003c=l[h]){l=this._attackCurve.slice(h),l[0]=c;break}this._sig.setValueCurveAtTime(l,t,n,e)}if(i\u0026\u0026this.sustain\u003c1){let l=e*this.sustain,h=t+n;this.log(\"decay\",h),this._decayCurve===\"linear\"?this._sig.linearRampToValueAtTime(l,i+h):this._sig.exponentialApproachValueAtTime(l,h,i)}return this}triggerRelease(t){this.log(\"triggerRelease\",t),t=this.toSeconds(t);let e=this.getValueAtTime(t);if(e\u003e0){let n=this.toSeconds(this.release);n\u003cthis.sampleTime?this._sig.setValueAtTime(0,t):this._releaseCurve===\"linear\"?this._sig.linearRampTo(0,n,t):this._releaseCurve===\"exponential\"?this._sig.targetRampTo(0,n,t):(mt(Ae(this._releaseCurve),\"releaseCurve must be either 'linear', 'exponential' or an array\"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return wi(this,t,e,n),this}asArray(t=1024){return Yt(this,void 0,void 0,function*(){let e=t/this.context.sampleRate,n=new Ms(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),c=i+this.toSeconds(this.release),l=.1*c,h=c+l,p=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/h,decay:e*this.toSeconds(this.decay)/h,release:e*this.toSeconds(this.release)/h,context:n}));return p._sig.toDestination(),p.triggerAttackRelease(e*(i+l)/h,0),(yield n.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}un([En(0)],Te.prototype,\"attack\",void 0),un([En(0)],Te.prototype,\"decay\",void 0),un([ru(0,1)],Te.prototype,\"sustain\",void 0),un([En(0)],Te.prototype,\"release\",void 0);let vr=(()=\u003e{let s,t,e=[];for(s=0;s\u003c128;s++)e[s]=Math.sin(s/127*(Math.PI/2));let n=[];for(s=0;s\u003c127;s++){t=s/127;let f=Math.sin(t*(2*Math.PI)*6.4-Math.PI/2)+1;n[s]=f/10+.83*t}n[127]=1;let i=[];for(s=0;s\u003c128;s++)i[s]=Math.ceil(s/127*5)/5;let c=[];for(s=0;s\u003c128;s++)t=s/127,c[s]=.5*(1-Math.cos(Math.PI*t));let l=[];for(s=0;s\u003c128;s++){t=s/127;let f=4*Math.pow(t,3)+.2,y=Math.cos(f*Math.PI*2*t);l[s]=Math.abs(y*(1-t))}function h(f){let y=new Array(f.length);for(let g=0;g\u003cf.length;g++)y[g]=1-f[g];return y}return{bounce:{In:h(l),Out:l},cosine:{In:e,Out:(p=e,p.slice(0).reverse())},exponential:\"exponential\",linear:\"linear\",ripple:{In:n,Out:h(n)},sine:{In:c,Out:h(c)},step:{In:i,Out:h(i)}};var p})();class Ke extends ot{constructor(){super(S(Ke.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;let t=S(Ke.getDefaults(),arguments);this._volume=this.output=new yn({context:this.context,volume:t.volume}),this.volume=this._volume.volume,yt(this,\"volume\")}static getDefaults(){return Object.assign(ot.getDefaults(),{volume:0})}sync(){return this._syncState()\u0026\u0026(this._syncMethod(\"triggerAttack\",1),this._syncMethod(\"triggerRelease\",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){let n=this[\"_original_\"+t]=this[t];this[t]=(...i)=\u003e{let c=i[e],l=this.context.transport.schedule(h=\u003e{i[e]=h,n.apply(this,i)},c);this._scheduledEvents.push(l)}}unsync(){return this._scheduledEvents.forEach(t=\u003ethis.context.transport.clear(t)),this._scheduledEvents=[],this._synced\u0026\u0026(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){let c=this.toSeconds(n),l=this.toSeconds(e);return this.triggerAttack(t,c,i),this.triggerRelease(c+l),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Oe extends Ke{constructor(){super(S(Oe.getDefaults(),arguments));let t=S(Oe.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Ke.getDefaults(),{detune:0,onsilence:Et,portamento:0})}triggerAttack(t,e,n=1){this.log(\"triggerAttack\",t,e,n);let i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log(\"triggerRelease\",t);let e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){let n=this.toSeconds(e),i=t instanceof Re?t.toFrequency():t;if(this.portamento\u003e0\u0026\u0026this.getLevelAtTime(n)\u003e.05){let c=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,c,n)}else this.frequency.setValueAtTime(i,n);return this}}un([En(0)],Oe.prototype,\"portamento\",void 0);class Vs extends Te{constructor(){super(S(Vs.getDefaults(),arguments,[\"attack\",\"decay\",\"sustain\",\"release\"])),this.name=\"AmplitudeEnvelope\",this._gainNode=new ft({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Nn extends Oe{constructor(){super(S(Nn.getDefaults(),arguments)),this.name=\"Synth\";let t=S(Nn.getDefaults(),arguments);this.oscillator=new bn(Object.assign({context:this.context,detune:t.detune,onstop:()=\u003ethis.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Vs(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),yt(this,[\"oscillator\",\"frequency\",\"detune\",\"envelope\"])}static getDefaults(){return Object.assign(Oe.getDefaults(),{envelope:Object.assign(Ce(Te.getDefaults(),Object.keys(ot.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ce(bn.getDefaults(),[...Object.keys(ce.getDefaults()),\"frequency\",\"detune\"]),{type:\"triangle\"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),this.envelope.sustain===0){let n=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+n+i)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Ls extends Oe{constructor(){super(S(Ls.getDefaults(),arguments)),this.name=\"ModulationSynth\";let t=S(Ls.getDefaults(),arguments);this._carrier=new Nn({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=\u003ethis.onsilence(this),volume:-10}),this._modulator=new Nn({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new wt({context:this.context,units:\"frequency\"}),this.detune=new wt({context:this.context,value:t.detune,units:\"cents\"}),this.harmonicity=new ee({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new ft({context:this.context,gain:0}),yt(this,[\"frequency\",\"harmonicity\",\"oscillator\",\"envelope\",\"modulation\",\"modulationEnvelope\",\"detune\"])}static getDefaults(){return Object.assign(Oe.getDefaults(),{harmonicity:3,oscillator:Object.assign(Ce(bn.getDefaults(),[...Object.keys(ce.getDefaults()),\"frequency\",\"detune\"]),{type:\"sine\"}),envelope:Object.assign(Ce(Te.getDefaults(),Object.keys(ot.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Ce(bn.getDefaults(),[...Object.keys(ce.getDefaults()),\"frequency\",\"detune\"]),{type:\"square\"}),modulationEnvelope:Object.assign(Ce(Te.getDefaults(),Object.keys(ot.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class ma extends Ls{constructor(){super(S(ma.getDefaults(),arguments)),this.name=\"AMSynth\",this._modulationScale=new dr({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class Ws extends ot{constructor(){super(S(Ws.getDefaults(),arguments,[\"frequency\",\"type\"])),this.name=\"BiquadFilter\";let t=S(Ws.getDefaults(),arguments,[\"frequency\",\"type\"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new St({context:this.context,units:\"number\",value:t.Q,param:this._filter.Q}),this.frequency=new St({context:this.context,units:\"frequency\",value:t.frequency,param:this._filter.frequency}),this.detune=new St({context:this.context,units:\"cents\",value:t.detune,param:this._filter.detune}),this.gain=new St({context:this.context,units:\"decibels\",convert:!1,value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(ot.getDefaults(),{Q:1,type:\"lowpass\",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){mt([\"lowpass\",\"highpass\",\"bandpass\",\"lowshelf\",\"highshelf\",\"notch\",\"allpass\",\"peaking\"].indexOf(t)!==-1,\"Invalid filter type: \"+t),this._filter.type=t}getFrequencyResponse(t=128){let e=new Float32Array(t);for(let l=0;l\u003ct;l++){let h=19980*Math.pow(l/t,2)+20;e[l]=h}let n=new Float32Array(t),i=new Float32Array(t),c=this.context.createBiquadFilter();return c.type=this.type,c.Q.value=this.Q.value,c.frequency.value=this.frequency.value,c.gain.value=this.gain.value,c.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class ze extends ot{constructor(){super(S(ze.getDefaults(),arguments,[\"frequency\",\"type\",\"rolloff\"])),this.name=\"Filter\",this.input=new ft({context:this.context}),this.output=new ft({context:this.context}),this._filters=[];let t=S(ze.getDefaults(),arguments,[\"frequency\",\"type\",\"rolloff\"]);this._filters=[],this.Q=new wt({context:this.context,units:\"positive\",value:t.Q}),this.frequency=new wt({context:this.context,units:\"frequency\",value:t.frequency}),this.detune=new wt({context:this.context,units:\"cents\",value:t.detune}),this.gain=new wt({context:this.context,units:\"decibels\",convert:!1,value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,yt(this,[\"detune\",\"frequency\",\"gain\",\"Q\"])}static getDefaults(){return Object.assign(ot.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:\"lowpass\"})}get type(){return this._type}set type(t){mt([\"lowpass\",\"highpass\",\"bandpass\",\"lowshelf\",\"highshelf\",\"notch\",\"allpass\",\"peaking\"].indexOf(t)!==-1,\"Invalid filter type: \"+t),this._type=t,this._filters.forEach(e=\u003ee.type=t)}get rolloff(){return this._rolloff}set rolloff(t){let e=Ye(t)?t:parseInt(t,10),n=[-12,-24,-48,-96],i=n.indexOf(e);mt(i!==-1,\"rolloff can only be \"+n.join(\", \")),i+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach(c=\u003ec.disconnect()),this._filters=new Array(i);for(let c=0;c\u003ci;c++){let l=new Ws({context:this.context});l.type=this._type,this.frequency.connect(l.frequency),this.detune.connect(l.detune),this.Q.connect(l.Q),this.gain.connect(l.gain),this._filters[c]=l}this._internalChannels=this._filters,Qe(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){let e=new Ws({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map(()=\u003e1);return this._filters.forEach(()=\u003e{e.getFrequencyResponse(t).forEach((i,c)=\u003en[c]*=i)}),e.dispose(),n}dispose(){return super.dispose(),this._filters.forEach(t=\u003e{t.dispose()}),_i(this,[\"detune\",\"frequency\",\"gain\",\"Q\"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class zs extends Te{constructor(){super(S(zs.getDefaults(),arguments,[\"attack\",\"decay\",\"sustain\",\"release\"])),this.name=\"FrequencyEnvelope\";let t=S(zs.getDefaults(),arguments,[\"attack\",\"decay\",\"sustain\",\"release\"]);this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new Fs({context:this.context,value:t.exponent}),this._scale=this.output=new wn({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(Te.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){let e=this.toFrequency(t);Me(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class zn extends Oe{constructor(){super(S(zn.getDefaults(),arguments)),this.name=\"MonoSynth\";let t=S(zn.getDefaults(),arguments);this.oscillator=new bn(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=\u003ethis.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new ze(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new zs(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new Vs(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),yt(this,[\"oscillator\",\"frequency\",\"detune\",\"filter\",\"filterEnvelope\",\"envelope\"])}static getDefaults(){return Object.assign(Oe.getDefaults(),{envelope:Object.assign(Ce(Te.getDefaults(),Object.keys(ot.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(Ce(ze.getDefaults(),Object.keys(ot.getDefaults())),{Q:1,rolloff:-12,type:\"lowpass\"}),filterEnvelope:Object.assign(Ce(zs.getDefaults(),Object.keys(ot.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(Ce(bn.getDefaults(),Object.keys(ce.getDefaults())),{type:\"sawtooth\"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),this.envelope.sustain===0){let n=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+n+i)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class _r extends Oe{constructor(){super(S(_r.getDefaults(),arguments)),this.name=\"DuoSynth\";let t=S(_r.getDefaults(),arguments);this.voice0=new zn(Object.assign(t.voice0,{context:this.context,onsilence:()=\u003ethis.onsilence(this)})),this.voice1=new zn(Object.assign(t.voice1,{context:this.context})),this.harmonicity=new ee({context:this.context,units:\"positive\",value:t.harmonicity}),this._vibrato=new Ne({frequency:t.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new ft({context:this.context,units:\"normalRange\",gain:t.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new wt({context:this.context,units:\"frequency\",value:440}),this.detune=new wt({context:this.context,units:\"cents\",value:t.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),yt(this,[\"voice0\",\"voice1\",\"frequency\",\"vibratoAmount\",\"vibratoRate\"])}getLevelAtTime(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}static getDefaults(){return tn(Oe.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:tn(Ce(zn.getDefaults(),Object.keys(Oe.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:tn(Ce(zn.getDefaults(),Object.keys(Oe.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class yr extends Ls{constructor(){super(S(yr.getDefaults(),arguments)),this.name=\"FMSynth\";let t=S(yr.getDefaults(),arguments);this.modulationIndex=new ee({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(Ls.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}let cu=[1,1.483,1.932,2.546,2.63,3.897];class br extends Oe{constructor(){super(S(br.getDefaults(),arguments)),this.name=\"MetalSynth\",this._oscillators=[],this._freqMultipliers=[];let t=S(br.getDefaults(),arguments);this.detune=new wt({context:this.context,units:\"cents\",value:t.detune}),this.frequency=new wt({context:this.context,units:\"frequency\"}),this._amplitude=new ft({context:this.context,gain:0}).connect(this.output),this._highpass=new ze({Q:0,context:this.context,type:\"highpass\"}).connect(this._amplitude);for(let e=0;e\u003ccu.length;e++){let n=new ss({context:this.context,harmonicity:t.harmonicity,modulationIndex:t.modulationIndex,modulationType:\"square\",onstop:e===0?()=\u003ethis.onsilence(this):Et,type:\"square\"});n.connect(this._highpass),this._oscillators[e]=n;let i=new ee({context:this.context,value:cu[e]});this._freqMultipliers[e]=i,this.frequency.chain(i,n.frequency),this.detune.connect(n.detune)}this._filterFreqScaler=new wn({context:this.context,max:7e3,min:this.toFrequency(t.resonance)}),this.envelope=new Te({attack:t.envelope.attack,attackCurve:\"linear\",context:this.context,decay:t.envelope.decay,release:t.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=t.octaves,this.octaves=t.octaves}static getDefaults(){return tn(Oe.getDefaults(),{envelope:Object.assign(Ce(Te.getDefaults(),Object.keys(ot.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(t,e=1){return this.envelope.triggerAttack(t,e),this._oscillators.forEach(n=\u003en.start(t)),this.envelope.sustain===0\u0026\u0026this._oscillators.forEach(n=\u003e{n.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(t){return this.envelope.triggerRelease(t),this._oscillators.forEach(e=\u003ee.stop(t+this.toSeconds(this.envelope.release))),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(t){this._oscillators.forEach(e=\u003ee.modulationIndex.value=t)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(t){this._oscillators.forEach(e=\u003ee.harmonicity.value=t)}get resonance(){return this._filterFreqScaler.min}set resonance(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}dispose(){return super.dispose(),this._oscillators.forEach(t=\u003et.dispose()),this._freqMultipliers.forEach(t=\u003et.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class Gs extends Nn{constructor(){super(S(Gs.getDefaults(),arguments)),this.name=\"MembraneSynth\",this.portamento=0;let t=S(Gs.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,yt(this,[\"oscillator\",\"envelope\"])}static getDefaults(){return tn(Oe.getDefaults(),Nn.getDefaults(),{envelope:{attack:.001,attackCurve:\"exponential\",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:\"sine\"},pitchDecay:.05})}setNote(t,e){let n=this.toSeconds(e),i=this.toFrequency(t instanceof Re?t.toFrequency():t),c=i*this.octaves;return this.oscillator.frequency.setValueAtTime(c,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}un([ru(0)],Gs.prototype,\"octaves\",void 0),un([En(0)],Gs.prototype,\"pitchDecay\",void 0);class wr extends Ke{constructor(){super(S(wr.getDefaults(),arguments)),this.name=\"NoiseSynth\";let t=S(wr.getDefaults(),arguments);this.noise=new Dn(Object.assign({context:this.context},t.noise)),this.envelope=new Vs(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(Ke.getDefaults(),{envelope:Object.assign(Ce(Te.getDefaults(),Object.keys(ot.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(Ce(Dn.getDefaults(),Object.keys(ce.getDefaults())),{type:\"white\"})})}triggerAttack(t,e=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),this.envelope.sustain===0\u0026\u0026this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()\u0026\u0026(this._syncMethod(\"triggerAttack\",0),this._syncMethod(\"triggerRelease\",0)),this}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,n),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}let ga=new Set;function va(s){ga.add(s)}function uu(s,t){let e=`registerProcessor(\"${s}\", ${t})`;ga.add(e)}class _a extends ot{constructor(t){super(t),this.name=\"ToneAudioWorklet\",this.workletOptions={},this.onprocessorerror=Et;let e=URL.createObjectURL(new Blob([Array.from(ga).join(`\n`)],{type:\"text/javascript\"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,n).then(()=\u003e{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet\u0026\u0026(this._worklet.port.postMessage(\"dispose\"),this._worklet.disconnect()),this}}va(`\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it's disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) =\u003e {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === \"dispose\") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n`),va(`\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length \u003e 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input \u0026\u0026 input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample \u003c this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel \u003c channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input \u0026\u0026 input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n`),va(`\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i \u003c channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] \u003e this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead \u003c 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n`),uu(\"feedback-comb-filter\",`\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"delayTime\",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: \"k-rate\"\n\t\t\t}, {\n\t\t\t\tname: \"feedback\",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: \"k-rate\"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n`);class Bs extends _a{constructor(){super(S(Bs.getDefaults(),arguments,[\"delayTime\",\"resonance\"])),this.name=\"FeedbackCombFilter\";let t=S(Bs.getDefaults(),arguments,[\"delayTime\",\"resonance\"]);this.input=new ft({context:this.context}),this.output=new ft({context:this.context}),this.delayTime=new St({context:this.context,value:t.delayTime,units:\"time\",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new St({context:this.context,value:t.resonance,units:\"normalRange\",param:this._dummyParam,swappable:!0}),yt(this,[\"resonance\",\"delayTime\"])}_audioWorkletName(){return\"feedback-comb-filter\"}static getDefaults(){return Object.assign(ot.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){Qe(this.input,t,this.output);let e=t.parameters.get(\"delayTime\");this.delayTime.setParam(e);let n=t.parameters.get(\"feedback\");this.resonance.setParam(n)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class Us extends ot{constructor(){super(S(Us.getDefaults(),arguments,[\"frequency\",\"type\"])),this.name=\"OnePoleFilter\";let t=S(Us.getDefaults(),arguments,[\"frequency\",\"type\"]);this._frequency=t.frequency,this._type=t.type,this.input=new ft({context:this.context}),this.output=new ft({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(ot.getDefaults(),{frequency:880,type:\"lowpass\"})}_createFilter(){let t=this._filter,e=this.toFrequency(this._frequency),n=1/(2*Math.PI*e);if(this._type===\"lowpass\"){let i=1/(n*this.context.sampleRate),c=i-1;this._filter=this.context.createIIRFilter([i,0],[1,c])}else{let i=1/(n*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,i])}this.input.chain(this._filter,this.output),t\u0026\u0026this.context.setTimeout(()=\u003e{this.disposed||(this.input.disconnect(t),t.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){let e=new Float32Array(t);for(let c=0;c\u003ct;c++){let l=19980*Math.pow(c/t,2)+20;e[c]=l}let n=new Float32Array(t),i=new Float32Array(t);return this._filter.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class Hs extends ot{constructor(){super(S(Hs.getDefaults(),arguments,[\"delayTime\",\"resonance\",\"dampening\"])),this.name=\"LowpassCombFilter\";let t=S(Hs.getDefaults(),arguments,[\"delayTime\",\"resonance\",\"dampening\"]);this._combFilter=this.output=new Bs({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new Us({context:this.context,frequency:t.dampening,type:\"lowpass\"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(ot.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class xr extends Ke{constructor(){super(S(xr.getDefaults(),arguments)),this.name=\"PluckSynth\";let t=S(xr.getDefaults(),arguments);this._noise=new Dn({context:this.context,type:\"pink\"}),this.attackNoise=t.attackNoise,this._lfcf=new Hs({context:this.context,dampening:t.dampening,resonance:t.resonance}),this.resonance=t.resonance,this.release=t.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return tn(Ke.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(t){this._lfcf.dampening=t}triggerAttack(t,e){let n=this.toFrequency(t);e=this.toSeconds(e);let i=1/n;return this._lfcf.delayTime.setValueAtTime(i,e),this._noise.start(e),this._noise.stop(e+i*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}triggerRelease(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class Tr extends Ke{constructor(){super(S(Tr.getDefaults(),arguments,[\"voice\",\"options\"])),this.name=\"PolySynth\",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;let t=S(Tr.getDefaults(),arguments,[\"voice\",\"options\"]);mt(!Ye(t.voice),\"DEPRECATED: The polyphony count is no longer the first argument.\");let e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();let n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Ke.getDefaults(),{maxPolyphony:32,options:{},voice:Nn})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);let e=this._activeVoices.findIndex(n=\u003en.voice===t);this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length\u003cthis.maxPolyphony){let t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}gi(\"Max polyphony exceeded. Note dropped.\")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length\u0026\u0026this._voices.length\u003eMath.ceil(this._averageActiveVoices+1)){let t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach(i=\u003e{let c=new Es(this.context,i).toMidi(),l=this._getNextAvailableVoice();l\u0026\u0026(l.triggerAttack(i,e,n),this._activeVoices.push({midi:c,voice:l,released:!1}),this.log(\"triggerAttack\",i,e))})}_triggerRelease(t,e){t.forEach(n=\u003e{let i=new Es(this.context,n).toMidi(),c=this._activeVoices.find(({midi:l,released:h})=\u003el===i\u0026\u0026!h);c\u0026\u0026(c.voice.triggerRelease(e),c.released=!0,this.log(\"triggerRelease\",n,e))})}_scheduleEvent(t,e,n,i){mt(!this.disposed,\"Synth was already disposed\"),n\u003c=this.now()?t===\"attack\"?this._triggerAttack(e,n,i):this._triggerRelease(e,n):this.context.setTimeout(()=\u003e{this._scheduleEvent(t,e,n,i)},n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);let i=this.toSeconds(e);return this._scheduleEvent(\"attack\",t,i,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);let n=this.toSeconds(e);return this._scheduleEvent(\"release\",t,n),this}triggerAttackRelease(t,e,n,i){let c=this.toSeconds(n);if(this.triggerAttack(t,c,i),Ae(e)){mt(Ae(t),\"If the duration is an array, the notes must also be an array\"),t=t;for(let l=0;l\u003ct.length;l++){let h=e[Math.min(l,e.length-1)],p=this.toSeconds(h);mt(p\u003e0,\"The duration must be greater than 0\"),this.triggerRelease(t[l],c+p)}}else{let l=this.toSeconds(e);mt(l\u003e0,\"The duration must be greater than 0\"),this.triggerRelease(t,c+l)}return this}sync(){return this._syncState()\u0026\u0026(this._syncMethod(\"triggerAttack\",1),this._syncMethod(\"triggerRelease\",1)),this}set(t){let e=Ce(t,[\"onsilence\",\"context\"]);return this.options=tn(this.options,e),this._voices.forEach(n=\u003en.set(e)),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){let e=this.toSeconds(t);return this._activeVoices.forEach(({voice:n})=\u003e{n.triggerRelease(e)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(t=\u003et.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Ys extends Ke{constructor(){super(S(Ys.getDefaults(),arguments,[\"urls\",\"onload\",\"baseUrl\"],\"urls\")),this.name=\"Sampler\",this._activeSources=new Map;let t=S(Ys.getDefaults(),arguments,[\"urls\",\"onload\",\"baseUrl\"],\"urls\"),e={};Object.keys(t.urls).forEach(n=\u003e{let i=parseInt(n,10);if(mt(vi(n)||Ye(i)\u0026\u0026isFinite(i),\"url key is neither a note or midi pitch: \"+n),vi(n)){let c=new Re(this.context,n).toMidi();e[c]=t.urls[n]}else Ye(i)\u0026\u0026isFinite(i)\u0026\u0026(e[i]=t.urls[i])}),this._buffers=new Ps({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded\u0026\u0026Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Ke.getDefaults(),{attack:0,baseUrl:\"\",curve:\"exponential\",onload:Et,onerror:Et,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e\u003c96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(\"No available buffers for note: \"+t)}triggerAttack(t,e,n=1){return this.log(\"triggerAttack\",t,e,n),Array.isArray(t)||(t=[t]),t.forEach(i=\u003e{let c=eu(new Re(this.context,i).toFrequency()),l=Math.round(c),h=c-l,p=this._findClosest(l),f=l-p,y=this._buffers.get(f),g=Cs(p+h),b=new On({url:y,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:g}).connect(this.output);b.start(e,0,y.duration/g,n),Ae(this._activeSources.get(l))||this._activeSources.set(l,[]),this._activeSources.get(l).push(b),b.onended=()=\u003e{if(this._activeSources\u0026\u0026this._activeSources.has(l)){let v=this._activeSources.get(l),E=v.indexOf(b);E!==-1\u0026\u0026v.splice(E,1)}}}),this}triggerRelease(t,e){return this.log(\"triggerRelease\",t,e),Array.isArray(t)||(t=[t]),t.forEach(n=\u003e{let i=new Re(this.context,n).toMidi();if(this._activeSources.has(i)\u0026\u0026this._activeSources.get(i).length){let c=this._activeSources.get(i);e=this.toSeconds(e),c.forEach(l=\u003e{l.stop(e)}),this._activeSources.set(i,[])}}),this}releaseAll(t){let e=this.toSeconds(t);return this._activeSources.forEach(n=\u003e{for(;n.length;)n.shift().stop(e)}),this}sync(){return this._syncState()\u0026\u0026(this._syncMethod(\"triggerAttack\",1),this._syncMethod(\"triggerRelease\",1)),this}triggerAttackRelease(t,e,n,i=1){let c=this.toSeconds(n);return this.triggerAttack(t,c,i),Ae(e)?(mt(Ae(t),\"notes must be an array when duration is array\"),t.forEach((l,h)=\u003e{let p=e[Math.min(h,e.length-1)];this.triggerRelease(l,c+this.toSeconds(p))})):this.triggerRelease(t,c+this.toSeconds(e)),this}add(t,e,n){if(mt(vi(t)||isFinite(t),\"note must be a pitch or midi: \"+t),vi(t)){let i=new Re(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=\u003e{t.forEach(e=\u003ee.dispose())}),this._activeSources.clear(),this}}un([En(0)],Ys.prototype,\"attack\",void 0),un([En(0)],Ys.prototype,\"release\",void 0);class dn extends xe{constructor(){super(S(dn.getDefaults(),arguments,[\"callback\",\"value\"])),this.name=\"ToneEvent\",this._state=new Os(\"stopped\"),this._startOffset=0;let t=S(dn.getDefaults(),arguments,[\"callback\",\"value\"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(xe.getDefaults(),{callback:Et,humanize:!1,loop:!1,loopEnd:\"1m\",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,e=\u003e{let n;if(e.state===\"started\"){e.id!==-1\u0026\u0026this.context.transport.clear(e.id);let i=e.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||Ye(this._loop)\u0026\u0026this._loop\u003e1){n=1/0,Ye(this._loop)\u0026\u0026(n=this._loop*this._getLoopDuration());let c=this._state.getAfter(i);c!==null\u0026\u0026(n=Math.min(n,c.time-i)),n!==1/0\u0026\u0026(this._state.setStateAtTime(\"stopped\",i+n+1,{id:-1}),n=new Xt(this.context,n));let l=new Xt(this.context,this._getLoopDuration());e.id=this.context.transport.scheduleRepeat(this._tick.bind(this),l,new Xt(this.context,i),n)}else e.id=this.context.transport.schedule(this._tick.bind(this),new Xt(this.context,i))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){let e=this.toTicks(t);return this._state.getValueAtTime(e)===\"stopped\"\u0026\u0026(this._state.add({id:-1,state:\"started\",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);let e=this.toTicks(t);if(this._state.getValueAtTime(e)===\"started\"){this._state.setStateAtTime(\"stopped\",e,{id:-1});let n=this._state.getBefore(e),i=e;n!==null\u0026\u0026(i=n.time),this._rescheduleEvents(i)}return this}cancel(t){t=en(t,-1/0);let e=this.toTicks(t);return this._state.forEachFrom(e,n=\u003e{this.context.transport.clear(n.id)}),this._state.cancel(e),this}_tick(t){let e=this.context.transport.getTicksAtTime(t);if(!this.mute\u0026\u0026this._state.getValueAtTime(e)===\"started\"){if(this.probability\u003c1\u0026\u0026Math.random()\u003ethis.probability)return;if(this.humanize){let n=.02;aa(this.humanize)||(n=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*n}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new Xt(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop\u0026\u0026this._rescheduleEvents()}get loopStart(){return new Xt(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop\u0026\u0026this._rescheduleEvents()}get progress(){if(this._loop){let t=this.context.transport.ticks,e=this._state.get(t);if(e!==null\u0026\u0026e.state===\"started\"){let n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class Xs extends xe{constructor(){super(S(Xs.getDefaults(),arguments,[\"callback\",\"interval\"])),this.name=\"Loop\";let t=S(Xs.getDefaults(),arguments,[\"callback\",\"interval\"]);this._event=new dn({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(xe.getDefaults(),{interval:\"4n\",callback:Et,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return this._event.loop===!0?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class Qs extends dn{constructor(){super(S(Qs.getDefaults(),arguments,[\"callback\",\"events\"])),this.name=\"Part\",this._state=new Os(\"stopped\"),this._events=new Set;let t=S(Qs.getDefaults(),arguments,[\"callback\",\"events\"]);this._state.increasing=!0,t.events.forEach(e=\u003e{Ae(e)?this.add(e[0],e[1]):this.add(e)})}static getDefaults(){return Object.assign(dn.getDefaults(),{events:[]})}start(t,e){let n=this.toTicks(t);if(this._state.getValueAtTime(n)!==\"started\"){e=en(e,this._loop?this._loopStart:0),e=this._loop?en(e,this._loopStart):en(e,0);let i=this.toTicks(e);this._state.add({id:-1,offset:i,state:\"started\",time:n}),this._forEach(c=\u003e{this._startNote(c,n,i)})}return this}_startNote(t,e,n){e-=n,this._loop?t.startOffset\u003e=this._loopStart\u0026\u0026t.startOffset\u003cthis._loopEnd?(t.startOffset\u003cn\u0026\u0026(e+=this._getLoopDuration()),t.start(new Xt(this.context,e))):t.startOffset\u003cthis._loopStart\u0026\u0026t.startOffset\u003e=n\u0026\u0026(t.loop=!1,t.start(new Xt(this.context,e))):t.startOffset\u003e=n\u0026\u0026t.start(new Xt(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach(e=\u003e{e.startOffset+=this._startOffset})}stop(t){let e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime(\"stopped\",e),this._forEach(n=\u003e{n.stop(t)}),this}at(t,e){let n=new me(this.context,t).toTicks(),i=new Xt(this.context,1).toSeconds(),c=this._events.values(),l=c.next();for(;!l.done;){let h=l.value;if(Math.abs(n-h.startOffset)\u003ci)return Ot(e)\u0026\u0026(h.value=e),h;l=c.next()}return Ot(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object\u0026\u0026Reflect.has(t,\"time\")\u0026\u0026(t=(e=t).time);let n=this.toTicks(t),i;return e instanceof dn?(i=e,i.callback=this._tick.bind(this)):i=new dn({callback:this._tick.bind(this),context:this.context,value:e}),i.startOffset=n,i.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(i),this._restartEvent(i),this}_restartEvent(t){this._state.forEach(e=\u003e{e.state===\"started\"?this._startNote(t,e.time,e.offset):t.stop(new Xt(this.context,e.time))})}remove(t,e){return Mn(t)\u0026\u0026t.hasOwnProperty(\"time\")\u0026\u0026(t=(e=t).time),t=this.toTicks(t),this._events.forEach(n=\u003e{n.startOffset===t\u0026\u0026(Ve(e)||Ot(e)\u0026\u0026n.value===e)\u0026\u0026(this._events.delete(n),n.dispose())}),this}clear(){return this._forEach(t=\u003et.dispose()),this._events.clear(),this}cancel(t){return this._forEach(e=\u003ee.cancel(t)),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events\u0026\u0026this._events.forEach(e=\u003e{e instanceof Qs?e._forEach(t):t(e)}),this}_setAll(t,e){this._forEach(n=\u003e{n[t]=e})}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop\u0026\u0026(t.startOffset\u003cthis._loopStart||t.startOffset\u003e=this._loopEnd)?t.cancel(0):t.state===\"stopped\"\u0026\u0026this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll(\"probability\",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll(\"humanize\",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach(e=\u003e{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)})}get loopEnd(){return new Xt(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop\u0026\u0026this._forEach(e=\u003e{e.loopEnd=t,this._testLoopBoundries(e)})}get loopStart(){return new Xt(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop\u0026\u0026this._forEach(e=\u003e{e.loopStart=this.loopStart,this._testLoopBoundries(e)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll(\"playbackRate\",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*Md(s){let t=0;for(;t\u003cs.length;)t=Zs(t,s),yield s[t],t++}function*Ad(s){let t=s.length-1;for(;t\u003e=0;)t=Zs(t,s),yield s[t],t--}function*ki(s,t){for(;;)yield*t(s)}function Zs(s,t){return Kc(s,0,t.length-1)}function*lu(s,t){let e=t?0:s.length-1;for(;;)e=Zs(e,s),yield s[e],t?(e++,e\u003e=s.length-1\u0026\u0026(t=!1)):(e--,e\u003c=0\u0026\u0026(t=!0))}function*Cd(s){let t=0,e=0;for(;t\u003cs.length;)t=Zs(t,s),yield s[t],e++,t+=e%2?2:-1}function*Od(s){let t=s.length-1,e=0;for(;t\u003e=0;)t=Zs(t,s),yield s[t],e++,t+=e%2?-2:1}function*Dd(s){let t=[];for(let e=0;e\u003cs.length;e++)t.push(e);for(;t.length\u003e0;){let e=Zs(t.splice(Math.floor(t.length*Math.random()),1)[0],s);yield s[e]}}function*hu(s,t=\"up\",e=0){switch(mt(s.length\u003e0,\"The array must have more than one value in it\"),t){case\"up\":yield*ki(s,Md);case\"down\":yield*ki(s,Ad);case\"upDown\":yield*lu(s,!0);case\"downUp\":yield*lu(s,!1);case\"alternateUp\":yield*ki(s,Cd);case\"alternateDown\":yield*ki(s,Od);case\"random\":yield*function*(n){for(;;){let i=Math.floor(Math.random()*n.length);yield n[i]}}(s);case\"randomOnce\":yield*ki(s,Dd);case\"randomWalk\":yield*function*(n){let i=Math.floor(Math.random()*n.length);for(;;)i===0?i++:i===n.length-1||Math.random()\u003c.5?i--:i++,yield n[i]}(s)}}class Sr extends Xs{constructor(){super(S(Sr.getDefaults(),arguments,[\"callback\",\"values\",\"pattern\"])),this.name=\"Pattern\";let t=S(Sr.getDefaults(),arguments,[\"callback\",\"values\",\"pattern\"]);this.callback=t.callback,this._values=t.values,this._pattern=hu(t.values,t.pattern),this._type=t.pattern}static getDefaults(){return Object.assign(Xs.getDefaults(),{pattern:\"up\",values:[],callback:Et})}_tick(t){let e=this._pattern.next();this._value=e.value,this.callback(t,this._value)}get values(){return this._values}set values(t){this._values=t,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(t){this._type=t,this._pattern=hu(this._values,this._type)}}class kr extends dn{constructor(){super(S(kr.getDefaults(),arguments,[\"callback\",\"events\",\"subdivision\"])),this.name=\"Sequence\",this._part=new Qs({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];let t=S(kr.getDefaults(),arguments,[\"callback\",\"events\",\"subdivision\"]);this._subdivision=this.toTicks(t.subdivision),this.events=t.events,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.playbackRate=t.playbackRate,this.probability=t.probability,this.humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate}static getDefaults(){return Object.assign(Ce(dn.getDefaults(),[\"value\"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:\"8n\"})}_seqCallback(t,e){e!==null\u0026\u0026this.callback(t,e)}get events(){return this._events}set events(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(t,e){return this._part.start(t,e\u0026\u0026this._indexTime(e)),this}stop(t){return this._part.stop(t),this}get subdivision(){return new Xt(this.context,this._subdivision).toSeconds()}_createSequence(t){return new Proxy(t,{get:(e,n)=\u003ee[n],set:(e,n,i)=\u003e(Je(n)\u0026\u0026isFinite(parseInt(n,10))\u0026\u0026Ae(i)?e[n]=this._createSequence(i):e[n]=i,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(t,e,n){t.forEach((i,c)=\u003e{let l=c*e+n;if(Ae(i))this._rescheduleSequence(i,e/i.length,l);else{let h=new Xt(this.context,l,\"i\").toSeconds();this._part.add(h,i)}})}_indexTime(t){return new Xt(this.context,t*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(t){this._part.loop=t}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this._part.loopEnd=t===0?this._indexTime(this._eventsArray.length):this._indexTime(t)}get startOffset(){return this._part.startOffset}set startOffset(t){this._part.startOffset=t}get playbackRate(){return this._part.playbackRate}set playbackRate(t){this._part.playbackRate=t}get probability(){return this._part.probability}set probability(t){this._part.probability=t}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(t){this._part.humanize=t}get length(){return this._part.length}}class cs extends ot{constructor(){super(Object.assign(S(cs.getDefaults(),arguments,[\"fade\"]))),this.name=\"CrossFade\",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new au({context:this.context}),this.a=new ft({context:this.context,gain:0}),this.b=new ft({context:this.context,gain:0}),this.output=new ft({context:this.context}),this._internalChannels=[this.a,this.b];let t=S(cs.getDefaults(),arguments,[\"fade\"]);this.fade=new wt({context:this.context,units:\"normalRange\",value:t.fade}),yt(this,\"fade\"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode=\"explicit\",Le(this._split,this.a.gain,0),Le(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(ot.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class _e extends ot{constructor(t){super(t),this.name=\"Effect\",this._dryWet=new cs({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new ft({context:this.context}),this.effectReturn=new ft({context:this.context}),this.input=new ft({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],yt(this,\"wet\")}static getDefaults(){return Object.assign(ot.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class Mr extends _e{constructor(t){super(t),this.name=\"LFOEffect\",this._lfo=new Ne({context:this.context,frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=t.type,yt(this,[\"frequency\",\"depth\"])}static getDefaults(){return Object.assign(_e.getDefaults(),{frequency:1,type:\"sine\",depth:1})}start(t){return this._lfo.start(t),this}stop(t){return this._lfo.stop(t),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Ar extends Mr{constructor(){super(S(Ar.getDefaults(),arguments,[\"frequency\",\"baseFrequency\",\"octaves\"])),this.name=\"AutoFilter\";let t=S(Ar.getDefaults(),arguments,[\"frequency\",\"baseFrequency\",\"octaves\"]);this.filter=new ze(Object.assign(t.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency}static getDefaults(){return Object.assign(Mr.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:\"lowpass\",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}dispose(){return super.dispose(),this.filter.dispose(),this}}class Ks extends ot{constructor(){super(Object.assign(S(Ks.getDefaults(),arguments,[\"pan\"]))),this.name=\"Panner\",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;let t=S(Ks.getDefaults(),arguments,[\"pan\"]);this.pan=new St({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode=\"explicit\",yt(this,\"pan\")}static getDefaults(){return Object.assign(ot.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class Cr extends Mr{constructor(){super(S(Cr.getDefaults(),arguments,[\"frequency\"])),this.name=\"AutoPanner\";let t=S(Cr.getDefaults(),arguments,[\"frequency\"]);this._panner=new Ks({context:this.context,channelCount:t.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(Mr.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class $s extends ot{constructor(){super(S($s.getDefaults(),arguments,[\"smoothing\"])),this.name=\"Follower\";let t=S($s.getDefaults(),arguments,[\"smoothing\"]);this._abs=this.input=new ou({context:this.context}),this._lowpass=this.output=new Us({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:\"lowpass\"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(ot.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class Or extends _e{constructor(){super(S(Or.getDefaults(),arguments,[\"baseFrequency\",\"octaves\",\"sensitivity\"])),this.name=\"AutoWah\";let t=S(Or.getDefaults(),arguments,[\"baseFrequency\",\"octaves\",\"sensitivity\"]);this._follower=new $s({context:this.context,smoothing:t.follower}),this._sweepRange=new Si({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this._inputBoost=new ft({context:this.context}),this._bandpass=new ze({context:this.context,rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new ze({context:this.context,type:\"peaking\"}),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,yt(this,[\"gain\",\"Q\"])}static getDefaults(){return Object.assign(_e.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(t){this._follower.smoothing=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}get sensitivity(){return yi(1/this._inputBoost.gain.value)}set sensitivity(t){this._inputBoost.gain.value=1/As(t)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}uu(\"bit-crusher\",`\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n`);class Dr extends _e{constructor(){super(S(Dr.getDefaults(),arguments,[\"bits\"])),this.name=\"BitCrusher\";let t=S(Dr.getDefaults(),arguments,[\"bits\"]);this._bitCrusherWorklet=new Pr({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(_e.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class Pr extends _a{constructor(){super(S(Pr.getDefaults(),arguments)),this.name=\"BitCrusherWorklet\";let t=S(Pr.getDefaults(),arguments);this.input=new ft({context:this.context}),this.output=new ft({context:this.context}),this.bits=new St({context:this.context,value:t.bits,units:\"positive\",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(_a.getDefaults(),{bits:12})}_audioWorkletName(){return\"bit-crusher\"}onReady(t){Qe(this.input,t,this.output);let e=t.parameters.get(\"bits\");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class Er extends _e{constructor(){super(S(Er.getDefaults(),arguments,[\"order\"])),this.name=\"Chebyshev\";let t=S(Er.getDefaults(),arguments,[\"order\"]);this._shaper=new nn({context:this.context,length:4096}),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample}static getDefaults(){return Object.assign(_e.getDefaults(),{order:1,oversample:\"none\"})}_getCoefficient(t,e,n){return n.has(e)||(e===0?n.set(e,0):e===1?n.set(e,t):n.set(e,2*t*this._getCoefficient(t,e-1,n)-this._getCoefficient(t,e-2,n))),n.get(e)}get order(){return this._order}set order(t){this._order=t,this._shaper.setMap(e=\u003ethis._getCoefficient(e,t,new Map))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Gn extends ot{constructor(){super(S(Gn.getDefaults(),arguments,[\"channels\"])),this.name=\"Split\";let t=S(Gn.getDefaults(),arguments,[\"channels\"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(ot.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class qn extends ot{constructor(){super(S(qn.getDefaults(),arguments,[\"channels\"])),this.name=\"Merge\";let t=S(qn.getDefaults(),arguments,[\"channels\"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(ot.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class xn extends ot{constructor(t){super(t),this.name=\"StereoEffect\",this.input=new ft({context:this.context}),this.input.channelCount=2,this.input.channelCountMode=\"explicit\",this._dryWet=this.output=new cs({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new Gn({context:this.context,channels:2}),this._merge=new qn({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),yt(this,[\"wet\"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),Qe(...t),Le(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),Qe(...t),Le(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(ot.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class ya extends xn{constructor(t){super(t),this.feedback=new wt({context:this.context,value:t.feedback,units:\"normalRange\"}),this._feedbackL=new ft({context:this.context}),this._feedbackR=new ft({context:this.context}),this._feedbackSplit=new Gn({context:this.context,channels:2}),this._feedbackMerge=new qn({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),yt(this,[\"feedback\"])}static getDefaults(){return Object.assign(xn.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class Nr extends ya{constructor(){super(S(Nr.getDefaults(),arguments,[\"frequency\",\"delayTime\",\"depth\"])),this.name=\"Chorus\";let t=S(Nr.getDefaults(),arguments,[\"frequency\",\"delayTime\",\"depth\"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new Ne({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new Ne({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new We({context:this.context}),this._delayNodeR=new We({context:this.context}),this.frequency=this._lfoL.frequency,yt(this,[\"frequency\"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(ya.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:\"sine\",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;let e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class qr extends _e{constructor(){super(S(qr.getDefaults(),arguments,[\"distortion\"])),this.name=\"Distortion\";let t=S(qr.getDefaults(),arguments,[\"distortion\"]);this._shaper=new nn({context:this.context,length:4096}),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample}static getDefaults(){return Object.assign(_e.getDefaults(),{distortion:.4,oversample:\"none\"})}get distortion(){return this._distortion}set distortion(t){this._distortion=t;let e=100*t,n=Math.PI/180;this._shaper.setMap(i=\u003eMath.abs(i)\u003c.001?0:(3+e)*i*20*n/(Math.PI+e*Math.abs(i)))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Ir extends _e{constructor(t){super(t),this.name=\"FeedbackEffect\",this._feedbackGain=new ft({context:this.context,gain:t.feedback,units:\"normalRange\"}),this.feedback=this._feedbackGain.gain,yt(this,\"feedback\"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(_e.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class jr extends Ir{constructor(){super(S(jr.getDefaults(),arguments,[\"delayTime\",\"feedback\"])),this.name=\"FeedbackDelay\";let t=S(jr.getDefaults(),arguments,[\"delayTime\",\"feedback\"]);this._delayNode=new We({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),yt(this,\"delayTime\")}static getDefaults(){return Object.assign(Ir.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class Pd extends ot{constructor(t){super(t),this.name=\"PhaseShiftAllpass\",this.input=new ft({context:this.context}),this.output=new ft({context:this.context}),this.offset90=new ft({context:this.context}),this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),Qe(this.input,...this._bank0,this._oneSampleDelay,this.output),Qe(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(t){return t.map(e=\u003e{let n=[[e*e,0,-1],[1,0,-e*e]];return this.context.createIIRFilter(n[0],n[1])})}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach(t=\u003et.disconnect()),this._bank1.forEach(t=\u003et.disconnect()),this._oneSampleDelay.disconnect(),this}}class Rr extends _e{constructor(){super(S(Rr.getDefaults(),arguments,[\"frequency\"])),this.name=\"FrequencyShifter\";let t=S(Rr.getDefaults(),arguments,[\"frequency\"]);this.frequency=new wt({context:this.context,units:\"frequency\",value:t.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new qs({context:this.context,type:\"sine\"}),this._cosine=new te({context:this.context,phase:-90,type:\"sine\"}),this._sineMultiply=new ee({context:this.context}),this._cosineMultiply=new ee({context:this.context}),this._negate=new fa({context:this.context}),this._add=new rs({context:this.context}),this._phaseShifter=new Pd({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);let e=this.immediate();this._sine.start(e),this._cosine.start(e)}static getDefaults(){return Object.assign(_e.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}let du=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],pu=[225,556,441,341];class Fr extends xn{constructor(){super(S(Fr.getDefaults(),arguments,[\"roomSize\",\"dampening\"])),this.name=\"Freeverb\",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];let t=S(Fr.getDefaults(),arguments,[\"roomSize\",\"dampening\"]);this.roomSize=new wt({context:this.context,value:t.roomSize,units:\"normalRange\"}),this._allpassFiltersL=pu.map(e=\u003e{let n=this.context.createBiquadFilter();return n.type=\"allpass\",n.frequency.value=e,n}),this._allpassFiltersR=pu.map(e=\u003e{let n=this.context.createBiquadFilter();return n.type=\"allpass\",n.frequency.value=e,n}),this._combFilters=du.map((e,n)=\u003e{let i=new Hs({context:this.context,dampening:t.dampening,delayTime:e});return n\u003cdu.length/2?this.connectEffectLeft(i,...this._allpassFiltersL):this.connectEffectRight(i,...this._allpassFiltersR),this.roomSize.connect(i.resonance),i}),yt(this,[\"roomSize\"])}static getDefaults(){return Object.assign(xn.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(t){this._combFilters.forEach(e=\u003ee.dampening=t)}dispose(){return super.dispose(),this._allpassFiltersL.forEach(t=\u003et.disconnect()),this._allpassFiltersR.forEach(t=\u003et.disconnect()),this._combFilters.forEach(t=\u003et.dispose()),this.roomSize.dispose(),this}}let fu=[.06748,.06404,.08212,.09004],Ed=[.773,.802,.753,.733],Nd=[347,113,37];class Vr extends xn{constructor(){super(S(Vr.getDefaults(),arguments,[\"roomSize\"])),this.name=\"JCReverb\",this._allpassFilters=[],this._feedbackCombFilters=[];let t=S(Vr.getDefaults(),arguments,[\"roomSize\"]);this.roomSize=new wt({context:this.context,value:t.roomSize,units:\"normalRange\"}),this._scaleRoomSize=new wn({context:this.context,min:-.733,max:.197}),this._allpassFilters=Nd.map(e=\u003e{let n=this.context.createBiquadFilter();return n.type=\"allpass\",n.frequency.value=e,n}),this._feedbackCombFilters=fu.map((e,n)=\u003e{let i=new Bs({context:this.context,delayTime:e});return this._scaleRoomSize.connect(i.resonance),i.resonance.value=Ed[n],n\u003cfu.length/2?this.connectEffectLeft(...this._allpassFilters,i):this.connectEffectRight(...this._allpassFilters,i),i}),this.roomSize.connect(this._scaleRoomSize),yt(this,[\"roomSize\"])}static getDefaults(){return Object.assign(xn.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach(t=\u003et.disconnect()),this._feedbackCombFilters.forEach(t=\u003et.dispose()),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class mu extends ya{constructor(t){super(t),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),yt(this,[\"feedback\"])}}class Lr extends mu{constructor(){super(S(Lr.getDefaults(),arguments,[\"delayTime\",\"feedback\"])),this.name=\"PingPongDelay\";let t=S(Lr.getDefaults(),arguments,[\"delayTime\",\"feedback\"]);this._leftDelay=new We({context:this.context,maxDelay:t.maxDelay}),this._rightDelay=new We({context:this.context,maxDelay:t.maxDelay}),this._rightPreDelay=new We({context:this.context,maxDelay:t.maxDelay}),this.delayTime=new wt({context:this.context,units:\"time\",value:t.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),yt(this,[\"delayTime\"])}static getDefaults(){return Object.assign(mu.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class Wr extends Ir{constructor(){super(S(Wr.getDefaults(),arguments,[\"pitch\"])),this.name=\"PitchShift\";let t=S(Wr.getDefaults(),arguments,[\"pitch\"]);this._frequency=new wt({context:this.context}),this._delayA=new We({maxDelay:1,context:this.context}),this._lfoA=new Ne({context:this.context,min:0,max:.1,type:\"sawtooth\"}).connect(this._delayA.delayTime),this._delayB=new We({maxDelay:1,context:this.context}),this._lfoB=new Ne({context:this.context,min:0,max:.1,type:\"sawtooth\",phase:180}).connect(this._delayB.delayTime),this._crossFade=new cs({context:this.context}),this._crossFadeLFO=new Ne({context:this.context,min:0,max:1,type:\"triangle\",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new We({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,yt(this,\"delayTime\"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);let e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(Ir.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t\u003c0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=Cs(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=Cs(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class zr extends xn{constructor(){super(S(zr.getDefaults(),arguments,[\"frequency\",\"octaves\",\"baseFrequency\"])),this.name=\"Phaser\";let t=S(zr.getDefaults(),arguments,[\"frequency\",\"octaves\",\"baseFrequency\"]);this._lfoL=new Ne({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new Ne({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this.Q=new wt({context:this.context,value:t.Q,units:\"positive\"}),this._filtersL=this._makeFilters(t.stages,this._lfoL),this._filtersR=this._makeFilters(t.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),yt(this,[\"frequency\",\"Q\"])}static getDefaults(){return Object.assign(xn.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(t,e){let n=[];for(let i=0;i\u003ct;i++){let c=this.context.createBiquadFilter();c.type=\"allpass\",this.Q.connect(c.Q),e.connect(c.frequency),n.push(c)}return n}get octaves(){return this._octaves}set octaves(t){this._octaves=t;let e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(t=\u003et.disconnect()),this._filtersR.forEach(t=\u003et.disconnect()),this.frequency.dispose(),this}}class Gr extends _e{constructor(){super(S(Gr.getDefaults(),arguments,[\"decay\"])),this.name=\"Reverb\",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();let t=S(Gr.getDefaults(),arguments,[\"decay\"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(_e.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){Me(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){Me(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return Yt(this,void 0,void 0,function*(){let t=this.ready,e=new Ms(2,this._decay+this._preDelay,this.context.sampleRate),n=new Dn({context:e}),i=new Dn({context:e}),c=new qn({context:e});n.connect(c,0,0),i.connect(c,0,1);let l=new ft({context:e}).toDestination();c.connect(l),n.start(0),i.start(0),l.gain.setValueAtTime(0,0),l.gain.setValueAtTime(1,this._preDelay),l.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);let h=e.render();return this.ready=h.then(Et),yield t,this._convolver.buffer=(yield h).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class Mi extends ot{constructor(){super(S(Mi.getDefaults(),arguments)),this.name=\"MidSideSplit\",this._split=this.input=new Gn({channels:2,context:this.context}),this._midAdd=new rs({context:this.context}),this.mid=new ee({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new as({context:this.context}),this.side=new ee({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class Ai extends ot{constructor(){super(S(Ai.getDefaults(),arguments)),this.name=\"MidSideMerge\",this.mid=new ft({context:this.context}),this.side=new ft({context:this.context}),this._left=new rs({context:this.context}),this._leftMult=new ee({context:this.context,value:Math.SQRT1_2}),this._right=new as({context:this.context}),this._rightMult=new ee({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new qn({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class gu extends _e{constructor(t){super(t),this.name=\"MidSideEffect\",this._midSideMerge=new Ai({context:this.context}),this._midSideSplit=new Mi({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...t){this._midSend.chain(...t,this._midReturn)}connectEffectSide(...t){this._sideSend.chain(...t,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class Br extends gu{constructor(){super(S(Br.getDefaults(),arguments,[\"width\"])),this.name=\"StereoWidener\";let t=S(Br.getDefaults(),arguments,[\"width\"]);this.width=new wt({context:this.context,value:t.width,units:\"normalRange\"}),yt(this,[\"width\"]),this._twoTimesWidthMid=new ee({context:this.context,value:2}),this._twoTimesWidthSide=new ee({context:this.context,value:2}),this._midMult=new ee({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new as({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),Le(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new ee({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(gu.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class Ur extends xn{constructor(){super(S(Ur.getDefaults(),arguments,[\"frequency\",\"depth\"])),this.name=\"Tremolo\";let t=S(Ur.getDefaults(),arguments,[\"frequency\",\"depth\"]);this._lfoL=new Ne({context:this.context,type:t.type,min:1,max:0}),this._lfoR=new Ne({context:this.context,type:t.type,min:1,max:0}),this._amplitudeL=new ft({context:this.context}),this._amplitudeR=new ft({context:this.context}),this.frequency=new wt({context:this.context,value:t.frequency,units:\"frequency\"}),this.depth=new wt({context:this.context,value:t.depth,units:\"normalRange\"}),yt(this,[\"frequency\",\"depth\"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=t.spread}static getDefaults(){return Object.assign(xn.getDefaults(),{frequency:10,type:\"sine\",depth:.5,spread:180})}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Hr extends _e{constructor(){super(S(Hr.getDefaults(),arguments,[\"frequency\",\"depth\"])),this.name=\"Vibrato\";let t=S(Hr.getDefaults(),arguments,[\"frequency\",\"depth\"]);this._delayNode=new We({context:this.context,delayTime:0,maxDelay:t.maxDelay}),this._lfo=new Ne({context:this.context,type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,yt(this,[\"frequency\",\"depth\"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(_e.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:\"sine\"})}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Js extends ot{constructor(){super(S(Js.getDefaults(),arguments,[\"type\",\"size\"])),this.name=\"Analyser\",this._analysers=[],this._buffers=[];let t=S(Js.getDefaults(),arguments,[\"type\",\"size\"]);this.input=this.output=this._gain=new ft({context:this.context}),this._split=new Gn({context:this.context,channels:t.channels}),this.input.connect(this._split),Me(t.channels,1);for(let e=0;e\u003ct.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(ot.getDefaults(),{size:1024,smoothing:.8,type:\"fft\",channels:1})}getValue(){return this._analysers.forEach((t,e)=\u003e{let n=this._buffers[e];this._type===\"fft\"?t.getFloatFrequencyData(n):this._type===\"waveform\"\u0026\u0026t.getFloatTimeDomainData(n)}),this.channels===1?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach((e,n)=\u003e{e.fftSize=2*t,this._buffers[n]=new Float32Array(t)})}get channels(){return this._analysers.length}get type(){return this._type}set type(t){mt(t===\"waveform\"||t===\"fft\",\"Analyser: invalid type: \"+t),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach(e=\u003ee.smoothingTimeConstant=t)}dispose(){return super.dispose(),this._analysers.forEach(t=\u003et.disconnect()),this._split.dispose(),this._gain.dispose(),this}}class Bn extends ot{constructor(){super(S(Bn.getDefaults(),arguments)),this.name=\"MeterBase\",this.input=this.output=this._analyser=new Js({context:this.context,size:256,type:\"waveform\"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class Yr extends Bn{constructor(){super(S(Yr.getDefaults(),arguments,[\"smoothing\"])),this.name=\"Meter\",this._rms=0;let t=S(Yr.getDefaults(),arguments,[\"smoothing\"]);this.input=this.output=this._analyser=new Js({context:this.context,size:256,type:\"waveform\",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange}static getDefaults(){return Object.assign(Bn.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return gi(\"'getLevel' has been changed to 'getValue'\"),this.getValue()}getValue(){let t=this._analyser.getValue(),e=(this.channels===1?[t]:t).map(n=\u003e{let i=n.reduce((l,h)=\u003el+h*h,0),c=Math.sqrt(i/n.length);return this._rms=Math.max(c,this._rms*this.smoothing),this.normalRange?this._rms:yi(this._rms)});return this.channels===1?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class Xr extends Bn{constructor(){super(S(Xr.getDefaults(),arguments,[\"size\"])),this.name=\"FFT\";let t=S(Xr.getDefaults(),arguments,[\"size\"]);this.normalRange=t.normalRange,this._analyser.type=\"fft\",this.size=t.size}static getDefaults(){return Object.assign(ot.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(t=\u003ethis.normalRange?As(t):t)}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return mt(0\u003c=t\u0026\u0026t\u003cthis.size,\"index must be greater than or equal to 0 and less than \"+this.size),t*this.context.sampleRate/(2*this.size)}}class ba extends Bn{constructor(){super(S(ba.getDefaults(),arguments)),this.name=\"DCMeter\",this._analyser.type=\"waveform\",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class Qr extends Bn{constructor(){super(S(Qr.getDefaults(),arguments,[\"size\"])),this.name=\"Waveform\";let t=S(Qr.getDefaults(),arguments,[\"size\"]);this._analyser.type=\"waveform\",this.size=t.size}static getDefaults(){return Object.assign(Bn.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(t){this._analyser.size=t}}class ue extends ot{constructor(){super(S(ue.getDefaults(),arguments,[\"solo\"])),this.name=\"Solo\";let t=S(ue.getDefaults(),arguments,[\"solo\"]);this.input=this.output=new ft({context:this.context}),ue._allSolos.has(this.context)||ue._allSolos.set(this.context,new Set),ue._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(ot.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),ue._allSolos.get(this.context).forEach(e=\u003ee._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){ue._soloed.has(this.context)||ue._soloed.set(this.context,new Set),ue._soloed.get(this.context).add(this)}_removeSolo(){ue._soloed.has(this.context)\u0026\u0026ue._soloed.get(this.context).delete(this)}_isSoloed(){return ue._soloed.has(this.context)\u0026\u0026ue._soloed.get(this.context).has(this)}_noSolos(){return!ue._soloed.has(this.context)||ue._soloed.has(this.context)\u0026\u0026ue._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),ue._allSolos.get(this.context).delete(this),this._removeSolo(),this}}ue._allSolos=new Map,ue._soloed=new Map;class Ci extends ot{constructor(){super(S(Ci.getDefaults(),arguments,[\"pan\",\"volume\"])),this.name=\"PanVol\";let t=S(Ci.getDefaults(),arguments,[\"pan\",\"volume\"]);this._panner=this.input=new Ks({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new yn({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,yt(this,[\"pan\",\"volume\"])}static getDefaults(){return Object.assign(ot.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Un extends ot{constructor(){super(S(Un.getDefaults(),arguments,[\"volume\",\"pan\"])),this.name=\"Channel\";let t=S(Un.getDefaults(),arguments,[\"volume\",\"pan\"]);this._solo=this.input=new ue({solo:t.solo,context:this.context}),this._panVol=this.output=new Ci({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),yt(this,[\"pan\",\"volume\"])}static getDefaults(){return Object.assign(ot.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return Un.buses.has(t)||Un.buses.set(t,new ft({context:this.context})),Un.buses.get(t)}send(t,e=0){let n=this._getBus(t),i=new ft({context:this.context,units:\"decibels\",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Un.buses=new Map;class wa extends ot{constructor(){super(S(wa.getDefaults(),arguments)),this.name=\"Mono\",this.input=new ft({context:this.context}),this._merge=this.output=new qn({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}}class ti extends ot{constructor(){super(S(ti.getDefaults(),arguments,[\"lowFrequency\",\"highFrequency\"])),this.name=\"MultibandSplit\",this.input=new ft({context:this.context}),this.output=void 0,this.low=new ze({context:this.context,frequency:0,type:\"lowpass\"}),this._lowMidFilter=new ze({context:this.context,frequency:0,type:\"highpass\"}),this.mid=new ze({context:this.context,frequency:0,type:\"lowpass\"}),this.high=new ze({context:this.context,frequency:0,type:\"highpass\"}),this._internalChannels=[this.low,this.mid,this.high];let t=S(ti.getDefaults(),arguments,[\"lowFrequency\",\"highFrequency\"]);this.lowFrequency=new wt({context:this.context,units:\"frequency\",value:t.lowFrequency}),this.highFrequency=new wt({context:this.context,units:\"frequency\",value:t.highFrequency}),this.Q=new wt({context:this.context,units:\"positive\",value:t.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),yt(this,[\"high\",\"mid\",\"low\",\"highFrequency\",\"lowFrequency\"])}static getDefaults(){return Object.assign(ot.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),_i(this,[\"high\",\"mid\",\"low\",\"highFrequency\",\"lowFrequency\"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class qd extends ot{constructor(){super(...arguments),this.name=\"Listener\",this.positionX=new St({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new St({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new St({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new St({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new St({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new St({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new St({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new St({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new St({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(ot.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}sr(s=\u003e{s.listener=new qd({context:s})}),ir(s=\u003e{s.listener.dispose()});class Zr extends ot{constructor(){super(S(Zr.getDefaults(),arguments,[\"positionX\",\"positionY\",\"positionZ\"])),this.name=\"Panner3D\";let t=S(Zr.getDefaults(),arguments,[\"positionX\",\"positionY\",\"positionZ\"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=t.panningModel,this.maxDistance=t.maxDistance,this.distanceModel=t.distanceModel,this.coneOuterGain=t.coneOuterGain,this.coneOuterAngle=t.coneOuterAngle,this.coneInnerAngle=t.coneInnerAngle,this.refDistance=t.refDistance,this.rolloffFactor=t.rolloffFactor,this.positionX=new St({context:this.context,param:this._panner.positionX,value:t.positionX}),this.positionY=new St({context:this.context,param:this._panner.positionY,value:t.positionY}),this.positionZ=new St({context:this.context,param:this._panner.positionZ,value:t.positionZ}),this.orientationX=new St({context:this.context,param:this._panner.orientationX,value:t.orientationX}),this.orientationY=new St({context:this.context,param:this._panner.orientationY,value:t.orientationY}),this.orientationZ=new St({context:this.context,param:this._panner.orientationZ,value:t.orientationZ})}static getDefaults(){return Object.assign(ot.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:\"inverse\",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:\"equalpower\",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(t,e,n){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=n,this}setOrientation(t,e,n){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=n,this}get panningModel(){return this._panner.panningModel}set panningModel(t){this._panner.panningModel=t}get refDistance(){return this._panner.refDistance}set refDistance(t){this._panner.refDistance=t}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(t){this._panner.rolloffFactor=t}get distanceModel(){return this._panner.distanceModel}set distanceModel(t){this._panner.distanceModel=t}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(t){this._panner.coneInnerAngle=t}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(t){this._panner.coneOuterAngle=t}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(t){this._panner.coneOuterGain=t}get maxDistance(){return this._panner.maxDistance}set maxDistance(t){this._panner.maxDistance=t}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class Oi extends ot{constructor(){super(S(Oi.getDefaults(),arguments)),this.name=\"Recorder\";let t=S(Oi.getDefaults(),arguments);this.input=new ft({context:this.context}),mt(Oi.supported,\"Media Recorder API is not available\"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:t.mimeType})}static getDefaults(){return ot.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return An!==null\u0026\u0026Reflect.has(An,\"MediaRecorder\")}get state(){return this._recorder.state===\"inactive\"?\"stopped\":this._recorder.state===\"paused\"?\"paused\":\"started\"}start(){return Yt(this,void 0,void 0,function*(){mt(this.state!==\"started\",\"Recorder is already started\");let t=new Promise(e=\u003e{let n=()=\u003e{this._recorder.removeEventListener(\"start\",n,!1),e()};this._recorder.addEventListener(\"start\",n,!1)});return this._recorder.start(),yield t})}stop(){return Yt(this,void 0,void 0,function*(){mt(this.state!==\"stopped\",\"Recorder is not started\");let t=new Promise(e=\u003e{let n=i=\u003e{this._recorder.removeEventListener(\"dataavailable\",n,!1),e(i.data)};this._recorder.addEventListener(\"dataavailable\",n,!1)});return this._recorder.stop(),yield t})}pause(){return mt(this.state===\"started\",\"Recorder must be started\"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class Tn extends ot{constructor(){super(S(Tn.getDefaults(),arguments,[\"threshold\",\"ratio\"])),this.name=\"Compressor\",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;let t=S(Tn.getDefaults(),arguments,[\"threshold\",\"ratio\"]);this.threshold=new St({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:\"decibels\",value:t.threshold}),this.attack=new St({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:\"time\",value:t.attack}),this.release=new St({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:\"time\",value:t.release}),this.knee=new St({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:\"decibels\",value:t.knee}),this.ratio=new St({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:\"positive\",value:t.ratio}),yt(this,[\"knee\",\"release\",\"attack\",\"ratio\",\"threshold\"])}static getDefaults(){return Object.assign(ot.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class Kr extends ot{constructor(){super(Object.assign(S(Kr.getDefaults(),arguments,[\"threshold\",\"smoothing\"]))),this.name=\"Gate\";let t=S(Kr.getDefaults(),arguments,[\"threshold\",\"smoothing\"]);this._follower=new $s({context:this.context,smoothing:t.smoothing}),this._gt=new Ti({context:this.context,value:As(t.threshold)}),this.input=new ft({context:this.context}),this._gate=this.output=new ft({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(ot.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return yi(this._gt.value)}set threshold(t){this._gt.value=As(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class $r extends ot{constructor(){super(Object.assign(S($r.getDefaults(),arguments,[\"threshold\"]))),this.name=\"Limiter\";let t=S($r.getDefaults(),arguments,[\"threshold\"]);this._compressor=this.input=this.output=new Tn({context:this.context,ratio:20,attack:.003,release:.01,threshold:t.threshold}),this.threshold=this._compressor.threshold,yt(this,\"threshold\")}static getDefaults(){return Object.assign(ot.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class Jr extends ot{constructor(){super(Object.assign(S(Jr.getDefaults(),arguments))),this.name=\"MidSideCompressor\";let t=S(Jr.getDefaults(),arguments);this._midSideSplit=this.input=new Mi({context:this.context}),this._midSideMerge=this.output=new Ai({context:this.context}),this.mid=new Tn(Object.assign(t.mid,{context:this.context})),this.side=new Tn(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),yt(this,[\"mid\",\"side\"])}static getDefaults(){return Object.assign(ot.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class to extends ot{constructor(){super(Object.assign(S(to.getDefaults(),arguments))),this.name=\"MultibandCompressor\";let t=S(to.getDefaults(),arguments);this._splitter=this.input=new ti({context:this.context,lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new ft({context:this.context}),this.low=new Tn(Object.assign(t.low,{context:this.context})),this.mid=new Tn(Object.assign(t.mid,{context:this.context})),this.high=new Tn(Object.assign(t.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),yt(this,[\"high\",\"mid\",\"low\",\"highFrequency\",\"lowFrequency\"])}static getDefaults(){return Object.assign(ot.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class eo extends ot{constructor(){super(S(eo.getDefaults(),arguments,[\"low\",\"mid\",\"high\"])),this.name=\"EQ3\",this.output=new ft({context:this.context}),this._internalChannels=[];let t=S(eo.getDefaults(),arguments,[\"low\",\"mid\",\"high\"]);this.input=this._multibandSplit=new ti({context:this.context,highFrequency:t.highFrequency,lowFrequency:t.lowFrequency}),this._lowGain=new ft({context:this.context,gain:t.low,units:\"decibels\"}),this._midGain=new ft({context:this.context,gain:t.mid,units:\"decibels\"}),this._highGain=new ft({context:this.context,gain:t.high,units:\"decibels\"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),yt(this,[\"low\",\"mid\",\"high\",\"lowFrequency\",\"highFrequency\"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(ot.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),_i(this,[\"low\",\"mid\",\"high\",\"lowFrequency\",\"highFrequency\"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class no extends ot{constructor(){super(S(no.getDefaults(),arguments,[\"url\",\"onload\"])),this.name=\"Convolver\",this._convolver=this.context.createConvolver();let t=S(no.getDefaults(),arguments,[\"url\",\"onload\"]);this._buffer=new Rt(t.url,e=\u003e{this.buffer=e,t.onload()}),this.input=new ft({context:this.context}),this.output=new ft({context:this.context}),this._buffer.loaded\u0026\u0026(this.buffer=this._buffer),this.normalize=t.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(ot.getDefaults(),{normalize:!0,onload:Et})}load(t){return Yt(this,void 0,void 0,function*(){this.buffer=yield this._buffer.load(t)})}get buffer(){return this._buffer.length?this._buffer:null}set buffer(t){t\u0026\u0026this._buffer.set(t),this._convolver.buffer\u0026\u0026(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));let e=this._buffer.get();this._convolver.buffer=e||null}get normalize(){return this._convolver.normalize}set normalize(t){this._convolver.normalize=t}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function Id(){return Jt().now()}function jd(){return Jt().immediate()}let Rd=Jt().transport;function Fd(){return Jt().transport}let Vd=Jt().destination,Ld=Jt().destination;function Wd(){return Jt().destination}let zd=Jt().listener;function Gd(){return Jt().listener}let Bd=Jt().draw;function Ud(){return Jt().draw}let Hd=Jt();function Yd(){return Rt.loaded()}let Xd=Rt,Qd=Ps,Zd=On}])})});var Kp={};ip(Kp,{default:()=\u003eZp,frontmatter:()=\u003eXp});var M=Be(wu()),mf=Be(ni());var qe=Be(si());var In=Be(si());var ii=[{pitches:[\"C\",\"B#\"],upperOffset:0,upperWidth:15.05},{pitches:[\"Db\",\"C#\"],upperOffset:0,upperWidth:12.7},{pitches:[\"D\"],upperOffset:4.15,upperWidth:15.3},{pitches:[\"Eb\",\"D#\"],upperOffset:0,upperWidth:12.7},{pitches:[\"E\"],upperOffset:8.55,upperWidth:15.05},{pitches:[\"F\",\"E#\"],upperOffset:0,upperWidth:13.95},{pitches:[\"Gb\",\"F#\"],upperOffset:0,upperWidth:12.7},{pitches:[\"G\"],upperOffset:3.05,upperWidth:14.2},{pitches:[\"Ab\",\"G#\"],upperOffset:0,upperWidth:12.7},{pitches:[\"A\"],upperOffset:6.35,upperWidth:14.2},{pitches:[\"Bb\",\"A#\"],upperOffset:0,upperWidth:12.7},{pitches:[\"B\",\"Cb\"],upperOffset:9.65,upperWidth:13.95}],us=[1,3,6,8,10],op={scaleX:1,scaleY:1,lowerWidth:23.6,palette:[\"#39383D\",\"#F2F2EF\"],stroke:\"#39383D\",strokeWidth:1,offsetY:2,offsetX:0,upperHeight:100,lowerHeight:45,keyCount:88,range:[\"A0\",\"C8\"],topLabels:!1};function ri(o){return o.range\u0026\u0026(o={...o,...ap(o.range)}),Object.assign({},op,o)}function ap(o){let r=o.map(k=\u003ek.slice(0,-1)),a=ii.find(k=\u003ek.pitches.includes(r[0])),u=ii.find(k=\u003ek.pitches.includes(r[1])),d=ii.indexOf(a),m=12-ii.indexOf(u),_=o.map(k=\u003eparseInt(k.slice(k.length-1)));return{keyCount:(_[1]-_[0]+1)*12-d-m+1,keyOffset:d}}function cp(o){let{lowerHeight:r,upperHeight:a,lowerWidth:u,strokeWidth:d,palette:m,stroke:_}=ri(o);return ii.map((T,k)=\u003eObject.assign(T,{upperHeight:a,lowerHeight:us.includes(k)?0:r,lowerWidth:us.includes(k)?T.upperWidth:u,fill:us.includes(k)?m[0]:m[1],contrast:us.includes(k)?m[1]:m[0],stroke:_,strokeWidth:d}))}function up(o){o=ri(o);let r=cp(o),{keyCount:a,scaleY:u,scaleX:d,visibleKeys:m,lowerWidth:_,strokeWidth:T,keyOffset:k,colorize:D}=o;return Array(a+k).fill(0).map((O,A,N)=\u003er[A%12]).map((O,A,N)=\u003e{let U=lp(A,o.range),z=O.pitches.map(X=\u003eX+U);return{index:A,notes:z,scaleX:d,scaleY:u,fill:hp(z,D)||O.fill,contrast:O.contrast,strokeWidth:O.strokeWidth,stroke:O.stroke,upperHeight:O.upperHeight*u,lowerHeight:O.lowerHeight*u,upperWidth:dp(O,A,k,a)*d,lowerWidth:O.lowerWidth*d,upperOffset:pp(O,A,k)*d,visible:!m||!!O.pitches.find(X=\u003em.includes(X)),offsetX:fp(A,N,_,k)*d+Math.ceil(T/2)}}).filter(O=\u003eO.index\u003e=k)}function tl(o){o=ri(o);let r=up(o),a=mp(o);return{svg:{width:a[0],height:a[1]},children:r.map(u=\u003e{if(!u.visible)return;let d,m,_=o.labels?u.notes.find(k=\u003e!!Object.keys(o.labels).includes(k)):\"\";if(_){let k=vp(u,o.topLabels);d=k.circle,m=k.text,m.value=o.labels[_]}let T=gp(u);return{key:u,polygon:{points:T.map(k=\u003ek.join(\",\")).join(\" \"),style:{fill:u.fill,stroke:u.stroke,strokeWidth:u.strokeWidth}},circle:d,text:m}})}}function lp(o,r){let a=Math.floor(o/12),u=r.map(m=\u003eparseInt(m.slice(m.length-1)));return a+u[0]}function hp(o,r){if(!r)return null;let a=r.find(u=\u003e!!u.keys.find(d=\u003eo.includes(d)));return a?a.color:null}function dp(o,r,a,u){let d=_=\u003e_===a,m=_=\u003e_===u+a-1;return d(r)?o.upperWidth+o.upperOffset:m(r)?o.lowerWidth-o.upperOffset:o.upperWidth}function pp(o,r,a){return(d=\u003ed===a)(r)?0:o.upperOffset}function Sa(o){return Array(o%12).fill(0).filter((r,a)=\u003e!us.includes(a)).length+Math.floor(o/12)*7}function fp(o,r,a,u=0){let d=Sa(o),m=Sa(u),_=r[u].upperOffset;if(us.includes(u%12)){let T=ii[(u+12-1)%12];_-=a-(T.upperWidth+T.upperOffset)}return us.includes(o%12)?r.slice(u,o).reduce((T,k,D)=\u003eT+k.upperWidth,0)+_:d*a-m*a}function mp(o){let{scaleX:r,scaleY:a,lowerWidth:u,keyCount:d,lowerHeight:m,upperHeight:_,strokeWidth:T}=ri(o);return[r*u*Sa(d+1),(m+_)*a].map(k=\u003eMath.round(k+T*2))}function gp(o){let{upperOffset:r,offsetX:a,offsetY:u,upperHeight:d,lowerHeight:m,upperWidth:_,lowerWidth:T}=ri(o),k=m+d;return[[r+a,u],[r+a,d+u],[a,d+u],[a,k+u],[T+a,k+u],[T+a,d+u],[_+r+a,d+u],[_+r+a,u]]}function vp(o,r=!1,a=\"white\"){let{offsetX:u,upperHeight:d,lowerHeight:m,upperOffset:_,upperWidth:T,strokeWidth:k}=ri(o),D=o.scaleX*(12.7-k*2)/2,O=o.lowerWidth||o.upperWidth,A=r?u+T/2+_:u+O/2,N=r?D*2:d+m-D;return{circle:{cx:A,cy:N-D/3,r:D,fill:a,stroke:o.stroke,strokeWidth:o.strokeWidth},text:{x:A,y:N,textAnchor:\"middle\",fontSize:D,fontFamily:\"helvetica\"}}}var el=Be(si());function nl({downHandler:o,upHandler:r}){(0,el.useEffect)(()=\u003e(window.addEventListener(\"keydown\",o),window.addEventListener(\"keyup\",r),()=\u003e{window.removeEventListener(\"keydown\",o),window.removeEventListener(\"keyup\",r)}),[o,r])}var Il=Be(Ca());function Li({options:o,onClick:r,onAttack:a,onRelease:u,keyControl:d,mouseControl:m}){let _=(0,In.useRef)([]),[T,k]=(0,In.useState)([]);m=m??!0;let D=(0,Il.useGesture)({onDragStart:({down:z,args:[X]})=\u003em\u0026\u0026z\u0026\u0026O(X),onHover:({down:z,active:X,args:[K]})=\u003e{!m||(X\u0026\u0026z\u0026\u0026O(K),X||A(K))}});nl({downHandler:z=\u003ed\u0026\u0026d[z.key]\u0026\u0026O({notes:[d[z.key]]}),upHandler:z=\u003ed\u0026\u0026d[z.key]\u0026\u0026A({notes:[d[z.key]]})});let O=z=\u003e{T.includes(z.notes[0])||(_.current=[..._.current,z.notes[0]],a\u0026\u0026a(z)),k(_.current)},A=z=\u003e{T.includes(z.notes[0])\u0026\u0026(_.current=_.current.filter(X=\u003eX!==z.notes[0]),u\u0026\u0026u(z)),k(_.current)},{svg:N,children:U}=tl({...o,colorize:[...o.colorize||[],{keys:T,color:\"red\"}]});return In.default.createElement(\"svg\",{...N},U.filter(z=\u003e!!z).map(({polygon:z,circle:X,text:K,key:$},Y)=\u003e[z\u0026\u0026In.default.createElement(\"polygon\",{...z,key:\"p\"+Y,...D($),onMouseUp:()=\u003eA($),onClick:()=\u003er\u0026\u0026r($)}),X\u0026\u0026In.default.createElement(\"circle\",{...X,key:\"c\"+Y,style:{pointerEvents:\"none\"}}),K\u0026\u0026In.default.createElement(\"text\",{...K,key:\"t\"+Y,style:{pointerEvents:\"none\",userSelect:\"none\"}},K.value)]))}var gs=Be(ni()),Pa=Be(ni()),Rp=Be(Da()),Fl=Be(Ca()),{PolySynth:Fp,Synth:Vp}=Rp,Lp=[...gs.Note.names(),...gs.Note.names().map(o=\u003eo+\"b\"),...gs.Note.names().map(o=\u003eo+\"#\")];function Io(o,r){return Pa.ChordType.get(r).intervals.map(a=\u003egs.Note.transpose(o,a))}var Wp=typeof window!=\"undefined\";function Ea(){let o=(0,qe.useMemo)(()=\u003eWp\u0026\u0026new Fp({maxPolyphony:32,voice:Vp,volume:-12}).toDestination(),[]),[r,a]=(0,qe.useState)(\"C3\"),[u,d]=(0,qe.useState)(\"major\"),[m,_]=(0,qe.useState)(Io(r,u));function T(D){let O=Io(D,u);_(O),o.triggerAttack(O)}let k=(0,Fl.useDrag)(({down:D,first:O,active:A})=\u003e{O\u0026\u0026o.triggerAttack(m),A||o.triggerRelease(m)});return qe.default.createElement(qe.default.Fragment,null,qe.default.createElement(\"select\",{value:r.replace(/[0-9]/,\"\"),onChange:D=\u003e{a(D.target.value+\"3\"),_(Io(D.target.value+\"3\",u))}},Lp.map((D,O)=\u003eqe.default.createElement(\"option\",{key:O},D))),qe.default.createElement(\"select\",{value:u,onChange:D=\u003e{d(D.target.value),_(Io(r,D.target.value))}},Pa.ChordType.names().map((D,O)=\u003eqe.default.createElement(\"option\",{key:O},D))),qe.default.createElement(\"button\",{...k()},\"play\"),qe.default.createElement(\"br\",null),qe.default.createElement(Li,{onAttack:D=\u003e{a(D.notes[0]),T(D.notes[0])},onRelease:()=\u003e{o.triggerRelease(m)},options:{range:[\"B2\",\"C5\"],scaleX:2,scaleY:2,colorize:[{color:\"yellow\",keys:m.map(D=\u003egs.Note.simplify(D))}],labels:m.reduce((D,O)=\u003e({...D,[gs.Note.simplify(O)]:O}),{})}}))}var pe=Be(si()),pn=Be(ni());var fn=Be(ni()),zp=Be(Da()),{PolySynth:Gp,Synth:Bp}=zp,Up=[...fn.Note.names(),...fn.Note.names().map(o=\u003eo+\"b\"),...fn.Note.names().map(o=\u003eo+\"#\")];function Hp(o,r){let a=pn.Scale.get(`${o} ${r}`),u=a.intervals.map(d=\u003epn.RomanNumeral.get(pn.Interval.get(d)).name);return{...a,numerals:u}}var Yp=typeof window!=\"undefined\";function Na(){let o=(0,pe.useMemo)(()=\u003eYp\u0026\u0026new Gp({maxPolyphony:32,voice:Bp,volume:-12}).toDestination(),[]),r=[\"B2\",\"C6\"],[a,u]=(0,pe.useState)(\"C\"),[d,m]=(0,pe.useState)(\"major\"),[_,T]=(0,pe.useState)(1),[k,D]=(0,pe.useState)(2),{notes:O,numerals:A,intervals:N}=Hp(a,d),[U,z]=(0,pe.useState)([]);function X($,Y=3,st=2){let R=[$];for(let P=1;P\u003cY;++P){let B=R[R.length-1],F=O.indexOf(fn.Note.get(B).pc),tt=F+st,at=N[tt%N.length];tt\u003eN.length-1\u0026\u0026(at=pn.Interval.add(at,\"8P\")),at=pn.Interval.substract(at,N[F]);let pt=fn.Note.transpose(B,at);R.push(pt)}return R}function K($){return $.notes.find(Y=\u003eO.includes(Y.replace(/[0-9]/,\"\")))}return pe.default.createElement(pe.default.Fragment,null,pe.default.createElement(\"select\",{value:a,onChange:$=\u003eu($.target.value)},Up.map(($,Y)=\u003epe.default.createElement(\"option\",{key:Y},$))),pe.default.createElement(\"select\",{value:d,onChange:$=\u003em($.target.value)},pn.Scale.names().map(($,Y)=\u003epe.default.createElement(\"option\",{key:Y},$))),pe.default.createElement(\"select\",{value:_+\"\",onChange:$=\u003eT(parseInt($.target.value))},[1,2,3,4,5,6,7].map(($,Y)=\u003epe.default.createElement(\"option\",{key:Y,value:$},$,\" note\",Y?\"s\":\"\"))),_\u003e1\u0026\u0026pe.default.createElement(\"select\",{value:k+\"\",onChange:$=\u003eD(parseInt($.target.value))},[1,2,3,4,5,6,7].map(($,Y)=\u003epe.default.createElement(\"option\",{key:Y,value:$},\"stacking \",[\"\",\"seconds\",\"thirds\",\"fourths\",\"fifths\",\"sixths\",\"sevenths\"][$]))),pe.default.createElement(\"br\",null),pe.default.createElement(Li,{onAttack:$=\u003e{let Y=K($);if(!Y)return;let st=X(Y,_,k);z(st),o.triggerAttack(st)},onRelease:$=\u003e{let Y=K($);if(!Y)return;let st=X(Y,_,k);z([]),o.triggerRelease(st)},options:{range:r,scaleX:1.3,scaleY:1.3,colorize:[{color:\"yellow\",keys:U.map($=\u003efn.Note.simplify($))},{color:\"lightblue\",keys:pn.Range.chromatic(r).filter($=\u003e!!O.find(Y=\u003efn.Note.chroma(Y)===fn.Note.chroma($))).map($=\u003efn.Note.simplify($))}],labels:N.map($=\u003efn.Note.transpose(a+\"3\",$)).reduce(($,Y,st)=\u003e({...$,[Y]:A[st]}),{})}}))}var Xp={title:\"Chords and Scales\",date:\"2020-03-27\",tags:[\"music theory\"],description:\"Let's use the SVG Piano to display chords.\",image:\"./img/chords-scales.png\"};function Qp(o){let r=Object.assign({p:\"p\",a:\"a\",pre:\"pre\",code:\"code\",span:\"span\",h2:\"h2\"},o.components),{wrapper:a}=r,u=(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(r.p,{children:[\"Let's use the SVG Piano to display chords. My favourite lib for music theory in javascript is \",(0,M.jsx)(r.a,{href:\"https://github.com/tonaljs/tonal\",children:\"tonal\"}),`.\nIt comes with a dictionary that contains all more or less common chords. We will use that to build a simple chord selection.\nTo get the notes of a chord on a certain root, we can do it like this:`]}),`\n`,(0,M.jsx)(r.pre,{className:\"language-js\",children:(0,M.jsxs)(r.code,{className:\"language-js\",children:[(0,M.jsx)(r.span,{className:\"token comment\",children:\"// we can get all chord symbols with ChordType.names()\"}),`\n`,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,M.jsx)(r.span,{className:\"token function\",children:\"getChordNotes\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),(0,M.jsxs)(r.span,{className:\"token parameter\",children:[\"tonic\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\",\"}),\" symbol\"]}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,M.jsx)(r.span,{className:\"token maybe-class-name\",children:\"ChordType\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"get\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),\"symbol\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token property-access\",children:\"intervals\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"map\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),(0,M.jsx)(r.span,{className:\"token parameter\",children:\"interval\"}),\" \",(0,M.jsx)(r.span,{className:\"token arrow operator\",children:\"=\u003e\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token maybe-class-name\",children:\"Note\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"transpose\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),\"tonic\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\",\"}),\" interval\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),`\n`,(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,M.jsx)(r.p,{children:\"If we combine this with our svg piano, and some mouse events + colorization + labels, we can build this:\"}),`\n`,(0,M.jsx)(Ea,{}),`\n`,(0,M.jsxs)(r.h2,{id:\"scales--step-chords\",children:[(0,M.jsx)(r.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#scales--step-chords\",children:(0,M.jsx)(r.span,{className:\"icon icon-link\"})}),\"Scales + Step Chords\"]}),`\n`,(0,M.jsx)(r.p,{children:\"Tonal also knows scales:\"}),`\n`,(0,M.jsx)(r.pre,{className:\"language-js\",children:(0,M.jsxs)(r.code,{className:\"language-js\",children:[(0,M.jsx)(r.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,M.jsx)(r.span,{className:\"token function\",children:\"getScaleWithNumerals\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),(0,M.jsxs)(r.span,{className:\"token parameter\",children:[\"root\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\",\"}),\" name\"]}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"const\"}),\" scale \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" \",(0,M.jsx)(r.span,{className:\"token maybe-class-name\",children:\"Scale\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"get\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),(0,M.jsxs)(r.span,{className:\"token template-string\",children:[(0,M.jsx)(r.span,{className:\"token template-punctuation string\",children:\"`\"}),(0,M.jsxs)(r.span,{className:\"token interpolation\",children:[(0,M.jsx)(r.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"root\",(0,M.jsx)(r.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,M.jsx)(r.span,{className:\"token string\",children:\" \"}),(0,M.jsxs)(r.span,{className:\"token interpolation\",children:[(0,M.jsx)(r.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"name\",(0,M.jsx)(r.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,M.jsx)(r.span,{className:\"token template-punctuation string\",children:\"`\"})]}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"const\"}),\" numerals \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" scale\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token property-access\",children:\"intervals\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"map\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token parameter\",children:\"interval\"}),\" \",(0,M.jsx)(r.span,{className:\"token arrow operator\",children:\"=\u003e\"}),\" \",(0,M.jsx)(r.span,{className:\"token maybe-class-name\",children:\"RomanNumeral\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"get\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),(0,M.jsx)(r.span,{className:\"token maybe-class-name\",children:\"Interval\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"get\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),\"interval\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token property-access\",children:\"name\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,M.jsx)(r.span,{className:\"token spread operator\",children:\"...\"}),\"scale\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\",\"}),\" numerals \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"}\"}),`\n`,(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,M.jsx)(r.p,{children:`It would be cool to trigger step chords with the mouse.\nA step chord is nothing but a every other note in the scale starting from any note in the scale:`}),`\n`,(0,M.jsx)(r.pre,{className:\"language-js\",children:(0,M.jsxs)(r.code,{className:\"language-js\",children:[(0,M.jsx)(r.span,{className:\"token comment\",children:\"// variables obtained from getScaleWithNumerals:\"}),`\n`,(0,M.jsx)(r.span,{className:\"token comment\",children:\"// notes = pitches in scale\"}),`\n`,(0,M.jsx)(r.span,{className:\"token comment\",children:\"// intervals = intervals of scale\"}),`\n`,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,M.jsx)(r.span,{className:\"token function\",children:\"getStepChord\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),(0,M.jsxs)(r.span,{className:\"token parameter\",children:[\"root\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\",\"}),\" count \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" \",(0,M.jsx)(r.span,{className:\"token number\",children:\"3\"})]}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"let\"}),\" chordNotes \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"[\"}),\"root\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"]\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token keyword control-flow\",children:\"for\"}),\" \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),(0,M.jsx)(r.span,{className:\"token keyword\",children:\"let\"}),\" i \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" \",(0,M.jsx)(r.span,{className:\"token number\",children:\"1\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"\u003c\"}),\" count\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"++\"}),\"i\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"{\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"const\"}),\" lastNote \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" chordNotes\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"[\"}),\"chordNotes\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token property-access\",children:\"length\"}),\" \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"-\"}),\" \",(0,M.jsx)(r.span,{className:\"token number\",children:\"1\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"]\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"const\"}),\" index \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" notes\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"indexOf\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),(0,M.jsx)(r.span,{className:\"token maybe-class-name\",children:\"Note\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"get\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),\"lastNote\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token property-access\",children:\"pc\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"const\"}),\" nextIndex \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" index \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"+\"}),\" \",(0,M.jsx)(r.span,{className:\"token number\",children:\"2\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"let\"}),\" nextInterval \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" intervals\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"[\"}),\"nextIndex \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"%\"}),\" intervals\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token property-access\",children:\"length\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"]\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),\"nextIndex \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"\u003e\"}),\" intervals\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token property-access\",children:\"length\"}),\" \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"-\"}),\" \",(0,M.jsx)(r.span,{className:\"token number\",children:\"1\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"{\"}),`\n      nextInterval `,(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" \",(0,M.jsx)(r.span,{className:\"token maybe-class-name\",children:\"Interval\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"add\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),\"nextInterval\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,M.jsx)(r.span,{className:\"token string\",children:'\"8P\"'}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"}\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token comment\",children:\"// make next interval relative to current root\"}),`\n    nextInterval `,(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" \",(0,M.jsx)(r.span,{className:\"token maybe-class-name\",children:\"Interval\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"substract\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),\"nextInterval\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\",\"}),\" intervals\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"[\"}),\"index\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"]\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),`\n    `,(0,M.jsx)(r.span,{className:\"token keyword\",children:\"const\"}),\" nextNote \",(0,M.jsx)(r.span,{className:\"token operator\",children:\"=\"}),\" \",(0,M.jsx)(r.span,{className:\"token maybe-class-name\",children:\"Note\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"transpose\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),\"lastNote\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\",\"}),\" nextInterval\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),`\n    chordNotes`,(0,M.jsx)(r.span,{className:\"token punctuation\",children:\".\"}),(0,M.jsx)(r.span,{className:\"token method function property-access\",children:\"push\"}),(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"(\"}),\"nextNote\",(0,M.jsx)(r.span,{className:\"token punctuation\",children:\")\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"}\"}),`\n  `,(0,M.jsx)(r.span,{className:\"token keyword control-flow\",children:\"return\"}),` chordNotes\n`,(0,M.jsx)(r.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,M.jsx)(r.p,{children:`Disabling all keys that are not in scale + applying coloring (blue = scale note, yellow = played note).\nMake sure you try more than one note to let the magic happen!`}),`\n`,(0,M.jsx)(Na,{})]});return a?(0,M.jsx)(a,Object.assign({},o,{children:u})):u}var Zp=Qp;return Kp;})();\n/*! *****************************************************************************\n    Copyright (c) Microsoft Corporation.\n\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */\n/**\n * Tone.js\n * @author Yotam Mann\n * @license http://opensource.org/licenses/MIT MIT License\n * @copyright 2014-2019 Yotam Mann\n */\n;return Component.default;"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"chords"},"buildId":"G5eXQ8z6A3k3-xRBvlX_5","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>